/*!
*  filename: ej2-pivotview.min.js
*  version : 29.2.4
*  Copyright Syncfusion Inc. 2001 - 2024. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("SyncfusionBase"),require("SyncfusionData"),require("SyncfusionPdfExport"),require("SyncfusionPopups"),require("SyncfusionGrids"),require("SyncfusionNavigations"),require("SyncfusionInputs"),require("SyncfusionDropdowns"),require("SyncfusionCalendars"),require("SyncfusionSplitbuttons"),require("SyncfusionButtons"),require("SyncfusionCharts"),require("SyncfusionSvgBase"),require("SyncfusionFileUtils"),require("SyncfusionExcelExport")):"function"==typeof define&&define.amd?define(["SyncfusionBase","SyncfusionData","SyncfusionPdfExport","SyncfusionPopups","SyncfusionGrids","SyncfusionNavigations","SyncfusionInputs","SyncfusionDropdowns","SyncfusionCalendars","SyncfusionSplitbuttons","SyncfusionButtons","SyncfusionCharts","SyncfusionSvgBase","SyncfusionFileUtils","SyncfusionExcelExport"],t):"object"==typeof exports?exports.SyncfusionPivotview=t(require("SyncfusionBase"),require("SyncfusionData"),require("SyncfusionPdfExport"),require("SyncfusionPopups"),require("SyncfusionGrids"),require("SyncfusionNavigations"),require("SyncfusionInputs"),require("SyncfusionDropdowns"),require("SyncfusionCalendars"),require("SyncfusionSplitbuttons"),require("SyncfusionButtons"),require("SyncfusionCharts"),require("SyncfusionSvgBase"),require("SyncfusionFileUtils"),require("SyncfusionExcelExport")):e.SyncfusionPivotview=t(e.SyncfusionBase,e.SyncfusionData,e.SyncfusionPdfExport,e.SyncfusionPopups,e.SyncfusionGrids,e.SyncfusionNavigations,e.SyncfusionInputs,e.SyncfusionDropdowns,e.SyncfusionCalendars,e.SyncfusionSplitbuttons,e.SyncfusionButtons,e.SyncfusionCharts,e.SyncfusionSvgBase,e.SyncfusionFileUtils,e.SyncfusionExcelExport)}(self,((e,t,i,a,r,n,s,o,l,d,h,p,u,c,g)=>(()=>{"use strict";var m={766:t=>{t.exports=e},741:e=>{e.exports=h},570:e=>{e.exports=l},60:e=>{e.exports=p},74:e=>{e.exports=t},778:e=>{e.exports=o},437:e=>{e.exports=g},115:e=>{e.exports=c},707:e=>{e.exports=r},323:e=>{e.exports=s},215:e=>{e.exports=n},461:e=>{e.exports=i},197:e=>{e.exports=a},295:e=>{e.exports=d},727:e=>{e.exports=u}},f={};function v(e){var t=f[e];if(void 0!==t)return t.exports;var i=f[e]={exports:{}};return m[e](i,i.exports,v),i.exports}v.d=(e,t)=>{for(var i in t)v.o(t,i)&&!v.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},v.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),v.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var S={};return(()=>{v.r(S),v.d(S,{AggregateMenu:()=>Ss,Authentication:()=>zs,AxisFieldRenderer:()=>bl,AxisTableRenderer:()=>Sl,CalculatedField:()=>Rl,CalculatedFieldSettings:()=>_s,CellEditSettings:()=>al,Common:()=>Es,CommonKeyboardInteraction:()=>bs,ConditionalFormatSettings:()=>js,ConditionalFormatting:()=>Vl,ConditionalSettings:()=>rl,CustomGroups:()=>Us,DataSourceSettings:()=>Ws,DataSourceUpdate:()=>ws,DialogRenderer:()=>fl,DisplayOption:()=>ll,DrillOptions:()=>Bs,DrillThrough:()=>eo,ErrorDialog:()=>Ts,EventBase:()=>Cs,ExcelExport:()=>cl,FieldList:()=>kl,FieldListFieldOptions:()=>As,FieldOptions:()=>Ls,Filter:()=>ks,FilterDialog:()=>Ps,FormatSettings:()=>Vs,GroupSettings:()=>Hs,Grouping:()=>_l,GroupingBar:()=>ql,GroupingBarSettings:()=>il,HyperlinkSettings:()=>nl,KeyboardInteraction:()=>Xs,MDXQuery:()=>Yo,MdxQuery:()=>jr,NodeStateModified:()=>xs,NumberFormatting:()=>Ul,OlapEngine:()=>Ko,PDFExport:()=>gl,PageSettings:()=>sl,Pager:()=>ml,PagerSettings:()=>ol,PivotChart:()=>io,PivotCommon:()=>Ns,PivotContextMenu:()=>Js,PivotEngine:()=>Pi,PivotFieldList:()=>Tl,PivotUtil:()=>Di,PivotView:()=>hl,Render:()=>ys,Sort:()=>qs,Style:()=>Rs,Toolbar:()=>Hl,TreeViewRenderer:()=>vl,ValueSortSettings:()=>Gs,VirtualScroll:()=>Zs,VirtualScrollSettings:()=>dl,actionBegin:()=>or,actionComplete:()=>lr,actionDropped:()=>us,actionFailure:()=>dr,addNewRecord:()=>mn,addNewReport:()=>Nr,afterPivotTableRender:()=>ki,afterServiceInvoke:()=>sr,aggregateCellInfo:()=>Ba,aggregateField:()=>vn,aggregateMenuOpen:()=>ir,animationComplete:()=>wa,axisLabelFont:()=>ao,axisTitleFont:()=>ro,beforeColumnsRender:()=>Zi,beforeExcelExport:()=>Xa,beforeExport:()=>ji,beforePdfExport:()=>Ka,beforePivotTableRender:()=>Ri,beforePrint:()=>xa,beforeServiceInvoke:()=>nr,beginDrillThrough:()=>oa,calculatedFieldApplied:()=>xn,calculatedFieldCreate:()=>Za,calculatedFieldEdited:()=>Zn,cellClick:()=>Xi,cellDeselected:()=>ra,cellSelected:()=>aa,cellSelecting:()=>ta,chartAxisLabelRender:()=>Ua,chartLegendClick:()=>ya,chartLoad:()=>Va,chartLoaded:()=>ba,chartMouseClick:()=>Na,chartMouseDown:()=>Fa,chartMouseLeave:()=>Ia,chartMouseMove:()=>Pa,chartMouseUp:()=>La,chartPointClick:()=>rr,chartResized:()=>Ha,chartSeriesCreated:()=>_a,chartSubTitleFont:()=>so,chartTitleFont:()=>no,chartTooltipRender:()=>Sa,chartView:()=>Hr,chartViewed:()=>_n,click:()=>Cr,closeFieldlist:()=>Dn,columnPageNavigated:()=>ps,columnPageNavigation:()=>Cn,conditionalFormatting:()=>Ya,conditionalFormattingMenu:()=>nn,conditionallyFormatted:()=>Vn,contentReady:()=>mr,contextMenuCalculatedField:()=>Sn,contextMenuClick:()=>za,contextMenuOpen:()=>Wa,crosshairLabelFont:()=>oo,csvExport:()=>Wr,csvExported:()=>An,dataBound:()=>Gi,dataReady:()=>fr,dragComplete:()=>Aa,drill:()=>ia,drillDown:()=>Pr,drillThrough:()=>Ji,drillThroughClosed:()=>os,drillUp:()=>Or,editCalculatedField:()=>ln,editCompleted:()=>la,editRecord:()=>cn,editedRecordsSaved:()=>wn,enginePopulated:()=>Fi,enginePopulating:()=>Ii,excelExport:()=>zr,excelExported:()=>Ln,excelHeaderQueryCellInfo:()=>Vi,excelQueryCellInfo:()=>Ui,exportComplete:()=>qi,fetchReport:()=>pa,fieldAggregated:()=>is,fieldDragStart:()=>ar,fieldDrop:()=>Ai,fieldFiltered:()=>es,fieldListRefreshed:()=>Qa,fieldRemove:()=>er,fieldRemoved:()=>ts,fieldSorted:()=>$n,fieldTreeSorted:()=>On,filterField:()=>hn,grandTotalsColumn:()=>tn,grandTotalsColumnShown:()=>Kn,grandTotalsHidden:()=>Qn,grandTotalsRow:()=>en,grandTotalsRowShown:()=>Yn,grandTotalsShown:()=>Xn,headerCellInfo:()=>Wi,hideGrandTotals:()=>$r,hideSubTotals:()=>Kr,horizontalScroll:()=>gr,horizontalScrolled:()=>ds,hyperlinkCellClick:()=>Qi,initCalculatedField:()=>br,initFormatting:()=>Tr,initGrouping:()=>Mr,initPivotPager:()=>wr,initSubComponent:()=>vr,initToolbar:()=>xr,initialLoad:()=>hr,invalidFormula:()=>cs,jpegExport:()=>Qr,jpegExported:()=>jn,legendLabelFont:()=>ho,legendRender:()=>Ta,load:()=>Ei,loadReport:()=>ua,loadReports:()=>Ar,memberEditorOpen:()=>$a,memberFiltering:()=>Ja,multiLevelLabelClick:()=>da,multiLevelLabelRender:()=>Ca,multipleAxis:()=>Ur,newRecordAdded:()=>Tn,newReport:()=>ma,newReportAdded:()=>Nn,numberFormatted:()=>Hn,numberFormatting:()=>tr,numberFormattingMenu:()=>rn,onFieldDropped:()=>Li,onHeadersSort:()=>Ga,onPdfCellRender:()=>Bi,openCalculatedField:()=>un,openConditionalFormatting:()=>Rr,openNumberFormatting:()=>kr,pdfExport:()=>Br,pdfExported:()=>Rn,pdfHeaderQueryCellInfo:()=>Hi,pdfQueryCellInfo:()=>_i,pivotButtonUpdate:()=>yr,pngExport:()=>Gr,pngExported:()=>kn,pointMove:()=>Ea,pointRender:()=>Da,queryCellInfo:()=>zi,recordEdited:()=>as,recordRemoved:()=>Mn,recordUpdated:()=>ss,removeCurrentReport:()=>Lr,removeField:()=>pn,removeRecord:()=>fn,removeReport:()=>ga,renameCurrentReport:()=>Fr,renameReport:()=>ca,reportChange:()=>sn,reportChanged:()=>rs,reportReSaved:()=>En,reportRemoved:()=>Fn,reportRenamed:()=>In,reportSaved:()=>Pn,resizeStop:()=>Ki,resizing:()=>Yi,rowDeselected:()=>sa,rowPageNavigated:()=>hs,rowPageNavigation:()=>bn,rowSelected:()=>na,saveAsCurrentReport:()=>Ir,saveCurrentReport:()=>Er,saveEditedRecords:()=>gn,saveReport:()=>ha,scroll:()=>ur,scrollChanged:()=>qa,scrollEnd:()=>ja,scrollStart:()=>ka,selected:()=>$i,selecting:()=>ea,seriesRender:()=>Oa,showFieldList:()=>qr,showGrandTotals:()=>an,showLegend:()=>_r,showSubTotals:()=>Zr,sortField:()=>dn,sortFieldTree:()=>on,sortValue:()=>Dr,stockEventFont:()=>uo,stripLineLabelFont:()=>po,subTotalsColumn:()=>Jr,subTotalsColumnShown:()=>zn,subTotalsHidden:()=>Bn,subTotalsRow:()=>Xr,subTotalsRowShown:()=>Gn,subTotalsShown:()=>Wn,svgExport:()=>Yr,svgExported:()=>qn,tableView:()=>Vr,tableViewed:()=>Un,textRender:()=>Ma,toolbarClick:()=>va,toolbarRender:()=>fa,tooltipLabelFont:()=>lo,treeViewUpdate:()=>Sr,uiUpdate:()=>pr,valueSorted:()=>Jn,verticalScroll:()=>cr,verticalScrolled:()=>ls,windowResize:()=>yn,windowResized:()=>ns,zoomComplete:()=>Ra});var e,t=v(766),i=v(74),a=v(461),r="e-pivotfieldlist",n="e-rtl",s="e-device",o="e-icons",l="e-disable",d="e-hide",h="e-icon-first",p="e-icon-last",u="e-icon-prev",c="e-icon-next",g="e-dropdown-icon",m="e-pivotfieldlist-container",f="e-toggle-field-list",y="e-static",b="e-draggable",C="e-field-list",x="e-field-list-tree-outer-div",w="e-field-list-tree-outer-div-searchMode",T="e-search-mode",M="e-pivot-parent",D="e-pivot-child",O="e-field-list-footer",P="e-left-axis-fields",N="e-right-axis-fields",E="e-all-fields-axis",I="e-axis-content",F="e-draggable-prompt",L="e-pvt-btn-div",A="e-pivot-button",R="e-content",k="e-pvt-btn-content",j="e-sort",q="e-member-sort",V="e-descend",H="e-btn-filter",U="e-pv-filter",_="e-pv-filtered",B="e-remove",G="e-drag",z="e-disable-drag",W="e-drop-indicator",Q="e-drop-hover",Y="e-member-editor-outer-container",K="e-member-editor-container",X="e-drillthrough-body-header",J="e-drillthrough-body-header-common",Z="e-drillthrough-body-header-value",$="e-frame",ee="e-check",te="e-stop",ie="e-ok-btn",ae="e-cancel-btn",re="e-pivot-error-dialog",ne="e-droppable",se="e-rows",oe="e-columns",le="e-values",de="e-filters",he="e-grouping-bar",pe="e-group-all-fields",ue="e-group-rows",ce="e-group-columns",ge="e-group-values",me="e-group-filters",fe="e-drag-restrict",ve="e-list-selected",Se="e-title-header",ye="e-text-content",be="e-field-list-btn",Ce="e-calculated-field-btn",xe="e-small",we="e-round",Te="e-add-icon",Me="e-flat",De="e-list-text",Oe="e-selected-node",Pe="e-selected-option-icon",Ne="e-selected-level-icon",Ee="e-between-text-div",Ie="e-filter-input-div-2",Fe="e-value-options",Le="e-filter-operator",Ae="e-filter-sort",Re="e-sort-ascend-icon",ke="e-sort-descend-icon",je="e-active",qe="e-collapse",Ve="e-expand",He="e-table",Ue="e-columnsheader",_e="e-rowsheader",Be="e-headercell",Ge="e-cellvalue",ze="e-tooltipheader",We="e-tooltipcontent",Qe="e-nextspan",Ye="e-lastspan",Ke="e-editor-search-container",Xe="e-editor-search",Je="e-select-all",Ze="e-pivot-calc-check",$e="e-pivot-calc-input",et="e-custom-format-input",tt="e-olap-calc-hierarchy-list-div",it="e-pivot-calc-format-type-div",at="e-olap-calc-member-type-div",rt="e-member-options",nt="e-format",st="e-pivot-formula",ot="e-pivot-treeview",lt="e-pivot-treeview-outer",dt="e-treeContainer",ht="e-pivot-ok-button",pt="e-pivot-button-div",ut="e-axis",ct="e-axis-filter",gt="e-grid",mt="e-pivotview",ft="e-pivot-all-field-title",vt="e-disabled",St="e-menu-hide",yt="e-member-prompt",bt="e-edit",Ct="e-edited",xt="e-info",wt="e-empty-field",Tt="e-format-condition-button",Mt="e-format-table",Dt="e-input",Ot="e-visible-hide",Pt="e-format-color-picker",Nt="e-dlg-header",Et="e-virtualtrack",It="e-movablescrolldiv",Ft="e-content-virtualtable",Lt="e-movablescroll",At="e-headercontent",Rt="e-cellselectionbackground",kt="e-selectionbackground",jt="e-checkbox-wrapper",qt="e-headercontent",Vt="e-field-list-back-icon",Ht="e-rowcell",Ut="e-active",_t="e-spanclicked",Bt="e-rowselect",Gt="e-gridheader",zt="e-gridcontent",Wt="e-pivotview-pdf-export",Qt="e-pivotview-excel-export",Yt="e-pivotview-csv-export",Kt="e-remove-report",Xt="e-pivot-toolbar",Jt="e-pivotview-report-input",Zt="e-toolbar-grid",$t="e-toolbar-chart",ei="e-pivotchart",ti="e-group-chart-rows",ii="e-group-chart-columns",ai="e-group-chart-values",ri="e-group-chart-values-drodown-div",ni="e-group-chart-columns-dropdown-div",si="e-chart-grouping-bar",oi="e-pivotview-disable-icon",li="e-pivotview-select-icon",di="e-pivot-grouping-bar",hi="e-mdx-query-content",pi="e-pivotchart-inner",ui="e-group-pivot-rows",ci="e-pivot-toolbar-menu",gi="e-pivot-pager",mi="e-pagercontainer",fi="e-page-size-disable",vi="e-node-limit",Si="e-leftfreeze",yi="e-pivot-content-loader",bi="e-hide-loader",Ci="e-icon-collapsible",xi="e-icon-expandable",wi="e-pivotview-autofit",Ti="e-group-row",Mi="e-freezeleftborder",Di=function(){function e(){}return e.getType=function(e){var t=new Date(e);return"boolean"==typeof e?"boolean":isNaN(Number(e))?t instanceof Date&&!isNaN(t.valueOf())?t&&t.getDay()&&(t.getHours()>0||t.getMinutes()>0||t.getSeconds()>0||t.getMilliseconds()>0)?"datetime":"date":typeof e:"number"},e.resetTime=function(e){return e.setHours(0,0,0,0),e},e.getClonedData=function(e){var t=[];if(e)for(var i=0,a=e;i<a.length;i++){for(var r=a[i],n=Object.keys(r),s=0,o={};s<n.length;)o[n[s]]=r[n[s]],s++;t.push(o)}return t},e.getClonedCSVData=function(e){return e.map((function(e){return e.slice()}))},e.getDefinedObj=function(e){var t=0,i={};if(null!=e)for(var a=Object.keys(e);t<a.length;)null!==e[a[t]]&&void 0!==e[a[t]]&&(i[a[t]]=e[a[t]]),t++;else i=e;return i},e.inArray=function(e,t){if(t)for(var i=0,a=t.length;i<a;i++)if(t[i]===e)return i;return-1},e.setPivotProperties=function(e,t){e.allowServerDataBinding=!1,e.pivotGridModule&&(e.pivotGridModule.allowServerDataBinding=!1),e.setProperties(t,!0),e.allowServerDataBinding=!0,e.pivotGridModule&&(e.pivotGridModule.allowServerDataBinding=!0)},e.getClonedDataSourceSettings=function(e){return this.getDefinedObj({type:e.type,catalog:e.catalog,cube:e.cube,providerType:e.providerType,url:e.url,localeIdentifier:e.localeIdentifier,excludeFields:(0,t.isNullOrUndefined)(e.excludeFields)?[]:e.excludeFields.slice(),expandAll:e.expandAll,allowLabelFilter:e.allowLabelFilter,allowValueFilter:e.allowValueFilter,allowMemberFilter:e.allowMemberFilter,enableSorting:!!e.enableSorting,rows:this.cloneFieldSettings(e.rows),columns:this.cloneFieldSettings(e.columns),filters:this.cloneFieldSettings(e.filters),values:this.cloneFieldSettings(e.values),filterSettings:this.cloneFilterSettings(e.filterSettings),sortSettings:this.cloneSortSettings(e.sortSettings),drilledMembers:this.cloneDrillMemberSettings(e.drilledMembers),valueSortSettings:this.CloneValueSortObject(e.valueSortSettings),valueAxis:e.valueAxis,valueIndex:e.valueIndex,grandTotalsPosition:e.grandTotalsPosition,formatSettings:this.cloneFormatSettings(e.formatSettings),calculatedFieldSettings:this.cloneCalculatedFieldSettings(e.calculatedFieldSettings),fieldMapping:this.cloneFieldSettings(e.fieldMapping),showSubTotals:e.showSubTotals,showRowSubTotals:e.showRowSubTotals,showColumnSubTotals:e.showColumnSubTotals,subTotalsPosition:e.subTotalsPosition,showGrandTotals:e.showGrandTotals,showRowGrandTotals:e.showRowGrandTotals,showColumnGrandTotals:e.showColumnGrandTotals,showHeaderWhenEmpty:e.showHeaderWhenEmpty,alwaysShowValueHeader:e.alwaysShowValueHeader,conditionalFormatSettings:this.cloneConditionalFormattingSettings(e.conditionalFormatSettings),emptyCellsTextContent:e.emptyCellsTextContent,groupSettings:this.cloneGroupSettings(e.groupSettings),showAggregationOnValueField:e.showAggregationOnValueField,authentication:this.CloneAuthenticationObject(e.authentication)})},e.getClonedFieldList=function(e,t){for(var i=Object.keys(e),a={},r=0,n=i.length;r<n;r++){var s=e[i[r]];e[i[r]]&&(a[i[r]]={type:s.type,caption:s.caption,id:s.id,isSelected:s.isSelected,sort:s.sort,filterType:s.filterType,index:s.index,filter:t?[]:s.filter,isCustomField:s.isCustomField,showRemoveIcon:s.showRemoveIcon,showFilterIcon:s.showFilterIcon,showSortIcon:s.showSortIcon,showNoDataItems:s.showNoDataItems,isCalculatedField:s.isCalculatedField,showEditIcon:s.showEditIcon,showValueTypeIcon:s.showValueTypeIcon,allowDragAndDrop:s.allowDragAndDrop,showSubTotals:s.showSubTotals,expandAll:s.expandAll,pid:s.pid,aggregateType:s.aggregateType,baseField:s.baseField,baseItem:s.baseItem,dateMember:t?[]:this.cloneDateMembers(s.dateMember),members:t?{}:this.cloneFormatMembers(s.members),formatString:s.formatString,format:s.format,formula:s.formula,isExcelFilter:s.isExcelFilter,membersOrder:s.membersOrder?s.membersOrder.slice():s.membersOrder,isAlphanumeric:s.isAlphanumeric,tag:s.tag,expanded:s.expanded,spriteCssClass:s.spriteCssClass,name:s.name,defaultHierarchy:s.defaultHierarchy,hasAllMember:s.hasAllMember,allMember:s.allMember,isChecked:s.isChecked,filterMembers:this.cloneFieldMembers(s.filterMembers),childMembers:t?[]:this.cloneFieldMembers(s.childMembers),searchMembers:t?[]:this.cloneFieldMembers(s.searchMembers),htmlAttributes:this.getDefinedObj(s.htmlAttributes),currrentMembers:t?{}:this.cloneFormatMembers(s.currrentMembers),isHierarchy:s.isHierarchy,isNamedSets:s.isNamedSets,actualFilter:s.actualFilter?s.actualFilter.slice():s.actualFilter,levels:t?[]:this.cloneFieldMembers(s.levels),levelCount:s.levelCount,fieldType:s.fieldType,memberType:s.memberType,parentHierarchy:s.parentHierarchy})}return a},e.cloneDateMembers=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push({formattedText:r.formattedText,actualText:r.actualText})}return t}return e},e.cloneFormatMembers=function(e){if(e){for(var t=Object.keys(e),i={},a=0,r=t.length;a<r;a++){var n=e[t[a]];i[t[a]]={index:n.index?n.index.slice():n.index,isDrilled:n.isDrilled,ordinal:n.ordinal}}return i}return e},e.cloneFieldMembers=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push({caption:r.caption,hasChildren:r.hasChildren,id:r.id,isSelected:r.isSelected,name:r.name,tag:r.tag,htmlAttributes:this.getDefinedObj(r.htmlAttributes),type:r.type,spriteCssClass:r.spriteCssClass,pid:r.pid,isChecked:r.isChecked})}return t}return e},e.updateDataSourceSettings=function(e,i){e&&this.setPivotProperties(e,{dataSourceSettings:this.getDefinedObj({type:i.type,catalog:i.catalog,cube:i.cube,providerType:i.providerType,url:i.url,localeIdentifier:i.localeIdentifier,excludeFields:(0,t.isNullOrUndefined)(i.excludeFields)?[]:i.excludeFields,expandAll:i.expandAll,allowLabelFilter:i.allowLabelFilter,allowValueFilter:i.allowValueFilter,allowMemberFilter:i.allowMemberFilter,enableSorting:!!i.enableSorting,rows:i.rows,columns:i.columns,filters:i.filters,values:i.values,filterSettings:i.filterSettings,sortSettings:i.sortSettings,drilledMembers:i.drilledMembers,valueSortSettings:i.valueSortSettings,valueAxis:i.valueAxis,grandTotalsPosition:i.grandTotalsPosition,formatSettings:i.formatSettings,calculatedFieldSettings:i.calculatedFieldSettings,fieldMapping:i.fieldMapping,showSubTotals:i.showSubTotals,showRowSubTotals:i.showRowSubTotals,showColumnSubTotals:i.showColumnSubTotals,subTotalsPosition:i.subTotalsPosition,showGrandTotals:i.showGrandTotals,showRowGrandTotals:i.showRowGrandTotals,showColumnGrandTotals:i.showColumnGrandTotals,showHeaderWhenEmpty:i.showHeaderWhenEmpty,alwaysShowValueHeader:i.alwaysShowValueHeader,conditionalFormatSettings:i.conditionalFormatSettings,emptyCellsTextContent:i.emptyCellsTextContent,groupSettings:i.groupSettings,showAggregationOnValueField:i.showAggregationOnValueField,authentication:this.CloneAuthenticationObject(i.authentication)})})},e.cloneFieldSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({name:r.name,caption:r.caption,axis:r.axis,baseField:r.baseField,baseItem:r.baseItem,isCalculatedField:r.isCalculatedField,isNamedSet:r.isNamedSet,showNoDataItems:r.showNoDataItems,showSubTotals:r.showSubTotals,type:r.type,dataType:r.dataType,showFilterIcon:r.showFilterIcon,showSortIcon:r.showSortIcon,showRemoveIcon:r.showRemoveIcon,showValueTypeIcon:r.showValueTypeIcon,showEditIcon:r.showEditIcon,allowDragAndDrop:r.allowDragAndDrop,expandAll:r.expandAll,groupName:r.groupName}))}return t}return e},e.cloneOlapFieldSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({caption:r.caption,hasChildren:r.hasChildren,id:r.id,isSelected:r.isSelected,name:r.name,spriteCssClass:r.spriteCssClass,tag:r.tag,type:r.type,pid:r.pid,expanded:r.expanded,defaultHierarchy:r.defaultHierarchy,hasAllMember:r.hasAllMember,allMember:r.allMember,isChecked:r.isChecked,filterMembers:r.filterMembers,formula:r.formula,childMembers:r.childMembers,searchMembers:r.searchMembers,htmlAttributes:this.getDefinedObj(r.htmlAttributes),currrentMembers:r.currrentMembers,isHierarchy:r.isHierarchy,isNamedSets:r.isNamedSets,formatString:r.formatString,actualFilter:r.actualFilter,levels:r.levels,levelCount:r.levelCount,memberType:r.memberType,fieldType:r.fieldType,parentHierarchy:r.parentHierarchy}))}return t}return e},e.cloneFilterSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({name:r.name,type:r.type,condition:r.condition,items:r.items?r.items.slice():r.items,levelCount:r.levelCount,measure:r.measure,selectedField:r.selectedField,showDateFilter:r.showDateFilter,showLabelFilter:r.showLabelFilter,showNumberFilter:r.showNumberFilter,value1:r.value1,value2:r.value2}))}return t}return e},e.cloneSortSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({name:r.name,order:r.order,membersOrder:r.membersOrder?r.membersOrder.slice():r.membersOrder}))}return t}return e},e.getFormattedHeader=function(t,i){var a=e.frameHeaderWithKeys(t);if(a.valueSort&&a.valueSort.axis){var r=a.valueSort.axis,n=this.isDateField(r,i);a.formattedText=n||!i.formatFields[r]||!0===t.isSum?a.formattedText:i.getFormattedValue(a.actualText,r).formattedText}return a},e.getFormattedMembers=function(e,t,i){var a=this.isDateField(t,i);if(a||i.groupingFields[t]){for(var r={},n=Object.keys(e),s=i.fieldList[t].dateMember,o=0,l=n.length;o<l;o++){var d=e[n[o]];if(a)r[d.caption]=d;else r[s[d.ordinal-1].actualText]=d}return r}return e},e.isDateField=function(e,t){return t.formatFields[e]&&["date","dateTime","time"].indexOf(t.formatFields[e].type)>-1},e.formatChartHeaders=function(e,i,a,r){for(var n=[],s=0,o=e.length;s<o;s++){var l=a?i.parent.dataSourceSettings.columns.length>0&&!(0,t.isNullOrUndefined)(i.parent.dataSourceSettings.columns[s])?i.parent.dataSourceSettings.columns[s].name:void 0:i.parent.dataSourceSettings.rows.length>0&&!(0,t.isNullOrUndefined)(i.parent.dataSourceSettings.rows[s])?i.parent.dataSourceSettings.rows[s].name:void 0;(0,t.isNullOrUndefined)(l)?r&&r.isGrandSum?n.push(i.parent.localeObj.getConstant("grandTotal")):n.push(e[s]):i.engineModule.formatFields[l]&&["date","dateTime","time"].indexOf(i.engineModule.formatFields[l].type)>-1?n.push(e[s]):n.push(i.engineModule.getFormattedValue(e[s],l).formattedText)}return n.join(" - ")},e.cloneDrillMemberSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({name:r.name,delimiter:r.delimiter,items:r.items?r.items.slice():r.items}))}return t}return e},e.cloneFormatSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({name:r.name,calendar:r.calendar,currency:r.currency,format:r.format,maximumFractionDigits:r.maximumFractionDigits,maximumSignificantDigits:r.maximumSignificantDigits,minimumFractionDigits:r.minimumFractionDigits,minimumIntegerDigits:r.minimumIntegerDigits,minimumSignificantDigits:r.minimumSignificantDigits,skeleton:r.skeleton,type:r.type,useGrouping:r.useGrouping}))}return t}return e},e.CloneValueSortObject=function(e){return e?{columnIndex:e.columnIndex,headerDelimiter:e.headerDelimiter,headerText:e.headerText,measure:e.measure,sortOrder:e.sortOrder}:e},e.CloneAuthenticationObject=function(e){return e?{userName:e.userName,password:e.password}:e},e.cloneCalculatedFieldSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({name:r.name,formatString:r.formatString,formula:r.formula,hierarchyUniqueName:r.hierarchyUniqueName}))}return t}return e},e.cloneConditionalFormattingSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({applyGrandTotals:r.applyGrandTotals,conditions:r.conditions,label:r.label,measure:r.measure,style:r.style?{backgroundColor:r.style.backgroundColor,color:r.style.color,fontFamily:r.style.fontFamily,fontSize:r.style.fontSize}:r.style,value1:r.value1,value2:r.value2}))}return t}return e},e.cloneGroupSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({name:r.name,caption:r.caption,customGroups:this.cloneCustomGroups(r.customGroups),endingAt:r.endingAt,startingAt:r.startingAt,groupInterval:r.groupInterval,rangeInterval:r.rangeInterval,type:r.type}))}return t}return e},e.cloneCustomGroups=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({groupName:r.groupName,items:r.items?r.items.slice():r.items}))}return t}return e},e.getFilterItemByName=function(e,t){var a=new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e));if(a&&a.length>0)return a[a.length-1]},e.getFieldByName=function(e,t){return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.getFieldInfo=function(e,t,i){if(!i)for(var a=[this.cloneFieldSettings(t.dataSourceSettings.rows),this.cloneFieldSettings(t.dataSourceSettings.columns),this.cloneFieldSettings(t.dataSourceSettings.values),this.cloneFieldSettings(t.dataSourceSettings.filters)],r=0,n=a.length;r<n;r++)for(var s=0,o=a[r]?a[r].length:0;s<o;s++)if(a[r][s]&&a[r][s].name===e)return{fieldName:e,fieldItem:a[r][s],axis:0===r?"rows":1===r?"columns":2===r?"values":"filters",position:s};var l="olap"===t.dataType?t.olapEngineModule.fieldList[e]:t.engineModule.fieldList[e];return{fieldName:e,fieldItem:l?{name:e,caption:l.caption,baseField:l.baseField,baseItem:l.baseItem,isCalculatedField:l.isCalculatedField,isNamedSet:l.isNamedSets,showNoDataItems:l.showNoDataItems,showSubTotals:l.showSubTotals,type:l.aggregateType,showFilterIcon:l.showFilterIcon,showSortIcon:l.showSortIcon,showRemoveIcon:l.showRemoveIcon,showValueTypeIcon:l.showValueTypeIcon,showEditIcon:l.showEditIcon,allowDragAndDrop:l.allowDragAndDrop,expandAll:l.expandAll}:void 0,axis:"fieldlist",position:-1}},e.isButtonIconRefesh=function(e,i,a){var r=!1;try{if("dataSourceSettings"===e&&i.dataSourceSettings&&a.dataSourceSettings){var n=["notAvail","notAvail","notAvail","notAvail"],s=Object.keys(i.dataSourceSettings),o=Object.keys(a.dataSourceSettings);if(s&&o&&o.length>0&&s.length===o.length)for(var l=["rows","columns","values","filters"],d=0;d<o.length;d++){var h=o[d]in i.dataSourceSettings&&!(0,t.isNullOrUndefined)(i.dataSourceSettings[o[d]])?Object.keys(i.dataSourceSettings[o[d]]):[],p=o[d]in a.dataSourceSettings&&!(0,t.isNullOrUndefined)(a.dataSourceSettings[o[d]])?Object.keys(a.dataSourceSettings[o[d]]):[];if(-1!==l.indexOf(o[d])&&-1!==l.indexOf(s[d])&&h&&p&&p.length>0&&h.length===p.length)for(var u=["showFilterIcon","showSortIcon","showRemoveIcon","showValueTypeIcon","showEditIcon","allowDragAndDrop","expandAll"],c=0;c<p.length;c++){for(var g=Object.keys(i.dataSourceSettings[o[d]][p[c]]),m=Object.keys(a.dataSourceSettings[o[d]][p[c]]),f=0;f<m.length;f++){if(-1===u.indexOf(m[f])||-1===u.indexOf(g[f])){n[d]="break";break}n[d]="update"}if("break"===n[d])break}else n[d]="break";if("break"===n[d])break}for(var v=0,S=0,y=0,b=0,C=n;b<C.length;b++){var x=C[b];"break"===x&&v++,"notAvail"===x&&S++,"update"===x&&y++}r=!(v>0||4===S)&&(0===v&&S<4&&y>0)}}catch(e){r=!1}return r},e.frameContent=function(e,t,i,a){var r=[],n=a;if(n.dataSourceSettings.values.length>0&&!n.engineModule.isEmptyData&&(n.enableValueSorting||!n.engineModule.isEngineUpdated))for(var s=0,o="value"===t?i:0,l="value"===t?e.length:i,d=o;d<l;d++)if(e[d]){r[s="header"===t?d:s]={};for(var h=0;h<e[d].length;h++)e[d][h]&&(r[s][h]=e[d][h]);s++}return r},e.getLocalizedObject=function(e){var t={};return t.Null=e.localeObj.getConstant("null"),t.Years=e.localeObj.getConstant("Years"),t.Quarters=e.localeObj.getConstant("Quarters"),t.Months=e.localeObj.getConstant("Months"),t.Days=e.localeObj.getConstant("Days"),t.Hours=e.localeObj.getConstant("Hours"),t.Minutes=e.localeObj.getConstant("Minutes"),t.Seconds=e.localeObj.getConstant("Seconds"),t.QuarterYear=e.localeObj.getConstant("QuarterYear"),t.Of=e.localeObj.getConstant("of"),t.Qtr=e.localeObj.getConstant("qtr"),t.Undefined=e.localeObj.getConstant("undefined"),t.GroupOutOfRange=e.localeObj.getConstant("groupOutOfRange"),t.Group=e.localeObj.getConstant("group"),t},e.generateUUID=function(){var e=(new Date).getTime(),t=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(i){var a=16*Math.random();return e>0?(a=(e+a)%16|0,e=Math.floor(e/16)):(a=(t+a)%16|0,t=Math.floor(t/16)),("x"===i?a:3&a|8).toString(16)}))},e.applyCustomSort=function(e,t,i,a,r){var n,s=[];(s=e.IsOrderChanged?e.members:"Ascending"===e.sortOrder||"None"===e.sortOrder||void 0===e.sortOrder?[].concat(e.members):[].concat(e.members).reverse()).length>t.length&&(s=s.filter((function(e){return t.some((function(t){var a=r?t.formattedText:"string"===i||"number"===i?t.actualText:t.dateText;return typeof e==typeof a&&a===e}))})));var o=[],l=void 0===i||"string"===i||"number"===i;t.length>0&&"Grand Total"===t[0].actualText&&(n=t[0],t.shift());for(var d=0,h=0;d<t.length;d++){var p=t[d],u=r?p.formattedText:l?p.actualText:!0===i?p.actualText.toString():p.dateText;if(s[h]===u){if(t.splice(h++,0,p),t.splice(++d,1),!(h<s.length)){a||o.splice(--h,0,u);break}d=-1}d>=0&&!a&&(o[d]=u)}if(!a){for(d=o.length;d<t.length;d++){p=t[d],u=r?p.formattedText:l?p.actualText:!0===i?p.actualText.toString():p.dateText;o[d]=u}"Grand Total"===o[o.length-1]&&o.pop(),e.members=o}return n&&t.splice(0,0,n),t},e.applyHeadersSort=function(e,t,i,a){if(a)e=e.sort((function(e,i){var a=e.actualText,r=i.actualText;return"Grand Total"===a||"Grand Total"===r?0:"Out of Range"===a?1:"Out of Range"===r?-1:isNaN(parseFloat(a))||isNaN(parseFloat(r))?"Ascending"===t?a.localeCompare(r,void 0,{numeric:!0,sensitivity:"base"}):r.localeCompare(a,void 0,{numeric:!0,sensitivity:"base"}):"Ascending"===t?parseFloat(a)-parseFloat(r):parseFloat(r)-parseFloat(a)}));else if("datetime"===i||"date"===i||"time"===i)e="Ascending"===t?e.sort((function(e,t){return"Out of Range"===e.dateText?1:"Out of Range"===t.dateText?-1:e.dateText>t.dateText?1:e.dateText<t.dateText?-1:0})):"Descending"===t?e.sort((function(e,t){return"Out of Range"===e.dateText?1:"Out of Range"===t.dateText?-1:e.dateText<t.dateText?1:e.dateText>t.dateText?-1:0})):e;else if(!0===i)e="Ascending"===t?e.sort((function(e,t){return"Grand Total"===e.actualText||"Grand Total"===t.actualText?0:"Out of Range"===e.actualText?1:"Out of Range"===t.actualText?-1:Number(e.actualText.toString().match(/\d+/))>Number(t.actualText.toString().match(/\d+/))?1:Number(t.actualText.toString().match(/\d+/))>Number(e.actualText.toString().match(/\d+/))?-1:0})):"Descending"===t?e.sort((function(e,t){return"Grand Total"===e.actualText||"Grand Total"===t.actualText?0:"Out of Range"===e.actualText?-1:"Out of Range"===t.actualText||Number(e.actualText.toString().match(/\d+/))<Number(t.actualText.toString().match(/\d+/))?1:Number(t.actualText.toString().match(/\d+/))<Number(e.actualText.toString().match(/\d+/))?-1:0})):e;else if("string"===i){e.sort((function(e,i){return"Ascending"===t?"Grand Total"===e.actualText||"Grand Total"===i.actualText?0:e.actualText.localeCompare(i.actualText,void 0,{sensitivity:"base"}):"Grand Total"===e.actualText||"Grand Total"===i.actualText?0:i.actualText.localeCompare(e.actualText,void 0,{sensitivity:"base"})}))}else e="Ascending"===t?e.sort((function(e,t){return"Grand Total"===e.actualText||"Grand Total"===t.actualText?0:e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0})):"Descending"===t?e.sort((function(e,t){return"Grand Total"===e.actualText||"Grand Total"===t.actualText?0:e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0})):e;return e},e.renderOlapEngine=function(e,t){try{e.olapEngineModule.renderEngine(e.dataSourceSettings,t||e.frameCustomProperties(e.olapEngineModule.fieldListData,e.olapEngineModule.fieldList),e.onHeadersSort?e.getHeaderSortInfo.bind(e):void 0),e.setProperties({dataSourceSettings:{valueIndex:e.olapEngineModule.measureIndex}},!0)}catch(t){e.actionObj.actionName="engineFormation",e.olapEngineModule.errorInfo?(e.actionFailureMethod(e.olapEngineModule.errorInfo),e.olapEngineModule.errorInfo=void 0):e.actionFailureMethod(t)}},e.frameHeaderWithKeys=function(e){for(var t=Object.keys(e),i=0,a={};i<t.length;)a[t[i]]=e[t[i]],i++;return a},e.getPageSize=function(e){switch(e){case"Letter":return new a.SizeF(612,792);case"Note":return new a.SizeF(540,720);case"Legal":return new a.SizeF(612,1008);case"A0":return new a.SizeF(2380,3368);case"A1":return new a.SizeF(1684,2380);case"A2":return new a.SizeF(1190,1684);case"A3":return new a.SizeF(842,1190);case"A5":return new a.SizeF(421,595);case"A6":return new a.SizeF(297,421);case"A7":return new a.SizeF(210,297);case"A8":return new a.SizeF(148,210);case"A9":return new a.SizeF(105,148);case"B0":return new a.SizeF(2836,4008);case"B1":return new a.SizeF(2004,2836);case"B2":return new a.SizeF(1418,2004);case"B3":return new a.SizeF(1002,1418);case"B4":return new a.SizeF(709,1002);case"B5":return new a.SizeF(501,709);case"Archa":return new a.SizeF(648,864);case"Archb":return new a.SizeF(864,1296);case"Archc":return new a.SizeF(1296,1728);case"Archd":return new a.SizeF(1728,2592);case"Arche":return new a.SizeF(2592,3456);case"Flsa":return new a.SizeF(612,936);case"HalfLetter":return new a.SizeF(396,612);case"Letter11x17":return new a.SizeF(792,1224);case"Ledger":return new a.SizeF(1224,792);default:return new a.SizeF(595,842)}},e.getSortedValue=function(e,t){return e.sort((function(e,i){return"Descending"===t?(i.value||"grand sum"===i.header.type?i.value:0)-(e.value||"grand sum"===e.header.type?e.value:0):(e.value||"grand sum"===e.header.type?e.value:0)-(i.value||"grand sum"===i.header.type?i.value:0)})),e.map((function(e){return e.header}))},e.toggleFieldListIconVisibility=function(e){e.showFieldList&&(0,t.select)("#"+e.element.id+"_PivotFieldList",e.element)&&(e.toolbar&&-1!==e.toolbar.indexOf("FieldList")?(0,t.select)("#"+e.element.id+"_PivotFieldList",e.element).style.display="none":((0,t.select)("#"+e.element.id+"_PivotFieldList",e.element).style.top=e.element.querySelector("."+Xt).offsetHeight.toString()+"px",(0,t.select)("#"+e.element.id+"_PivotFieldList",e.element).style.position="relative")),e.toolbar&&-1!==e.toolbar.indexOf("FieldList")&&e.showToolbar&&e.element.querySelector(".e-toggle-field-list")&&(e.element.querySelector(".e-toggle-field-list").style.display="none")},e}(),Oi=function(){return Oi=Object.assign||function(e){for(var t,i=1,a=arguments.length;i<a;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Oi.apply(this,arguments)},Pi=function(){function e(){this.aggregatedValueMatrix=[],this.valueContent=[],this.formatFields={},this.groupingFieldsInfo={},this.dateFormatFunction={},this.calculatedFields={},this.calculatedFormulas={},this.valueAxis=0,this.saveDataHeaders={},this.columnCount=0,this.rowCount=0,this.columnPageCount=0,this.rowPageCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.rowStartPos=0,this.colStartPos=0,this.enableValueSorting=!1,this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0},this.rMembers=[],this.cMembers=[],this.groupingFields={},this.isLastHeaderHasMeasures=!0,this.measureIndex=-1,this.isPagingOrVirtualizationEnabled=!1,this.rowMaxLevel=0,this.valueMatrix=[],this.memberCnt=-1,this.pageInLimit=!1,this.endPos=0,this.removeCount=0,this.colHdrBufferCalculated=!1,this.colValuesLength=1,this.rowValuesLength=1,this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={},this.selectedHeaders={selectedHeader:[],values:[]},this.rowGrandTotal=null,this.columnGrandTotal=null,this.removeRowGrandTotal=!1,this.removeColumnGrandTotal=!1,this.isValueHasAdvancedAggregate=!1,this.rawIndexObject={},this.reformAxisCount=0,this.isEditing=!1,this.valueAxisFields={},this.data=[],this.actualData=[],this.groupRawIndex={},this.fieldKeys={},this.allowDataCompression=!1,this.dataSourceSettings={},this.frameHeaderObjectsCollection=!1,this.headerObjectsCollection={},this.columnKeys={},this.fieldDrillCollection={},this.formatRegex=/^(?:[ncpae])(?:([0-9]|1[0-9]|20))?$/i,this.measureNames={},this.enablePaging=!1,this.enableVirtualization=!1,this.enableHtmlSanitizer=!1,this.enableOptimizedRendering=!1,this.groupedDataType={},this.emptyRowsLength=0,this.tabularPivotValues=[],this.viewportPageCount=3}return e.prototype.clearProperties=function(e){this.isPagingOrVirtualizationEnabled||e||(this.columnKeys={},this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0}),this.enableValueSorting&&(this.valueContent=[]),this.saveDataHeaders=this.allowValueFilter?this.saveDataHeaders:{},this.rMembers=[],this.cMembers=[],this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={},this.selectedHeaders={selectedHeader:[],values:[]},this.rowGrandTotal=null,this.columnGrandTotal=null,this.rawIndexObject={},this.dataSourceSettings.valueIndex>-1&&(this.valueAxisFields={}),this.headerObjectsCollection={},this.fieldDrillCollection={}},e.prototype.renderEngine=function(e,a,r,n){if(this.getValueCellInfo=r,this.getHeaderSortInfo=n,this.customProperties=a,this.fieldList)for(var s=0,o=e.formatSettings;s<o.length;s++)!this.formatFields[o[s].name]&&this.fieldList[o[s].name]&&(this.fieldList[o[s].name].members={},this.fieldList[o[s].name].formattedMembers={},this.fieldList[o[s].name].dateMember=[]);var l;if(this.formatFields={},this.dateFormatFunction={},this.calculatedFields={},this.calculatedFormulas={},this.valueAxis=0,this.saveDataHeaders={},this.columnCount=0,this.rowCount=0,this.columnPageCount=0,this.rowPageCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.rowStartPos=0,this.colStartPos=0,this.dataSourceSettings.excludeFields=(0,t.isNullOrUndefined)(e.excludeFields)?[]:e.excludeFields,this.enableValueSorting=!1,this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0},this.aggregatedValueMatrix=[],this.rMembers=[],this.cMembers=[],this.memberCnt=-1,this.pageInLimit=!1,this.endPos=0,this.removeCount=0,this.colHdrBufferCalculated=!1,this.colValuesLength=1,this.rowValuesLength=1,this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={},this.selectedHeaders={selectedHeader:[],values:[]},this.rowGrandTotal=null,this.columnGrandTotal=null,this.removeRowGrandTotal=!1,this.removeColumnGrandTotal=!1,this.isValueHasAdvancedAggregate=!1,this.rawIndexObject={},this.isLastHeaderHasMeasures=!0,this.isEditing=!1,this.globalize=a&&a.globalize?a.globalize:new t.Internationalization,this.currencyCode=a&&a.currenyCode?a.currenyCode:void 0,this.localeObj=a?a.localeObj:void 0,this.fieldsType=a?a.fieldsType:{},this.clonedReport=a?a.clonedReport&&a.clonedReport.properties?a.clonedReport.properties:a.clonedReport:{},this.enablePaging=a.enablePaging,this.enableVirtualization=a.enableVirtualization,this.enableOptimizedRendering=a.enableOptimizedRendering,this.enableHtmlSanitizer=a.enableHtmlSanitizer,this.isPagingOrVirtualizationEnabled=this.enablePaging||this.enableVirtualization,this.enableSort=e.enableSorting,this.dataSourceSettings.alwaysShowValueHeader=e.alwaysShowValueHeader,this.dataSourceSettings.showHeaderWhenEmpty=!!(0,t.isNullOrUndefined)(e.showHeaderWhenEmpty)||e.showHeaderWhenEmpty,this.dataSourceSettings.showSubTotals=!!(0,t.isNullOrUndefined)(e.showSubTotals)||e.showSubTotals,this.dataSourceSettings.showRowSubTotals=!!(0,t.isNullOrUndefined)(e.showRowSubTotals)||e.showRowSubTotals,this.dataSourceSettings.showColumnSubTotals=!!(0,t.isNullOrUndefined)(e.showColumnSubTotals)||e.showColumnSubTotals,this.dataSourceSettings.showGrandTotals=!!(0,t.isNullOrUndefined)(e.showGrandTotals)||e.showGrandTotals,this.dataSourceSettings.grandTotalsPosition=(0,t.isNullOrUndefined)(e.grandTotalsPosition)?"Bottom":e.grandTotalsPosition,this.dataSourceSettings.showRowGrandTotals=!!(0,t.isNullOrUndefined)(e.showRowGrandTotals)||e.showRowGrandTotals,this.dataSourceSettings.showColumnGrandTotals=!!(0,t.isNullOrUndefined)(e.showColumnGrandTotals)||e.showColumnGrandTotals,this.showSubTotalsAtTop=this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals&&"Top"===e.subTotalsPosition,this.showSubTotalsAtBottom=this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showRowSubTotals&&"Bottom"===e.subTotalsPosition||a.isTabularLayout,this.allowValueFilter=e.allowValueFilter,this.isValueFilterEnabled=!1,this.enableValueSorting=!!a&&a.enableValueSorting,this.isDrillThrough=!!a&&(!!a.isDrillThrough&&a.isDrillThrough),this.valueContent=[],this.dataSourceSettings=Di.getClonedDataSourceSettings(e),e.dataSource instanceof i.DataManager||("CSV"===e.type?(this.data=e.dataSource.map((function(e){return e.slice()})),this.fieldList&&this.data.shift()):this.data=e.dataSource),this.data&&this.data[0]){if(!this.fieldList){"CSV"===e.type?this.fields=this.data.shift():this.fields=Object.keys(this.data[0]),this.fieldKeys={};for(s=0;s<this.fields.length;s++)this.fieldKeys[this.fields[s]]="CSV"===e.type?s:this.fields[s]}a&&a.pageSettings&&a.allowDataCompression&&(this.actualData=this.data,this.data=this.getGroupedRawData(e)),this.dataSourceSettings.rows=e.rows?e.rows:[],this.dataSourceSettings.columns=e.columns?e.columns:[],this.dataSourceSettings.filters=e.filters?e.filters:[],this.dataSourceSettings.values=e.values?e.values:[],this.dataSourceSettings.formatSettings=e.formatSettings?e.formatSettings:[],this.dataSourceSettings.groupSettings=e.groupSettings?e.groupSettings:[],this.dataSourceSettings.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.enableSort=void 0===e.enableSorting||e.enableSorting,this.dataSourceSettings.fieldMapping=e.fieldMapping?e.fieldMapping:[],this.valueAxisFields={};for(var d=0,h=this.dataSourceSettings.values;d<h.length;d++){var p=h[d];this.valueAxisFields[p.name]=p}l=this.getGroupData(this.data),this.validateFilters(e),this.isExpandAll=!(!this.isValueFiltersAvail||!e.allowValueFilter)||e.expandAll,this.drilledMembers=e.drilledMembers?this.isValueFiltersAvail&&e.allowValueFilter?[]:e.drilledMembers:[],this.isMultiMeasures=this.dataSourceSettings.values.length>1,this.valueAxis="row"===e.valueAxis?1:0,this.measureIndex=(0,t.isNullOrUndefined)(e.valueIndex)?-1:e.valueIndex,this.emptyCellTextContent=e.emptyCellsTextContent?e.emptyCellsTextContent:"",this.rowValuesLength=1===this.valueAxis?this.dataSourceSettings.values.length:1,this.colValuesLength=0===this.valueAxis?this.dataSourceSettings.values.length:1,this.valueSortSettings=e.valueSortSettings||{sortOrder:"None",headerDelimiter:".",headerText:"",columnIndex:void 0},this.valueSortData=[],this.pageSettings=a?a.pageSettings?a.pageSettings:this.pageSettings:void 0,this.allowDataCompression=a&&a.allowDataCompression,this.savedFieldList=a?a.savedFieldList:void 0,this.getFieldList(l,this.enableSort,e.allowValueFilter),this.removeIrrelevantFields(Object.keys(this.fieldList)),this.fillFieldMembers(),this.updateSortSettings(e.sortSettings,this.enableSort),this.filterMembers=[];var u=this.dataSourceSettings.columns.length-1;for(this.columnKeys={};u>-1;)this.columnKeys[this.dataSourceSettings.columns[u].name]=this.dataSourceSettings.columns[u],u--;this.updateFilterMembers(e),this.generateGridData(e)}},e.prototype.removeIrrelevantFields=function(e){var i={};i[0]=this.dataSourceSettings.rows,i[1]=this.dataSourceSettings.columns,i[2]=this.dataSourceSettings.values,i[3]=this.dataSourceSettings.filters;for(var a=0;a<4;){if(i[a])for(var r=0;r<i[a].length;r++){var n=i[a][r].name;this.dataSourceSettings.excludeFields.indexOf(n)>-1||!(0,t.isNullOrUndefined)(e)&&-1===e.indexOf(n)?(i[a].splice(r,1),r--):2===a&&(this.measureNames[n]=i[a][r].caption?i[a][r].caption:n,this.measureNames[i[a][r].caption?i[a][r].caption:n]=n)}a++}this.isMultiMeasures=this.dataSourceSettings.values.length>1,this.measureIndex=-1===this.measureIndex?this.valueAxis?i[0].length:i[1].length:this.measureIndex},e.prototype.updateDataSourceSettings=function(e,i){i&&(this.emptyCellTextContent=e.emptyCellsTextContent?e.emptyCellsTextContent:"",this.valueAxis="row"===e.valueAxis?1:0,this.rowValuesLength=1===this.valueAxis?this.dataSourceSettings.values.length:1,this.colValuesLength=0===this.valueAxis?this.dataSourceSettings.values.length:1,this.measureIndex=(0,t.isNullOrUndefined)(e.valueIndex)?-1:e.valueIndex,this.enableSort=e.enableSorting,this.dataSourceSettings.alwaysShowValueHeader=e.alwaysShowValueHeader,this.dataSourceSettings.showHeaderWhenEmpty=!!(0,t.isNullOrUndefined)(e.showHeaderWhenEmpty)||e.showHeaderWhenEmpty,this.dataSourceSettings.showSubTotals=!!(0,t.isNullOrUndefined)(e.showSubTotals)||e.showSubTotals,this.dataSourceSettings.showRowSubTotals=!!(0,t.isNullOrUndefined)(e.showRowSubTotals)||e.showRowSubTotals,this.dataSourceSettings.showColumnSubTotals=!!(0,t.isNullOrUndefined)(e.showColumnSubTotals)||e.showColumnSubTotals,this.dataSourceSettings.showGrandTotals=!!(0,t.isNullOrUndefined)(e.showGrandTotals)||e.showGrandTotals,this.dataSourceSettings.grandTotalsPosition=(0,t.isNullOrUndefined)(e.grandTotalsPosition)?"Bottom":e.grandTotalsPosition,this.dataSourceSettings.showRowGrandTotals=!!(0,t.isNullOrUndefined)(e.showRowGrandTotals)||e.showRowGrandTotals,this.dataSourceSettings.showColumnGrandTotals=!!(0,t.isNullOrUndefined)(e.showColumnGrandTotals)||e.showColumnGrandTotals,this.showSubTotalsAtTop=this.dataSourceSettings.showSubTotals&&"Top"===e.subTotalsPosition&&e.showColumnSubTotals,this.showSubTotalsAtBottom=!!this.customProperties.isTabularLayout||this.dataSourceSettings.showSubTotals&&"Bottom"===e.subTotalsPosition&&e.showRowSubTotals,this.allowValueFilter=e.allowValueFilter,this.dataSourceSettings.formatSettings=e.formatSettings?e.formatSettings:[],this.dataSourceSettings.groupSettings=e.groupSettings?e.groupSettings:[],this.dataSourceSettings.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.enableSort=void 0===e.enableSorting||e.enableSorting,this.dataSourceSettings.fieldMapping=e.fieldMapping?e.fieldMapping:[],this.dataSourceSettings.values=e.values?e.values:[],this.dataSourceSettings.rows=e.rows?e.rows:[],this.dataSourceSettings.columns=e.columns?e.columns:[],this.dataSourceSettings.filters=e.filters?e.filters:[],this.dataSourceSettings.filterSettings=e.filterSettings?e.filterSettings:[],this.dataSourceSettings.sortSettings=e.sortSettings?e.sortSettings:[],this.dataSourceSettings.conditionalFormatSettings=e.conditionalFormatSettings?e.conditionalFormatSettings:[],this.dataSourceSettings.valueSortSettings=e.valueSortSettings?e.valueSortSettings:{},this.removeIrrelevantFields(Object.keys(this.fieldList)))},e.prototype.getGroupedRawData=function(e){this.data=[];for(var i=0,a=this.actualData;i<a.length;i++){var r=a[i];this.data[this.data.length]=Di.frameHeaderWithKeys(r)}var n=e.values.filter((function(e){return"Count"===e.type||"DistinctCount"===e.type})).map((function(e){return e.name})),s=n.length>0,o=this.data,l=e.rows.concat(e.columns.concat(e.filters)).map((function(e){return e.name})),d={},h=[];this.groupRawIndex={};for(var p={},u=0,c=0;c<o.length;c++){var g=o[c],m=[];if(s)for(var f=0;f<n.length;f++)g[this.fieldKeys[n[f]]]=(0,t.isNullOrUndefined)(g[this.fieldKeys[n[f]]])?g[this.fieldKeys[n[f]]]:1;for(var v=0;v<l.length;v++)m.push(g[this.fieldKeys[l[v]]]);var S=m.join("-");if(d[S]){for(f=0;f<e.values.length;f++){var y=e.values[f].name,b=g[this.fieldKeys[y]],C=d[S],x=e.values[f].type;(0,t.isNullOrUndefined)(b)||("number"==typeof b&&"DistinctCount"!==x||(x="Count"),(0,t.isNullOrUndefined)(C[y])?C[y]="Product"===x?1:"Min"===x||"Max"===x?void 0:0:"number"!=typeof C[y]&&(C[y]=1),"Count"===x?C[y]+=1:"Min"===x?(0,t.isNullOrUndefined)(C[y])||(C[y]=C[y]>b?b:C[y]):"Max"===x?(0,t.isNullOrUndefined)(C[y])||(C[y]=C[y]<b?b:C[y]):"Product"===x?C[y]*=b:C[y]+=b)}this.isDrillThrough&&this.groupRawIndex[p[S]].push(c)}else d[S]=g,h.push(g),this.isDrillThrough&&(this.groupRawIndex[u]=[c],p[S]=u,u++)}return h},e.prototype.getGroupData=function(e){for(var i=this,a=e[0],r=function(r,s){var o=s[r],l=o.name,d=o.caption;if(!(n.fields.indexOf(l)>-1))return r<s.length-1?"continue":{value:a};var h={},p=void 0;if("Date"===o.type&&n.groupingFields[l]||"Custom"===o.type&&n.groupingFields[l])return{value:a};if("Number"===o.type){if("number"!==Di.getType(a[l])&&n.groupingFields[l])return{value:a};o.rangeInterval&&e.sort((function(e,t){return Number(e[i.fieldKeys[l]])>Number(t[i.fieldKeys[l]])?1:Number(t[i.fieldKeys[l]])>Number(e[i.fieldKeys[l]])?-1:0}))}for(var u=e.length;u--;){var c=e[u];if(c[n.fieldKeys[l]]&&"Date"===o.type){var g=new Date(c[n.fieldKeys[l]].toString());if(!(0,t.isNullOrUndefined)(g)&&o.groupInterval.length>0)for(var m=0,f=o.groupInterval.length;m<f;m++){var v=o.groupInterval[m],S=n.getRange(o,g.getTime()),y=Di.resetTime(new Date);switch(v){case"Years":h[C=m===o.groupInterval.length-1?l:l+"_date_group_years"]=v,n.fieldKeys[C]="CSV"===n.dataSourceSettings.type?n.fieldKeys[C]?n.fieldKeys[C]:n.fields.length:C,-1===n.fields.indexOf(C)&&n.fields.push(C),c[n.fieldKeys[C]]=S?void 0:new Date(y.setFullYear(g.getFullYear())).toString();break;case"Quarters":h[C=m===o.groupInterval.length-1?l:l+"_date_group_quarters"]=v;var b=Math.ceil((g.getMonth()+1)/3);n.fieldKeys[C]="CSV"===n.dataSourceSettings.type?n.fieldKeys[C]?n.fieldKeys[C]:n.fields.length:C,-1===n.fields.indexOf(C)&&n.fields.push(C),c[n.fieldKeys[C]]=S?void 0:(n.localeObj?n.localeObj.getConstant("qtr"):"Qtr")+b.toString();break;case"QuarterYear":h[C=m===o.groupInterval.length-1?l:l+"_date_group_quarterYear"]=v;b=Math.ceil((g.getMonth()+1)/3);n.fieldKeys[C]="CSV"===n.dataSourceSettings.type?n.fieldKeys[C]?n.fieldKeys[C]:n.fields.length:C,-1===n.fields.indexOf(C)&&n.fields.push(C),c[n.fieldKeys[C]]=S?void 0:(n.localeObj?n.localeObj.getConstant("qtr"):"Qtr")+b.toString()+" "+(n.localeObj?n.localeObj.getConstant("of"):"of")+" "+g.getFullYear().toString();break;case"Months":h[C=m===o.groupInterval.length-1?l:l+"_date_group_months"]=v,n.fieldKeys[C]="CSV"===n.dataSourceSettings.type?n.fieldKeys[C]?n.fieldKeys[C]:n.fields.length:C,-1===n.fields.indexOf(C)&&n.fields.push(C),c[n.fieldKeys[C]]=S?void 0:new Date(y.setMonth(g.getMonth(),1)).toString();break;case"Days":h[C=m===o.groupInterval.length-1?l:l+"_date_group_days"]=v,n.fieldKeys[C]="CSV"===n.dataSourceSettings.type?n.fieldKeys[C]?n.fieldKeys[C]:n.fields.length:C,-1===n.fields.indexOf(C)&&n.fields.push(C),c[n.fieldKeys[C]]=S?void 0:new Date(y.setMonth(g.getMonth(),g.getDate())).toString();break;case"Hours":h[C=m===o.groupInterval.length-1?l:l+"_date_group_hours"]=v,n.fieldKeys[C]="CSV"===n.dataSourceSettings.type?n.fieldKeys[C]?n.fieldKeys[C]:n.fields.length:C,-1===n.fields.indexOf(C)&&n.fields.push(C),c[n.fieldKeys[C]]=S?void 0:new Date(y.setHours(g.getHours())).toString();break;case"Minutes":h[C=m===o.groupInterval.length-1?l:l+"_date_group_minutes"]=v,n.fieldKeys[C]="CSV"===n.dataSourceSettings.type?n.fieldKeys[C]?n.fieldKeys[C]:n.fields.length:C,-1===n.fields.indexOf(C)&&n.fields.push(C),c[n.fieldKeys[C]]=S?void 0:new Date(y.setMinutes(g.getMinutes())).toString();break;case"Seconds":h[C=m===o.groupInterval.length-1?l:l+"_date_group_seconds"]=v,n.fieldKeys[C]="CSV"===n.dataSourceSettings.type?n.fieldKeys[C]?n.fieldKeys[C]:n.fields.length:C,-1===n.fields.indexOf(C)&&n.fields.push(C),c[n.fieldKeys[C]]=S?void 0:new Date(y.setSeconds(g.getSeconds())).toString()}}}else if(isNaN(Number(c[n.fieldKeys[l]]))||"Number"!==o.type){if(c[n.fieldKeys[l]]&&"Custom"===o.type&&o.customGroups&&o.customGroups.length>0){var C=l+"_custom_group",x=o.customGroups,w=void 0;n.groupingFieldsInfo[l]=l,n.groupingFieldsInfo[C]=l;for(var T=0,M=x.length;T<M;T++){var D=x[T];if(D.items&&D.items.length>1){p=C,n.fieldKeys[C]="CSV"===n.dataSourceSettings.type?n.fieldKeys[C]?n.fieldKeys[C]:n.fields.length:C,-1===n.fields.indexOf(C)&&n.fields.push(C);var O=-1!==Di.inArray(c[n.fieldKeys[l]].toString(),D.items);c[n.fieldKeys[C]]=O?D.groupName&&""!==D.groupName?D.groupName:n.localeObj.getConstant("group")+" "+T:w&&w!==c[n.fieldKeys[l]].toString()?w:c[n.fieldKeys[l]].toString(),w=c[n.fieldKeys[C]]}}}}else{S=n.getRange(o,Number(c[n.fieldKeys[l]]));c[n.fieldKeys[l]]=S?void 0:c[n.fieldKeys[l]]}for(var P=[],N=0,E=fe=Object.keys(c);N<E.length;N++){var I=E[N];P.push(!!c[I])}a=-1===P.indexOf(!1)&&fe.length===Object.keys(e[0]).length?c:a}if("Date"===o.type){for(var F=!1,L=[n.dataSourceSettings.rows,n.dataSourceSettings.columns,n.dataSourceSettings.values,n.dataSourceSettings.filters],A=Object.keys(h),R=Object.keys(A).length,k=void 0,j=0,q=L;j<q.length;j++){var V=q[j];if(!F&&V){for(var H=V.length,U=0;U<H;){if(V[U].name===l){F=!0;var _=V[U];for(V.splice(U,1),Me=(Me=n.dataSourceSettings.rows).concat(n.dataSourceSettings.columns,n.dataSourceSettings.values,n.dataSourceSettings.filters);R--;){var B=_.caption?_.caption:_.name;if(n.clonedReport){var G=n.clonedReport.rows;G=G.concat(n.clonedReport.columns,n.clonedReport.values,n.clonedReport.filters);var z=Di.getFieldByName(A[R],G);z&&(B=z.caption?z.caption:z.name)}if(Di.getFieldByName(A[R],Me))n.groupingFieldsInfo[A[R]]=l;else{k=h[A[R]],B=-1!==B.indexOf(" (")&&-1!==B.indexOf(")")?B.slice(B.indexOf("(")+1,B.length-1):B;var W={name:A[R],caption:(n.localeObj?n.localeObj.getConstant(k):k)+" ("+B+")",type:"Count",showNoDataItems:_.showNoDataItems,baseField:_.baseField,baseItem:_.baseItem,showFilterIcon:_.showFilterIcon,showSortIcon:_.showSortIcon,showEditIcon:_.showEditIcon,showRemoveIcon:_.showRemoveIcon,showSubTotals:_.showValueTypeIcon,allowDragAndDrop:_.allowDragAndDrop,expandAll:_.expandAll,groupName:_.groupName};V.splice(U,0,W),n.groupingFieldsInfo[W.name]=l}}break}if(V[U].name.indexOf(l)>-1){var Q=h[V[U].name],Y=V.filter((function(e){return e.name===l}))[0];if(!(0,t.isNullOrUndefined)(Y)){var K=Y.caption?-1!==Y.caption.indexOf(" (")&&-1!==Y.caption.indexOf(")")?Y.caption.slice(Y.caption.indexOf("(")+1,Y.caption.length-1):Y.caption:l;V[U].caption=(n.localeObj?n.localeObj.getConstant(Q):Y)+" ("+K+")"}}U++}if(F)break}}R=Object.keys(A).length;for(var X=(Ce=n.getMappingField(l,n.clonedReport?n.clonedReport.fieldMapping:n.dataSourceSettings.fieldMapping)).caption?Ce.caption:l;R--;){k=h[A[R]];for(var J=0,Z=n.dataSourceSettings.formatSettings.length;J<Z;J++)if(n.dataSourceSettings.formatSettings[J].name===A[R]){n.dataSourceSettings.formatSettings.splice(J,1);break}if("Quarters"!==k&&"QuarterYear"!==k){var $={name:A[R],type:["Years","Months","Days"].indexOf(k)>-1?"date":"time",format:"Years"===k?"yyyy":"Months"===k?"MMM":"Days"===k?"d-MMM":"Hours"===k?"hh a":"Minutes"===k?":mm":"Seconds"===k?":ss":void 0};n.dataSourceSettings.formatSettings.push($)}if(!F){var ee=n.getMappingField(A[R],n.dataSourceSettings.fieldMapping);if(A[R]!==l&&(0,t.isNullOrUndefined)(ee.name)){W={name:A[R],caption:(n.localeObj?n.localeObj.getConstant(k):k)+" ("+X+")"};n.dataSourceSettings.fieldMapping.push(W),n.groupingFieldsInfo[W.name]=l}else A[R]!==l&&(ee.caption=(n.localeObj?n.localeObj.getConstant(k):k)+" ("+X+")",n.groupingFieldsInfo[ee.name]=l)}}if(!F){ee=n.getMappingField(l,n.dataSourceSettings.fieldMapping);if(k=h[l],A[R]!==l&&(0,t.isNullOrUndefined)(ee.name)){W={name:l,caption:(n.localeObj?n.localeObj.getConstant(k):k)+" ("+X+")"};n.dataSourceSettings.fieldMapping.push(W),n.groupingFieldsInfo[W.name]=l}else ee.caption=(n.localeObj?n.localeObj.getConstant(k):k)+" ("+X+")",n.groupingFieldsInfo[ee.name]=l}}else if("Number"===o.type&&o.rangeInterval){var te=void 0,ie=[],ae=[],re=e.length;H=0;n.groupingFields[l]=l;for(var ne=[];H<re;){var se=Number(e[H][l]);ae.push(se),isNaN(se)||-1!==ie.indexOf(se)||ie.push(se),H++}for(re=e.length,H=0;H<re;){var oe=e[H];if(oe&&!isNaN(Number(oe[l]))){te=("string"==typeof o.endingAt?parseInt(o.endingAt,10):o.endingAt)||Math.max.apply(Math,ie);var le=Number.isInteger(o.rangeInterval)?0:n.countDecimalPlaces(o.rangeInterval),de=void 0;switch(le){case 10:de=1e-10;break;case 9:de=1e-9;break;case 8:de=1e-8;break;case 7:de=1e-7;break;case 6:de=1e-6;break;case 5:de=1e-5;break;case 4:de=1e-4;break;case 3:de=.001;break;case 2:de=.01;break;case 1:de=.1;break;default:de=1}var he=Number.isInteger(o.rangeInterval)?Math.floor(Number(oe[l])):Number(oe[l].toFixed(le)),pe=Number.isInteger(o.rangeInterval)?Math.floor(Number(he+(o.rangeInterval-1))):Number((he+o.rangeInterval).toFixed(le));if(he>=ne[0]&&he<=ne[ne.length-1]){var ue=ne[0],ce=Number.isInteger(o.rangeInterval)?Math.floor(ne[ne.length-1]):Number(ne[ne.length-1].toFixed(le));n.processGrouping(oe,l,ue,ce,te,o.rangeInterval,le),(0,t.isNullOrUndefined)(n.groupedDataType[l])&&(n.groupedDataType[l]="string")}else if(0===ne.length){for(var ge=he;ge<=pe;ge=Number((ge+de).toFixed(le)))ne.push(ge);ue=ne[0],ce=Number.isInteger(o.rangeInterval)?Math.floor(ne[ne.length-1]):Number(ne[ne.length-1].toFixed(le));n.processGrouping(oe,l,ue,ce,te,o.rangeInterval,le),(0,t.isNullOrUndefined)(n.groupedDataType[l])&&(n.groupedDataType[l]="string")}else{ue=Number.isInteger(o.rangeInterval)?Math.floor(ne[ne.length-1])+1:Number(ne[ne.length-1].toFixed(le)),ce=Number.isInteger(o.rangeInterval)?Math.floor(ue+(o.rangeInterval-1)):Number((ue+o.rangeInterval).toFixed(le));var me=!0;for(ne.splice(0,ne.length);me;)he>=ue&&he<=ce&&(n.processGrouping(oe,l,ue,ce,te,o.rangeInterval,le),(0,t.isNullOrUndefined)(n.groupedDataType[l])&&(n.groupedDataType[l]="string"),ne.push(ue),ne.push(ce),me=!1),ue=Number.isInteger(o.rangeInterval)?ce+1:ce,ce=Number.isInteger(o.rangeInterval)?Math.floor(ue+(o.rangeInterval-1)):Number((ue+o.rangeInterval).toFixed(le))}P=[];for(var fe,ve=0,Se=fe=Object.keys(oe);ve<Se.length;ve++){I=Se[ve];P.push(!!oe[I])}a=-1===P.indexOf(!1)&&fe.length===Object.keys(e[0]).length?oe:a}H++}for(var ye=0,be=L=[n.dataSourceSettings.rows,n.dataSourceSettings.columns,n.dataSourceSettings.values,n.dataSourceSettings.filters];ye<be.length;ye++){var Ce,xe=be[ye];(Ce=Di.getFieldByName(l,xe))&&((Ce=Ce.properties?Ce.properties:Ce).type="Count")}for(var we=0,Te=n.dataSourceSettings.formatSettings.length;we<Te;we++)if(n.dataSourceSettings.formatSettings[we].name===l){n.dataSourceSettings.formatSettings.splice(we,1);break}}else if("Custom"===o.type&&p){var Me,De=p;F=!1,L=[n.dataSourceSettings.rows,n.dataSourceSettings.columns,n.dataSourceSettings.values,n.dataSourceSettings.filters];Me=(Me=n.dataSourceSettings.rows).concat(n.dataSourceSettings.columns,n.dataSourceSettings.values,n.dataSourceSettings.filters);var Oe=[];d&&""!==d||(Oe=De.match(/_custom_group/g));for(var Pe=Di.getFieldByName(l.replace(/_custom_group/g,""),Me),Ne=Di.getFieldByName(De,Me),Ee=0,Ie=L;Ee<Ie.length;Ee++){V=Ie[Ee];if(!F&&V){H=V.length;for(var Fe=0;Fe<H;){if(V[Fe].name===o.name&&!Ne){F=!0;_=V[Fe],W={name:De,caption:d&&""!==d?d:(Pe.caption?Pe.caption:Pe.name)+(Oe.length+1),type:"Count",showNoDataItems:_.showNoDataItems,baseField:_.baseField,baseItem:_.baseItem,showSubTotals:_.showValueTypeIcon,allowDragAndDrop:_.allowDragAndDrop,showFilterIcon:_.showFilterIcon,showSortIcon:_.showSortIcon,showRemoveIcon:_.showRemoveIcon,showEditIcon:_.showEditIcon,expandAll:_.expandAll,groupName:_.groupName};V.splice(Fe,0,W),n.groupingFieldsInfo[W.name]=l,n.groupingFieldsInfo[l]=l;break}if(V[Fe].name===De&&Ne){W={name:Ne.name,caption:d&&""!==d?d:Ne.caption,type:Ne.type,showNoDataItems:Ne.showNoDataItems,baseField:Ne.baseField,baseItem:Ne.baseItem,showRemoveIcon:Ne.showRemoveIcon,showSubTotals:Ne.showValueTypeIcon,allowDragAndDrop:Ne.allowDragAndDrop,showFilterIcon:Ne.showFilterIcon,showSortIcon:Ne.showSortIcon,showEditIcon:Ne.showEditIcon,expandAll:Ne.expandAll,groupName:Ne.groupName};V.splice(Fe,1,W),n.groupingFieldsInfo[W.name]=l,n.groupingFieldsInfo[l]=l;break}Fe++}if(F)break}}var Le=Di.getFieldByName(l,Di.cloneFormatSettings(n.dataSourceSettings.formatSettings));Le&&(Le.name=De,n.dataSourceSettings.formatSettings.push(Le)),n.groupingFields[l]=l}n.groupingFields=(0,t.extend)(n.groupingFields,h)},n=this,s=0,o=this.dataSourceSettings.groupSettings;s<o.length;s++){var l=r(s,o);if("object"==typeof l)return l.value}return a},e.prototype.countDecimalPlaces=function(e){var t=e.toString();return t.includes(".")?t.split(".")[1].length:0},e.prototype.processGrouping=function(e,t,i,a,r,n,s){Number.isInteger(e[t])||!Number.isInteger(e[t])&&(Number(e[t])<a||r<=Number(e[t]))?e[t]=this.getNumberGroupHeaders(i,a,r):!Number.isInteger(e[t])&&Number(e[t])>=a&&(e[t]=this.getNumberGroupHeaders(Number((i+n).toFixed(s)),Number((a+n).toFixed(s)),r))},e.prototype.getNumberGroupHeaders=function(e,t,i){return e===t?e.toString():i>=e&&i<=t?i===e?e.toString():e.toString()+"-"+i.toString():e.toString()+"-"+t.toString()},e.prototype.getRange=function(e,t){var i;if("Date"===e.type){var a=new Date(t),r="string"==typeof e.startingAt?new Date(e.startingAt):e.startingAt,n="string"==typeof e.endingAt?new Date(e.endingAt):e.endingAt;i=!!(r&&a.getTime()<r.getTime()||n&&a.getTime()>n.getTime())}else{var s="string"==typeof e.startingAt?parseFloat(e.startingAt):e.startingAt,o="string"==typeof e.endingAt?parseFloat(e.endingAt):e.endingAt;i=!isNaN(s)&&t<s||!isNaN(o)&&t>o}return i},e.prototype.getPercentFormat=function(e,i){var a=(0,t.isNullOrUndefined)(e[i])||(0,t.isNullOrUndefined)(this.formatFields[i].format)?void 0:this.formatFields[i].format.toLowerCase().match(/p[0-9]/);return(0,t.isNullOrUndefined)(a)?2:Number(this.formatFields[i].format.replace(/[^0-9]/g,""))},e.prototype.getFormattedFields=function(e){this.formatFields=this.setFormattedFields(e.formatSettings)},e.prototype.setFormattedFields=function(e){for(var t=e.length,i={};t--;)i[e[t].name]=e[t],e[t].type&&(this.dateFormatFunction[e[t].name]={exactFormat:this.globalize.getDateFormat(e[t]),fullFormat:this.globalize.getDateFormat({format:"yyyy/MM/dd/HH/mm/ss",type:e[t].type})});return i},e.prototype.getFieldList=function(e,i,a){for(var r,n=this,s=this.dataSourceSettings.excludeFields.length-1;s>-1;){var o=this.fields.indexOf(this.dataSourceSettings.excludeFields[s]);-1!==o&&this.fields.splice(o,1),this.fieldList&&delete this.fieldList[this.dataSourceSettings.excludeFields[s]],s--}var l=this.fields,d=(0,t.extend)([],this.dataSourceSettings.rows,null,!0);d=d.concat(this.dataSourceSettings.columns,this.dataSourceSettings.values,this.dataSourceSettings.filters),this.getFormattedFields(this.dataSourceSettings),this.getCalculatedField(l);var h=(l=this.fields).length,p=["string","number","datetime","date","boolean"];if(this.savedFieldList)for(this.fieldList=this.savedFieldList;h--;){var u=l[h],c=this.getMappingField(u,this.dataSourceSettings.fieldMapping);this.fieldList[u]?(this.fieldList[u].isSelected=!1,this.fieldList[u].index=h,this.fieldList[u].filter=[],this.fieldList[u].sort=i?"Ascending":"None",this.fieldList[u].isExcelFilter=!1,this.fieldList[u].filterType="",this.fieldList[u].showFilterIcon=!c||!("showFilterIcon"in c)||c.showFilterIcon,this.fieldList[u].showRemoveIcon=!c||!("showRemoveIcon"in c)||c.showRemoveIcon,this.fieldList[u].showSortIcon=!c||!("showSortIcon"in c)||c.showSortIcon,this.fieldList[u].showEditIcon=!c||!("showEditIcon"in c)||c.showEditIcon,this.fieldList[u].showValueTypeIcon=!c||!("showValueTypeIcon"in c)||c.showValueTypeIcon,this.fieldList[u].allowDragAndDrop=!c||!("allowDragAndDrop"in c)||c.allowDragAndDrop,this.fieldList[u].isCalculatedField=!(!c||!("isCalculatedField"in c))&&c.isCalculatedField,this.fieldList[u].showNoDataItems=!(!c||!("showNoDataItems"in c))&&c.showNoDataItems,this.fieldList[u].showSubTotals=!c||!("showSubTotals"in c)||c.showSubTotals,this.fieldList[u].expandAll=!(!c||!("expandAll"in c))&&c.expandAll,this.fieldList[u].pid=c&&"groupName"in c&&c.groupName?c.groupName:this.groupingFieldsInfo[u]?this.groupingFieldsInfo[u]:void 0,this.isValueFiltersAvail&&a&&(this.fieldList[u].dateMember=[],this.fieldList[u].members={},this.fieldList[u].isMembersFilled=!1),this.updateMembersOrder(u)):(r=(0,t.isNullOrUndefined)(this.groupedDataType[u])?c&&"dataType"in c&&c.dataType&&p.indexOf(c.dataType.toLowerCase())>-1?c.dataType.toLowerCase():r:this.groupedDataType[u],this.fieldList[u]={caption:c&&"caption"in c&&c.caption?c.caption:u,id:u,type:-1!==u.indexOf("_custom_group")||-1!==u.indexOf("_date_group")?"string":void 0===r||"undefined"===r?"number":r,isSelected:!1,sort:i?"Ascending":"None",filterType:"",index:h,filter:[],isCustomField:-1!==u.indexOf("_custom_group")||-1!==u.indexOf("_date_group"),showRemoveIcon:!c||!("showRemoveIcon"in c)||c.showRemoveIcon,showFilterIcon:!c||!("showFilterIcon"in c)||c.showFilterIcon,showSortIcon:!c||!("showSortIcon"in c)||c.showSortIcon,showNoDataItems:!(!c||!("showNoDataItems"in c))&&c.showNoDataItems,isCalculatedField:!(!c||!("isCalculatedField"in c))&&c.isCalculatedField,showEditIcon:!c||!("showEditIcon"in c)||c.showEditIcon,showValueTypeIcon:!c||!("showValueTypeIcon"in c)||c.showValueTypeIcon,allowDragAndDrop:!c||!("allowDragAndDrop"in c)||c.allowDragAndDrop,showSubTotals:!c||!("showSubTotals"in c)||c.showSubTotals,expandAll:!(!c||!("expandAll"in c))&&c.expandAll,pid:c&&"groupName"in c&&c.groupName?c.groupName:this.groupingFieldsInfo[u]?this.groupingFieldsInfo[u]:void 0,aggregateType:c&&"type"in c?c.type:"number"===(-1!==u.indexOf("_custom_group")||-1!==u.indexOf("_date_group")?"string":void 0===r||"undefined"===r?"number":r)?"Sum":"Count",baseField:c&&"baseField"in c?c.baseField:void 0,baseItem:c&&"baseItem"in c?c.baseItem:void 0},this.updateMembersOrder(u))}else{this.fieldList={};for(var g=function(){var a=l[h],s=m.getMappingField(a,m.dataSourceSettings.fieldMapping);void 0!==(r=(0,t.isNullOrUndefined)(m.groupedDataType[a])?s&&"dataType"in s&&s.dataType&&p.indexOf(s.dataType.toLowerCase())>-1?s.dataType.toLowerCase():Di.getType(e[m.fieldKeys[a]]):m.groupedDataType[a])&&"undefined"!==r||(m.dataSourceSettings.groupSettings.length>0?m.dataSourceSettings.groupSettings.forEach((function(e){r=n.fieldKeys[a]===e.name&&"number"===e.type.toLocaleLowerCase()?"string":"number"})):r="number"),m.fieldList[a]={id:a,pid:s&&"groupName"in s&&s.groupName?s.groupName:m.groupingFieldsInfo[a]?m.groupingFieldsInfo[a]:void 0,caption:s&&"caption"in s&&s.caption?s.caption:a,type:-1!==a.indexOf("_custom_group")||-1!==a.indexOf("_date_group")?"string":r,filterType:"",index:h,filter:[],sort:i?"Ascending":"None",isSelected:!1,isCustomField:-1!==a.indexOf("_custom_group")||-1!==a.indexOf("_date_group"),showFilterIcon:!s||!("showFilterIcon"in s)||s.showFilterIcon,showRemoveIcon:!s||!("showRemoveIcon"in s)||s.showRemoveIcon,showSortIcon:!s||!("showSortIcon"in s)||s.showSortIcon,showEditIcon:!s||!("showEditIcon"in s)||s.showEditIcon,showValueTypeIcon:!s||!("showValueTypeIcon"in s)||s.showValueTypeIcon,allowDragAndDrop:!s||!("allowDragAndDrop"in s)||s.allowDragAndDrop,showSubTotals:!s||!("showSubTotals"in s)||s.showSubTotals,showNoDataItems:!(!s||!("showNoDataItems"in s))&&s.showNoDataItems,isCalculatedField:!(!s||!("isCalculatedField"in s))&&s.isCalculatedField,expandAll:!(!s||!("expandAll"in s))&&s.expandAll,aggregateType:s&&"type"in s?s.type:"number"===(-1!==a.indexOf("_custom_group")||-1!==a.indexOf("_date_group")?"string":void 0===r||"undefined"===r?"number":r)?"Sum":"Count",baseField:s&&"baseField"in s?s.baseField:void 0,baseItem:s&&"baseItem"in s?s.baseItem:void 0},m.updateMembersOrder(a)},m=this;h--;)g()}this.groupedDataType={},this.updateTreeViewData(d)},e.prototype.updateMembersOrder=function(e){for(var t=0,i=this.dataSourceSettings.sortSettings;t<i.length;t++){var a=i[t];if(e===a.name&&a.membersOrder){this.fieldList[e].membersOrder=a.membersOrder;break}}},e.prototype.getMappingField=function(e,t){var i={};if(t&&t.length>0)for(var a=0,r=t.length;a<r;a++)if(t[a].name===e){i=t[a];break}return i},e.prototype.updateFieldList=function(e){for(var t=this.fields,i=t.length;i--;)this.fieldList[t[i]].isExcelFilter=e[t[i]].isExcelFilter},e.prototype.updateTreeViewData=function(e){for(var i=this,a=e.length,r=this.dataSourceSettings.calculatedFieldSettings.length;a--;)if(this.fieldList[e[a].name]){var n=this.fieldList[e[a].name];n.type=e[a].dataType?e[a].dataType.toLowerCase():n.type,n.caption=e[a].caption?e[a].caption:e[a].name,n.isSelected=!0,n.showNoDataItems=e[a].showNoDataItems,n.aggregateType=e[a].type,n.baseField=e[a].baseField,n.baseItem=e[a].baseItem,n.allowDragAndDrop=e[a].allowDragAndDrop,n.showFilterIcon=e[a].showFilterIcon,n.showSortIcon=e[a].showSortIcon,n.showRemoveIcon=e[a].showRemoveIcon,n.showValueTypeIcon=e[a].showValueTypeIcon,n.showEditIcon=e[a].showEditIcon,n.showSubTotals=e[a].showSubTotals,n.expandAll=e[a].expandAll}for(;r--;)this.fieldList[this.dataSourceSettings.calculatedFieldSettings[r].name]&&(this.fieldList[this.dataSourceSettings.calculatedFieldSettings[r].name].aggregateType="CalculatedField",this.fieldList[this.dataSourceSettings.calculatedFieldSettings[r].name].isCalculatedField=!0,this.fieldList[this.dataSourceSettings.calculatedFieldSettings[r].name].formula=this.dataSourceSettings.calculatedFieldSettings[r].formula);var s=this.dataSourceSettings.groupSettings.filter((function(t){return!e.some((function(e){return t.name===e.name}))})),o=["_date_group_years","_date_group_quarters","_date_group_quarterYear","_date_group_months","_date_group_days","_date_group_hours","_date_group_minutes","_date_group_seconds"];s.forEach((function(e){var a=e.name,r=e.type.toLowerCase();Object.keys(i.fieldList).forEach((function(n){"date"!==r||(0,t.isNullOrUndefined)(e.caption)||!o.some((function(e){return n===""+a+e}))&&n!==a?("custom"!==r||(0,t.isNullOrUndefined)(e.caption)||n!==a+"_custom_group")&&("number"!==r||(0,t.isNullOrUndefined)(e.caption)||n!==a)||(i.fieldList[n].caption=e.caption):i.fieldList[n].caption=i.fieldList[n].caption.replace(e.name,e.caption)}))}))},e.prototype.getCalculatedField=function(e){for(var i=0,a=this.dataSourceSettings.calculatedFieldSettings;i<a.length;i++){var r=a[i];this.calculatedFields[r.name]=(0,t.extend)({},r,null,!0),this.calculatedFields[r.name].actualFormula=r.formula}for(var n=Object.keys(this.calculatedFields),s=function(t,i){var a=o.calculatedFields[n[t]],r=a.properties,s=(r?r.formula:a.formula).trim(),l=s.replace(/"/g,"");a.formula=l.indexOf("^")>-1?o.powerFunction(l):l,-1===a.formula.indexOf("Math.min(")&&a.formula.indexOf("min(")>-1&&(a.formula=a.formula.replace(/min\(/g,"Math.min(")),-1===a.formula.indexOf("Math.max(")&&a.formula.indexOf("max(")>-1&&(a.formula=a.formula.replace(/max\(/g,"Math.max(")),-1===a.formula.indexOf("Math.abs(")&&a.formula.indexOf("abs(")>-1&&(a.formula=a.formula.replace(/abs\(/g,"Math.abs(")),a.name=r?r.name:a.name,"CSV"===o.dataSourceSettings.type?-1===e.indexOf(a.name)&&e.push(a.name):(e=e.filter((function(e){return e!==a.name}))).push(a.name);for(var d=s.split('"'),h=0,p=d.length;h<p;h++){var u=d[h].trim(),c=u.split(/[ .:;?!~,`"&|()<>{}[\]\r\n/\\]+/),g=u.match(/^([^()]+)\((.*)\)$/),m="DistinctCount"===c[0]?"DistinctCount":"PopulationStDev"===c[0]?"PopulationStDev":"SampleStDev"===c[0]?"SampleStDev":"PopulationVar"===c[0]?"PopulationVar":"SampleVar"===c[0]?"SampleVar":c[0];if(-1!==["Sum","Count","Min","Max","Avg","Product","DistinctCount","PopulationStDev","SampleStDev","PopulationVar","SampleVar","Median"].indexOf(m)){var f=-1===e.indexOf(c[1])&&g[2]?e.indexOf(g[2]):e.indexOf(c[1]);o.calculatedFormulas[a.name]?o.calculatedFormulas[a.name].push({index:f,type:m,formula:u}):o.calculatedFormulas[a.name]=[{index:f,type:m,formula:u}]}}},o=this,l=0,d=n.length;l<d;l++)s(l);this.fields=e},e.prototype.validateFilters=function(e){this.isValueFiltersAvail=!1;var i=e.filterSettings?e.filterSettings:[],a=(0,t.extend)([],this.dataSourceSettings.rows,null,!0);a=a.concat(this.dataSourceSettings.columns);for(var r=0,n=i;r<n.length;r++){for(var s=n[r],o=0,l=a;o<l.length;o++){var d=l[o];if(s.name===d.name&&"Value"===s.type){this.isValueFiltersAvail=!0;break}}if(this.isValueFiltersAvail)break}},e.prototype.validateValueFields=function(){this.isValueHasAdvancedAggregate=!1;for(var e=0,t=this.dataSourceSettings.values;e<t.length;e++){var i=t[e];if(-1!==["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal","RunningTotals"].indexOf(i.type)){this.isValueHasAdvancedAggregate=!0;break}}},e.prototype.fetchFieldMembers=function(e){var t=this.fieldList[e].index;this.generateMembers(t,new Set)},e.prototype.generateMembers=function(e,i){var a=this.data.length,r=this.fields,n=this.fieldList,s=r[e];n[s].members&&!this.allowDataCompression||(n[s].members={},this.allowDataCompression&&(n[s].isMembersFilled=!1)),n[s].dateMember&&!this.allowDataCompression||(n[s].dateMember=[]);var o=n[s].members,l=n[s].dateMember;if((n[s].isSelected||i.has(e))&&!n[s].isMembersFilled){for(var d=Object.keys(o).length>0,h=0,p=n[s].expandAll,u=Di.isDateField(s,this),c=0;c<a;c++){var g=this.data[c][this.fieldKeys[s]],m=g;if(m=this.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(m):m,!d){var f=u?this.getFormattedValue(m,s):{formattedText:null===m?this.localeObj?this.localeObj.getConstant("null"):String(m):void 0===m?this.localeObj?s in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(m):m.toString(),actualText:null===m?this.localeObj?this.localeObj.getConstant("null"):String(m):void 0===m?this.localeObj?s in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(m):m};Object.prototype.hasOwnProperty.call(o,m)?o[m].index.push(c):(h++,o[m]={index:[c],ordinal:h,isDrilled:this.isExpandAll||p,caption:f.formattedText},l.push({formattedText:f.formattedText,actualText:u?f.dateText:f.actualText}))}var v=(0,t.isNullOrUndefined)(g)?g:"number"===n[s].type?isNaN(Number(g))?void 0:Number(g):1,S={ordinal:o[m].ordinal,member:v};this.valueMatrix[c]||(this.valueMatrix[c]=[]),this.valueMatrix[c][e]=S}n[s].isMembersFilled=!0}},e.prototype.fillFieldMembers=function(){var e=this.fields,t=this.fieldList,i=e.length;this.data.length-this.valueMatrix.length<0&&(this.valueMatrix=this.valueMatrix.slice(0,this.data.length));var a=new Set;if(this.calculatedFormulas&&Object.keys(this.calculatedFormulas).length>0)for(var r in this.calculatedFormulas)if(t[r]&&t[r].isSelected)for(var n=this.calculatedFormulas[r],s=0;s<n.length;s++){var o=n[s];a.add(o.index)}for(var l=0;l<i;l++)this.generateMembers(l,a)},e.prototype.generateValueMatrix=function(){for(var e=this.fields,i=this.data.length,a=e.length,r=this.fieldList;i--;)for(var n=a;n--;){var s=e[n],o=r[s];if(o.isMembersFilled){var l=this.data[i][this.fieldKeys[s]];this.valueMatrix[i][n].member=(0,t.isNullOrUndefined)(l)?l:"number"===o.type?isNaN(Number(l))?void 0:Number(l):1}}},e.prototype.updateSortSettings=function(e,t){for(var i=0,a=e?e.length:0;i<a&&t;i++)this.fieldList[e[i].name]&&(this.fieldList[e[i].name].sort=e[i].order)},e.prototype.updateFilterMembers=function(e){var t=this.filterMembers,i={},a=this.getFilters(e,i),r=this.valueMatrix.length;if(a)for(var n=i.include.index,s=0;s<n.length;s++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[n[s]]||t.push(n[s]);else for(s=0;s<r;s++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[s]||t.push(s)},e.prototype.getFilters=function(e,t){for(var i=e.filterSettings?e.filterSettings:[],a=!1,r=[],n=0,s=i.length;n<s;n++){var o=i[n].properties?i[n].properties:i[n];this.fieldList[o.name]&&this.fieldList[o.name].isSelected&&this.isValidFilterField(o,e.allowMemberFilter,e.allowLabelFilter)&&(this.applyLabelFilter(o),o&&(r=o.items),o.type&&"Include"===o.type?(this.frameFilterList(r,o.name,t,"include",o.showLabelFilter,a),a=!0):this.frameFilterList(r,o.name,t,"exclude",o.showLabelFilter),o.showLabelFilter&&(o.items=[],o.type=o.showDateFilter?"Date":o.showNumberFilter?"Number":"Label"))}return a},e.prototype.isValidFilterField=function(e,i,a){var r=e.name,n=!1,s=(0,t.extend)([],this.dataSourceSettings.rows,null,!0);if(s=s.concat(this.dataSourceSettings.columns),this.fieldList[r].isSelected&&i&&["Include","Exclude"].indexOf(e.type)>=0){n=!0;for(var o=0,l=this.dataSourceSettings.values;o<l.length;o++){if(r===l[o].name){n=!1;break}}}else if(a)for(var d=0,h=s;d<h.length;d++){if(r===h[d].name&&["Label","Date","Number"].indexOf(e.type)>=0){n=!0;break}}return n},e.prototype.applyLabelFilter=function(e){if(["Label","Date","Number"].indexOf(e.type)>=0){var t=Object.keys(this.fieldList[e.name].members);if(e.showLabelFilter=!0,"Label"===e.type)e.items=this.getLabelFilterMembers(t,e.condition,e.value1,e.value2);else if("Date"===e.type){e.showDateFilter=!0;var i="string"==typeof e.value1?new Date(e.value1):e.value1,a="string"==typeof e.value2?new Date(e.value2):e.value2;e.items=this.getDateFilterMembers(t,e.name,e.condition,i,a)}else{e.showNumberFilter=!0,e.items=[];for(var r=0,n=t;r<n.length;r++){var s=n[r],o=this.getParsedValue(e.name,e.value1),l=this.getParsedValue(e.name,e.value2),d=this.getParsedValue(e.name,s);this.validateFilterValue(d,e.condition,o,l)&&e.items.push(s)}}e.type=e.condition?["DoesNotBeginWith","DoesNotContains","DoesNotEndsWith","DoesNotEquals","NotBetween"].indexOf(e.condition)>-1&&!e.showNumberFilter?"Exclude":"Include":"Exclude"}else e.showLabelFilter=!1},e.prototype.getLabelFilterMembers=function(e,t,i,a){for(var r=[],n=0,s=e;n<s.length;n++){var o=s[n],l=o.toLowerCase();if(i.toString())switch(t){case"Equals":case"DoesNotEquals":default:l===i.toLowerCase()&&r.push(o);break;case"BeginWith":case"DoesNotBeginWith":0===l.indexOf(i.toLowerCase())&&r.push(o);break;case"EndsWith":case"DoesNotEndsWith":null!==l.match(i.toLowerCase()+"$")&&r.push(o);break;case"Contains":case"DoesNotContains":l.indexOf(i.toLowerCase())>-1&&r.push(o);break;case"GreaterThan":l>i.toLowerCase()&&r.push(o);break;case"GreaterThanOrEqualTo":l>=i.toLowerCase()&&r.push(o);break;case"LessThan":l<i.toLowerCase()&&r.push(o);break;case"LessThanOrEqualTo":l<=i.toLowerCase()&&r.push(o);break;case"Between":case"NotBetween":l>=i.toLowerCase()&&l<=a.toLowerCase()&&r.push(o)}}return r},e.prototype.getDateFilterMembers=function(e,t,i,a,r){for(var n=[],s=0,o=e;s<o.length;s++){var l=o[s],d=new Date(l);if(a)switch(i){case"Equals":case"DoesNotEquals":default:this.getFormattedValue(d.toString(),t).formattedText===this.getFormattedValue(a.toString(),t).formattedText&&n.push(this.getFormattedValue(l,t).formattedText);break;case"After":d.getTime()>a.getTime()&&n.push(this.getFormattedValue(l,t).formattedText);break;case"AfterOrEqualTo":d.getTime()>=a.getTime()&&n.push(this.getFormattedValue(l,t).formattedText);break;case"Before":d.getTime()<a.getTime()&&n.push(this.getFormattedValue(l,t).formattedText);break;case"BeforeOrEqualTo":d.getTime()<=a.getTime()&&n.push(this.getFormattedValue(l,t).formattedText);break;case"Between":case"NotBetween":d.getTime()>=a.getTime()&&d.getTime()<=r.getTime()&&n.push(this.getFormattedValue(l,t).formattedText)}}return n},e.prototype.validateFilterValue=function(e,t,i,a){var r=!1;if("number"==typeof i)switch(t){case"Equals":e===i&&(r=!0);break;case"DoesNotEquals":default:e!==i&&(r=!0);break;case"GreaterThan":e>i&&(r=!0);break;case"GreaterThanOrEqualTo":e>=i&&(r=!0);break;case"LessThan":e<i&&(r=!0);break;case"LessThanOrEqualTo":e<=i&&(r=!0);break;case"Between":e>=i&&e<=a&&(r=!0);break;case"NotBetween":e>=i&&e<=a||(r=!0)}return r},e.prototype.frameFilterList=function(e,t,i,a,r,n){i[a]||(i[a]={indexObject:{},index:[]}),this.updateFilter(e,t,i,a,r,n)},e.prototype.updateFilter=function(e,i,a,r,n,s){var o=0,l=this.fieldList[i];l.filter=e,l.filterType=r,l.isExcelFilter=n;var d=Di.getFormattedMembers(l.members,i,this),h=s,p={},u={};for(p[r]={indexObject:{},index:[]},this.fieldFilterMem[i]={memberObj:{}};!(0,t.isNullOrUndefined)(e[o]);){if(d[e[o]]){var c=d[e[o]].index;if("include"===r)for(var g=0,m=c.length;g<m;g++)h&&void 0===a[r].indexObject[c[g]]||(p[r].indexObject[c[g]]=c[g],p[r].index.push(c[g]));else{for(g=0,m=c.length;g<m;g++)void 0===a[r].indexObject[c[g]]&&(a[r].indexObject[c[g]]=c[g],a[r].index.push(c[g]));this.fieldFilterMem[i].memberObj[e[o]]=e[o]}}o++}if("include"===r){a[r]=p[r];for(g=0;g<e.length;g++)d[e[g]]&&(u[e[g]]=e[g]);var f=Object.keys(d);for(g=0,m=f.length;g<m;g++)void 0===u[f[g]]&&(this.fieldFilterMem[i].memberObj[f[g]]=f[g])}},e.prototype.applyValueFiltering=function(e,i,a,r,n,s,o){this.isValueFiltered=!1;var l=(0,t.extend)({},"row"===o&&this.rowGrandTotal?this.rowGrandTotal:"column"===o&&this.columnGrandTotal?this.columnGrandTotal:"Top"!==this.dataSourceSettings.grandTotalsPosition?a[a.length-1]:a[0],null,!0);return this.getFilteredData(a,r,n,s,i,e.name,l,o),this.isValueFiltered&&(("row"===o&&null===this.rowGrandTotal||"column"===o&&null===this.columnGrandTotal)&&s.push(l),a=s),a},e.prototype.getFilteredData=function(e,i,a,r,n,s,o,l){for(var d=e.length,h=0;h<d;h++)if(a[s])if(e[h].level===n){this.isValueFiltered=!0,this.fieldList[s].isExcelFilter=!0;var p=0,u=a[s].measure,c=this.fieldList[u].index,g=this.fieldList[u].aggregateType;this.rawIndexObject={},p="row"===l?this.getAggregateValue(e[h].index,i.indexObject,c,g,!1):this.getAggregateValue(i.index,e[h].indexObject,c,g,!1);var m={fieldName:u,row:e[h],column:i,value:p,cellSets:this.getValueCellInfo?this.getCellSet(this.rawIndexObject):[],rowCellType:e[h].hasChild&&e[h].isDrilled?"subTotal":"grand sum"===e[h].type?"grandTotal":"value",columnCellType:i.hasChild&&i.isDrilled?"subTotal":"grand sum"===i.type?"grandTotal":"value",aggregateType:g,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(m),p=m.value,this.rawIndexObject={};var f=this.getParsedValue(u,a[s].value1),v=this.getParsedValue(u,a[s].value2);if(this.validateFilterValue(p,a[s].condition,f,v)||"grand sum"===e[h].type)"grand sum"!==e[h].type&&(r.push((0,t.extend)({},e[h],null,!0)),r[r.length-1].isLevelFiltered=!0);else{var S=this.removefilteredData(e[h],this.valueFilteredData),y=S||e[h];this.validateFilteredParentData(y,this.valueFilteredData,o,0,n,l)}}else e[h].hasChild&&e[h].members.length>0&&"grand sum"!==e[h].type&&(r.push((0,t.extend)({},e[h],null,!0)),r[r.length-1].members=[],r[r.length-1].isLevelFiltered=!0,this.getFilteredData(e[h].members,i,a,r[r.length-1].members,n,s,o,l))},e.prototype.getParsedValue=function(e,i){var a=i?i.toString():"";if(this.formatFields[e]&&i){var r=(0,t.extend)({},this.formatFields[e],null,!0);return delete r.name,this.globalize.parseNumber(a,r)}return this.globalize.parseNumber(a,{format:"N"})},e.prototype.removefilteredData=function(e,i){for(var a,r=(0,t.extend)([],i,null,!0),n=0;n<r.length;n++){if(e.isLevelFiltered&&e.axis===r[n].axis&&e.valueSort.levelName===r[n].valueSort.levelName&&e.actualText===r[n].actualText&&e.axis===r[n].axis&&e.level===r[n].level&&e.ordinal===r[n].ordinal){a=r[n],i.splice(n,1);break}i[n].hasChild&&i[n].members.length>0&&this.removefilteredData(e,i[n].members)}return a},e.prototype.validateFilteredParentData=function(e,t,i,a,r,n){if(t.length>0)for(var s=0,o=t;s<o.length;s++){var l=o[s];if(l.level===a){if("row"===n)for(var d=0,h=u=e.index;d<h.length;d++){var p=h[d];i.index.indexOf(p)>=0&&i.index.splice(i.index.indexOf(p),1),e.valueSort.levelName.toString().indexOf(l.valueSort.levelName.toString())>=0&&l.level!==r&&l.index.indexOf(p)>=0&&l.index.splice(l.index.indexOf(p),1)}else for(var u=e.indexObject,c=0,g=Object.keys(u);c<g.length;c++){p=g[c];Object.prototype.hasOwnProperty.call(u,p)&&(delete i.indexObject[p],e.valueSort.levelName.toString().indexOf(l.valueSort.levelName.toString())>=0&&l.level!==r&&delete l.indexObject[p])}l&&l.members.length>0&&l.members[0].level===a+1&&l.members[0].level!==r&&this.validateFilteredParentData(e,l.members,i,a+1,r,n)}}else if("row"===n)for(var m=0,f=u=e.index;m<f.length;m++){p=f[m];i.index.indexOf(p)>=0&&i.index.splice(i.index.indexOf(p),1)}else{u=e.indexObject;for(var v=0,S=Object.keys(u);v<S.length;v++){p=S[v];Object.prototype.hasOwnProperty.call(u,p)&&delete i.indexObject[p]}}},e.prototype.updateFramedHeaders=function(e,i,a,r,n){for(var s=0,o=e;s<o.length;s++){var l=o[s];this.isHeaderAvail=!1,(this.validateFilteredHeaders(l,a,n)||"grand sum"===l.type)&&("row"===n?this.rowCount+=this.rowValuesLength:this.columnCount+=this.customProperties.isTabularLayout?this.rowMaxLevel+this.colValuesLength:this.colValuesLength,r.push((0,t.extend)({},l,null,!0)),r[r.length-1].members=[],l.hasChild&&l.isDrilled&&l.members.length>0&&this.updateFramedHeaders(l.members,i,a,r[r.length-1].members,n))}return this.filterFramedHeaders},e.prototype.validateFilteredHeaders=function(e,t,i){for(var a=0,r=t;a<r.length;a++){var n=r[a];if(!this.isHeaderAvail){if(e.actualText===n.actualText&&e.level===n.level&&e.valueSort.levelName===n.valueSort.levelName)return"row"===i?n.index.length>0?(this.isHeaderAvail=!0,e.index=n.index,!0):(this.isHeaderAvail=!1,e.index=n.index,!1):Object.keys(n.indexObject).length>0?(this.isHeaderAvail=!0,e.indexObject=n.indexObject,!0):(this.isHeaderAvail=!1,e.indexObject=n.indexObject,!1);n.hasChild&&n.members.length>0&&"grand sum"!==n.type&&this.validateFilteredHeaders(e,n.members,i)}}return this.isHeaderAvail},e.prototype.isEmptyDataAvail=function(e,t){this.isEmptyData=!1,e.length>0&&"grand sum"===e[e.length-1].type&&0===e[e.length-1].index.length&&(this.isEmptyData=!0),t.length>0&&"grand sum"===t[t.length-1].type&&0===Object.keys(t[t.length-1].indexObject).length&&(this.isEmptyData=!0),0!==e.length&&0!==t.length||(this.isEmptyData=!0)},e.prototype.updateGridData=function(e){this.updateDataSourceSettings(e,!0),this.data=e.dataSource,this.allowDataCompression&&(this.actualData=this.data,this.data=this.getGroupedRawData(e));for(var t=0,i=this.fields;t<i.length;t++){var a=i[t];this.fieldList[a].members={},this.fieldList[a].dateMember=[],this.fieldList[a].isMembersFilled=!1}this.fillFieldMembers(),this.filterMembers=[],this.cMembers=[],this.rMembers=[],this.updateFilterMembers(e),this.isEditing=!0,this.isDrillThrough=!0,this.generateGridData(e),this.isEditing=!1},e.prototype.generateGridData=function(e,i,a,r,n){void 0===i&&(i=!1),void 0===n&&(n=!1),(0,t.isNullOrUndefined)(r)&&this.customProperties.isTabularLayout&&(this.rowMaxLevel=0),this.updateDataSourceSettings(e,i);var s=e.columns?e.columns:[],o=this.data,l=e.rows?e.rows:[],d=e.filterSettings,h=e.values?e.values:[];this.removeCount=0,this.isExpandAll=e.expandAll,this.drilledMembers=e.drilledMembers?e.drilledMembers:[],this.isEmptyData=!1;var p=[];if(l[0]&&l[0].showNoDataItems||s[0]&&s[0].showNoDataItems)for(var u=0;u<this.valueMatrix.length;u++)p.push(u);for(u=0;u<this.filterMembers.length;u++)this.filterPosObj[this.filterMembers[u]]=this.filterMembers[u];this.valueSortSettings.columnIndex=void 0,this.validateValueFields(),this.frameDrillObject(),this.isValueFilterEnabled&&!this.isEditing||r||(this.isLastHeaderHasMeasures=!0,this.columnCount=0,this.rowCount=0,this.cMembers=[],this.rMembers=[],0!==l.length&&0!==h.length&&(this.rMembers=this.getIndexedHeaders(l,o,this.customProperties.isTabularLayout?this.rowMaxLevel:0,l[0].showNoDataItems?p:this.filterMembers,"row","",this.allowValueFilter)),0!==s.length&&0!==h.length&&(this.cMembers=this.getIndexedHeaders(s,o,0,s[0].showNoDataItems?p:this.filterMembers,"column","",this.allowValueFilter)),this.insertAllMembersCommon(),this.saveDataHeaders=this.isValueFiltersAvail&&e.allowValueFilter?{rowHeaders:(0,t.extend)([],this.rMembers,null,!0),columnHeaders:(0,t.extend)([],this.cMembers,null,!0)}:{}),this.customProperties.isTabularLayout&&(this.showSubTotalsAtBottom=!0),this.pivotValues=[],this.headerContent=[],this.valueContent=[],this.valueFilteredData=[],this.filterFramedHeaders=[];var c=[],g=[],m=[],f=[],v=[],S=this.dataSourceSettings.values.length;if(this.isValueFiltersAvail&&e.allowValueFilter&&!r){this.valueFilteredData=[];var y=this.saveDataHeaders.rowHeaders?this.saveDataHeaders.rowHeaders:[],b=this.saveDataHeaders.columnHeaders?this.saveDataHeaders.columnHeaders:[];if(d.length>0){for(var C={},x={},w=0,T=h;w<T.length;w++){var M=T[w];x[M.name]=M}for(var D=0,O=d;D<O.length;D++){var P=O[D];y=m.length>0?m:y,b=f.length>0?f:b,this.valueFilteredData=[];var N=P.properties?P.properties:P;if("Value"===N.type&&this.fieldList[P.name]&&this.fieldList[P.name].isSelected){C[P.name]=P,N.items=[];for(var E=!1,I=l.length,F=s.length,L=0;L<I;L++)if(N.name===l[L].name&&x[N.measure]&&!E){E=!0,m=this.applyValueFiltering(l[L],L,y,this.columnGrandTotal?this.columnGrandTotal:"Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals?b[0]:b[b.length-1],C,this.valueFilteredData,"row");break}for(var A=0;A<F;A++)if(N.name===s[A].name&&x[N.measure]&&!E){E=!0,f=this.applyValueFiltering(s[A],A,b,this.rowGrandTotal?this.rowGrandTotal:"Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals?y[0]:y[y.length-1],C,this.valueFilteredData,"column");break}}}}m=m.length>0?m:y,f=f.length>0?f:b,this.isEmptyDataAvail(m,f);var R=Di.getClonedFieldList(this.fieldList),k=this.data[0];this.getFieldList(k,this.enableSort,e.allowValueFilter),this.fillFieldMembers(),this.updateSortSettings(e.sortSettings,this.enableSort),this.filterMembers=[],this.updateFilterMembers(e),this.isLastHeaderHasMeasures=!0,this.rMembers=0!==l.length?this.getIndexedHeaders(l,o,0,l[0].showNoDataItems?p:this.filterMembers,"row",""):[],this.cMembers=0!==s.length?this.getIndexedHeaders(s,o,0,s[0].showNoDataItems?p:this.filterMembers,"column",""):[],this.insertAllMembersCommon(),this.updateFieldList(R),this.rowCount=0,this.columnCount=0,this.rMembers=this.updateFramedHeaders(this.rMembers,this.rMembers,m,this.filterFramedHeaders,"row"),this.filterFramedHeaders=[],this.cMembers=this.updateFramedHeaders(this.cMembers,this.cMembers,f,this.filterFramedHeaders,"column"),this.isValueFilterEnabled=!0}r||this.applyValueSorting(),this.isPagingOrVirtualizationEnabled&&(r?(this.rMembers=r.rowHeaders,this.cMembers=r.columnHeaders,this.rowCount=this.customProperties.isTabularLayout?this.rowCount+this.emptyRowsLength:r.rowHeadersCount,this.columnCount=r.columnHeadersCount):(this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.columnHeaders=this.cMembers,this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeadersCount=this.columnCount),this.calculatePagingValues()),!this.valueAxis&&this.isLastHeaderHasMeasures&&this.getAggregatedHeaders(l,s,this.rMembers,this.cMembers,h),this.getHeaderData(l,s,h,v,this.cMembers,g,this.pivotValues,0,this.valueAxis?1:S),this.insertSubTotals(),this.getTableData(v.length>0?v:this.rMembers,c,g,0,this.pivotValues,S,0,this.rowGrandTotal?this.rowGrandTotal:this.rMembers[this.rMembers.length-1],this.columnGrandTotal?this.columnGrandTotal:this.cMembers[this.cMembers.length-1]),this.applyAdvancedAggregate(c,g,this.pivotValues),this.customProperties.isTabularLayout&&(this.pivotValues=this.getTabularPivotValues(i,!1,n),this.setRowSpan(),this.rowCount=this.rowCount-this.emptyRowsLength),this.isEngineUpdated=!0,this.isEmptyDataAvail(this.rMembers,this.cMembers),this.clearProperties(a)},e.prototype.updateHeaders=function(e,i){e=(0,t.isNullOrUndefined)(e)?!(!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showRowGrandTotals)||!(this.dataSourceSettings.rows.length>0):e,(this.pageSettings&&this.removeRowGrandTotal||!e&&!this.rowGrandTotal)&&"grand sum"===this.rMembers[this.rMembers.length-1].type&&(this.rMembers=this.rMembers.slice(0,this.rMembers.length-1)),i=(0,t.isNullOrUndefined)(i)?!(!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showColumnGrandTotals)||!(this.dataSourceSettings.columns.length>0):i,(this.pageSettings&&this.removeColumnGrandTotal||!i&&!this.columnGrandTotal)&&"grand sum"===this.cMembers[this.cMembers.length-1].type&&(this.cMembers=this.cMembers.slice(0,this.cMembers.length-1))},e.prototype.updatePivotValues=function(e){var t=!(!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showRowGrandTotals)||!(this.dataSourceSettings.rows.length>0),i=!(!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showColumnGrandTotals)||!(this.dataSourceSettings.columns.length>0);if(e&&this.updateHeaders(t,i),(this.pageSettings&&this.removeRowGrandTotal||!t&&!this.rowGrandTotal)&&this.valueContent.length>0){var a=1;this.valueAxis&&this.dataSourceSettings.values.length>0&&(a=1+this.dataSourceSettings.values.length),this.pivotValues[this.pivotValues.length-a]&&"grand sum"===this.pivotValues[this.pivotValues.length-a][0].type&&(this.pivotValues=this.pivotValues.slice(0,this.pivotValues.length-a),this.valueContent=this.valueContent.slice(0,this.valueContent.length-a))}if((this.pageSettings&&this.removeColumnGrandTotal||!i&&!this.columnGrandTotal)&&this.headerContent.length>0){a=this.dataSourceSettings.values.length;if(this.valueAxis&&this.dataSourceSettings.values.length>0&&(a=1),this.pivotValues[0][this.pivotValues[0].length-a]&&"grand sum"===this.pivotValues[0][this.pivotValues[0].length-a].type)for(var r=0;r<this.pivotValues.length;r++)if(this.pivotValues[r]&&(this.pivotValues[r]=this.pivotValues[r].slice(0,this.pivotValues[r].length-a)),this.headerContent[r])for(var n=this.pivotValues[r].length;n<this.pivotValues[r].length+a;n++)delete this.headerContent[r][n]}this.removeRowGrandTotal=this.removeColumnGrandTotal=!1},e.prototype.onDrill=function(e){this.enableVirtualization||this.enablePaging||!this.customProperties.isTabularLayout||(this.rowMaxLevel=0),this.frameDrillObject(e);var t=this.getHeadersInfo(e.fieldName,e.axis);this.performDrillOperation(t.headers,e,t.fields,t.position,0),this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeadersCount=this.columnCount,"row"===t.axis?this.headerCollection.rowHeaders=t.headers:this.headerCollection.columnHeaders=t.headers,this.updateEngine()},e.prototype.onSort=function(e,t){t&&this.updateDataSourceSettings(t,!0);var i=this.getHeadersInfo(e.name,"");this.fieldList[e.name].sort=e.order,this.performSortOperation(i.headers,e,i,0),this.updateEngine()},e.prototype.onFilter=function(e,t){this.updateDataSourceSettings(t,!0);var i=this.getHeadersInfo(e.name,"");this.isLastHeaderHasMeasures=!!(this.valueAxis&&"row"===i.axis||!this.valueAxis&&"column"===i.axis)||this.isLastHeaderHasMeasures,"Include"===e.type&&e.items.length===this.fieldList[e.name].dateMember.length?(this.fieldList[e.name].filter=[],this.fieldList[e.name].filterType=""):(this.fieldList[e.name].filter=e.items,this.fieldList[e.name].filterType=e.type);for(var a={},r=0,n=this.filterMembers;r<n.length;r++){var s=n[r];a[s]=s}this.filterMembers=[],this.fieldFilterMem={},this.updateFilterMembers(t);for(var o=this.filterMembers.filter((function(e){return void 0===a[e]})),l={},d=0,h=e.items;d<h.length;d++){var p=h[d];l[p]=p}var u=this.dataSourceSettings.rows[0]&&this.dataSourceSettings.rows[0].showNoDataItems||this.dataSourceSettings.columns[0]&&this.dataSourceSettings.columns[0].showNoDataItems;if(u&&this.columnKeys[e.name]?u=!(!this.dataSourceSettings.columns[0]||!this.dataSourceSettings.columns[0].showNoDataItems):u&&"row"===i.axis&&(u=!(!this.dataSourceSettings.rows[0]||!this.dataSourceSettings.rows[0].showNoDataItems)),u){var c=[];this.filterPosObj={};for(var g=0;g<o.length;g++)this.filterPosObj[o[g]]=o[g];for(g=0;g<this.valueMatrix.length;g++)c.push(g);o=c}this.performFilterCommonUpdate(e,i,o),"column"===i.axis?(i=this.getHeadersInfo("","row"),this.performFilterCommonUpdate(e,i,o)):(i=this.getHeadersInfo("","column"),this.performFilterCommonUpdate(e,i,o)),this.frameHeaderObjectsCollection=!1,this.headerObjectsCollection={},this.customProperties.isTabularLayout&&(this.rowCount=this.rowCount-this.emptyRowsLength),this.updateEngine()},e.prototype.onAggregation=function(e,t){t&&this.updateDataSourceSettings(t,!0),this.fieldList[e.name].aggregateType=e.type,this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders,this.allowDataCompression&&(this.data=this.getGroupedRawData(this.dataSourceSettings),this.generateValueMatrix()),this.updateEngine()},e.prototype.onCalcOperation=function(e,t){this.dataSourceSettings.calculatedFieldSettings=t.calculatedFieldSettings?t.calculatedFieldSettings:[],this.dataSourceSettings.values=t.values?t.values:[],this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders,this.getCalculatedField(this.fields),this.fieldList[e.name]?this.fieldList[e.name].formula=e.formula:(this.fieldList[e.name]={id:e.name,caption:e.name,type:"number",aggregateType:"CalculatedField",filterType:"",index:this.fields.length-1,filter:[],sort:this.enableSort?"Ascending":"None",isSelected:!0,isExcelFilter:!1,formula:e.formula},1===this.valueAxis?this.headerCollection.rowHeadersCount=this.rowCount=this.rowCount/(this.dataSourceSettings.values.length-1)*this.dataSourceSettings.values.length:this.headerCollection.columnHeadersCount=this.columnCount=this.columnCount/(this.dataSourceSettings.values.length-1)*this.dataSourceSettings.values.length),this.getFormattedFields(t),this.fillFieldMembers(),this.updateEngine()},e.prototype.performDrillOperation=function(e,t,i,a,r){for(var n=0;n<e.length;){if(a===r){var s=e[n].valueSort.levelName.split(this.valueSortSettings.headerDelimiter);if(t.memberName===s.join(t.delimiter?t.delimiter:"**")){if("down"===t.action){e[n].isDrilled=!0,e[n].members=this.getIndexedHeaders(i,this.data,a+1,e[n].index,t.axis,t.memberName.split(t.delimiter?t.delimiter:"**").join(this.valueSortSettings.headerDelimiter));var o=void 0;if("row"===t.axis)o=this.applyValueSorting(e[n].members,this.cMembers),e[n].members=o.rMembers,this.rowCount+=this.showSubTotalsAtBottom?1:0;else{var l=this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals&&i[a].showSubTotals;this.columnCount-=l?0:this.colValuesLength,o=this.applyValueSorting(this.rMembers,e[n].members),e[n].members=o.cMembers}}else e[n].isDrilled=!1,this.updateHeadersCount(e[n].members,t.axis,a,i,"minus",!0),e[n].members=[],"row"===t.axis&&(this.rowCount-=this.showSubTotalsAtBottom?1:0);break}}else e[n].members.length>0&&(e[n].members=this.performDrillOperation(e[n].members,t,i,a,r+1));n++}return e},e.prototype.performSortOperation=function(e,t,i,a){for(var r=0;r<e.length;){if(i.position===a){e=this.getSortedHeaders(e,t.order.toString());break}e[r].members.length>0&&(e[r].members=this.performSortOperation(e[r].members,t,i,a+1)),r++}return e},e.prototype.performFilterDeletion=function(e,t,i,a,r){for(var n=0,s=!0,o=function(){if(i.position===r){var o=l;e=e.filter((function(e){return""!==o.fieldFilterMem[t.name].memberObj[e.formattedText]&&(!o.fieldFilterMem[t.name].memberObj[e.formattedText]||"grand sum"===e.type)})),s=!1}else e[n].members.length>0&&(e[n].members=l.performFilterDeletion(e[n].members,t,i,a,r+1));n++},l=this;n<e.length&&s;)o();var d=this;return e.filter((function(e){return e.members.length>0||"grand sum"===e.type||d.matchIndexes(e.indexObject,a)}))},e.prototype.matchIndexes=function(e,t){var i=Object.keys(e),a=i.length;if(0===a)return!0;for(;a>-1;){if(void 0!==t[e[i[a]]])return!0;a--}return!1},e.prototype.performFilterAddition=function(e,t,i){for(var a=0,r=function(){var r=e[a].valueSort.levelName;if(n.headerObjectsCollection[r]){for(var s={},o=0,l=e[a].members;o<l.length;o++){var d=l[o];s[d.valueSort.levelName.toString()]=d.valueSort.levelName.toString()}var h=n.headerObjectsCollection[r].filter((function(e){return!s[e.valueSort.levelName.toString()]}));e[a].members=e[a].members.concat(h),e[a].members=n.getSortedHeaders(e[a].members,n.fieldList[i.fields[e[a].members[0].level].name].sort),delete n.headerObjectsCollection[r]}e[a].members.length>0&&(e[a].members=n.performFilterAddition(e[a].members,t,i)),a++},n=this;a<e.length;)r();return e},e.prototype.performFilterCommonUpdate=function(e,t,i){if("row"===t.axis||"column"===t.axis){for(var a="row"===t.axis?this.rMembers:this.cMembers,r={},n=0,s=this.filterMembers;n<s.length;n++){var o=s[n];r[o]=o}if(this.fieldFilterMem[e.name]&&(a=this.performFilterDeletion(t.headers,e,t,r,0)),i.length>0&&t.fields.length>0){if(this.frameHeaderObjectsCollection=!0,t.fields.filter((function(e){return e.showNoDataItems})).length>0)for(var l=0;l<this.data.length;l++)i.push(l);this.headerObjectsCollection.parent=this.getIndexedHeaders(t.fields,this.data,0,i,t.axis,""),a=this.performFilterAddition(a,t.fields,t);for(var d={},h=0,p=a;h<p.length;h++){var u=p[h];d[u.valueSort.levelName.toString()]=u.valueSort.levelName.toString()}var c=this.headerObjectsCollection.parent.filter((function(e){return!d[e.valueSort.levelName.toString()]})),g=a.filter((function(e){return"grand sum"===e.type}));g.length>0&&a.pop(),a=this.getSortedHeaders(a.concat(c),this.fieldList[t.fields[0].name].sort).concat(g),"row"===t.axis?(this.cMembers=this.getIndexedHeaders(this.dataSourceSettings.columns,this.data,0,this.filterMembers,"column",""),this.insertAllMember(this.cMembers,this.filterMembers,"","column")):(this.rMembers=this.getIndexedHeaders(this.dataSourceSettings.rows,this.data,0,this.filterMembers,"row",""),this.insertAllMember(this.rMembers,this.filterMembers,"","row"))}"row"===t.axis?this.rowCount=0:this.columnCount=0,this.updateHeadersCount(a,t.axis,0,t.fields,"plus",!1),"row"===t.axis?(t.position>0&&this.insertPosition(this.dataSourceSettings.rows,this.data,0,this.filterMembers,"row","",a),this.insertTotalPosition(a),this.rMembers=this.headerCollection.rowHeaders=a,this.headerCollection.rowHeadersCount=this.rowCount):(t.position>0&&this.insertPosition(this.dataSourceSettings.columns,this.data,0,this.filterMembers,"column","",a),this.insertTotalPosition(a),this.cMembers=this.headerCollection.columnHeaders=a,this.headerCollection.columnHeadersCount=this.columnCount)}else{var m=this.dataSourceSettings.rows[0]&&this.dataSourceSettings.rows[0].showNoDataItems||this.dataSourceSettings.columns[0]&&this.dataSourceSettings.columns[0].showNoDataItems;this.rMembers=this.getIndexedHeaders(this.dataSourceSettings.rows,this.data,0,m?i:this.filterMembers,"row",""),this.cMembers=this.getIndexedHeaders(this.dataSourceSettings.columns,this.data,0,m?i:this.filterMembers,"column",""),this.insertAllMembersCommon(),this.rowCount=0,this.columnCount=0,this.updateHeadersCount(this.cMembers,"column",0,this.dataSourceSettings.columns,"plus",!1),this.updateHeadersCount(this.rMembers,"row",0,this.dataSourceSettings.rows,"plus",!1),m&&(this.insertPosition(this.dataSourceSettings.rows,this.data,0,this.filterMembers,"row","",this.rMembers),this.insertPosition(this.dataSourceSettings.columns,this.data,0,this.filterMembers,"column","",this.cMembers)),this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeaders=this.cMembers,this.headerCollection.columnHeadersCount=this.columnCount}this.applyValueSorting()},e.prototype.getHeadersInfo=function(e,t){this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders;for(var i="row"===(t=""===t?this.getAxisByFieldName(e):t)?this.rMembers:this.cMembers,a="row"===t?this.dataSourceSettings.rows:this.dataSourceSettings.columns,r=0,n=0,s=a;n<s.length;n++){if(s[n].name===e)break;r++}return{axis:t,fields:a,headers:i,position:r}},e.prototype.updateEngine=function(){this.customProperties.isTabularLayout&&(this.rowCount=this.rowCount+this.emptyRowsLength),this.removeCount=0,this.validateValueFields(),this.calculatePagingValues(),this.pivotValues=[],this.headerContent=[],this.valueContent=[];var e=[],t=[],i=[],a=this.dataSourceSettings.values.length;this.frameDrillObject(),this.getAggregatedHeaders(this.dataSourceSettings.rows,this.dataSourceSettings.columns,this.rMembers,this.cMembers,this.dataSourceSettings.values),this.getHeaderData(this.dataSourceSettings.rows,this.dataSourceSettings.columns,this.dataSourceSettings.values,i,this.cMembers,t,this.pivotValues,0,this.valueAxis?1:a),this.insertSubTotals(),this.getTableData(i.length>0?i:this.rMembers,e,t,0,this.pivotValues,a,0,this.rowGrandTotal?this.rowGrandTotal:this.rMembers[this.rMembers.length-1],this.columnGrandTotal?this.columnGrandTotal:this.cMembers[this.cMembers.length-1]),this.applyAdvancedAggregate(e,t,this.pivotValues),this.customProperties.isTabularLayout&&(this.pivotValues=this.getTabularPivotValues(!0,!0),this.setRowSpan(),this.rowCount=this.rowCount-this.emptyRowsLength),this.isEngineUpdated=!0,this.isEmptyDataAvail(this.rMembers,this.cMembers)},e.prototype.getAxisByFieldName=function(e){for(var t=0,i="";t<4&&""===i;){switch(t){case 0:i=this.getFieldByName(e,this.dataSourceSettings.rows)?"row":"";break;case 1:i=this.getFieldByName(e,this.dataSourceSettings.columns)?"column":""}t++}return i},e.prototype.getFieldByName=function(e,t){return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.updateHeadersCount=function(e,t,i,a,r,n){var s=0,o=a[i],l=!0;for(l="column"===t?this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals&&(!o||o.showSubTotals):this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showRowSubTotals&&(!o||o.showSubTotals);s<e.length;)"row"===t?this.rowCount=this.rowCount-("plus"===r?-(1===this.valueAxis?this.dataSourceSettings.values.length:1):1===this.valueAxis?this.dataSourceSettings.values.length:1):this.columnCount=this.columnCount-("plus"===r?-(1===this.valueAxis?1:this.dataSourceSettings.values.length):1===this.valueAxis?1:this.dataSourceSettings.values.length),e[s].members.length>0&&(this.updateHeadersCount(e[s].members,t,i+1,a,r,!0),"row"===t&&(this.rowCount-=this.showSubTotalsAtBottom&&e[s].hasChild&&e[s].isDrilled?1:0)),s++;"column"===t&&!l&&n&&(this.columnCount+="plus"===r?-this.colValuesLength:this.colValuesLength)},e.prototype.getSortedHeaders=function(e,t){var i="Grand Total"!==e[0].actualText?e[0].valueSort.axis:e[1].valueSort.axis,a=!(this.formatFields&&this.formatFields[i]&&this.formatFields[i].type),r=this.fieldList[i];if(a){if(r&&"number"===r.type&&e.length>0&&"string"==typeof e[0].actualText){for(var n=[],s=[],o=[],l=0;l<e.length;l++)if(isNaN(Number(e[l].actualText.toString().charAt(0))))n.push(e[l]);else{if(""!==e[l].actualText){s.push(e[l]);break}o.push(e[l])}return s.length>0&&(s=this.sortHeaders(i,r,e,r.sort,r.isAlphanumeric)),e}return this.sortHeaders(i,r,e,t,r.type)}return this.sortHeaders(i,r,e,t,"date")},e.prototype.sortHeaders=function(e,i,a,r,n){var s=!1,o=this.fieldList[e]&&this.fieldList[e].membersOrder?this.fieldList[e].membersOrder.slice():[],l={fieldName:e,sortOrder:r,members:o&&o.length>0?o:Object.keys(i.members),IsOrderChanged:!1},d="datetime"===(n="datetime"===n||"date"===n||"time"===n?this.formatFields[e]&&["date","dateTime","time"].indexOf(this.formatFields[e].type)>-1?n:"string":n)||"date"===n||"time"===n,h=!1;if(this.dataSourceSettings.groupSettings.length>0){var p=this.dataSourceSettings.groupSettings.filter((function(e){return e.name===i.id}));!(0,t.isNullOrUndefined)(p)&&p.length>0&&(h="number"===p[0].type.toLocaleLowerCase()&&"string"===i.type.toLocaleLowerCase())}if(o&&o.length>0?Di.applyCustomSort(l,a,n):(Di.applyHeadersSort(a,r,n,h),s=!0),s&&this.getHeaderSortInfo){for(var u=[],c=0,g=0;c<a.length;c++){var m=a[c],f=d?m.dateText:m.actualText;"Grand Total"!==m.actualText&&(u[g++]=f)}l.members=u}return this.getHeaderSortInfo&&this.getHeaderSortInfo(l),l.IsOrderChanged&&Di.applyCustomSort(l,a,n,!0),a},e.prototype.applyValueSorting=function(e,t){var i=!1;if(void 0===e||void 0===t){if(this.valueSortHeaderText=void 0,this.enableValueSorting&&this.valueSortSettings.headerText&&!this.valueSortHeaderText&&""!==this.valueSortSettings.headerText&&this.dataSourceSettings.values.length>0){this.valueSortHeaderText=this.valueSortSettings.headerText;for(var a=this.valueSortHeaderText.split(this.valueSortSettings.headerDelimiter),r=0,n=this.dataSourceSettings.values;r<n.length;r++){var s=n[r],o=s.caption?s.caption:s.name,l=a.indexOf(o);if(l>-1){a.splice(l,1),a.push(o),this.valueSortHeaderText=a.join(this.valueSortSettings.headerDelimiter);break}}}e=this.rMembers,t=this.cMembers,i=!0}if(this.valueSortHeaderText){a=this.valueSortHeaderText.split(this.valueSortSettings.headerDelimiter);for(var d="",h=void 0,p=void 0,u=void 0,c=0;c<this.dataSourceSettings.values.length;c++){if(this.dataSourceSettings.values[c].caption===a[a.length-1]){u=this.dataSourceSettings.values[c].name;break}u=a[a.length-1]}if((1===this.dataSourceSettings.values.length&&0===this.dataSourceSettings.columns.length||this.dataSourceSettings.values.length>1)&&u&&this.fieldList[u]){for(c=0;c<a.length-1;c++)d=""===d?a[c]:d+this.valueSortSettings.headerDelimiter+a[c];h=this.fieldList[u].index,p=this.fieldList[u].aggregateType}else{if(this.dataSourceSettings.alwaysShowValueHeader&&1!==a.length)for(c=0;c<a.length-1;c++)d=""===d?a[c]:d+this.valueSortSettings.headerDelimiter+a[c];else d=this.valueSortHeaderText;h=this.fieldList[this.dataSourceSettings.values[0].name].index,p=this.fieldList[this.dataSourceSettings.values[0].name].aggregateType}var g=void 0;0===this.valueAxis?(g=this.getMember(t,d))&&(e=this.sortByValueRow(e,g,this.valueSortSettings.sortOrder,h,p)):(g=this.getMember(e,d))&&(t=this.sortByValueRow(t,g,this.valueSortSettings.sortOrder,h,p)),i&&(this.rMembers=e,this.cMembers=t,this.isPagingOrVirtualizationEnabled&&(this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.columnHeaders=this.cMembers))}return{rMembers:e,cMembers:t}},e.prototype.getMember=function(e,t){for(var i,a=e.length,r=0;r<a;r++){if(e[r].valueSort.levelName===t){i=e[r];break}if(e[r].members.length>0&&(i=this.getMember(e[r].members,t)),i)return i}return i},e.prototype.sortByValueRow=function(e,t,i,a,r){for(var n=[],s=0,o=e;s<o.length;s++){if("grand sum"===(u=o[s]).type)n.push({header:u});else{this.rawIndexObject={};var l=this.getAggregateValue(u.index,t.indexObject,a,r,!1),d={fieldName:this.fields[a],row:u,column:t,value:l,cellSets:this.getValueCellInfo?this.getCellSet(this.rawIndexObject):[],rowCellType:u.hasChild&&u.isDrilled?"subTotal":"grand sum"===u.type?"grandTotal":"value",columnCellType:t.hasChild&&t.isDrilled?"subTotal":"grand sum"===t.type?"grandTotal":"value",aggregateType:r,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(d),l=d.value,this.rawIndexObject={},n.push({header:u,value:l})}}for(var h=0,p=e=Di.getSortedValue(n,i);h<p.length;h++){var u;(u=p[h]).members.length>0&&(u.members=this.sortByValueRow(u.members,t,i,a,r))}return e},e.prototype.insertAllMembersCommon=function(){this.rowGrandTotal=this.columnGrandTotal=null;var e=!(!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showRowGrandTotals)||!(this.dataSourceSettings.rows.length>0),t=!(!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showColumnGrandTotals)||!(this.dataSourceSettings.columns.length>0);this.isValueHasAdvancedAggregate?(this.insertAllMember(this.rMembers,this.filterMembers,"","row"),e&&(this.rowCount+=this.rowValuesLength),this.insertAllMember(this.cMembers,this.filterMembers,"","column"),t&&(this.columnCount+=this.colValuesLength)):(e?(this.insertAllMember(this.rMembers,this.filterMembers,"","row"),this.rowCount+=this.rowValuesLength):this.rowGrandTotal=this.insertAllMember([],this.filterMembers,"","row")[0],t?(this.insertAllMember(this.cMembers,this.filterMembers,"","column"),this.columnCount+=this.colValuesLength):this.columnGrandTotal=this.insertAllMember([],this.filterMembers,"","column")[0])},e.prototype.insertSubTotals=function(){for(var e=this.pivotValues.length,i=0;i<e;i++){var a=this.pivotValues[i];if(a)for(var r=void 0,n=1,s=a.length,o=void 0,l=1,d=this.showSubTotalsAtTop?this.reformAxisCount:s,h=this.showSubTotalsAtTop?l:d-1,p=void 0,u=void 0;l<d;){var c=a[h];if(c){r&&(r.colSpan=n,r.colIndex=this.showSubTotalsAtTop?r.colIndex+(n-1):r.colIndex-(n-1)),this.showSubTotalsAtTop&&(p=u=this.getMemberSpanCount(this.pivotValues[i],h)),o={index:c.index,indexObject:c.indexObject},c.index=[],c.indexObject={},r=(0,t.extend)({},c,null,!0),c.index=o.index,c.indexObject=o.indexObject;for(var g=i+1;this.pivotValues[g]&&!this.pivotValues[g][h];){var m=this.pivotValues[i][h];m.isDrilled||!this.valueAxis&&!this.isLastHeaderHasMeasures&&m.members&&m.members.length>0&&g>this.measureIndex||(m.rowSpan=g-i+1,r.rowSpan=g-i+1);var f="sum"===c.type||"grand sum"===c.type?c.type:"sum";this.pivotValues[g][h]=this.headerContent[g][h]={type:f,formattedText:"sum"===c.type||"grand sum"===c.type?c.formattedText:c.formattedText+" Total",axis:"column",hierarchyName:c.hierarchyName,level:-1,colIndex:h,rowIndex:g,valueSort:c.valueSort},c.valueSort&&c.valueSort[this.valueSortSettings.headerText]&&(this.valueSortSettings.columnIndex=h);var v=!1;"grand sum"===f?(m.rowSpan=g-i+1,r.rowSpan=g-i+1):"sum"!==m.type&&(m.isDrilled||this.valueAxisFields[m.actualText]&&!this.valueAxis&&!this.isLastHeaderHasMeasures&&m.members&&m.members.length>0)?(this.pivotValues[i+1][h].rowSpan=g-i,v=!0):this.pivotValues[g][h].rowSpan=-1,g>i+1&&("sum"===m.type||v)&&(this.pivotValues[g][h].rowSpan=-1),g++}n=1}else a[h]=this.headerContent[i][h]=(0,t.extend)({},r,null,!0),a[h].index=this.headerContent[i][h].index=o.index,a[h].indexObject=this.headerContent[i][h].indexObject=o.indexObject,n++,this.showSubTotalsAtTop?(u--,a[h].colSpan=u,a[h].colIndex=a[h].colIndex+(n-1)):(a[h].colSpan=n,a[h].colIndex=a[h].colIndex-(n-1));if(1===h&&r&&(this.showSubTotalsAtTop?(r.colSpan=p,r.colIndex=r.colIndex+(n-1)):(r.colSpan=n,r.colIndex=r.colIndex-(n-1))),this.showSubTotalsAtTop&&(a[h+1]||h+1===this.reformAxisCount)){var S=this.pivotValues[i][h-n+1];S.colSpan=p,this.pivotValues[i][h-n+1]=S}h=this.showSubTotalsAtTop?h+1:h-1,l++}}},e.prototype.getMemberSpanCount=function(e,t){for(var i=1,a=t+1;a<this.reformAxisCount&&!e[a];a++)i++;return i},e.prototype.frameDrillObject=function(e){void 0===e&&(e=null),this.fieldDrillCollection={};for(var t=0;t<this.drilledMembers.length;t++){for(var i=this.drilledMembers[t],a=!1,r=1,n=!1,s=this.fieldList[i.name],o=s&&s.expandAll,l=0;l<this.dataSourceSettings.rows.length;l++)if(this.dataSourceSettings.rows[l].name===i.name){r=((d=this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)&&this.measureIndex>-1&&this.measureIndex<=l)?l+1:l)+1,a=!!d,n=!0;break}if(!n)for(l=0;l<this.dataSourceSettings.columns.length;l++)if(this.dataSourceSettings.columns[l].name===i.name){var d;r=((d=!this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)&&this.measureIndex>-1&&this.measureIndex<=l)?l+1:l)+1,a=!!d,n=!0;break}for(var h=0,p=i.items;h<p.length;h++){var u=p[h],c=u.split(i.delimiter);if(r===c.length){var g=i.name+this.valueSortSettings.headerDelimiter+c.join(this.valueSortSettings.headerDelimiter);if(this.fieldDrillCollection[g]=g,a){var m=!1;if(this.isExpandAll||o)for(var f=0,v=this.dataSourceSettings.values;f<v.length;f++){var S=v[f],y=S.caption?S.caption:S.name;if(c[this.measureIndex]=y,!(i.items.indexOf(c.join(i.delimiter))>-1)){m=!1;break}m=!0}((this.isExpandAll||o)&&m||!this.isExpandAll||!o)&&((c=u.split(i.delimiter)).splice(this.measureIndex,1),e&&e.memberName===u&&(e.memberName=c.join(i.delimiter)),g=i.name+this.valueSortSettings.headerDelimiter+c.join(this.valueSortSettings.headerDelimiter),this.fieldDrillCollection[g]=g)}}}}},e.prototype.getIndexedHeaders=function(e,i,a,r,n,s,o){var l=[],d=0;if(e&&e.length>0){d++;var h=e.length,p={},u=e[a].name,c=e[a],g=this.fieldList[u];if((0,t.isNullOrUndefined)(this.reportDataType)){this.reportDataType={};for(var m=0;m<this.dataSourceSettings.rows.length;m++)this.reportDataType[this.dataSourceSettings.rows[m].name]=this.dataSourceSettings.rows[m].dataType;for(m=0;m<this.dataSourceSettings.columns.length;m++)this.reportDataType[this.dataSourceSettings.columns[m].name]=this.dataSourceSettings.columns[m].dataType;for(m=0;m<this.dataSourceSettings.values.length;m++)this.reportDataType[this.dataSourceSettings.values[m].name]=this.dataSourceSettings.values[m].dataType}g.type=(0,t.isNullOrUndefined)(this.reportDataType[g.id])?g.type:this.reportDataType[g.id];var f=!1,v=this.formatFields[u]&&["date","dateTime","time"].indexOf(this.formatFields[u].type)>-1,S=r.length<1&&a>0||c.showNoDataItems,y={};if(S){for(var b=Object.keys(g.members),C=0,x=b.length;C<x;C++)(this.dataSourceSettings.showHeaderWhenEmpty||this.localeObj&&b[C]!==this.localeObj.getConstant("undefined"))&&(y[b[C]]=b[C]);r.length<1&&(f=!0,r.length=b.length)}n===this.dataSourceSettings.valueAxis&&this.measureIndex===a&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&(this.isLastHeaderHasMeasures=!1);for(C=0,x=r.length;C<x;C++){var w={};(0,t.isNullOrUndefined)(e[a].showSubTotals)||e[a].showSubTotals||(w.showSubTotals=!1),w.hasChild=a<h-1,w.level=a,w.axis=n,w.colSpan=1,this.rowMaxLevel="row"===n&&this.rowMaxLevel<a?a:this.rowMaxLevel;var T=f?g.members[Object.keys(y)[0]].ordinal:this.valueMatrix[r[C]][g.index].ordinal,M=f?Object.keys(y)[0]:i[r[C]][this.fieldKeys[u]];if(M=this.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(M):M,!((0,t.isNullOrUndefined)(M)||this.localeObj&&M===this.localeObj.getConstant("undefined"))||this.dataSourceSettings.showHeaderWhenEmpty){if(delete y[M],!S||!this.fieldFilterMem[u]||this.fieldFilterMem[u].memberObj[M]!==M){var D=v?{actualText:M,formattedText:g.dateMember[T-1].formattedText,dateText:g.dateMember[T-1].actualText}:{formattedText:null===M?this.localeObj?this.localeObj.getConstant("null"):String(M):void 0===M&&this.localeObj?u in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(M),actualText:null===M?this.localeObj?this.localeObj.getConstant("null"):String(M):void 0===M?this.localeObj?u in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(M):M};w.actualText=D.actualText,w.formattedText=D.formattedText,v&&(w.dateText=D.dateText);var O=!S||void 0!==this.filterPosObj[r[C]]&&!f,P=!1;if(S&&g.filter.length>0&&"include"===g.filterType&&(P=!0),p&&p[T]||P&&!(P&&g.filter.indexOf(M.toString())>-1))O&&(p[T].index.push(r[C]),p[T].indexObject[r[C]]=r[C]);else{p[T]={index:[],indexObject:{}},w.index=p[T].index,w.indexObject=p[T].indexObject,O&&(w.index=p[T].index=[r[C]],p[T].indexObject[r[C]]=r[C],w.indexObject=p[T].indexObject),w.ordinal=T,w.valueSort={},w.valueSort.axis=u,0!==a?(w.valueSort.levelName=s+this.valueSortSettings.headerDelimiter+(this.customProperties.isTabularLayout?this.getFormattedValue(w.formattedText,g.caption).formattedText:w.formattedText),w.valueSort[s+this.valueSortSettings.headerDelimiter+w.formattedText]=1,w.valueSort.uniqueName=s+this.valueSortSettings.headerDelimiter+(w.actualText?w.actualText:w.formattedText),w.valueSort[s+this.valueSortSettings.headerDelimiter+(w.actualText?w.actualText:w.formattedText)]=1):(w.valueSort[w.formattedText]=1,w.valueSort.levelName=this.customProperties.isTabularLayout?this.getFormattedValue(w.formattedText,g.caption).formattedText:w.formattedText,w.valueSort[w.actualText?w.actualText:w.formattedText]=1,w.valueSort.uniqueName=w.actualText?w.actualText:w.formattedText);var N=w.valueSort.axis+this.valueSortSettings.headerDelimiter+w.valueSort.levelName,E=this.isExpandAll||c&&c.expandAll;w.isDrilled=!(!o||!this.isValueFiltersAvail)||(w.hasChild&&this.fieldDrillCollection[N]?!E||!this.valueAxis&&!this.isLastHeaderHasMeasures&&d>=this.measureIndex:E),w.members=[],l.push(w)}S&&!f&&a>0&&C+1===r.length&&Object.keys(y).length>0&&(f=!0,x=Object.keys(y).length,C=-1)}}else S&&!f&&a>0&&C+1===r.length&&Object.keys(y).length>0&&(x=Object.keys(y).length,f=!0,C=-1)}for(var I=0,F=l.length;I<F;I++){this.frameHeaderObjectsCollection||("row"===n?this.rowCount+=this.rowValuesLength+(l[I].isDrilled&&l[I].hasChild&&this.showSubTotalsAtBottom?1:0):this.columnCount+=this.colValuesLength);var L=null;if(l[I].valueSort&&l[I].valueSort.levelName&&(L=l[I].valueSort.levelName),s=L||l[I].formattedText,!this.dataSourceSettings.showHeaderWhenEmpty&&h-1>a&&l[I].index&&l[I].index.length>0)if(S&&e[a+1]&&e[a+1].name&&Object.keys(this.fieldList[e[a+1].name].members).length>0)l[I].hasChild=!0;else{for(var A=l[I].index.length,R=0,k=0;k<A;k++){M=i[l[I].index[k]][this.fieldKeys[e[a+1].name]];((0,t.isNullOrUndefined)(M)||this.localeObj&&M===this.localeObj.getConstant("undefined"))&&R++}l[I].hasChild=R!==A}if(h-1>a&&l[I].isDrilled){this.columnCount-=this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals&&c.showSubTotals||"column"!==n?0:this.colValuesLength;var j=l[I].index;l[I].members=this.getIndexedHeaders(e,i,a+1,void 0===j?[]:j,n,s,o),this.frameHeaderObjectsCollection&&(this.headerObjectsCollection[s]=l[I].members)}}if(this.enableSort){if(v)return this.sortHeaders(u,g,l,g.sort,"date");if("number"===g.type.toLowerCase()&&l.length>0&&"string"==typeof l[0].actualText&&l[0].actualText.match(/[a-zA-Z]+/g)){var q=[],V=void 0,H=[],U=[];for(m=0;m<l.length;m++)if((0,t.isNullOrUndefined)(l[m].actualText.toString().match(/\d+/)))q.push(l[m]),V||"None"===g.sort||"Out of Range"===l[m].actualText&&(V=l[m],l.splice(m,1));else{if(""!==l[m].actualText){this.fieldList[u].isAlphanumeric=!0,H.push(l[m]);break}U.push(l[m])}return V&&("Ascending"===g.sort?"Grand Total"===l[0].actualText?l.splice(1,0,V):l.splice(0,0,V):"Grand Total"===l[l.length-1].actualText?l.splice(l.length-1,0,V):l.splice(l.length,0,V)),H.length>0&&this.sortHeaders(u,g,l,g.sort,g.isAlphanumeric),l}return this.sortHeaders(u,g,l,g.sort,g.type)}return l}return l},e.prototype.getOrderedIndex=function(e){for(var t={},i=0;i<e.length;i++)"grand sum"!==e[i].type&&(t[e[i].ordinal]=i);return t},e.prototype.insertPosition=function(e,t,i,a,r,n,s){var o=[],l=this.getOrderedIndex(s);if(e){for(var d={},h=e[i].name,p=this.fieldList[h],u=0,c=a.length;u<c;u++){var g={},m=this.valueMatrix[a[u]][p.index].ordinal,f=s[l[m]],v=t[a[u]][this.fieldKeys[h]];v=null===v?this.localeObj?this.localeObj.getConstant("null"):String(v):v;var S=this.formatFields[h]&&["date","dateTime","time"].indexOf(this.formatFields[h].type)>-1?this.getFormattedValue(v,h):{formattedText:v.toString(),actualText:v.toString()};f&&f.formattedText===S.formattedText&&(d&&d[m]?(d[m].index.push(a[u]),d[m].indexObject[a[u]]=a[u]):(d[m]={index:[],indexObject:{}},f.index=d[m].index=[a[u]],d[m].indexObject[a[u]]=a[u],f.indexObject=d[m].indexObject,f.valueSort={},f.valueSort.axis=h,0!==i?(f.valueSort.levelName=n+this.valueSortSettings.headerDelimiter+f.formattedText,f.valueSort[n+this.valueSortSettings.headerDelimiter+f.formattedText]=1,f.valueSort.uniqueName=n+this.valueSortSettings.headerDelimiter+(f.actualText?f.actualText:f.formattedText),f.valueSort[n+this.valueSortSettings.headerDelimiter+(f.actualText?f.actualText:f.formattedText)]=1):(f.valueSort[f.formattedText]=1,f.valueSort.levelName=f.formattedText,f.valueSort[f.actualText?f.actualText:f.formattedText]=1,f.valueSort.uniqueName=f.actualText?f.actualText:f.formattedText),g.members=[],o.push(g)))}for(var y=s.length-o.length;y>0;)o.push({members:[]}),y--;for(var b=0,C=o.length;b<C;b++)if(s[b].members.length>0){var x=null;s[b].valueSort&&s[b].valueSort.levelName&&(x=s[b].valueSort.levelName),n=x||s[b].formattedText,o[b].members=this.insertPosition(e,t,i+1,s[b].index,r,n,s[b].members)}return o}return o},e.prototype.insertTotalPosition=function(e){var t=e[e.length-1];if(t&&"grand sum"===t.type){t.index=this.filterMembers,t.indexObject={};for(var i=0,a=this.filterMembers.length;i<a;i++)t.indexObject[this.filterMembers[i]]=this.filterMembers[i]}return e},e.prototype.calculatePagingValues=function(){if(this.isPagingOrVirtualizationEnabled){1===this.valueAxis?this.rowValuesLength=this.dataSourceSettings.values.length:this.colValuesLength=this.dataSourceSettings.values.length,this.columnPageCount=Math.ceil(this.columnCount/this.pageSettings.columnPageSize),this.rowPageCount=Math.ceil(this.rowCount/this.pageSettings.rowPageSize),this.pageSettings.currentColumnPage=this.pageSettings.currentColumnPage>=this.columnPageCount||this.enableOptimizedRendering&&this.pageSettings.currentColumnPage>1&&(this.pageSettings.currentColumnPage+1)*this.colValuesLength>=this.columnPageCount?this.columnPageCount:this.pageSettings.currentColumnPage,this.pageSettings.currentRowPage=this.pageSettings.currentRowPage>=this.rowPageCount||this.enableOptimizedRendering&&this.pageSettings.currentRowPage>1&&(this.pageSettings.currentRowPage+1)*this.rowValuesLength>=this.rowPageCount?this.rowPageCount:this.pageSettings.currentRowPage;var e=this.enablePaging?1:this.enableOptimizedRendering?1.5:this.viewportPageCount;this.memberCnt=this.enablePaging?0:-this.rowValuesLength,this.rowStartPos=(this.pageSettings.currentRowPage*this.pageSettings.rowPageSize-this.pageSettings.rowPageSize)*(this.enablePaging?1:this.rowValuesLength)+(this.enablePaging?1:0);var t=this.enablePaging?this.rowStartPos:this.rowStartPos+this.pageSettings.rowPageSize*e*this.rowValuesLength>this.rowCount?this.rowCount-this.pageSettings.rowPageSize*e*this.rowValuesLength:this.rowStartPos;t<0&&(t=this.rowStartPos=0,this.pageSettings.currentRowPage=1),this.rowFirstLvl=(this.rowStartPos-t)%this.pageSettings.rowPageSize,this.rowStartPos=t,this.endPos=this.rowStartPos+this.pageSettings.rowPageSize*e*(this.enablePaging?1:this.rowValuesLength)-(this.enablePaging?1:0),this.endPos=this.endPos>this.rowCount+1?this.rowCount+1:this.endPos,this.rMembers=this.performSlicing(this.rMembers,[],this.rowStartPos,"row"),this.memberCnt=this.enablePaging?0:-this.colValuesLength,this.pageInLimit=!1,this.colHdrBufferCalculated=!1,this.colStartPos=(this.pageSettings.currentColumnPage*this.pageSettings.columnPageSize-this.pageSettings.columnPageSize)*(this.enablePaging?1:this.colValuesLength)+(this.enablePaging?1:0),(t=this.enablePaging?this.colStartPos:this.colStartPos+this.pageSettings.columnPageSize*e*this.colValuesLength>this.columnCount?this.columnCount-this.pageSettings.columnPageSize*e*this.colValuesLength:this.colStartPos)<0&&(t=this.colStartPos=0,this.pageSettings.currentColumnPage=1),this.colFirstLvl=(this.colStartPos-t)%this.pageSettings.columnPageSize,this.colStartPos=t,this.endPos=this.colStartPos+this.pageSettings.columnPageSize*e*(this.enablePaging?1:this.colValuesLength)-(this.enablePaging?1:0),this.endPos=this.endPos>this.columnCount+1?this.columnCount+1:this.endPos,this.cMembers=this.performSlicing(this.cMembers,[],this.colStartPos,"column"),this.memberCnt=-1,this.pageInLimit=!1,this.isValueHasAdvancedAggregate?("grand sum"!==this.rMembers[this.rMembers.length-1].type&&"grand sum"===this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1].type&&(this.rMembers.push(this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1]),this.removeRowGrandTotal=!0),"grand sum"!==this.cMembers[this.cMembers.length-1].type&&"grand sum"===this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1].type&&(this.cMembers.push(this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1]),this.removeColumnGrandTotal=!0)):(this.rowGrandTotal=this.rowGrandTotal?this.rowGrandTotal:this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1],this.columnGrandTotal=this.columnGrandTotal?this.columnGrandTotal:this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1])}},e.prototype.performSlicing=function(e,t,i,a){for(var r=0;e[r]&&!(this.enablePaging&&this.endPos<=this.memberCnt&&0!==r);){if(this.memberCnt+=e[r].level<=this.measureIndex?"column"===a?this.colValuesLength:this.rowValuesLength:1,!this.pageInLimit&&i<=this.memberCnt&&("column"===a?this.colFirstLvl=this.colFirstLvl+e[r].level:this.rowFirstLvl=this.rowFirstLvl+e[r].level,this.pageInLimit=!0),this.pageInLimit&&!this.enablePaging&&this.endPos<=this.memberCnt){if("column"!==a)break;if(0===e[r].members.length){if(this.colHdrBufferCalculated)break;this.colHdrBufferCalculated=!0,this.endPos+=e[r].level*this.colValuesLength}else if(this.colHdrBufferCalculated)break}if(t.push(e[r].members.length>0?this.removeChildMembers(e[r]):e[r]),e[r].members.length>0&&("column"===a?this.memberCnt-=this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals&&this.columnKeys[e[r].valueSort.axis].showSubTotals?0:this.colValuesLength:this.showSubTotalsAtBottom&&this.memberCnt++,t[t.length-1].members=this.performSlicing(e[r].members,[],i,a)),this.pageInLimit||t.pop(),0===e[r].level&&this.pageInLimit&&this.endPos<=this.memberCnt)break;r++}return t},e.prototype.removeChildMembers=function(e){for(var t=Object.keys(e),i=0,a={};i<t.length;)a[t[i]]=e[t[i]],"members"===t[i]&&(a.members=[]),i++;return a},e.prototype.insertAllMember=function(e,t,i,a){var r=e.length,n={hasChild:!1,index:t,level:0,axis:a,isDrilled:!1,indexObject:{},members:[],actualText:"Grand"+(i=" Total"),formattedText:this.localeObj?this.localeObj.getConstant("grandTotal"):"Grand"+i,ordinal:r,type:"grand sum",valueSort:{}};n.valueSort[n.formattedText]=1,n.valueSort.levelName=n.formattedText,n.valueSort[n.actualText]=1,n.valueSort.uniqueName=n.actualText;for(var s=0,o=t.length;s<o;s++)n.indexObject[t[s]]=t[s];return"Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals?e.unshift(n):e.push(n),e},e.prototype.getTableData=function(e,i,a,r,n,s,o,l,d,h){for(var p=e.length,u=0;u<p;u++){var c=!this.valueAxis&&!this.isLastHeaderHasMeasures&&n.length<this.dataSourceSettings.columns.length+1?this.dataSourceSettings.columns.length+1:n.length,g=e[u];i[c]=g;var m=c-Number(Object.keys(i)[0]),f=!i[c].members.length;g.colIndex=0,g.rowIndex=c;var v=!1,S=this.dataSourceSettings.valueSortSettings.headerDelimiter;if(this.valueAxis&&0===this.dataSourceSettings.rows.length&&this.dataSourceSettings.values.length>1&&(this.rowIndex=(0,t.isNullOrUndefined)(this.rowIndex)&&!f&&0===this.dataSourceSettings.rows.length?g.index:this.rowIndex,v=this.valueAxis&&0===this.dataSourceSettings.rows.length&&g.valueSort.levelName&&0!==g.valueSort.levelName.toString().indexOf("Grand Total"+S),this.valueAxis&&0===this.dataSourceSettings.rows.length&&0===g.valueSort.levelName.toString().indexOf("Grand Total"+S)&&(g.index=this.rowIndex)),v)f||this.recursiveRowData(e,i,a,c,n,s,f,u,0,o,l,d);else{var y=!1;if(this.showSubTotalsAtBottom&&i[r]&&i[r].hasChild)for(var b=0,C=i[r].members;b<C.length;b++)if("value"===C[b].type){y=!0;break}if(y&&!i[c].isSum&&i[c].members&&0===i[c].members.length)continue;if(n[c]||(n[c]=[],this.valueContent[m]={}),n[c][0]=i[c]=this.valueContent[m][0]=Di.getFormattedHeader(g,this),this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)){var x=c,w=m,T=c,M=!1;if(((0!==o||0!==this.measureIndex)&&!f||f)&&"value"===g.type&&!g.valueSort.axis||o>this.measureIndex&&"row"===g.axis&&g.valueSort.axis)for(var D=0,O=!1,P=g.valueSort.uniqueName?g.valueSort.uniqueName.toString().split(this.valueSortSettings.headerDelimiter):[],N=0,E=1,I=a.length;N<I;++N){if(!O)for(D=0;D<s;D++)if(P.indexOf(this.dataSourceSettings.values[D].name)>-1){O=!0,M=!0;break}if(o>this.measureIndex&&"row"===g.axis&&g.valueSort.axis)this.updateRowData(e,a,c,n,D,u,N,E,m,l,d);else{if(!i[r]){M=!1;break}var F=this.showSubTotalsAtBottom&&h?h:r;this.updateRowData(i,a,c,n,D,F,N,E,m,l,d)}E=n[c].length}if(!M)for(N=0,E=1,I=a.length;N<I;++N)E=n[c].length,n[x][E]=this.valueContent[w][E]={axis:"value",actualText:"",colSpan:1,colIndex:E,formattedText:"",hasChild:!1};this.recursiveRowData(e,i,a,T,n,s,f,u,s,o,l,d)}else{for(N=0,E=1,I=a.length;N<I;++N){var L=a[N].valueSort.uniqueName?a[N].valueSort.uniqueName.toString().split(this.valueSortSettings.headerDelimiter):[];for(D=0;D<s;D++)(this.valueAxis||this.isLastHeaderHasMeasures||L.indexOf(this.dataSourceSettings.values[D].name)>-1)&&(this.updateRowData(e,a,c,n,D,u,N,E,m,l,d),E=n[c].length)}this.recursiveRowData(e,i,a,c,n,s,f,u,0,o,l,d)}}}},e.prototype.insertRowSubTotals=function(e,t,i,a,r,n,s,o){var l=!!e[i].type&&("value"===e[i].type&&e[i].valueSort.levelName!==e[i].actualText);if(e[i].hasChild&&e[i].members.length>0){var d=[],h=Di.frameHeaderWithKeys(e[i]);if("value"===e[i].members[0].type){for(var p=0,u=[],c=1,g=0,m=h.members;g<m.length;g++){var f=m[g];"value"===f.type&&(u[u.length]=f)}for(;p<u.length;){for(var v=Di.frameHeaderWithKeys(u[p]),S=void 0;c<e.length;c++)if(e[c]&&e[c].valueSort.levelName===v.valueSort.levelName){S=e.indexOf(e[c]);break}S>-1&&(d[d.length]=S),v.formattedText=h.formattedText+" "+v.formattedText,v.isSum=!0,v.members=[],this.getTableData([v],e,t,i,a,r,n,s,o),p++}}else{h.formattedText=h.formattedText+" Total",h.members=[],h.isDrilled=!1,h.hasChild=!1,h.isSum=!0,h.type="sum";var y=l?this.getParentIndex(e,h):0;this.getTableData([h],e,t,i,a,r,n,s,o,y),d=[i]}for(S=0;S<d.length;S++){var b=a[d[S]];b=b.map((function(e){return e.formattedText=0===e.colIndex?e.formattedText:"",e})),a[d[S]]=b}}},e.prototype.getParentIndex=function(e,t){for(var i=0,a=e.length-1;a>0;a--)if(t.level===e[a].level&&e[a].index){i=a;break}return i},e.prototype.getAggregatedHeaders=function(e,t,i,a,r){this.selectedHeaders={selectedHeader:[],values:[]};for(var n=r.length,s=0;s<n;s++)switch(r[s].type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":var o=void 0,l=void 0;this.selectedHeaders.values.push(r[s].name),r[s].baseField&&r[s].baseItem?(o=r[s].baseField,l=r[s].baseItem):this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)&&t.length>0?(o=t[0].name,l=Object.keys(this.fieldList[t[0].name].members)[0]):e.length>0&&(o=e[0].name,l=Object.keys(this.fieldList[e[0].name].members)[0]);for(var d=!1,h=0,p=e;h<p.length;h++){if(p[h].name===o){this.getAggregatedHeaderData(i,r[s].name,l,!1,"row",r[s].type,this.selectedHeaders.selectedHeader,s),d=!0;break}}if(!d)for(var u=0,c=t;u<c.length;u++){if(c[u].name===o){this.getAggregatedHeaderData(a,r[s].name,l,!1,"column",r[s].type,this.selectedHeaders.selectedHeader,s);break}}break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":this.selectedHeaders.values.push(r[s].name),this.getAggregatedHeaderData("PercentageOfParentRowTotal"===r[s].type?i:a,r[s].name,void 0,!1,"PercentageOfParentRowTotal"===r[s].type?"row":"column",r[s].type,this.selectedHeaders.selectedHeader,s);break;case"RunningTotals":this.selectedHeaders.values.push(r[s].name),this.getAggregatedHeaderData(this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)?a:i,r[s].name,void 0,!1,this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)?"column":"row",r[s].type,this.selectedHeaders.selectedHeader,s);break;case"PercentageOfParentTotal":o=void 0;this.selectedHeaders.values.push(r[s].name),r[s].baseField?o=r[s].baseField:this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)&&t.length>0?o=t[0].name:e.length>0&&(o=e[0].name);d=!1;for(var g=e.length,m=0;m<g;m++)if(e[m].name===o){var f=m>=this.measureIndex?m+1:m;this.getAggregatedHeaderData(i,r[s].name,void 0,!1,"row",r[s].type,this.selectedHeaders.selectedHeader,s,f),d=!0;break}if(!d)for(g=t.length,m=0;m<g;m++)if(t[m].name===o){f=m;this.valueAxis||this.isLastHeaderHasMeasures||(f=m>=this.measureIndex?m+1:m),this.getAggregatedHeaderData(a,r[s].name,void 0,!1,"column",r[s].type,this.selectedHeaders.selectedHeader,s,f);break}}},e.prototype.getAggregatedHeaderData=function(e,i,a,r,n,s,o,l,d){for(var h=0,p=e;h<p.length;h++){var u=p[h];switch(s){case"DifferenceFrom":case"PercentageOfDifferenceFrom":if(-1!==u.valueSort.levelName.toString().split(this.valueSortSettings.headerDelimiter).indexOf(a)){var c=[];if(!r&&"row"===n)for(var g=0,m=e;g<m.length;g++){var f=m[g];f.level>=u.level&&c.push(f)}if(o.push(this.updateSelectedHeaders(a,u.level,n,r,i,s,u.valueSort.levelName,r?[u]:"column"===n?e:c,l+1)),u.members.length>0){var v=!1,S=[];if("row"===n)for(var y=0,b=u.members;y<b.length;y++){if("value"!==(T=b[y]).type||0!==T.members.length){S.push(T),v=!1;break}v=!0}(!v&&S.length>0||"column"===n)&&this.getAggregatedHeaderData("column"===n?u.members:S,i,a,!0,n,s,o[o.length-1].childMembers,l)}}else u.members.length>0&&this.getAggregatedHeaderData(u.members,i,a,!1,n,s,o,l);break;case"RunningTotals":case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":"grand sum"===u.type?o.push(this.updateSelectedHeaders(void 0,u.level,n,!1,i,s,u.valueSort.levelName,e,l+1)):u.members.length>0&&(o.push(this.updateSelectedHeaders(void 0,u.level,n,!1,i,s,u.valueSort.levelName,u.members,l+1)),this.getAggregatedHeaderData(u.members,i,void 0,!1,n,s,o,l));break;case"PercentageOfParentTotal":if("grand sum"!==u.type)if(u.valueSort.levelName.split(this.valueSortSettings.headerDelimiter).length-1===d)if(u.members.length>0){if(r)for(var C=o[o.length-1].aggregateHeaders,x=0,w=u.members;x<w.length;x++){var T=w[x];C.push((0,t.extend)({},T,null,!0))}else{var M=(0,t.extend)([],u.members,null,!0);o.push(this.updateSelectedHeaders(void 0,u.level,n,!1,i,s,u.valueSort.levelName,M,l+1)),(C=o[o.length-1].aggregateHeaders).push((0,t.extend)({},u,null,!0))}this.getAggregatedHeaderData(u.members,i,void 0,!0,n,s,o,l,d+1)}else r||o.push(this.updateSelectedHeaders(void 0,u.level,n,!1,i,s,u.valueSort.levelName,[u],l+1));else u.members.length>0&&this.getAggregatedHeaderData(u.members,i,void 0,!1,n,s,o,l,d)}}},e.prototype.updateSelectedHeaders=function(e,i,a,r,n,s,o,l,d){return{name:e,level:i,axis:a,isChild:r,value:n,type:s,uniqueName:o,aggregateHeaders:(0,t.extend)([],l,null,!0),childMembers:[],valueCount:d}},e.prototype.applyAdvancedAggregate=function(e,t,i){if(this.aggregatedValueMatrix=[],this.selectedHeaders.values.length>0){for(var a={},r=[],n=[],s=!1,o=i.length,l=0;l<o;l++)if(void 0!==i[l]&&void 0!==i[l][0]){if(!s)for(var d=i[l].length,h=0;h<d;h++){var p=i[l][h].actualText;"value"===i[l][h].axis&&-1!==this.selectedHeaders.values.indexOf(p)&&(r.push(h),s=!0)}if(!(this.showSubTotalsAtBottom&&i[l][0].isDrilled&&i[l][0].hasChild)&&r.length>0&&"value"===i[l][r[0]].axis&&-1!==this.selectedHeaders.values.indexOf(i[l][r[0]].actualText)){n.push(l);for(var u=0,c=r;u<c.length;u++){a[l+","+(f=c[u])]=[l,f]}}}this.updateAggregates(e,t,i,this.selectedHeaders.selectedHeader,r,n,a);for(var g=0,m=Object.keys(a);g<m.length;g++){var f;i[a[f=m[g]][0]][a[f][1]].formattedText=this.selectedHeaders.selectedHeader.length>0?this.emptyCellTextContent:"#N/A",this.aggregatedValueMatrix[a[f][0]]||(this.aggregatedValueMatrix[a[f][0]]=[]),this.aggregatedValueMatrix[a[f][0]][a[f][1]]=0}this.updatePivotValues(!0)}},e.prototype.updateAggregates=function(e,i,a,r,n,s,o){for(var l=0,d=r;l<d.length;l++){var h=d[l],p=h.aggregateHeaders,u=h.value,c=h.type,g=h.uniqueName,m="row"===h.axis,f=void 0,v=[],S=[],y=[],b=[],C=[],x=[];if(-1!==["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal","RunningTotals"].indexOf(h.type))if(m){if("RunningTotals"!==h.type)for(var w=0,T=s;w<T.length;w++){if(void 0!==e[He=T[w]]&&e[He].valueSort[g]){f=e[He],C=0===this.valueAxis||this.valueAxis&&a[He]&&a[He][1]&&a[He][1].actualText===u?a[He]:[];break}}}else{for(var M=a.length,D=0;D<M&&(void 0!==a[D]&&void 0===a[D][0]);D++)y.push(a[D]);for(var O=y.length;O--;){var P=(R=y[O][n[0]]).actualText;-1===this.selectedHeaders.values.indexOf(P)&&(S=y[O],O=0)}if("RunningTotals"!==h.type){for(var N=S.length,E=0;E<N;E++){var I=!1;if(void 0!==S[E]&&S[E].valueSort[g]){f=S[E];var F=a.length;for(D=0;D<F;D++){void 0!==(R=a[D])&&void 0!==R[0]&&"value"===R[E].axis&&-1!==this.selectedHeaders.values.indexOf(R[E].actualText)&&(I=!0,x[D]=R[E],b.push(D))}if(I)break}}if(0===x.length&&0===b.length)for(N=S.length,E=0;E<N;E++){I=!1;if(void 0!==S[E]&&0===S[E].valueSort.levelName.indexOf(g)){f=S[E];for(var L=a.length,A=0;A<L;A++){var R;void 0!==(R=a[A])&&void 0!==R[0]&&"value"===R[E].axis&&-1!==this.selectedHeaders.values.indexOf(R[E].actualText)&&(I=!0,b.push(A))}if(I)break}}}}switch(h.type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":var k=h.isChild;if(m){if(k)for(var j=g.split(this.valueSortSettings.headerDelimiter),q=0,V=s;q<V.length;q++){if(void 0!==e[je=V[q]])if(-1!==e[je].valueSort.levelName.split(this.valueSortSettings.headerDelimiter).indexOf(j[j.length-1])&&f&&e[je].level===f.level)for(var H=0,U=n;H<U.length;H++){K=U[H];"value"===(Z=a[je][K]).axis&&Z.actualText===u&&(v.push([je,K]),o[je+","+K]&&delete o[je+","+K])}}else for(var _=0,B=p;_<B.length;_++)for(var G=B[_],z=0,W=s;z<W.length;z++){if(void 0!==e[He=W[z]]&&e[He].valueSort[G.valueSort.levelName]&&e[He].level===f.level&&"grand sum"!==e[He].type)for(var Q=0,Y=n;Q<Y.length;Q++){var K=Y[Q];"value"===(Z=a[He][K]).axis&&Z.actualText===u&&(v.push([He,K]),o[He+","+K]&&delete o[He+","+K])}}for(var X=0,J=v;X<J.length;X++){var Z=a[(K=J[X])[0]][K[1]],$=(0,t.isNullOrUndefined)(C[K[1]].actualValue)?0:C[K[1]].actualValue,ee=((0,t.isNullOrUndefined)(Z.actualValue)?0:Z.actualValue)-$;ee=isNaN(ee)||0===Z.value&&0===C[K[1]].value?0:ee,this.aggregatedValueMatrix[K[0]]||(this.aggregatedValueMatrix[K[0]]=[]),"DifferenceFrom"===c?(this.aggregatedValueMatrix[K[0]][K[1]]=ee,Z.formattedText=0===ee?this.emptyCellTextContent:this.getFormattedValue(ee,u).formattedText):(ee=0===$?0:ee/$,this.aggregatedValueMatrix[K[0]][K[1]]=ee,Z.formattedText=Z.showSubTotals?0!==ee?this.globalize.formatNumber(ee,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,Z.actualText)}):this.emptyCellTextContent:Z.formattedText)}}else{if(k){j=g.split(this.valueSortSettings.headerDelimiter),N=S.length;for(var te=0;te<N;te++){I=!1;if(void 0!==S[te])if(-1!==S[te].valueSort.levelName.split(this.valueSortSettings.headerDelimiter).indexOf(j[j.length-1])&&S[te].level===f.level){for(var ie=0,ae=b;ie<ae.length;ie++){"value"===(Z=a[K=ae[ie]][te]).axis&&Z.actualText===u&&(I=!0,v.push([K,te]),o[K+","+te]&&delete o[K+","+te])}if(I)break}}}else for(var re=0,ne=p;re<ne.length;re++){G=ne[re];var N=S.length;for(E=0;E<N;E++){var I=!1;if(void 0!==S[E]&&S[E].valueSort[G.valueSort.levelName]&&f&&S[E].level===f.level&&"grand sum"!==S[E].type){for(var se=0,oe=b;se<oe.length;se++){"value"===(Z=a[K=oe[se]][E]).axis&&Z.actualText===u&&(I=!0,v.push([K,E]),o[K+","+E]&&delete o[K+","+E])}if(I)break}}}var le=void 0;0===x.length&&(le=this.getSelectedColumn(h.uniqueName,i));for(var de=0,he=v;de<he.length;de++){Z=a[(K=he[de])[0]][K[1]];var pe=0;if(0===x.length){var ue=this.getSelectedRow(Z.rowHeaders,e);pe=this.getAggregateValue(ue.index,le.indexObject,this.fieldList[u].index,h.type,!1)}else pe=x[K[0]].value;ee=Z.value-pe;ee=isNaN(ee)?0:ee,this.aggregatedValueMatrix[K[0]]||(this.aggregatedValueMatrix[K[0]]=[]),"DifferenceFrom"===c?(Z.formattedText=0===ee?this.emptyCellTextContent:this.getFormattedValue(ee,u).formattedText,this.aggregatedValueMatrix[K[0]][K[1]]=ee):(ee=0===x[K[0]].value?0:ee/x[K[0]].value,Z.formattedText=0!==ee?this.globalize.formatNumber(ee,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,Z.actualText)}):this.emptyCellTextContent,this.aggregatedValueMatrix[K[0]][K[1]]=ee)}}h.childMembers.length>0&&this.updateAggregates(e,i,a,h.childMembers,n,s,o);break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":case"PercentageOfParentTotal":if(m){for(var ce=0,ge=p;ce<ge.length;ce++){G=ge[ce];for(var me=0,fe=s;me<fe.length;me++){if(void 0!==e[D=fe[me]]&&e[D].valueSort[G.valueSort.levelName]&&e[D].level===G.level)for(var ve=0,Se=n;ve<Se.length;ve++){K=Se[ve];"value"===(Z=a[D][K]).axis&&Z.actualText===u&&(v.push([D,K]),o[D+","+K]&&delete o[D+","+K])}}}for(var ye=0,be=v;ye<be.length;ye++){Z=a[(D=be[ye])[0]][D[1]];var Ce=0;Ce=0===C.length&&f?this.getAggregateValue(f.index,i[D[1]-1].indexObject,this.fieldList[u].index,h.type,!1):C[D[1]]?C[D[1]].actualValue:0;ee=Z.value/Ce;ee=isNaN(ee)?0:ee,Z.formattedText=Z.showSubTotals?0!==ee?this.globalize.formatNumber(ee,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,Z.actualText)}):this.emptyCellTextContent:Z.formattedText,this.aggregatedValueMatrix[D[0]]||(this.aggregatedValueMatrix[D[0]]=[]),this.aggregatedValueMatrix[D[0]][D[1]]=ee}}else{for(var xe=0,we=p;xe<we.length;xe++)for(G=we[xe],N=S.length,A=0;A<N;A++){I=!1;if(void 0!==S[A]&&S[A].valueSort[G.valueSort.levelName]){for(var Te=0,Me=b;Te<Me.length;Te++){K=Me[Te];if(!(this.showSubTotalsAtBottom&&a[K][0].isDrilled&&a[K][0].hasChild))"value"===(Z=a[K][A]).axis&&Z.actualText===u&&(I=!0,v.push([K,A]),o[K+","+A]&&delete o[K+","+A])}if(I)break}}var De=void 0;0===x.length&&(De=this.getSelectedColumn(h.uniqueName,i));for(var Oe=0,Pe=v;Oe<Pe.length;Oe++){Z=a[(D=Pe[Oe])[0]][D[1]];var Ne=0;if(0===x.length){ue=this.getSelectedRow(Z.rowHeaders,e);Ne=this.getAggregateValue(ue.index,De.indexObject,this.fieldList[u].index,h.type,!1)}else Ne=x[D[0]].value;var Ee=Z.value/Ne;Ee=isNaN(Ee)?0:Ee,Z.formattedText=0!==Ee?this.globalize.formatNumber(Ee,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,Z.actualText)}):this.emptyCellTextContent,this.aggregatedValueMatrix[D[0]]||(this.aggregatedValueMatrix[D[0]]=[]),this.aggregatedValueMatrix[D[0]][D[1]]=Ee}}break;case"RunningTotals":if(m)for(var Ie=0,Fe=n;Ie<Fe.length;Ie++){K=Fe[Ie],ee=0;for(var Le=0,Ae=p;Le<Ae.length;Le++){G=Ae[Le];for(var Re=0,ke=s;Re<ke.length;Re++){var je;if(void 0!==e[je=ke[Re]]){Z=a[je][K];if(void 0!==e[je]&&e[je].valueSort[G.valueSort.levelName]&&e[je].level===G.level&&"value"===Z.axis&&Z.actualText===u){"grand sum"!==e[je].type&&(ee+=Z.showSubTotals||!(0,t.isNullOrUndefined)(Z.actualValue)&&isNaN(Z.actualValue)?(0,t.isNullOrUndefined)(Z.value)||isNaN(Z.value)?null:Z.value:Z.actualValue,Z.formattedText=Z.showSubTotals?0===ee&&Z.actualValue&&0!==Z.actualValue?"":this.getFormattedValue(ee,u).formattedText:Z.formattedText,this.aggregatedValueMatrix[je]||(this.aggregatedValueMatrix[je]=[]),this.aggregatedValueMatrix[je][K]=ee),o[je+","+K]&&delete o[je+","+K];break}}}}}else for(var qe=0,Ve=s;qe<Ve.length;qe++){var He;if(void 0!==a[He=Ve[qe]]){ee=0;for(var Ue=0,_e=p;Ue<_e.length;Ue++){G=_e[Ue];var Be=e[He].hasChild&&e[He].isDrilled&&(!(0,t.isNullOrUndefined)(e[He].showSubTotals)&&!e[He].showSubTotals||!this.dataSourceSettings.showSubTotals||!this.dataSourceSettings.showRowSubTotals);for(N=S.length,E=0;E<N;E++){Z=a[He][E];if(void 0!==S[E]&&S[E].valueSort[G.valueSort.levelName]&&"value"===Z.axis&&Z.actualText===u){"grand sum"!==S[E].type&&((0,t.isNullOrUndefined)(Z.value)||(ee+=Z.value),Z.formattedText=Be?"":this.getFormattedValue(ee,u).formattedText,this.aggregatedValueMatrix[He]||(this.aggregatedValueMatrix[He]=[]),this.aggregatedValueMatrix[He][E]=ee),o[He+","+E]&&delete o[He+","+E];break}}}}}}}},e.prototype.getSelectedColumn=function(e,t){for(var i={axis:"column",index:[],indexObject:{}},a=0,r=t;a<r.length;a++){var n=r[a];n&&n.valueSort&&0===n.valueSort.levelName.indexOf(e)&&(i.index=i.index.concat(n.index).sort((function(e,t){return e-t})),i.indexObject=Oi({},i.indexObject,n.indexObject))}return i},e.prototype.getSelectedRow=function(e,t){for(var i=0,a=t;i<a.length;i++){var r=a[i];if(r){if(r.valueSort&&r.valueSort.levelName===e)return r;if(""===e&&"grand sum"===r.type)return r}}return null},e.prototype.recursiveRowData=function(e,i,a,r,n,s,o,l,d,h,p,u){o||this.getTableData(i[r].members,i,a,r,n,s,h+1,p,u),this.showSubTotalsAtBottom&&((0,t.isNullOrUndefined)(e[l].showSubTotals)||e[l].showSubTotals)&&this.insertRowSubTotals(i,a,r,n,s,h,p,u),this.isPagingOrVirtualizationEnabled||(i[r].members=[])},e.prototype.updateRowData=function(e,i,a,r,n,s,o,l,d,h,p){var u=this.fieldList[this.dataSourceSettings.values[n].name].index,c=this.fieldList[this.dataSourceSettings.values[n].name].aggregateType,g=this.dataSourceSettings.values[n].name,m=[],f={},v=0,S=0;switch(c){case"Index":for(var y=["cVal","rTotalVal","cTotalVal","gTotalVal"],b=0,C=0,x=m=[[e[s],i[o]],[e[s],p],[h,i[o]],[h,p]];C<x.length;C++){var w=x[C];f[y[b]]=this.getAggregateValue(w[0].index,w[1].indexObject,u,c,0!==b),b++}var T=f.cVal*f.gTotalVal/(f.rTotalVal*f.cTotalVal);v=!(e[s].members.length>0&&e[s].hasChild&&e[s].isDrilled)||((0,t.isNullOrUndefined)(e[s].showSubTotals)||e[s].showSubTotals)&&this.dataSourceSettings.showRowSubTotals&&this.dataSourceSettings.showSubTotals?(0,t.isNullOrUndefined)(f.cVal)?f.cVal:isNaN(T)?0:T:void 0,S=(0,t.isNullOrUndefined)(f.cVal)?f.cVal:isNaN(T)?0:T;break;case"PercentageOfGrandTotal":case"PercentageOfColumnTotal":case"PercentageOfRowTotal":(m=[[e[s],i[o]]]).push("PercentageOfGrandTotal"===c?[h,p]:"PercentageOfColumnTotal"===c?[h,i[o]]:[e[s],p]);y=["cVal","gTotalVal"],b=0;for(var M=0,D=m;M<D.length;M++){w=D[M];f[y[b]]=this.getAggregateValue(w[0].index,w[1].indexObject,u,c,0!==b),b++}T=f.cVal/f.gTotalVal;v=!(e[s].members.length>0&&e[s].hasChild&&e[s].isDrilled)||((0,t.isNullOrUndefined)(e[s].showSubTotals)||e[s].showSubTotals)&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showRowSubTotals?(0,t.isNullOrUndefined)(f.cVal)?f.cVal:isNaN(T)?0:T:void 0,S=(0,t.isNullOrUndefined)(f.cVal)?f.cVal:isNaN(T)?0:T;break;default:T=this.getAggregateValue(e[s].index,i[o].indexObject,u,c,!1);v=!(e[s].members.length>0&&e[s].hasChild&&e[s].isDrilled)||((0,t.isNullOrUndefined)(e[s].showSubTotals)||e[s].showSubTotals)&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showRowSubTotals?T:void 0,S=T}var O={fieldName:this.dataSourceSettings.values[n].name,row:e[s],column:i[o],value:v,cellSets:this.getValueCellInfo?this.getCellSet(this.rawIndexObject):[],rowCellType:e[s].hasChild&&e[s].isDrilled?"subTotal":"grand sum"===e[s].type?"grandTotal":"value",columnCellType:i[o].hasChild&&i[o].isDrilled?"subTotal":"grand sum"===i[o].type?"grandTotal":"value",aggregateType:c,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(O),v=O.value;var P=e[s].hasChild||i[o].hasChild||"grand sum"===e[s].type||"grand sum"===i[o].type||this.showSubTotalsAtBottom&&e[s].isSum,N="grand sum"===e[s].type||"grand sum"===i[o].type,E=e[s].members.length>0&&e[s].hasChild&&e[s].isDrilled&&(!(0,t.isNullOrUndefined)(e[s].showSubTotals)&&!e[s].showSubTotals||!this.dataSourceSettings.showSubTotals||!this.dataSourceSettings.showRowSubTotals),I=E?"":void 0===v?this.emptyCellTextContent:"Count"===c||"DistinctCount"===c?v.toLocaleString():this.getFormattedValue(v,g).formattedText;!isNaN(v)&&!(0,t.isNullOrUndefined)(v)&&["PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal"].indexOf(c)>=0?I=this.globalize.formatNumber(v,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,O.fieldName)}):E||!isNaN(v)||(0,t.isNullOrUndefined)(v)||-1===["PopulationStDev","SampleStDev","PopulationVar","SampleVar"].indexOf(c)||(I="#DIV/0!",v=0),I=O.skipFormatting?(0,t.isNullOrUndefined)(v)?this.emptyCellTextContent:v.toString():I,r[a][l]=this.valueContent[d][l]={axis:"value",actualText:g,indexObject:this.isDrillThrough?this.rawIndexObject:{},rowHeaders:"grand sum"===e[s].type?"":e[s].valueSort.levelName,columnHeaders:"grand sum"===i[o].type?"":i[o].valueSort.levelName,formattedText:I,value:v,hierarchyName:i[o].hierarchyName,actualValue:S,rowIndex:a,colIndex:l,isSum:P,isGrandSum:N,showSubTotals:!E},this.rawIndexObject={}},e.prototype.getCellSet=function(e){for(var t=[],i=0,a=Object.keys(e);i<a.length;i++){var r=a[i];this.data[parseInt(r,10)]&&t.push(this.data[parseInt(r,10)])}return t},e.prototype.updateValueMembers=function(e,i,a,r,n,s,o){var l=a&&!(0,t.isNullOrUndefined)(a.levelName)?a.levelName.toString():void 0,d=a&&!(0,t.isNullOrUndefined)(a.uniqueName)?a.uniqueName.toString():void 0;if(e)for(var h=0;h<s;h++){var p=this.dataSourceSettings.values[h],u=p.caption?p.caption:p.name,c={axis:this.valueAxis?"row":"column",rowIndex:this.valueAxis?0:i&&o<=i.rowIndex?i.rowIndex+1:o,actualText:p.name,formattedText:u,level:0,valueSort:{},members:[],type:this.valueAxis?"value":i?i.type:null,index:!this.valueAxis&&i?i.index:null,indexObject:!this.valueAxis&&i?i.indexObject:null};n.length>0&&(c.showSubTotals=p.showSubTotals);var g=c.valueSort;g.axis=this.valueAxis?void 0:p.name,g[(l?l+this.valueSortSettings.headerDelimiter:"")+u]=1,g[(d?d+this.valueSortSettings.headerDelimiter:"")+p.name]=1,g.levelName=(l?l+this.valueSortSettings.headerDelimiter:"")+u,g.uniqueName=(d?d+this.valueSortSettings.headerDelimiter:"")+p.name,r.push(c),this.updateValueMembers(!1,i,g,c.members,n,s,o+1)}else for(var m=0,f=n.length;m<f;m++){var v=Di.frameHeaderWithKeys(n[m]);v.members=[],v.rowIndex=this.valueAxis?v.rowIndex:o<0?0:o;var S={};S.axis=v.valueSort.axis,S[(l?l+this.valueSortSettings.headerDelimiter:"")+v.formattedText]=1,S[(d?d+this.valueSortSettings.headerDelimiter:"")+v.actualText]=1,S.levelName=(l?l+this.valueSortSettings.headerDelimiter:"")+v.formattedText,S.uniqueName=(d?d+this.valueSortSettings.headerDelimiter:"")+v.actualText,v.hierarchyName=v.valueSort.uniqueName,v.valueSort=S;var y=S.axis+this.valueSortSettings.headerDelimiter+S.levelName,b=this.fieldList[S.axis];v.isDrilled&&((this.isExpandAll||b.expandAll)&&this.fieldDrillCollection[y]||!this.isExpandAll&&!b.expandAll&&!this.fieldDrillCollection[y])&&(v.isDrilled=!1),r.push(v),v.isDrilled&&n[m].members.length>0?(this.valueAxis&&o<this.measureIndex&&this.measureIndex!==o+1&&(!n[m].hasChild||((0,t.isNullOrUndefined)(n[m].showSubTotals)||n[m].showSubTotals)&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showRowSubTotals)&&this.updateValueMembers(!0,v,S,r[r.length-1].members,[],s,o),this.updateValueMembers(this.measureIndex===o+1,v,S,r[r.length-1].members,n[m].members,s,o+1),!this.valueAxis&&o<this.measureIndex&&this.measureIndex!==o+1&&(!n[m].hasChild||((0,t.isNullOrUndefined)(n[m].showSubTotals)||n[m].showSubTotals)&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals)&&this.updateValueMembers(!0,v,S,r[r.length-1].members,[],s,o)):o<this.measureIndex&&this.updateValueMembers(!0,v,S,r[r.length-1].members,[],s,o)}},e.prototype.reArrangeValueMember=function(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];this.valueAxisFields[r.actualText]&&(t[t.length]=r)}return t.concat(e).slice(0,e.length)},e.prototype.frameDefinedHeaderData=function(e,i,a,r,n,s){for(var o=0,l=e.length;o<l;o++){var d=!0;!(e[o].members.length>0)||((0,t.isNullOrUndefined)(e[o].showSubTotals)||e[o].showSubTotals)&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals||(d=!1);var h=this.measureIndex<r&&d?1:this.measureIndex>r&&e[o].members.length>0||this.measureIndex!==r+1||!e[o].isDrilled?this.measureIndex===r&&0!==this.measureIndex&&d||this.measureIndex>r&&d&&e[o].valueSort&&e[o].valueSort.axis&&this.measureNames[e[o].valueSort.axis.toString()]?1:0:0!==this.measureIndex&&d?1:0;if(e[o].members.length){var p=void 0,u=e[o].members;this.showSubTotalsAtTop?r+1<this.measureIndex&&d?(p=n,u=this.reArrangeValueMember(u)):p=n+h:p=n,this.frameDefinedHeaderData(u,i,a,r+1,p,s)}var c=this.measureIndex>r&&e[o].valueSort&&e[o].valueSort.axis&&this.measureNames[e[o].valueSort.axis.toString()]?this.measureIndex:r;i[(n=this.showSubTotalsAtTop?n+1:i.length+h)-1]||(i[n-1]=Di.frameHeaderWithKeys(e[o])),e[o].colIndex=n,a[c]||(a[c]=[],this.headerContent[c]={}),a[c][n]=this.headerContent[c][n]=Di.frameHeaderWithKeys(e[o]),this.isPagingOrVirtualizationEnabled||this.showSubTotalsAtTop&&0===h||i[n-1]&&(i[n-1].members=[]),this.showSubTotalsAtTop&&(n=i.length,o+1===l&&0===e[o].level&&(this.reformAxisCount=i.length+1))}},e.prototype.getHeaderData=function(e,i,a,r,n,s,o,l,d){if(this.valueAxis||this.isLastHeaderHasMeasures){if(0===r.length&&this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)&&this.dataSourceSettings.values.length>0){if(this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals&&"grand sum"===this.rMembers[this.rMembers.length-1].type)this.updateValueMembers(0===this.measureIndex&&this.rMembers.length>1,null,null,r,this.rMembers.slice(0,this.rMembers.length-1),this.dataSourceSettings.values.length,0),this.updateValueMembers(!1,null,null,r,this.rMembers.slice(this.rMembers.length-1,this.rMembers.length),this.dataSourceSettings.values.length,-1);else if("Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals&&0===this.measureIndex)this.updateValueMembers(!1,null,null,r,this.rMembers.slice(0,1),this.dataSourceSettings.values.length,-1),this.updateValueMembers(0===this.measureIndex&&this.rMembers.length>1,null,null,r,this.rMembers.slice(1,this.rMembers.length),this.dataSourceSettings.values.length,0);else{var h=0===e.length&&1===this.rMembers.length&&"grand sum"===this.rMembers[0].type;this.updateValueMembers(!h&&0===this.measureIndex,null,null,r,this.rMembers,this.dataSourceSettings.values.length,h?-1:0)}if(this.getAggregatedHeaders(e,i,r,n,a),this.selectedHeaders.values.length>0)for(E=this.selectedHeaders.selectedHeader.length,I=0;I<E;I++){if("row"===(F=this.selectedHeaders.selectedHeader[I]).axis){var p=F.aggregateHeaders.length;for(A=0;A<p;A++)if(F.aggregateHeaders[A].actualText===F.value)if(-1!==F.aggregateHeaders[A].valueSort.levelName.indexOf(F.uniqueName))F.uniqueName=F.aggregateHeaders[A].valueSort.levelName,F.aggregateHeaders.splice(A,1),A--,p--;else for(var u=F.aggregateHeaders[A].members.length,c=0;c<u;c++){if("value"!==(j=F.aggregateHeaders[A].members[c]).type&&j.level===F.aggregateHeaders[A].level){var g=(0,t.extend)([],F.aggregateHeaders[A].members,null,!0);F.aggregateHeaders=[].concat(F.aggregateHeaders,g,F.aggregateHeaders.splice(A)),F.aggregateHeaders.splice(g.length+A,1),A=g.length+A-1,p=F.aggregateHeaders.length}}else if(F.aggregateHeaders[A].actualText!==F.value&&F.aggregateHeaders[A].members.length>0)for(u=F.aggregateHeaders[A].members.length,c=0;c<u;c++){if((j=F.aggregateHeaders[A].members[c]).actualText===F.value){F.uniqueName===F.aggregateHeaders[A].valueSort.levelName&&(F.uniqueName=j.valueSort.levelName),F.aggregateHeaders[A].members.splice(c,1),F.aggregateHeaders[A]=j;break}}}}}for(var m=n.length,f=this.dataSourceSettings.columns.length,v=this.valueSortSettings.headerText,S=0;S<m;S++){var y=!(0,t.isNullOrUndefined)(n[S].showSubTotals)&&!n[S].showSubTotals;n[S].members.length&&this.getHeaderData(e,i,a,r,n[S].members,s,o,this.showSubTotalsAtTop&&!y?l+1:l,d);var b=!0;l=this.showSubTotalsAtTop?l:s.length,!y&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals?s[l]=Di.frameHeaderWithKeys(n[S]):(n[S].members.length>0?(this.removeCount++,b=!1):s[this.showSubTotalsAtTop?l:s.length]=Di.frameHeaderWithKeys(n[S]),l=this.showSubTotalsAtTop?l:s.length-1);var C=n[S].level;n[S].rowIndex=C;var x=l*d+(this.showSubTotalsAtTop?1:d);n[S].colIndex=x,o[C]||(o[C]=[],this.headerContent[C]={}),o[C][x]=this.headerContent[C][x]=Di.getFormattedHeader(n[S],this);var w=0===this.dataSourceSettings.columns.length&&1===this.dataSourceSettings.values.length;if((this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader||w)&&!this.valueAxis&&b)for(var T=0;T<d;T++){var M=this.dataSourceSettings.values[T].caption?this.dataSourceSettings.values[T].caption:this.dataSourceSettings.values[T].name,D={axis:"column",actualText:this.dataSourceSettings.values[T].name,formattedText:M,level:0,valueSort:{},colIndex:l*d+1+T,rowIndex:f};o[f]||(o[f]=[],this.headerContent[f]={}),o[f][l*d+1+T]=this.headerContent[f][l*d+1+T]=D;var O=o[f][l*d+1+T].valueSort;O[n[S].valueSort.levelName+this.valueSortSettings.headerDelimiter+M]=1,O.levelName=n[S].valueSort.levelName+this.valueSortSettings.headerDelimiter+M,O[n[S].valueSort.uniqueName+this.valueSortSettings.headerDelimiter+this.dataSourceSettings.values[T].name]=1,O.uniqueName=n[S].valueSort.uniqueName+this.valueSortSettings.headerDelimiter+this.dataSourceSettings.values[T].name,O&&O[v]&&(this.valueSortSettings.columnIndex=l*d+1+T)}else n[S].valueSort&&n[S].valueSort[v]&&(this.valueSortSettings.columnIndex=l*d+1);this.isPagingOrVirtualizationEnabled||(s[l].members=[]),this.showSubTotalsAtTop&&(l=s.length,0===n[S].level&&S+1===m&&(this.reformAxisCount=s.length*d+1))}}else{var P=[];if(this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals&&"grand sum"===n[n.length-1].type)this.updateValueMembers(0===this.measureIndex&&n.length>1,null,null,P,n.slice(0,n.length-1),d,0),this.updateValueMembers(!1,null,null,P,n.slice(n.length-1,n.length),d,-1);else if("Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals&&0===this.measureIndex)this.updateValueMembers(!1,null,null,P,n.slice(0,1),d,-1),this.updateValueMembers(0===this.measureIndex&&n.length>1,null,null,P,n.slice(1,n.length),d,0);else{var N=0===i.length&&1===n.length&&"grand sum"===n[0].type;this.updateValueMembers(!N&&0===this.measureIndex,null,null,P,n,d,N?-1:0)}if(this.getAggregatedHeaders(e,i,this.rMembers,P,a),this.selectedHeaders.values.length>0)for(var E=this.selectedHeaders.selectedHeader.length,I=0;I<E;I++){var F;if("column"===(F=this.selectedHeaders.selectedHeader[I]).axis)if(F.uniqueName===F.value)this.selectedHeaders.selectedHeader.splice(I,1),I--,E--;else if("Grand Total"===F.uniqueName)for(var L=F.aggregateHeaders.length,A=0;A<L;A++)if(F.aggregateHeaders[A]&&F.aggregateHeaders[A].members.length>0)for(var R=0,k=F.aggregateHeaders[A].members;R<k.length;R++){var j;(j=k[R]).actualText===F.value&&(F.aggregateHeaders[A]=j,"grand sum"===j.type&&(F.uniqueName=j.valueSort.levelName))}}this.frameDefinedHeaderData(P,s,o,0,this.showSubTotalsAtTop?0:1,d)}},e.prototype.getAggregateValue=function(e,i,a,r,n){var s=0,o=0,l=0,d=!0,h=!1;switch(r.toLowerCase()){case"median":for(var p=[],u=0;void 0!==e[s];){void 0!==i[w=e[s]]&&(h=!0,this.rawIndexObject[w]=w,(0,t.isNullOrUndefined)(this.valueMatrix[w][a].member)||p.push(this.valueMatrix[w][a].member)),s++}(E=p.length)>0&&(p.sort((function(e,t){return e-t})),o=E%2==0?(p[u=E/2<=1?0:E/2-1]+p[u+1])/2:p[u=(E+1)/2<=1?0:(E+1)/2-1]);break;case"count":for(;void 0!==e[s];){void 0!==i[w=e[s]]&&(h=!0,this.rawIndexObject[w]=w,o+=(0,t.isNullOrUndefined)(this.valueMatrix[w][a].member)?0:this.allowDataCompression?this.valueMatrix[w][a].member:1),s++}break;case"distinctcount":for(var c=[];void 0!==e[s];){if(void 0!==i[e[s]]){this.rawIndexObject[e[s]]=e[s],h=!0;var g=this.data[e[s]][this.fieldKeys[this.fields[a]]];if(!(0,t.isNullOrUndefined)(g)){var m=g.toString();(0===c.length||c.length>0&&-1===c.indexOf(m))&&(o+=this.allowDataCompression&&"number"==typeof g?g:1,c.push(m))}}s++}break;case"product":for(;void 0!==e[s];){if(void 0!==i[w=e[s]]){this.rawIndexObject[w]=w,h=!0;m=this.valueMatrix[w][a].member;(0,t.isNullOrUndefined)(m)?d&&(o=m):(o=d||(0,t.isNullOrUndefined)(o)?1:o,o*=m),d=!1}s++}break;case"populationstdev":case"samplestdev":case"populationvar":case"samplevar":for(var f=0,v=(g=0,[]),S=0,y=0,b=0;void 0!==e[s];){if(void 0!==i[w=e[s]]){h=!0,this.rawIndexObject[w]=w;m=this.valueMatrix[w][a].member;(0,t.isNullOrUndefined)(m)||(g+=m,v.push(m),f++)}s++}if(f>0){S=g/f;for(var C=0,x=v;C<x.length;C++){var w=x[C];b+=Math.pow(w-S,2)}o=0===(y=-1!==["populationstdev","samplestdev"].indexOf(r.toLowerCase())?Math.sqrt(b/("populationstdev"===r.toLowerCase()?f:f-1)):b/("populationvar"===r.toLowerCase()?f:f-1))?NaN:y}else o=g;break;case"min":var T=!0;for(o=void 0;void 0!==e[s];){void 0!==i[w=e[s]]&&void 0!==this.valueMatrix[w][a].member&&(h=!0,this.rawIndexObject[w]=w,(0,t.isNullOrUndefined)(o)&&(0,t.isNullOrUndefined)(this.valueMatrix[w][a].member)?o=this.valueMatrix[w][a].member:T?(o=this.valueMatrix[w][a].member,T=!1):o=this.valueMatrix[w][a].member<o?this.valueMatrix[w][a].member:o),s++}break;case"max":for(var M=!0;void 0!==e[s];){void 0!==i[w=e[s]]&&void 0!==this.valueMatrix[w][a].member&&(h=!0,this.rawIndexObject[w]=w,M?(o=this.valueMatrix[w][a].member,M=!1):o=this.valueMatrix[w][a].member>o?this.valueMatrix[w][a].member:o),s++}break;case"calculatedfield":h=!0;var D=this.calculatedFields[this.fields[a]],O=D.formula,P={};if(this.calculatedFormulas[D.name])for(var N=this.calculatedFormulas[D.name],E=0,I=N.length;E<I;E++){var F=N[E],L=P[F.formula];if(void 0===L){var A=F.type;L=this.getAggregateValue(e,i,F.index,A,!1),P[F.formula]=L}O=O.replace(F.formula,String(L))}o=(o=this.evaluate(O))===1/0||o===-1/0?1/0:void 0===o||isNaN(o)?void 0:JSON.parse(String(o));break;default:for(o=void 0;void 0!==e[s];){if(void 0!==i[w=e[s]]){h=!0,n||(this.rawIndexObject[w]=w);m=this.valueMatrix[w][a].member;(0,t.isNullOrUndefined)(o)&&(0,t.isNullOrUndefined)(m)?o=m:((0,t.isNullOrUndefined)(o)&&(o=0),o+=(0,t.isNullOrUndefined)(m)?0:m),(0,t.isNullOrUndefined)(m)||l++}s++}}return r&&"avg"===r.toLowerCase()&&0!==o&&!(0,t.isNullOrUndefined)(o)?o/l:h?o:void 0},e.prototype.evaluate=function(e){return Function('"use strict";return ('+e+")")()},e.prototype.getFormattedValue=function(e,i){var a=null===e?this.localeObj?this.localeObj.getConstant("null"):String(e):void 0===e?this.localeObj?i in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(e):e,r={formattedText:a.toString(),actualText:a,dateText:a};if(this.formatFields[i]&&(this.formatFields[i].format||this.formatFields[i].skeleton)&&!(0,t.isNullOrUndefined)(e))try{var n=this.formatFields[i].properties?this.formatFields[i].properties:this.formatFields[i],s=(0,t.extend)({},n,null,!0);delete s.name,!s.minimumSignificantDigits&&s.minimumSignificantDigits<1&&delete s.minimumSignificantDigits,!s.maximumSignificantDigits&&s.maximumSignificantDigits<1&&delete s.maximumSignificantDigits,s.type?(r.formattedText=null===this.dateFormatFunction[i].exactFormat(new Date(e))?r.formattedText:this.dateFormatFunction[i].exactFormat(new Date(e)),r.actualText=e):(delete s.type,s.format&&!this.formatRegex.test(s.format)&&((0,t.isNullOrUndefined)(s.minimumFractionDigits)&&delete s.minimumFractionDigits,(0,t.isNullOrUndefined)(s.maximumFractionDigits)&&delete s.maximumFractionDigits,(0,t.isNullOrUndefined)(s.minimumIntegerDigits)&&delete s.minimumIntegerDigits),r.formattedText=this.globalize.formatNumber(isNaN(Number(e))?e:Number(e),s),r.actualText=isNaN(Number(e))?e:Number(e),r.dateText=isNaN(Number(e))?e:Number(e)),"None"!==this.fieldList[i].sort&&s.type&&["date","dateTime","time"].indexOf(this.formatFields[i].type)>-1&&(r.dateText=this.dateFormatFunction[i].fullFormat(new Date(e))),this.fieldList[i].isCustomField&&(r.formattedText="NaN"===r.formattedText?a.toString():r.formattedText,r.dateText="NaN"===r.dateText?a.toString():r.dateText)}catch(e){if(!this.fieldList[i].isCustomField)throw e}finally{this.fieldList[i].isCustomField&&(r.formattedText=(0,t.isNullOrUndefined)(r.formattedText)||"NaN"===r.formattedText?a.toString():r.formattedText,r.dateText=(0,t.isNullOrUndefined)(r.dateText)||"NaN"===r.dateText?a.toString():r.dateText)}return r},e.prototype.powerFunction=function(e){if(e.indexOf("^")>-1){for(var t=[];e.indexOf("(")>-1;)e=e.replace(/(\([^()]*\))/g,(function(e,i){return t.push(i),"~"+(t.length-1)}));for(t.push(e),e="~"+(t.length-1);e.indexOf("~")>-1;)e=e.replace(new RegExp("~(\\d+)","g"),(function(e,i){return t[i].replace(/(\w*)\^(\w*)/g,"Math.pow($1,$2)")}))}return e},e.prototype.getTabularPivotValues=function(e,i,a){var r;this.tabularPivotValues=[],this.emptyRowsLength=0;var n=Object.keys(this.groupingFields).length>0;"row"!==this.dataSourceSettings.valueAxis||!(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)||i||a||(this.rowMaxLevel=this.rowMaxLevel+1);for(var s=0;s<this.pivotValues.length;s++){for(var o=void 0,l=!1,d=!0,h=void 0,p=void 0;(0,t.isNullOrUndefined)(this.pivotValues[s])&&s<this.pivotValues.length;)this.tabularPivotValues.length++,s++;s<this.pivotValues.length&&(o=this.pivotValues[s]);var u=o[0]?o[0]:void 0;if(u&&(h=u.valueSort.levelName.split(this.dataSourceSettings.valueSortSettings.headerDelimiter),this.dataSourceSettings.showSubTotals&&(!this.dataSourceSettings.showColumnSubTotals||this.dataSourceSettings.showRowSubTotals)||u.formattedText===this.localeObj.getConstant("grandTotal")||u.isSum&&(d=!1),n)){var c=this.pivotValues[s-1][0],g=this.tabularPivotValues[this.tabularPivotValues.length-1][this.rowMaxLevel-1];if(!(0,t.isNullOrUndefined)(c)||!(0,t.isNullOrUndefined)(g)){var m=c.valueSort.axis,f=void 0;!(0,t.isNullOrUndefined)(g)&&g.valueSort.axis&&(f=g.valueSort.axis),p=(m.includes("custom_group")||!(0,t.isNullOrUndefined)(f)&&f.includes("custom_group"))&&(c.formattedText===h[this.rowMaxLevel-1]&&c.formattedText!==h[h.length-1]||g&&g.formattedText===h[this.rowMaxLevel-1])?c.valueSort.axis?c.valueSort.axis:g.valueSort.axis:u.valueSort.axis}}if(u&&"row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)){if("value"===u.type&&h.length-1!==this.rowMaxLevel&&h[0]!==this.localeObj.getConstant("grandTotal"))for(var v=0;v<this.dataSourceSettings.values.length;v++)if(u.formattedText===this.dataSourceSettings.values[v].name){d=!1,u.hasChild=!1;break}h.length-1!==this.rowMaxLevel?(u.isDrilled=!0,u.hasChild||u.type?h[0]===this.localeObj.getConstant("grandTotal")&&"grand sum"===u.type?u.hasChild=!0:u.level=h.length-1:u.hasChild=!0):u.level=h.length-1;for(var S=0;S<this.drilledMembers.length;S++)for(var y=this.drilledMembers[S].items,b=0;b<y.length;b++)for(var C=y[b].split(this.drilledMembers[S].delimiter),x=u.formattedText.split(" "),w=[],T=0;T<x.length;T++)if(w.push(x[T]),w.join(" ")===C[C.length-1]&&C[0]===h[0]){l=!0;break}}if(d&&h&&h.length>1&&"sum"===u.type&&h[h.length-1]===h[h.length-2]&&(d=!1),(0,t.isNullOrUndefined)(u)||"row"!==u.axis){for(var M=[],D=this.rowMaxLevel+1,O=0;O<this.rowMaxLevel;O++)M.push(void 0);M.push(u);H=o.slice(1,o.length);for(var P=0;P<H.length;P++)H[P].colIndex=D,H[P].rowIndex=this.tabularPivotValues.length,D++;M=M.concat(H),this.tabularPivotValues.push(M)}else if((0,t.isNullOrUndefined)(o[1])||u.hasChild&&u.isDrilled||!d)this.emptyRowsLength++;else{var N=[];if("row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&(e&&l?h.length-1<this.rowMaxLevel:h.length<=this.rowMaxLevel)&&"value"===u.type&&(this.dataSourceSettings.expandAll?!l:l)||h[0]===this.localeObj.getConstant("grandTotal")){for(var E=h.length-1;E>=0;E--){if(h[E]===h[h.length-2]){if(N[E]=h[h.length-2]+" "+h[h.length-1],0===E)break;for(;E>=0;)N[E-1]=h[E-1],E--;break}N[E]=h[h.length-2]+" "+h[h.length-1]}h=N}r=u.colIndex;for(var I=[],F=h[0],L=0,A=0;A<h.length-1||A<this.rowMaxLevel;A++){var R=void 0,k=void 0,j=u.isDrilled,q=u.hasChild;if("row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)){if(R=!1,k=!1,h[h.length-1]!==h[h.length-2])A<(h.length-1===this.rowMaxLevel&&this.dataSourceSettings.rows.length===this.rowMaxLevel?h.length-2:h.length-1)&&(k=!0),A<h.length-2&&(R=!0)}else A<this.rowMaxLevel&&(q=!0),(h.length>1||0===A)&&(j=!0);if(A<h.length-1&&(A>0&&(F=F+this.dataSourceSettings.valueSortSettings.headerDelimiter+h[A]),I.push({actualText:h[A],axis:u.axis,formattedText:h[A],rowIndex:this.tabularPivotValues.length,hasChild:"row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&"grand sum"!==u.type?k:q,isDrilled:"row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&"grand sum"!==u.type?R:j,level:L,valueSort:{levelName:F,axis:n?p?p.includes("custom_group")?p:this.dataSourceSettings.rows[A].name:u.valueSort.axis:this.dataSourceSettings.rows[A].name},colIndex:r++,colSpan:1,rowSpan:1})),A>=u.level){var V=0===A?this.rowMaxLevel:this.rowMaxLevel-1;I.push({actualText:"row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)?void 0===h[A]?h[h.length-1]:h[A]:u.formattedText,axis:u.axis,formattedText:"row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)?void 0===h[A]?h[h.length-1]:h[A]:u.formattedText,rowIndex:this.tabularPivotValues.length,hasChild:"row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&"grand sum"!==u.type?k:u.hasChild,isDrilled:"row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&"grand sum"!==u.type?R:u.isDrilled,level:L,valueSort:{levelName:u.valueSort.levelName,axis:n?p?p.includes("custom_group")?p:this.dataSourceSettings.rows[A].name:u.valueSort.axis:this.dataSourceSettings.rows[A].name},colIndex:r++,colSpan:V,rowSpan:1})}L++}u.colIndex=r,u.rowIndex=this.tabularPivotValues.length,u.colSpan=1,u.rowSpan=1,"row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&(u.formattedText=h[h.length-1]),I.push(u),this.setColumnSpan(I,u);for(var H=o.slice(1,o.length),U=1;U<o.length;U++){var _=o[U];_.colIndex=r+1,_.rowIndex=this.tabularPivotValues.length,r++}I=I.concat(H),this.tabularPivotValues.push(I)}}return this.tabularPivotValues},e.prototype.setColumnSpan=function(e,t){for(var i=1,a=e.length-1;a>=0;a--){if(0!==a&&e[a].formattedText===e[a-1].formattedText&&(e[a].colSpan=0,i++,e[a-1].colSpan=i),a<("row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)?e.length-2:e.length-1)&&("grand sum"!==t.type||t.isSum)&&e[e.length-1].formattedText!==e[e.length-2].formattedText&&"grand sum"!==t.type){e[a].hasChild=!0;for(var r=this.dataSourceSettings.drilledMembers,n=0;n<r.length;n++)for(var s=0;s<r[n].items.length;s++)r[n].items[s]===e[a].formattedText&&(e[a].isDrilled=!!e[a].isDrilled)}}},e.prototype.setRowSpan=function(){for(var e=this.headerContent.length,i=0;i<this.rowMaxLevel;i++){var a=1;if(this.tabularPivotValues.length>this.rowMaxLevel+e)for(var r=this.tabularPivotValues.length-1;r>=e-1;r--)if(r!==e-1){var n=this.tabularPivotValues;if((0,t.isNullOrUndefined)(n[r-1]))break;(0,t.isNullOrUndefined)(n[r-1][i])||n[r][i].formattedText!==n[r-1][i].formattedText?a=1:(n[r][i].rowSpan=0,a++,n[r-1][i].rowSpan=a)}}},e}(),Ni=v(197),Ei="load",Ii="enginePopulating",Fi="enginePopulated",Li="onFieldDropped",Ai="fieldDrop",Ri="beforePivotTableRender",ki="afterPivotTableRender",ji="beforeExport",qi="exportComplete",Vi="excelHeaderQueryCellInfo",Hi="pdfHeaderQueryCellInfo",Ui="excelQueryCellInfo",_i="pdfQueryCellInfo",Bi="onPdfCellRender",Gi="dataBound",zi="queryCellInfo",Wi="headerCellInfo",Qi="hyperlinkCellClick",Yi="resizing",Ki="resizeStop",Xi="cellClick",Ji="drillThrough",Zi="beforeColumnsRender",$i="selected",ea="selecting",ta="cellSelecting",ia="drill",aa="cellSelected",ra="cellDeselected",na="rowSelected",sa="rowDeselected",oa="beginDrillThrough",la="editCompleted",da="multiLevelLabelClick",ha="saveReport",pa="fetchReport",ua="loadReport",ca="renameReport",ga="removeReport",ma="newReport",fa="toolbarRender",va="toolbarClick",Sa="chartTooltipRender",ya="chartLegendClick",ba="chartLoaded",Ca="multiLevelLabelRender",xa="beforePrint",wa="animationComplete",Ta="legendRender",Ma="textRender",Da="pointRender",Oa="seriesRender",Pa="chartMouseMove",Na="chartMouseClick",Ea="pointMove",Ia="chartMouseLeave",Fa="chartMouseDown",La="chartMouseUp",Aa="dragComplete",Ra="zoomComplete",ka="scrollStart",ja="scrollEnd",qa="scrollChanged",Va="chartLoad",Ha="chartResized",Ua="chartAxisLabelRender",_a="chartSeriesCreated",Ba="aggregateCellInfo",Ga="onHeadersSort",za="contextMenuClick",Wa="contextMenuOpen",Qa="fieldListRefreshed",Ya="conditionalFormatting",Ka="beforePdfExport",Xa="beforeExcelExport",Ja="memberFiltering",Za="calculatedFieldCreate",$a="memberEditorOpen",er="fieldRemove",tr="numberFormatting",ir="aggregateMenuOpen",ar="fieldDragStart",rr="chartPointClick",nr="beforeServiceInvoke",sr="afterServiceInvoke",or="actionBegin",lr="actionComplete",dr="actionFailure",hr="initial-load",pr="ui-update",ur="scroll",cr="vertical-scroll",gr="horizontal-scroll",mr="content-ready",fr="data-ready",vr="init-groupingbar",Sr="tree-view-update",yr="pivot-button-update",br="init-calculatedfield",Cr="click",xr="init-toolbar",wr="init-pivotPager",Tr="init-formatting",Mr="init-grouping",Dr="Sort value",Or="Drill up",Pr="Drill down",Nr="Add new report",Er="Save current report",Ir="Save as current report",Fr="Rename current report",Lr="Remove current report",Ar="Load report",Rr="Open conditional formatting dialog",kr="Open number formatting dialog",jr="MdxQuery",qr="Open field list",Vr="Show table view",Hr="Show chart view",Ur="Multiple Axis",_r="Show legend",Br="PDF export",Gr="PNG export",zr="Excel export",Wr="CSV export",Qr="JPEG export",Yr="SVG export",Kr="Hide sub-totals",Xr="Show row sub-totals",Jr="Show column sub-totals",Zr="Show sub-totals",$r="Hide grand totals",en="Show row grand totals",tn="Show column grand totals",an="Show grand totals",rn="Number Formatting menu",nn="Conditional Formatting menu",sn="Report change",on="Sort field tree",ln="Edit calculated field",dn="Sort field",hn="Filter field",pn="Remove field",un="Open calculated field dialog",cn="Edit record",gn="Save edited records",mn="Add new record",fn="Remove record",vn="Aggregate field",Sn="CalculatedField Context menu",yn="Window resize",bn="Navigate row page",Cn="Navigate column page",xn="Calculated field applied",wn="Edited records saved",Tn="New record added",Mn="Record removed",Dn="Field list closed",On="Field tree sorted",Pn="Report saved",Nn="New report added",En="Report re-saved",In="Reportrenamed",Fn="Report removed",Ln="Excel exported",An="CSV exported",Rn="PDF exported",kn="PNG exported",jn="JPEG exported",qn="SVG exported",Vn="Conditional formatting applied",Hn="Number formatting applied",Un="Table view shown",_n="Chart view shown",Bn="Sub-totals hidden",Gn="Row sub-totals shown",zn="Column sub-totals shown",Wn="Sub-totals shown",Qn="Grand totals hidden",Yn="Row grand totals shown",Kn="Column grand totals shown",Xn="Grand totals shown",Jn="Value sorted",Zn="Calculated field edited",$n="Field sorted",es="Field filtered",ts="Field removed",is="Field aggregated",as="Record edited",rs="Report changed",ns="Window resized",ss="Records updated",os="Drill-through closed",ls="Vertically scrolled",ds="Horizontally scrolled",hs="Row page navigated",ps="Column page navigated",us="Action dropped",cs="Invalid formula",gs=v(707),ms=v(215),fs=v(323),vs=v(778),Ss=function(){function e(e){this.menuInfo=[],this.stringAggregateTypes=["Count","DistinctCount"],this.parent=e}return e.prototype.render=function(e,t){this.parentElement=t,this.openContextMenu(e)},e.prototype.openContextMenu=function(e){var t=this,i=e.target.parentElement.getAttribute("data-uid"),a=Di.getFieldInfo(i,this.parent);this.buttonElement=e.target.parentElement;var r="number"!==this.parent.engineModule.fieldList[i].type?1:0,n=this.getMenuItem(r).slice();if(this.parent.actionObj.actionName=vn,this.parent.actionObj.fieldInfo=a.fieldItem,!this.parent.actionBeginMethod()){var s={cancel:!1,fieldName:i,aggregateTypes:n,displayMenuCount:7},o="pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent;try{o.trigger(ir,s,(function(i){if(!i.cancel){n=i.aggregateTypes,t.createContextMenu(r,n,i.displayMenuCount),t.currentMenu=e.target;var a=t.currentMenu.getBoundingClientRect();t.parent.enableRtl?t.menuInfo[r].open(a.top+(window.scrollY||document.documentElement.scrollTop),a.left-105):t.menuInfo[r].open(a.top+(window.scrollY||document.documentElement.scrollTop),a.left)}}))}catch(e){this.parent.actionFailureMethod(e)}}},e.prototype.createContextMenu=function(e,i,a){var r=this,n=[];n[e]=[],this.menuInfo[e]&&!this.menuInfo[e].isDestroyed&&this.menuInfo[e].destroy();for(var s=[],o=0;o<i.length;o++){var l=i[o];e?this.stringAggregateTypes.indexOf(l)>-1&&s.indexOf(l)<0&&(n[e].push({text:this.parent.localeObj.getConstant(l),id:this.parent.element.id+"StringMenu_"+l}),s.push(l)):this.parent.getAllSummaryType().indexOf(l)>-1&&s.indexOf(l)<0&&(n[e].push({text:this.parent.localeObj.getConstant(l),id:this.parent.element.id+"_"+l}),s.push(l))}n[e].length>a&&(n[e].splice(a),n[e].push({text:this.parent.localeObj.getConstant("MoreOption"),id:this.parent.element.id+"_MoreOption"}));var d={items:n[e],enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:this.parent.cssClass,beforeOpen:this.beforeMenuOpen.bind(this,e),onClose:function(){(0,t.select)("#"+r.buttonElement.id,r.parentElement).focus()},select:this.selectOptionInContextMenu.bind(this)},h=document.getElementById(this.parent.element.id+(e?"valueFieldStringContextMenu":"valueFieldContextMenu"));null!==h?h.innerHTML="":h=(0,t.createElement)("ul",{id:this.parent.element.id+(e?"valueFieldStringContextMenu":"valueFieldContextMenu")}),this.parent.element.appendChild(h),this.menuInfo[e]=new ms.ContextMenu(d),this.menuInfo[e].isStringTemplate=!0,this.menuInfo[e].appendTo(h)},e.prototype.getMenuItem=function(e){for(var t=[],i=0;i<this.parent.aggregateTypes.length;i++){var a=this.parent.aggregateTypes[i];e?this.stringAggregateTypes.indexOf(a)>-1&&-1===t.indexOf(a)&&t.push(a):this.parent.getAllSummaryType().indexOf(a)>-1&&-1===t.indexOf(a)&&t.push(a)}return t},e.prototype.beforeMenuOpen=function(e,t){t.element.style.zIndex=(this.menuInfo[e].element.style.zIndex+3).toString(),t.element.style.display="inline"},e.prototype.createValueSettingsDialog=function(e,i,a){this.parentElement=i;var r=(0,t.createElement)("div",{id:this.parentElement.id+"_ValueDialog",className:"e-value-field-settings",attrs:{"data-field":e.getAttribute("data-uid")?e.getAttribute("data-uid"):e.getAttribute("data-field")}});this.parentElement.appendChild(r);var n=new Ni.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("valueFieldSettings"),content:this.createFieldOptions(e,a),isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"320px",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.updateValueSettings.bind(this),isFlat:!1,buttonModel:{cssClass:ie+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:function(){n.hide()},isFlat:!1,buttonModel:{cssClass:ae+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:"pivotfieldlist"!==this.parent.getModuleName()||"Popup"!==this.parent.renderMode,target:this.parentElement,close:this.removeDialog.bind(this),cssClass:this.parent.cssClass});n.isStringTemplate=!0,n.appendTo(r)},e.prototype.createFieldOptions=function(e,i){var a=this,r=e.getAttribute("data-caption"),n=i&&"MoreOption"!==i?i:e.getAttribute("data-type"),s=e.getAttribute("data-basefield"),o=e.getAttribute("data-baseitem");n="undefined"!==n.toString()?n:"Sum";for(var l=[],d=this.parent.aggregateTypes,h=[],p=0;p<d.length;p++)this.parent.getAllSummaryType().indexOf(d[p])>-1&&h.indexOf(d[p])<0&&(l.push({value:d[p],text:this.parent.localeObj.getConstant(d[p])}),h.push(d[p]));var u=["DifferenceFrom","PercentageOfDifferenceFrom"],c=["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"],g=(0,t.extend)([],this.parent.dataSourceSettings.rows,null,!0);g=g.concat(this.parent.dataSourceSettings.columns);for(var m=[],f=[],v=0,S=g;v<S.length;v++){var y=S[v],b=y.name,C=y.caption?y.caption:y.name;m.push({value:b,text:C})}if(0===Object.keys(m).length)m.push({value:"",text:""}),s="",f=[];else{var x="undefined"!==(s=s&&"undefined"!==s.toString()&&"null"!==s.toString()?s:m[0].value).toString()?s:m[0].value,w=Di.isDateField(x,this.parent.engineModule);f=this.parent.engineModule.fieldList[x].dateMember.map((function(e){return w?e.formattedText:a.parent.engineModule.getFormattedValue(e.actualText,x).formattedText}))}o="undefined"!==o.toString()?o:f[0];var T=(0,t.createElement)("div",{className:"e-value-field-div-content",id:this.parentElement.id+"_field_div_content",attrs:{"data-type":n,"data-caption":r,"data-basefield":s,"data-baseitem":o}}),M=(0,t.createElement)("div",{className:"e-field-name-text-container"}),D=(0,t.createElement)("div",{className:"e-field-option-container"}),O=(0,t.createElement)("div",{className:"e-type-option-container"}),P=(0,t.createElement)("div",{className:"e-base-field-option-container"}),N=(0,t.createElement)("div",{className:"e-base-item-option-container"}),E=(0,t.createElement)("div",{className:"e-field-name-title"});E.innerText=this.parent.localeObj.getConstant("sourceName")+" ";var I=(0,t.createElement)("div",{className:"e-field-name-content"});I.innerText=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(e.getAttribute("data-uid")?e.getAttribute("data-uid"):e.getAttribute("data-field")):e.getAttribute("data-uid")?e.getAttribute("data-uid"):e.getAttribute("data-field"),this.buttonElement=this.buttonElement?this.buttonElement:document.getElementsByClassName(I.innerText)[0];var F=(0,t.createElement)("div",{className:"e-type-option-text"});F.innerText=this.parent.localeObj.getConstant("sourceCaption");var L=(0,t.createElement)("div",{className:"e-base-field-option-text"});L.innerText=this.parent.localeObj.getConstant("summarizeValuesBy");var A=(0,t.createElement)("div",{className:"e-base-item-option-text"});A.innerText=this.parent.localeObj.getConstant("baseField");var R=(0,t.createElement)("div",{className:"e-type-option-text"});R.innerText=this.parent.localeObj.getConstant("baseItem");var k=(0,t.createElement)("div",{className:"e-caption-input-container"}),j=(0,t.createElement)("div",{id:this.parentElement.id+"_type_option"}),q=(0,t.createElement)("div",{id:this.parentElement.id+"_base_field_option"}),V=(0,t.createElement)("div",{id:this.parentElement.id+"_base_item_option"}),H=(0,t.createElement)("input",{id:this.parentElement.id+"type_input_option",className:"e-caption-input-text",attrs:{type:"text"}});M.appendChild(E),M.appendChild(I),k.appendChild(F),k.appendChild(H),O.appendChild(L),P.appendChild(A),N.appendChild(R),O.appendChild(j),P.appendChild(q),N.appendChild(V),D.appendChild(M),D.appendChild(k),D.appendChild(O),D.appendChild(P),D.appendChild(N),T.appendChild(D);var U=this,_=new vs.DropDownList({dataSource:l,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:n,cssClass:Fe+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(e){B.enabled=-1!==c.indexOf(e.value),G.enabled=-1!==u.indexOf(e.value),G.enabled&&1===G.dataSource.length&&(G.dataSource=f,G.dataBind())}});_.isStringTemplate=!0,_.appendTo(j);var B=new vs.DropDownList({dataSource:m,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:s,enabled:-1!==c.indexOf(n),cssClass:Fe+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(e){var t=Di.isDateField(e.value,a.parent.engineModule);f=U.parent.engineModule.fieldList[e.value].dateMember.map((function(i){return t?i.formattedText:a.parent.engineModule.getFormattedValue(i.actualText,e.value).formattedText})),G.dataSource=f,G.value=f[0],G.filterBarPlaceholder=U.parent.localeObj.getConstant("example")+" "+f[0],G.itemData=null,G.dataBind()}});B.isStringTemplate=!0,B.appendTo(q);var G=new vs.DropDownList({dataSource:f,enableRtl:this.parent.enableRtl,locale:this.parent.locale,value:o,allowFiltering:!0,filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+f[0],enabled:-1!==u.indexOf(n),cssClass:Le+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%"});G.isStringTemplate=!0,G.appendTo(V);var z=new fs.MaskedTextBox({placeholder:"Enter field caption",enableRtl:this.parent.enableRtl,locale:this.parent.locale,value:r,width:"100%",cssClass:this.parent.cssClass});return z.isStringTemplate=!0,z.appendTo(H),T},e.prototype.selectOptionInContextMenu=function(e){if(null!==e.item.text){var i=this.currentMenu.parentElement,a=Di.getFieldInfo(i?i.getAttribute("data-uid"):"",this.parent);if(this.parent.actionObj.actionName=vn,this.parent.actionObj.fieldInfo=a.fieldItem,this.parent.actionBeginMethod())return;var r=e.item.id.split("_").pop();try{if("MoreOption"===r||"PercentageOfDifferenceFrom"===r||"PercentageOfParentTotal"===r||"DifferenceFrom"===r)this.createValueSettingsDialog(i,this.parentElement,r);else{var n=i.getAttribute("data-uid"),s=this.parent.dataSourceSettings.values,o=i.querySelector("."+k),l=e.item.text+" "+this.parent.localeObj.getConstant("of")+" "+this.parent.engineModule.fieldList[n].caption;l=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(l):l,this.parent.dataSourceSettings.showAggregationOnValueField&&(o.innerText=l),o.setAttribute("title",l),i.setAttribute("data-type",r);for(var d=0;d<this.parent.dataSourceSettings.values.length;d++)if(this.parent.dataSourceSettings.values[d].name===n){var h=(0,t.extend)({},s[d].properties?s[d].properties:s[d],null,!0);h.type=r,this.parent.engineModule.fieldList[n].aggregateType=r,s.splice(d,1,h),this.parent.lastAggregationInfo=h}this.updateDataSource()}}catch(e){this.parent.actionFailureMethod(e)}}},e.prototype.updateDataSource=function(e){!1===this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&!1===this.parent.pivotGridModule.pivotDeferLayoutUpdate||"pivotview"===this.parent.getModuleName()||this.parent.isAdaptive&&"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?this.parent.updateDataSource(e):"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?(this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0),this.parent.pivotGridModule.notify(pr,this),this.parent.pivotGridModule.engineModule=this.parent.engineModule):this.parent.triggerPopulateEvent()},e.prototype.updateValueSettings=function(){var e,i=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"_ValueDialog",document),Ni.Dialog),a=i.element,r=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"type_input_option"),fs.MaskedTextBox),n=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"_type_option"),vs.DropDownList),s=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"_base_field_option"),vs.DropDownList),o=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"_base_item_option"),vs.DropDownList),l=a.getAttribute("data-field");if(this.parentElement.querySelector("."+A)&&(e=this.parentElement.getElementsByClassName(A+" "+l.replace(/[^A-Z0-9]/gi,""))[0]),e){var d=e.querySelector("."+k),h=this.parent.dataSourceSettings.showAggregationOnValueField?this.parent.localeObj.getConstant(n.value)+" "+this.parent.localeObj.getConstant("of")+" "+r.value:r.value;h=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(h):h,d.innerText=h,d.setAttribute("title",h),e.setAttribute("data-type",n.value),e.setAttribute("data-caption",r.value),e.setAttribute("data-basefield",s.value),e.setAttribute("data-baseitem",o.value)}var p=Di.getFieldByName(l,this.parent.dataSourceSettings.values);(p=p.properties?p.properties:p).caption=r.value,p.type=n.value,p.baseField=s.value,p.baseItem=o.value,this.parent.engineModule.fieldList[l].aggregateType=p.type,i.close(),this.parent.lastAggregationInfo=p,this.updateDataSource(!0)},e.prototype.removeDialog=function(){this.buttonElement&&(0,t.select)("#"+this.buttonElement.id,this.parentElement)&&(0,t.select)("#"+this.buttonElement.id,this.parentElement).focus();var e=(0,t.select)("#"+this.parentElement.id+"_ValueDialog",document),i=e?(0,t.getInstance)(e,Ni.Dialog):null;i&&!i.isDestroyed&&i.destroy(),document.getElementById(this.parentElement.id+"_ValueDialog")&&(0,t.remove)(document.getElementById(this.parentElement.id+"_ValueDialog"))},e.prototype.destroy=function(){this.parent.isDestroyed||this.menuInfo&&(void 0===this.menuInfo[1]||this.menuInfo[1].isDestroyed||this.menuInfo[1].destroy(),void 0===this.menuInfo[0]||this.menuInfo[0].isDestroyed||this.menuInfo[0].destroy())},e}(),ys=function(){function e(e){this.isAutoFitEnabled=!1,this.pivotColumns=[],this.indentCollection={},this.colPos=0,this.lastSpan=0,this.lvlCollection={},this.hierarchyCollection={},this.lvlPosCollection={},this.hierarchyPosCollection={},this.position=0,this.measurePos=0,this.maxMeasurePos=0,this.hierarchyCount=0,this.actualText="",this.drilledLevelInfo={},this.parent=e,this.resColWidth=this.parent.showGroupingBar&&this.parent.groupingBarModule?this.parent.isAdaptive?180:250:this.parent.isAdaptive?140:200,this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.gridSettings=this.parent.gridSettings,this.formatList=this.getFormatList(),this.aggMenu=new Ss(this.parent)}return e.prototype.render=function(e){if(e&&this.initProperties(),this.resColWidth=this.parent.isTabular?this.gridSettings.columnWidth:this.parent.showGroupingBar&&this.parent.groupingBarModule?this.parent.isAdaptive?180:250:this.parent.isAdaptive?140:200,this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.gridSettings=this.parent.gridSettings,this.formatList=this.getFormatList(),this.parent.gridCellCollection={},this.injectGridModules(this.parent),this.rowStartPos=this.getRowStartPos(),this.parent.grid&&this.parent.grid.element&&this.parent.element.querySelector("."+gt)){this.parent.notEmpty=!0,this.engine.isEngineUpdated?"olap"!==this.parent.dataType&&(this.parent.isTabular&&(this.engine.headerContent=this.frameDataSource("header")),(this.parent.enableValueSorting||this.parent.isTabular)&&(this.engine.valueContent=this.frameDataSource("value"))):(this.engine.headerContent=this.frameDataSource("header"),this.engine.valueContent=this.frameDataSource("value")),this.engine.isEngineUpdated=!1;var i=this.parent.isTabular?this.parent.engineModule.rowMaxLevel+1:1;this.parent.grid.setProperties({frozenColumns:i,columns:this.frameStackedHeaders(),dataSource:("olap"===this.parent.dataType&&""!==this.parent.dataSourceSettings.url||this.parent.dataSourceSettings.dataSource&&this.parent.engineModule.data.length>0&&this.parent.dataSourceSettings.values.length>0)&&!this.engine.isEmptyData?this.frameGridDataSource(this.engine.valueContent):this.frameDataSource("value")},!0),this.parent.grid.notify("datasource-modified",{}),this.parent.isScrolling&&(this.parent.resizeInfo={}),this.parent.grid.width=this.calculateGridWidth(),this.parent.grid.refreshColumns(),this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+he)&&this.parent.groupingBarModule.setGridRowWidth(),this.isAutoFitEnabled?this.addPivotAutoFitClass():this.removePivotAutoFitClass(),!this.gridSettings.allowAutoResizing&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+he)&&this.parent.groupingBarModule.refreshUI(),this.parent.isScrolling||this.calculateGridHeight(!0)}else{this.parent.element.innerHTML="",this.bindGrid(this.parent,!!this.engine.isEmptyData);var a=(0,t.createElement)("div",{id:this.parent.element.id+"_grid"});this.parent.element.appendChild(a),this.parent.grid.isStringTemplate=!0,this.parent.grid.appendTo(a)}this.parent.grid.on(gs.headerRefreshed,this.refreshHeader,this)},e.prototype.initProperties=function(){this.rowStartPos=void 0,this.maxIndent=void 0,this.resColWidth=void 0,this.isOverflows=void 0,this.indentCollection={},this.formatList=void 0,this.colPos=0,this.colGrandPos=void 0,this.rowGrandPos=void 0,this.lastSpan=0,this.field=void 0,this.fieldCaption=void 0,this.lvlCollection={},this.hierarchyCollection={},this.lvlPosCollection={},this.hierarchyPosCollection={},this.position=0,this.measurePos=0,this.maxMeasurePos=0,this.hierarchyCount=0,this.actualText="",this.timeOutObj=void 0},e.prototype.refreshHeader=function(){var e=this.parent.element.querySelector("."+Ft);if(this.parent.enableVirtualization&&!(0,t.isNullOrUndefined)(e)){var i=(0,t.closest)(e,"."+zt).querySelector("."+It),a=this.parent.element.querySelector("."+At),r=e.querySelector("."+Et);if(this.parent.virtualHeaderDiv=a.querySelector("."+Et),a.querySelector("."+Et)?(0,t.remove)(a.querySelector("."+Et)):this.parent.virtualHeaderDiv=(0,t.createElement)("div",{className:Et}),a.appendChild(this.parent.virtualHeaderDiv),r&&(0,t.setStyleAttribute)(this.parent.virtualHeaderDiv,{height:0,width:r.style.width}),a.querySelector("."+He)){(0,t.setStyleAttribute)(a.querySelector("."+He),{transform:e.querySelector("."+He).style.transform.split(",")[0]+",0px)"});var n=parseInt(a.querySelector("."+He).style.transform.split("(")[1].split(",")[0].split("px")[0],10);this.parent.enableRtl?this.parent.element.querySelector("."+Si).style.right=Number(n)+"px":this.parent.element.querySelector("."+Si).style.left=Number(-n)+"px"}var s=this.parent.isAdaptive?e:i&&"none"!==i.style.display?i:e.parentElement;a.scrollLeft=s.scrollLeft}},e.prototype.bindGrid=function(e,t){this.injectGridModules(e),this.parent.grid=new gs.Grid({cssClass:this.parent.cssClass,frozenColumns:1,frozenRows:0,enableHover:!1,dataSource:t?this.frameEmptyData():this.frameDataSource("value"),columns:t?this.frameEmptyColumns():this.frameStackedHeaders(),height:t?"auto":this.calculateGridHeight(),width:t?this.gridSettings.allowAutoResizing?this.parent.width:400:this.calculateGridWidth(),locale:e.locale,enableRtl:e.enableRtl,allowExcelExport:e.allowExcelExport,allowPdfExport:e.allowPdfExport,allowResizing:this.gridSettings.allowResizing,allowTextWrap:this.gridSettings.allowTextWrap,clipMode:this.gridSettings.clipMode,allowReordering:this.gridSettings.allowReordering,allowSelection:this.gridSettings.allowSelection,contextMenuItems:this.gridSettings.contextMenuItems,selectedRowIndex:this.gridSettings.selectedRowIndex,selectionSettings:this.gridSettings.selectionSettings,textWrapSettings:this.gridSettings.textWrapSettings,printMode:this.gridSettings.printMode,rowHeight:this.gridSettings.rowHeight,gridLines:this.gridSettings.gridLines,contextMenuClick:this.contextMenuClick.bind(this),contextMenuOpen:this.contextMenuOpen.bind(this),beforeCopy:this.gridSettings.beforeCopy?this.gridSettings.beforeCopy.bind(this.parent):void 0,beforePrint:this.gridSettings.beforePrint?this.gridSettings.beforePrint.bind(this.parent):void 0,printComplete:this.gridSettings.printComplete?this.gridSettings.printComplete.bind(this.parent):void 0,rowSelecting:this.gridSettings.rowSelecting?this.gridSettings.rowSelecting.bind(this.parent):void 0,rowSelected:this.rowSelected.bind(this),rowDeselecting:this.gridSettings.rowDeselecting?this.gridSettings.rowDeselecting.bind(this.parent):void 0,rowDeselected:this.rowDeselected.bind(this),cellSelecting:this.cellSelecting.bind(this),cellSelected:this.cellSelected.bind(this),cellDeselecting:this.gridSettings.cellDeselecting?this.gridSettings.cellDeselecting.bind(this.parent):void 0,cellDeselected:this.cellDeselected.bind(this),resizeStart:this.gridSettings.resizeStart?this.gridSettings.resizeStart.bind(this.parent):void 0,columnDragStart:this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0,columnDrag:this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0,columnDrop:this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0,beforeExcelExport:this.beforeExcelExport.bind(this),resizing:this.setGroupWidth.bind(this),resizeStop:this.onResizeStop.bind(this),queryCellInfo:this.queryCellInfo.bind(this),dataBound:this.dataBound.bind(this),headerCellInfo:this.headerCellInfo.bind(this),excelHeaderQueryCellInfo:this.excelHeaderQueryCellInfo.bind(this),pdfHeaderQueryCellInfo:this.pdfHeaderQueryCellInfo.bind(this),excelQueryCellInfo:this.excelQueryCellInfo.bind(this),pdfQueryCellInfo:this.pdfQueryCellInfo.bind(this),beforePdfExport:this.gridSettings.beforePdfExport?this.gridSettings.beforePdfExport.bind(this):void 0,pdfExportComplete:this.pdfExportComplete.bind(this),excelExportComplete:this.excelExportComplete.bind(this),actionComplete:this.actionComplete.bind(this)}),this.parent.grid.on("header-refreshed",this.headerRefreshed.bind(this)),this.parent.grid.on("export-DataBound",this.excelDataBound.bind(this))},e.prototype.actionComplete=function(e){e&&"refresh"===e.requestType&&this.isAutoFitEnabled&&this.removePivotAutoFitClass()},e.prototype.addPivotAutoFitClass=function(){document.body.classList.contains(mt)||document.body.classList.add(mt),document.body.classList.contains(wi)||document.body.classList.add(wi)},e.prototype.removePivotAutoFitClass=function(){document.body.classList.contains(mt)&&document.body.classList.remove(mt),document.body.classList.contains(wi)&&document.body.classList.remove(wi)},e.prototype.headerRefreshed=function(){var e=this.parent.element.querySelector("."+At);this.parent.lastGridSettings&&Object.keys(this.parent.lastGridSettings).indexOf("allowResizing")>-1&&!(0,t.isNullOrUndefined)(e)&&e.querySelector("."+He)&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+he)&&(this.parent.lastGridSettings=void 0,this.parent.groupingBarModule.setGridRowWidth())},e.prototype.beforeExcelExport=function(e){(0,t.isNullOrUndefined)(e.gridObject.columns)||(0,t.isNullOrUndefined)(this.parent.pivotColumns)||(e.gridObject.columns[e.gridObject.columns.length-1].width=this.parent.pivotColumns[this.parent.pivotColumns.length-1].width),this.parent.trigger(Xa,e)},e.prototype.rowSelected=function(e){this.parent.renderModule.selected(),this.parent.trigger(na,e)},e.prototype.rowDeselected=function(e){this.parent.renderModule.selected(),this.parent.trigger(sa,e)},e.prototype.cellSelected=function(e){this.parent.rowRangeSelection.enable?(this.parent.grid.selectionModule.selectRowsByRange(this.parent.rowRangeSelection.startIndex,this.parent.rowRangeSelection.endIndex),this.parent.rowRangeSelection.enable=!1):(this.parent.renderModule.selected(),this.parent.trigger($i,e))},e.prototype.cellSelecting=function(e){var i=this.parent.grid.selectionModule.actualTarget;!(0,t.isNullOrUndefined)(i)&&(i.classList.contains("e-expand")||i.classList.contains("e-collapse")||this.parent.allowGrouping&&i.closest(".e-valuescontent"))&&(e.cancel=!0),this.parent.trigger(ea,e)},e.prototype.cellDeselected=function(e){this.parent.renderModule.selected(),this.parent.trigger(ra,e)},e.prototype.queryCellInfo=function(e){this.parent.renderModule.rowCellBoundEvent(e)},e.prototype.headerCellInfo=function(e){this.parent.renderModule.columnCellBoundEvent(e)},e.prototype.excelHeaderQueryCellInfo=function(e){this.parent.renderModule.excelColumnEvent(e)},e.prototype.pdfQueryCellInfo=function(e){this.parent.renderModule.pdfRowEvent(e)},e.prototype.excelQueryCellInfo=function(e){this.parent.renderModule.excelRowEvent(e)},e.prototype.pdfHeaderQueryCellInfo=function(e){this.parent.renderModule.pdfColumnEvent(e)},e.prototype.pdfExportComplete=function(e){void 0!==this.parent.lastColumn&&this.parent.lastColumn&&"auto"!==this.parent.lastColumn.width&&(this.parent.lastColumn.width="auto",this.parent.lastColumn=void 0);var t={type:"PDF",promise:e.promise};this.parent.trigger(qi,t)},e.prototype.excelExportComplete=function(e){void 0!==this.parent.lastColumn&&this.parent.lastColumn&&"auto"!==this.parent.lastColumn.width&&(this.parent.lastColumn.width="auto",this.parent.lastColumn=void 0);var t={type:"Excel/CSV",promise:e.promise};this.parent.trigger(qi,t)},e.prototype.dataBound=function(){this.parent.notEmpty&&this.calculateGridHeight(!0),this.parent.isScrolling=!1,this.setFocusOnLastCell(),(0,t.isNullOrUndefined)(this.parent.renderReactTemplates)||this.parent.renderReactTemplates(),this.parent.isInitial&&(this.parent.isInitial=!1,this.parent.refreshData(),this.parent.enableVirtualization&&this.parent.onContentReady()),this.parent.notify(mr,{})},e.prototype.setFocusOnLastCell=function(){if(this.parent.keyboardModule&&this.parent.keyboardModule.event&&"TD"===this.parent.keyboardModule.event.target.nodeName){var e=this.parent.grid.serviceLocator.getService("focus");e.setFocusedElement(this.parent.keyboardModule.event.target),e.focus(this.parent.keyboardModule.event),(0,t.addClass)([this.parent.keyboardModule.event.target],["e-focused","e-focus"]),this.parent.keyboardModule.event.target.setAttribute("tabindex","0"),this.parent.keyboardModule.event=void 0}},e.prototype.getCellElement=function(e){var i=(0,t.closest)(e,"td");return(0,t.isNullOrUndefined)(i)&&(i=(0,t.closest)(e,"th")),i},e.prototype.contextMenuOpen=function(e){var i=this;e.element&&this.parent.cssClass&&(0,t.addClass)([e.element.parentElement],this.parent.cssClass);for(var a=function(a){var n=r.parent.lastCellClicked?r.parent.lastCellClicked:r.parent.isAdaptive?e.event.target:r.parent.lastCellClicked,s=r.getCellElement(n),o=void 0,l=void 0;if(!s||s&&0===Number(s.getAttribute("index"))&&parseInt(s.getAttribute("aria-colindex"),10)-1==0)return e.cancel=!0,{value:void 0};(s.classList.contains("e-valuesheader")||s.classList.contains("e-stot"))&&(o=!0),r.parent.allowGrouping&&r.parent.groupingModule&&!r.validateField(s)&&(l=!0);var d=Number(s.getAttribute("index")),h=parseInt(s.getAttribute("aria-colindex"),10)-1,p=r.parent.pivotValues[d][h];switch(a.id){case r.parent.element.id+"_expand":s.querySelectorAll("."+Ve).length>0?((0,t.selectAll)("#"+r.parent.element.id+"_expand",e.element)&&(0,t.select)("#"+r.parent.element.id+"_expand",e.element).classList.add(vt),(0,t.select)("#"+r.parent.element.id+"_expand",e.element).classList.contains(vt)&&(0,t.select)("#"+r.parent.element.id+"_expand",e.element).classList.remove(vt),(0,t.select)("#"+r.parent.element.id+"_expand",e.element).classList.contains(St)&&((0,t.select)("#"+r.parent.element.id+"_expand",e.element).classList.remove(St),(0,t.select)("#"+r.parent.element.id+"_collapse",e.element).classList.remove(St))):o?(0,t.select)("#"+r.parent.element.id+"_expand",e.element).classList.add(St):(0,t.select)("#"+r.parent.element.id+"_expand",e.element).classList.add(vt);break;case r.parent.element.id+"_collapse":s.querySelectorAll("."+qe).length>0?((0,t.select)("#"+r.parent.element.id+"_expand",e.element)&&(0,t.select)("#"+r.parent.element.id+"_expand",e.element).classList.add(vt),(0,t.select)("#"+r.parent.element.id+"_collapse",e.element).classList.contains(vt)&&(0,t.select)("#"+r.parent.element.id+"_collapse",e.element).classList.remove(vt),(0,t.select)("#"+r.parent.element.id+"_collapse",e.element).classList.contains(St)&&((0,t.select)("#"+r.parent.element.id+"_collapse",e.element).classList.remove(St),(0,t.select)("#"+r.parent.element.id+"_expand",e.element).classList.remove(St))):o?(0,t.select)("#"+r.parent.element.id+"_collapse",e.element).classList.add(St):(0,t.select)("#"+r.parent.element.id+"_collapse",e.element).classList.add(vt);break;case r.parent.element.id+"_custom_group":l||2!==e.items.length||(e.cancel=!0),(0,t.selectAll)("#"+r.parent.element.id+"_custom_group",e.element)&&(0,t.addClass)([(0,t.select)("#"+r.parent.element.id+"_custom_group",e.element)],St),l&&(0,t.selectAll)("#"+r.parent.element.id+"_custom_group",e.element)&&(0,t.removeClass)([(0,t.select)("#"+r.parent.element.id+"_custom_group",e.element)],St);break;case r.parent.element.id+"_custom_ungroup":if((0,t.selectAll)("#"+r.parent.element.id+"_custom_ungroup",e.element)&&(0,t.addClass)([(0,t.select)("#"+r.parent.element.id+"_custom_ungroup",e.element)],St),l){var u=!1,c=s.getAttribute("fieldname"),g=Di.getFieldByName(c,r.parent.dataSourceSettings.groupSettings);if(g&&"Custom"===g.type||r.parent.engineModule.fieldList[c].isCustomField&&c.indexOf("_custom_group")>-1){if(g=Di.getFieldByName(c.replace("_custom_group",""),r.parent.dataSourceSettings.groupSettings)){var m=r.parent.engineModule.pivotValues[Number(s.getAttribute("index"))][parseInt(s.getAttribute("aria-colindex"),10)-1],f=r.parent.groupingModule.getSelectedCells(m.axis,c,m.actualText.toString());f.push({axis:m.axis,fieldName:c,name:m.actualText.toString(),cellInfo:m});for(var v=r.parent.groupingModule.getSelectedOptions(f),S=0,y=g.customGroups;S<y.length;S++){var b=y[S];if(v.indexOf(b.groupName)>-1){u=!0;break}}}}else(g&&("Date"===g.type||"Number"===g.type)||r.parent.engineModule.fieldList[c].isCustomField&&c.indexOf("_date_group")>-1)&&(u=!0);(0,t.selectAll)("#"+r.parent.element.id+"_custom_ungroup",e.element)&&u&&(0,t.removeClass)([(0,t.select)("#"+r.parent.element.id+"_custom_ungroup",e.element)],St)}break;case r.parent.element.id+"_drillthrough":r.parent.allowDrillThrough?s.classList.contains("e-summary")?(0,t.select)("#"+r.parent.element.id+"_drillthrough",e.element).classList.contains(vt)&&(0,t.select)("#"+r.parent.element.id+"_drillthrough",e.element).classList.remove(vt):""===s.innerText&&(0,t.select)("#"+r.parent.element.id+"_drillthrough",e.element)&&(0,t.select)("#"+r.parent.element.id+"_drillthrough",e.element).classList.add(vt):(0,t.select)("#"+r.parent.element.id+"_drillthrough",e.element)&&(0,t.select)("#"+r.parent.element.id+"_drillthrough",e.element).classList.add(vt);break;case r.parent.element.id+"_sortasc":r.parent.enableValueSorting?s.querySelectorAll(".e-icon-descending").length>0?((0,t.select)("#"+r.parent.element.id+"_sortdesc",e.element)?(0,t.select)("#"+r.parent.element.id+"_sortdesc",e.element).classList.add(vt):(0,t.select)("#"+r.parent.element.id+"_sortdesc",e.element).classList.remove(vt),(0,t.select)("#"+r.parent.element.id+"_sortasc",e.element).classList.contains(vt)&&(0,t.select)("#"+r.parent.element.id+"_sortasc",e.element).classList.remove(vt)):(0,t.select)("#"+r.parent.element.id+"_sortdesc",e.element).classList.contains(vt)&&(0,t.select)("#"+r.parent.element.id+"_sortdesc",e.element).classList.remove(vt):(0,t.select)("#"+r.parent.element.id+"_sortasc",e.element)&&(0,t.select)("#"+r.parent.element.id+"_sortasc",e.element).classList.add(vt);break;case r.parent.element.id+"_sortdesc":r.parent.enableValueSorting?s.querySelectorAll(".e-icon-ascending").length>0?((0,t.select)("#"+r.parent.element.id+"_sortasc",e.element)?(0,t.select)("#"+r.parent.element.id+"_sortasc",e.element).classList.add(vt):(0,t.select)("#"+r.parent.element.id+"_sortasc",e.element).classList.remove(vt),(0,t.select)("#"+r.parent.element.id+"_sortdesc",e.element).classList.contains(vt)&&(0,t.select)("#"+r.parent.element.id+"_sortdesc",e.element).classList.remove(vt)):(0,t.select)("#"+r.parent.element.id+"_sortasc",e.element).classList.contains(vt)&&(0,t.select)("#"+r.parent.element.id+"_sortasc",e.element).classList.remove(vt):(0,t.select)("#"+r.parent.element.id+"_sortdesc",e.element)&&(0,t.select)("#"+r.parent.element.id+"_sortdesc",e.element).classList.add(vt);break;case r.parent.element.id+"_CalculatedField":r.parent.allowCalculatedField||(0,t.select)("#"+r.parent.element.id+"_CalculatedField",e.element).classList.add(vt);break;case r.parent.element.id+"_pdf":r.parent.allowPdfExport||(0,t.select)("#"+r.parent.element.id+"_pdf",e.element).classList.add(vt);break;case r.parent.element.id+"_excel":r.parent.allowExcelExport||(0,t.select)("#"+r.parent.element.id+"_excel",e.element).classList.add(vt);break;case r.parent.element.id+"_csv":r.parent.allowExcelExport||(0,t.select)("#"+r.parent.element.id+"_csv",e.element).classList.add(vt);break;case r.parent.element.id+"_exporting":r.parent.allowExcelExport||r.parent.allowPdfExport||(0,t.select)("#"+r.parent.element.id+"_exporting",e.element).classList.add(vt);break;case r.parent.element.id+"_aggregate":if((0,t.select)("#"+r.parent.element.id+"_aggregate",e.element)&&!(0,t.select)("#"+r.parent.element.id+"_aggregate",e.element).classList.contains(vt)&&(0,t.select)("#"+r.parent.element.id+"_aggregate",e.element).classList.add(vt),(s.classList.contains("e-valuesheader")||s.classList.contains("e-valuescontent")||s.classList.contains("e-stot")&&s.classList.contains("e-rowsheader"))&&"olap"!==r.parent.dataType){var C;""!==s.innerText&&(C=r.parent.engineModule.fieldList[p.actualText.toString()].type);var x={cancel:!1,fieldName:p.actualText.toString(),aggregateTypes:r.getMenuItem(C).slice(),displayMenuCount:7};r.parent.trigger(ir,x,(function(r){if(!r.cancel&&""!==s.innerText){for(var n=[],o=[],l=0;l<r.aggregateTypes.length;l++){var d=r.aggregateTypes[l];"number"!==C?["Count","DistinctCount"].indexOf(d)>-1&&o.indexOf(d)<0&&(n.push({text:i.parent.localeObj.getConstant(d),id:i.parent.element.id+"_Agg"+d}),o.push(d)):i.parent.getAllSummaryType().indexOf(d)>-1&&o.indexOf(d)<0&&(n.push({text:i.parent.localeObj.getConstant(d),id:i.parent.element.id+"_Agg"+d}),o.push(d))}n.length>r.displayMenuCount&&(n.splice(r.displayMenuCount),n.push({text:i.parent.localeObj.getConstant("MoreOption"),id:i.parent.element.id+"_AggMoreOption"})),n&&n.length>=1&&(a.items=n,(0,t.select)("#"+i.parent.element.id+"_aggregate",e.element).classList.remove(vt))}}))}}},r=this,n=0,s=e.items;n<s.length;n++){var o=a(s[n]);if("object"==typeof o)return o.value}this.parent.trigger(Wa,e)},e.prototype.getMenuItem=function(e){for(var t=[],i=0;i<this.parent.aggregateTypes.length;i++){var a=this.parent.aggregateTypes[i];"string"!==e?this.parent.getAllSummaryType().indexOf(a)>-1&&-1===t.indexOf(a)&&t.push(a):["Count","DistinctCount"].indexOf(a)>-1&&-1===t.indexOf(a)&&t.push(a)}return t},e.prototype.contextMenuClick=function(e){var t,i=this,a=this.parent.lastCellClicked,r=e.item.id,n={},s=this.getCellElement(a),o=Number(s.getAttribute("index")),l=parseInt(s.getAttribute("aria-colindex"),10)-1,d=this.parent.pivotValues[o][l];switch(e.item.id.indexOf(this.parent.element.id+"_Agg")>-1&&(this.field=this.parent.engineModule.fieldList[d.actualText.toString()].id,this.fieldCaption=this.parent.engineModule.fieldList[d.actualText.toString()].caption,t=e.item.id.split("_Agg")[1]),r){case this.parent.element.id+"_pdf":n={pdfDoc:void 0,isBlob:!1,isMultipleExport:!1,pdfExportProperties:{fileName:"Export.pdf"}},this.parent.trigger(ji,n,(function(e){i.parent.pdfExport(e.pdfExportProperties,e.isMultipleExport,e.pdfDoc,e.isBlob)}));break;case this.parent.element.id+"_excel":n={isBlob:!1,isMultipleExport:!1,workbook:void 0,excelExportProperties:{fileName:"Export.xlsx"}},this.parent.trigger(ji,n,(function(e){i.parent.excelExport(e.excelExportProperties,e.isMultipleExport,e.workbook,e.isBlob)}));break;case this.parent.element.id+"_csv":n={isBlob:!1,workbook:void 0,isMultipleExport:!1,excelExportProperties:{fileName:"Export.csv"}},this.parent.trigger(ji,n,(function(e){i.parent.csvExport(e.excelExportProperties,e.isMultipleExport,e.workbook,e.isBlob)}));break;case this.parent.element.id+"_drillthrough_menu":var h=new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0});s.dispatchEvent(h);break;case this.parent.element.id+"_sortasc":this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:d.valueSort.levelName,headerDelimiter:this.parent.dataSourceSettings.valueSortSettings.headerDelimiter}}}),this.parent.dataSourceSettings.valueSortSettings.sortOrder="Ascending";break;case this.parent.element.id+"_sortdesc":this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:d.valueSort.levelName,headerDelimiter:this.parent.dataSourceSettings.valueSortSettings.headerDelimiter}}}),this.parent.dataSourceSettings.valueSortSettings.sortOrder="Descending";break;case this.parent.element.id+"_expand":if(s.querySelectorAll("."+Ve)){var p=s.querySelectorAll("."+Ve)[0];this.parent.onDrill(p)}break;case this.parent.element.id+"_collapse":if(s.querySelectorAll("."+qe)){var u=s.querySelectorAll("."+qe)[0];this.parent.onDrill(u)}break;case this.parent.element.id+"_CalculatedField":this.parent.calculatedFieldModule.createCalculatedFieldDialog();break;case this.parent.element.id+"_AggMoreOption":case this.parent.element.id+"_AggDifferenceFrom":case this.parent.element.id+"_AggPercentageOfDifferenceFrom":case this.parent.element.id+"_AggPercentageOfParentTotal":s.setAttribute("id",this.field),s.setAttribute("data-caption",this.fieldCaption),s.setAttribute("data-field",this.field),s.setAttribute("data-type",this.engine.fieldList[d.actualText.toString()].aggregateType),s.setAttribute("data-basefield",this.engine.fieldList[d.actualText.toString()].baseField),s.setAttribute("data-baseItem",this.engine.fieldList[d.actualText.toString()].baseItem),this.aggMenu.createValueSettingsDialog(s,this.parent.element,t);break;case this.parent.element.id+"_Agg"+t:this.updateAggregate(t);break;case this.parent.element.id+"_custom_group":case this.parent.element.id+"_custom_ungroup":if(this.parent.groupingModule){var c={target:s,option:r,parentElement:this.parent.element};this.parent.notify(Mr,c),this.parent.grid.contextMenuModule.contextMenu.close()}}this.parent.trigger(za,e)},e.prototype.validateColumnTotalcell=function(e){for(var t=Object.keys(this.engine.headerContent),i=!1,a="",r=t.length-1;r>=0;r--){var n=this.engine.headerContent[Number(t[r])][e];if(!n)return!1;if(i=!(!i||""===a)&&a===n.valueSort.axis,a=n.valueSort.axis?n.valueSort.axis.toString():"","sum"===n.type&&(i=!0),i&&n.members&&n.members.length>0)return!0}return!1},e.prototype.validateField=function(e){var t=!1;if(e.classList.contains("e-stot")||e.classList.contains("e-gtot")||e.classList.contains("e-valuescontent")||e.classList.contains("e-valuesheader"))t=!0;else{var i=e.getAttribute("fieldName");if(!i||""===i){var a=Number(e.getAttribute("index")),r=parseInt(e.getAttribute("aria-colindex"),10)-1;i=this.engine.pivotValues[a][r].actualText}for(var n=this.parent.dataSourceSettings.values,s=0;s<n.length;s++)if(this.parent.dataSourceSettings.values[s].name===i){t=!0;break}}return t},e.prototype.updateAggregate=function(e){if(this.parent.getAllSummaryType().indexOf(e)>-1)for(var t=this.parent.dataSourceSettings.values,i=0;i<this.parent.dataSourceSettings.values.length;i++){if(this.parent.dataSourceSettings.values[i].name===this.field)t[i].type=e}},e.prototype.injectGridModules=function(e){gs.Grid.Inject(gs.Freeze),e.allowExcelExport&&gs.Grid.Inject(gs.ExcelExport),e.allowPdfExport&&gs.Grid.Inject(gs.PdfExport),gs.Grid.Inject(gs.Selection,gs.Reorder,gs.Resize),this.gridSettings.contextMenuItems&&gs.Grid.Inject(gs.ContextMenu)},e.prototype.updateGridSettings=function(){if(this.injectGridModules(this.parent),this.parent.grid.allowResizing=this.gridSettings.allowResizing,this.parent.grid.clipMode=this.gridSettings.clipMode,this.parent.grid.allowTextWrap=this.gridSettings.allowTextWrap,this.parent.grid.allowReordering=this.gridSettings.allowReordering,this.parent.grid.allowSelection=this.gridSettings.allowSelection,this.parent.grid.contextMenuItems=this.gridSettings.contextMenuItems,this.parent.grid.selectedRowIndex=this.gridSettings.selectedRowIndex,this.parent.grid.selectionSettings=this.gridSettings.selectionSettings,this.parent.grid.textWrapSettings=this.gridSettings.textWrapSettings,this.parent.grid.printMode=this.gridSettings.printMode,this.parent.grid.rowHeight=this.gridSettings.rowHeight,this.parent.grid.gridLines=this.gridSettings.gridLines,this.parent.lastGridSettings){var e=Object.keys(this.parent.lastGridSettings);e.indexOf("height")>-1&&(this.parent.grid.height=this.gridSettings.height),e.indexOf("width")>-1&&(this.parent.grid.width=this.gridSettings.width),this.updatePivotColumns(),(e.indexOf("allowTextWrap")>-1||e.indexOf("clipMode")>-1)&&this.parent.layoutRefresh()}this.clearColumnSelection()},e.prototype.updatePivotColumns=function(){for(var e=Object.keys(this.parent.lastGridSettings),i=0;i<this.parent.pivotColumns.length;i++)for(var a=this.parent.pivotColumns[i],r=0;r<e.length;r++){var n=e[r];(0,t.isNullOrUndefined)(this.parent.pivotColumns[i][n])||(a[n]=this.parent.lastGridSettings[n])}this.parent.fillGridColumns(this.parent.grid.columns)},e.prototype.clearColumnSelection=function(){(0,t.removeClass)(this.parent.element.querySelectorAll("."+Ut),[Ut,kt])},e.prototype.appendValueSortIcon=function(e,i,a,r,n){var s="pivot"===this.parent.dataType?this.parent.engineModule:this.parent.olapEngineModule,o=this.parent.dataSourceSettings.valueSortSettings;if(this.parent.enableValueSorting&&o&&""!==o.headerText){var l="grand sum"!==e.type||1!==this.parent.dataSourceSettings.values.length||this.parent.dataSourceSettings.alwaysShowValueHeader?this.parent.dataSourceSettings.values.length>1||this.parent.dataSourceSettings.alwaysShowValueHeader?s.headerContent.length-1:0===this.parent.dataSourceSettings.columns.length?0:s.headerContent.length-1:0,d=o&&o.headerText?e.valueSort.levelName===o.headerText:r===o.columnIndex;void 0!==o&&d&&(a===l||a+1===l&&e.level>-1&&s.headerContent[a+1][r]&&-1===s.headerContent[a+1][r].level)&&"column"===this.parent.dataSourceSettings.valueAxis&&i.querySelector("div div").appendChild((0,t.createElement)("span",{className:("Descending"===o.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv e-value-sort-icon":"e-icon-ascending e-icons e-ascending e-sortfilterdiv e-value-sort-icon")+(e.hasChild?" e-value-sort-align":""),styles:"Right"===n.headerTextAlign?"float : left":""}))}return i},e.prototype.onResizeStop=function(e){if(e.column.columns&&e.column.columns.length>0)this.getChildColumnWidth(e.column.columns);else{var i=this.parent.isTabular?e.column.index<this.parent.engineModule.rowMaxLevel+1?e.column.index+".formattedText":""+e.column.customAttributes.cell.valueSort.levelName:"0.formattedText"===e.column.field?"0.formattedText":""+e.column.customAttributes.cell.valueSort.levelName;this.parent.resizeInfo[i]=Number(e.column.width.toString().split("px")[0])}if(this.parent.enableVirtualization&&"0.formattedText"===e.column.field){if(this.parent.dataSourceSettings.values.length>1&&!(0,t.isNullOrUndefined)(this.parent.grid.columns[this.parent.grid.columns.length-1].columns)){var a=this.parent.grid.columns[this.parent.grid.columns.length-1].columns;a[a.length-1].minWidth=this.parent.gridSettings.columnWidth}else this.parent.grid.columns[this.parent.grid.columns.length-1].minWidth=this.parent.gridSettings.columnWidth;this.parent.layoutRefresh()}this.setGroupWidth(e),this.calculateGridHeight(!0),this.parent.grid.hideScroll()},e.prototype.getChildColumnWidth=function(e){for(var t=0,i=e;t<i.length;t++){var a=i[t];if(a.columns&&a.columns.length>0)this.getChildColumnWidth(a.columns);else{var r=a.customAttributes.cell.valueSort.levelName;this.parent.resizeInfo[r]=Number(a.width.toString().split("px")[0])}}},e.prototype.setGroupWidth=function(e){if(this.parent.enableVirtualization&&"0.formattedText"===e.column.field&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+he)&&Number(e.column.width.toString().split("px")[0])<250&&(e.cancel=!0),this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+he)){if(this.parent.groupingBarModule.refreshUI(),this.parent.element.querySelector(".e-group-row").offsetWidth<245&&!this.parent.firstColWidth){e.cancel=!0;var t=this.parent.grid.columns;t&&t.length>0&&(t[0].width=this.resColWidth),this.parent.element.querySelector("."+qt).querySelector("col").style.width=this.resColWidth+"px",this.parent.element.querySelector("."+R).querySelector("col").style.width=this.resColWidth+"px"}this.parent.element.querySelector(".e-group-rows").style.height="auto",this.parent.element.querySelector(".e-group-values").style.width=this.parent.element.querySelector(".e-group-row").offsetWidth+"px";var i=this.parent.element.querySelector("."+qt).offsetHeight;this.parent.element.querySelector(".e-group-rows").style.height=i+"px"}if(e.cancel){var a="0.formattedText"===e.column.field?"0.formattedText":e.column.customAttributes.cell.valueSort.levelName;this.parent.resizeInfo[a]=Number(e.column.width.toString().split("px")[0]),this.parent.enableVirtualization&&this.parent.layoutRefresh()}this.parent.enableVirtualization&&(this.parent.resizedValue=e.cancel||"0.formattedText"!==e.column.field?this.parent.resizedValue:Number(e.column.width.toString().split("px")[0])),this.parent.trigger("touchend"===e.e.type||"mouseup"===e.e.type?Ki:Yi,e)},e.prototype.selected=function(){clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.onSelect.bind(this),300)},e.prototype.onSelect=function(){for(var e={selectedCellsInfo:[],pivotValues:this.parent.pivotValues,currentCell:null},t=this.parent.element.querySelectorAll("."+Rt+",."+kt),i=0;i<t.length;i++){var a=t[i],r=parseInt(a.getAttribute("aria-colindex"),10)-1,n=Number(a.getAttribute("index")),s=this.engine.pivotValues[n][r];s&&("value"===s.axis?e.selectedCellsInfo.push({currentCell:s,value:s.value,columnHeaders:s.columnHeaders,rowHeaders:s.rowHeaders,measure:s.actualText.toString()}):"column"===s.axis?e.selectedCellsInfo.push({currentCell:s,value:s.formattedText,columnHeaders:s.valueSort.levelName,rowHeaders:"",measure:""}):e.selectedCellsInfo.push({currentCell:s,value:s.formattedText,columnHeaders:"",rowHeaders:s.valueSort.levelName,measure:""}))}this.parent.trigger(aa,e)},e.prototype.rowCellBoundEvent=function(e){var i=e.cell,a=(0,t.createElement)("div",{className:"e-pivotrow-container"});if(i&&this.parent.notEmpty&&this.engine.headerContent){var r=this.parent.hyperlinkSettings.cssClass,n=parseInt(i.getAttribute("aria-colindex"),10)-1,s=this.parent.isTabular?n.toString():"0",l=e.data[Number(s)],d=l.valueSort&&l.valueSort.levelName===(0===this.parent.dataSourceSettings.rows.length&&"row"===this.parent.dataSourceSettings.valueAxis&&this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+l.formattedText);i.setAttribute("index",l.rowIndex?l.rowIndex.toString():"0");var h=this.parent.pivotValues[l.rowIndex]&&this.parent.pivotValues[l.rowIndex][n]?this.parent.pivotValues[l.rowIndex][n]:null;if(n<=(this.parent.isTabular?this.parent.engineModule.rowMaxLevel:0)){if("pivot"===this.parent.dataType){var p=l.type&&"value"===l.type;i.innerText="";var u=l.valueSort?l.valueSort.levelName.toString():"",c=l.actualText?l.actualText.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length:0,g=u.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length-(c?c-1:c),m=g?g-1:0;if("Bottom"===this.parent.dataSourceSettings.subTotalsPosition&&!(0,t.isNullOrUndefined)(u)){var f=l.isSum?"value"===l.type?u.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+(this.parent.engineModule.valueAxisFields[l.actualText].caption?this.parent.engineModule.valueAxisFields[l.actualText].caption:this.parent.engineModule.valueAxisFields[l.actualText].name))[0]:"":u;l.isSum&&("value"!==l.type||this.drilledLevelInfo[f])?m-=1:l.isSum||(1===f.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length&&(this.drilledLevelInfo={}),l.members&&l.members.length>0&&(this.drilledLevelInfo[f]=l.isDrilled))}if(!this.parent.isTabular){do{m>0&&a.appendChild((0,t.createElement)("span",{className:0===m?"":Qe})),m--}while(m>-1);m=g?g-1:0,this.lastSpan=g?this.lastSpan:0,!l.hasChild&&(p?0:m)>0&&a.appendChild((0,t.createElement)("span",{className:Ye}))}var v=void 0;if(this.parent.dataSourceSettings.rows.length>0&&(!l.valueSort||Object.keys(l.valueSort).length>0)){if(p)for(var S=0,y=this.parent.dataSourceSettings.values;S<y.length;S++){var b=y[S],C=b.caption?b.caption:b.name;if(u.indexOf(C)>-1){v=b.name;break}}else v=l.level>-1&&this.parent.dataSourceSettings.rows[l.level]?this.parent.dataSourceSettings.rows[l.level].name:"";i.setAttribute("fieldname",v)}}else a=this.onOlapRowCellBoundEvent(i,a,l);var x=l.formattedText;if(l.type)if("grand sum"===l.type){this.rowGrandPos=l.rowIndex,i.classList.add("e-gtot");var w=this.parent.dataSourceSettings.values;x=(0,t.isNullOrUndefined)(l.valueSort.axis)?0===this.parent.dataSourceSettings.rows.length&&1===w.length&&"row"===this.parent.dataSourceSettings.valueAxis?this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(w[w.length-1].type)+" "+this.parent.localeObj.getConstant("of")+" "+((0,t.isNullOrUndefined)(w[w.length-1].caption)?w[w.length-1].name:w[w.length-1].caption):this.parent.localeObj.getConstant("grandTotal"):l.formattedText}else l.valueSort.levelName===this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+l.formattedText?(i.classList.add("e-gtot"),x=d?this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(this.parent.engineModule.fieldList[l.actualText].aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+l.formattedText:x):"sum"===l.type&&3!==l.memberType?x=l.formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total"):i.classList.add("e-stot");this.parent.isTabular?(this.setSpanAttributes("rowspan",l.rowSpan,i),this.setSpanAttributes("colspan",l.colSpan,i)):i.classList.add(_e),!0!==l.hasChild||l.isNamedSet||a.appendChild((0,t.createElement)("div",{className:(!0===l.isDrilled?qe:Ve)+" "+o,attrs:{title:!0===l.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}})),a.appendChild((0,t.createElement)("span",{className:Ge,innerHTML:this.parent.isRowCellHyperlink||l.enableHyperlink?'<a  data-url="'+x+'" class="e-hyperlinkcell '+r+'">'+x+"</a>":x}));var T=this.parent.pivotView.dataSourceSettings.valueSortSettings;this.parent.enableValueSorting&&T&&T.headerText&&"row"===this.parent.dataSourceSettings.valueAxis&&this.parent.pivotValues[Number(i.getAttribute("index"))][0]&&this.parent.pivotValues[Number(i.getAttribute("index"))][0].valueSort.levelName&&this.parent.pivotValues[Number(i.getAttribute("index"))][0].valueSort.levelName===T.headerText&&a.appendChild((0,t.createElement)("span",{className:("Descending"===T.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv e-value-sort-icon":"e-icon-ascending e-icons e-ascending e-sortfilterdiv e-value-sort-icon")+(l.hasChild?" e-value-sort-align":""),styles:"right"===a.style.textAlign?"float: left":""})),i.appendChild(a)}else{var M=i.innerText;i.innerText="",i.classList.add("e-valuescontent"),l=e.data[n],(l=(0,t.isNullOrUndefined)(l)?e.column.customAttributes.cell:l).isGrandSum=!!d||l.isGrandSum,l.isSum&&i.classList.add("e-summary");var D=(0,t.isNullOrUndefined)(l.isGrandSum)&&!(0,t.isNullOrUndefined)(this.parent.olapEngineModule)&&"column"===this.parent.olapEngineModule.olapValueAxis&&"olap"===this.parent.dataType&&this.colGrandPos-this.parent.dataSourceSettings.values.length<n;l.isGrandSum||D||this.colGrandPos===n||this.rowGrandPos===Number(i.getAttribute("index"))?i.classList.add("e-gtot"):("olap"===this.parent.dataType?l.isSum:this.validateColumnTotalcell(l.colIndex))&&i.classList.add("e-colstot"),h&&h.cssClass&&i.classList.add(h.cssClass),i.appendChild((0,t.createElement)("span",{className:Ge,innerHTML:-1!==i.className.indexOf("e-summary")&&this.parent.isSummaryCellHyperlink||-1===i.className.indexOf("e-summary")&&this.parent.isValueCellHyperlink||l.enableHyperlink?'<a data-url="'+M+'" class="e-hyperlinkcell '+r+'">'+M+"</a>":M})),this.parent.gridSettings.allowReordering&&i.setAttribute("aria-colindex",e.column.customAttributes?(e.column.customAttributes.cell.colIndex+1).toString():e.column.index.toString())}this.parent.cellTemplate&&this.appendTemplate(i,h),this.unWireEvents(i),this.wireEvents(i)}e.pivotview=this.parent,this.parent.trigger(zi,e)},e.prototype.appendTemplate=function(e,i){var a=this.parent.getCellTemplate()({targetCell:e,cellInfo:i},this.parent,"cellTemplate",this.parent.element.id+"_cellTemplate",null,null,e);if(a&&""!==a&&a.length>0)if(this.parent.enableHtmlSanitizer)if(this.parent.isVue||this.parent.isVue3){var r=(0,t.createElement)("div");r.innerHTML=t.SanitizeHtmlHelper.sanitize(a),(0,t.append)([r.firstChild],e)}else this.parent.appendHtml(e,t.SanitizeHtmlHelper.sanitize(a[0].outerHTML));else this.parent.isVue||this.parent.isVue3?(0,t.append)(a,e):this.parent.appendHtml(e,a[0].outerHTML)},e.prototype.onOlapRowCellBoundEvent=function(e,i,a){e.innerText="";var r=this.engine.rowMeasurePos;if(this.parent.enableVirtualization){if(a.ordinal>-1&&this.parent.olapEngineModule.tupRowInfo.length>0){var n=this.parent.olapEngineModule.tupRowInfo[a.ordinal],s=3===a.memberType?this.engine.fieldList[a.actualText.toString()].tag.toString():a.actualText.toString(),o=n.uNameCollection.indexOf(s),l=(n.uNameCollection.substring(0,o)+(3===a.memberType?"":a.actualText.toString())).split("::[").map((function(e){return"["===e[0]?e:"["+e}));3===a.memberType&&r&&l.push(a.actualText.toString());for(var d=-1,h=0,p=!1,u=0;u<l.length;u++){d+=l[u].split("~~").length;var c="2"!==n.typeCollection[u]&&(!!(this.engine.fieldList[n.members[u].getAttribute("Hierarchy")]&&this.engine.fieldList[n.members[u].getAttribute("Hierarchy")].isHierarchy&&u<this.parent.dataSourceSettings.rows.length-1&&!this.parent.dataSourceSettings.rows[u+1].isNamedSet&&this.parent.dataSourceSettings.rows[u+1].name.indexOf("[Measures]")<0&&this.engine.fieldList[this.parent.dataSourceSettings.rows[u+1].name]&&this.engine.fieldList[this.parent.dataSourceSettings.rows[u+1].name].hasAllMember)||Number(n.members[u].querySelector("CHILDREN_CARDINALITY").textContent)>0);h+=u>0&&p&&!c?1:0,p=c}for(var g=0,m=0;m<d;m++)i.appendChild((0,t.createElement)("span",{className:Qe})),g++;for(m=0;m<h&&d>0;m++)i.appendChild((0,t.createElement)("span",{className:Ye}));this.indentCollection[a.rowIndex]=g,this.maxIndent=this.maxIndent>g?this.maxIndent:g}}else{var f=a.hierarchy,v=a.valueSort?a.valueSort.levelName.toString():"",S=-1===a.level?this.measurePos:v.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length-1,y=3===a.memberType?S+"."+a.levelUniqueName:a.levelUniqueName,b=(c=a.hasChild,!1);if(a.isSum&&3===a.memberType){for(var C=this.lvlCollection[a.parentUniqueName].position,x=C+1;x<this.position;x++)delete this.lvlCollection[this.lvlPosCollection[x]],delete this.lvlPosCollection[x];this.position=this.position>C+1?C+1:this.position,b=!0,this.measurePos=this.lvlCollection[a.parentUniqueName].position}if(!this.lvlCollection[y]&&y)this.lvlPosCollection[this.position]=y,this.lvlCollection[y]={position:this.position,hasChild:c},this.position++;else if(y){for(var w=this.lvlCollection[y].position,T=w+1;T<this.position;T++)delete this.lvlCollection[this.lvlPosCollection[T]],delete this.lvlPosCollection[T];this.position=this.position>w+1?w+1:this.position}if(!this.hierarchyCollection[f]&&f)this.hierarchyPosCollection[this.hierarchyCount]=f,this.hierarchyCollection[f]={lvlPosition:this.position-1,hierarchyPOs:this.hierarchyCount},this.hierarchyCount++;else if(f){var M=this.hierarchyCollection[f].hierarchyPOs;for(T=M+1;T<this.hierarchyCount;T++)delete this.hierarchyCollection[this.hierarchyPosCollection[T]],delete this.hierarchyPosCollection[T];this.hierarchyCount=this.hierarchyCount>M+1?M+1:this.hierarchyCount}if(3!==a.memberType&&y&&this.lvlCollection[y]){var D=this.hierarchyCollection[f]?this.hierarchyCollection[f].hierarchyPOs:-1;this.measurePos=r<=D&&this.hierarchyPosCollection[r+1]?this.measurePos:this.lvlCollection[y].position}var O=this.lvlCollection[y]?this.lvlCollection[y].position:-1;O=b?O-1:O;var P=0;for(g=0;P<=O&&O>0&&a.level>-1;){var N=this.lvlCollection[this.lvlPosCollection[P]].hasChild;(p=P>0&&this.lvlCollection[this.lvlPosCollection[P-1]].hasChild)&&!N&&i.appendChild((0,t.createElement)("span",{className:Ye})),P!==O&&(i.appendChild((0,t.createElement)("span",{className:Qe})),g++),P++}"Top"!==this.parent.dataSourceSettings.grandTotalsPosition||(0,t.isNullOrUndefined)(this.parent.olapEngineModule)||"row"!==this.parent.olapEngineModule.olapValueAxis||"olap"!==this.parent.dataType||0!==a.valueSort.levelName.toString().indexOf(this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter)||i.appendChild((0,t.createElement)("span",{className:Qe})),3===a.memberType&&-1===a.level&&Object.keys(this.lvlCollection).length>1&&(i.appendChild((0,t.createElement)("span",{className:Qe})),g++),this.indentCollection[a.rowIndex]=g,this.maxIndent=this.maxIndent>g?this.maxIndent:g}return i.setAttribute("fieldname",a.hierarchy),e.setAttribute("fieldname",a.hierarchy),!!this.parent.olapEngineModule.tupRowInfo[a.ordinal]&&(0===this.parent.olapEngineModule.tupRowInfo[a.ordinal].measurePosition?1===this.parent.olapEngineModule.tupRowInfo[a.ordinal].allStartPos:0===this.parent.olapEngineModule.tupRowInfo[a.ordinal].allStartPos)&&e.classList.add("e-gtot"),i},e.prototype.columnCellBoundEvent=function(e){if(e.cell.column&&e.cell.column.customAttributes){var i=e.cell.column.customAttributes.cell,a=e.node;if(i){for(var r=this.parent.hyperlinkSettings.cssClass,n=!1,s=0,l=this.parent.dataSourceSettings.values;s<l.length;s++){var d=l[s];d.name===i.actualText&&(n=!0,a.setAttribute("fieldname",d.name))}-1===i.level&&!i.rowSpan||-1===i.rowSpan?e.node.style.display="none":i.rowSpan>1&&(e.node.setAttribute("rowspan",i.rowSpan.toString()),e.node.setAttribute("aria-rowspan",i.rowSpan.toString()),i.rowIndex+i.rowSpan===this.engine.headerContent.length&&(e.node.style.borderBottomWidth="0px")),e.node.setAttribute("aria-colindex",(i.colIndex+1).toString()),e.node.setAttribute("index",i.rowIndex.toString());var h=void 0;"pivot"===this.parent.dataType?(!n&&!(this.parent.dataSourceSettings.values&&"column"===this.parent.dataSourceSettings.valueAxis&&this.parent.dataSourceSettings.values.length>1&&n&&i.rowIndex===this.engine.headerContent.length-1)&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&(h=i.level>-1&&this.parent.dataSourceSettings.columns[i.level]?this.parent.dataSourceSettings.columns[i.level].name:"",a.setAttribute("fieldname",h)),this.validateColumnTotalcell(i.colIndex)&&a.classList.add("e-colstot")):a=this.onOlapColumnCellBoundEvent(a,i);var p=0===this.parent.dataSourceSettings.columns.length&&"column"===this.parent.dataSourceSettings.valueAxis&&i.valueSort&&i.valueSort.levelName===this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+i.formattedText;if(i.type||p){a.classList.add("grand sum"===i.type?"e-gtot":"e-stot"),"grand sum"===i.type?this.colGrandPos=i.colIndex:i.type&&a.classList.add("e-colstot");var u="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,c="grand sum"===i.type?(0,t.isNullOrUndefined)(i.valueSort.axis)||"olap"===this.parent.dataType?this.parent.localeObj.getConstant("grandTotal"):i.formattedText:i.formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total");c=p&&u.fieldList?this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(u.fieldList[i.actualText].aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+i.formattedText:c,null!==a.querySelector(".e-headertext")?a.querySelector(".e-headertext").innerText=c:a.querySelector(".e-stackedheadercelldiv").innerText=c}if(a.classList.add(Ue),this.parent.isColumnCellHyperlink||i.enableHyperlink)if(a.querySelector(".e-stackedheadercelldiv")){var g=a.querySelector(".e-stackedheadercelldiv").innerText;a.querySelector(".e-stackedheadercelldiv").innerHTML='<a data-url="'+g+'" class="e-hyperlinkcell '+r+'">'+g+"</a>"}else if(a.querySelector(".e-headertext")){g=a.querySelector(".e-headertext").innerText;a.querySelector(".e-headertext").innerHTML='<a data-url="'+g+'" class="e-hyperlinkcell '+r+'">'+g+"</a>"}if(!0!==i.hasChild||i.isNamedSet)this.updateWrapper(a);else{var m=a.querySelector(".e-headercelldiv");m&&(m.style.height="auto",m.style.lineHeight="normal");var f=(0,t.createElement)("div",{className:(!0===i.isDrilled?qe:Ve)+" "+o,attrs:{title:!0===i.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}});window.navigator.userAgent.indexOf("Edge")>-1||window.navigator.userAgent.indexOf("Trident")>-1?a.children[0].style.display="table":a.children[0].style.display="block",this.updateWrapper(a,f)}a=this.appendValueSortIcon(i,a,i.rowIndex,i.colIndex,e.cell.column),this.parent.cellTemplate&&this.appendTemplate(a,i);for(var v=this.parent.dataSourceSettings.values.length,S=0;S<v;S++)if(this.parent.dataSourceSettings.values[S].name===i.actualText){if("olap"===this.parent.dataType)!!this.parent.olapEngineModule.tupColumnInfo[i.ordinal]&&(0===this.parent.olapEngineModule.tupColumnInfo[i.ordinal].measurePosition?1===this.parent.olapEngineModule.tupColumnInfo[i.ordinal].allStartPos:0===this.parent.olapEngineModule.tupColumnInfo[i.ordinal].allStartPos)&&a.classList.add("e-gtot");i.valueSort.levelName===this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+i.formattedText||i.valueSort.levelName==="Grand Total"+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+i.formattedText?a.classList.add("e-gtot"):a.classList.add("e-valuesheader")}this.unWireEvents(a),this.wireEvents(a)}}else if(this.parent.isTabular){var y=this.parent.engineModule.rowMaxLevel+1;e.cell&&e.cell.column&&0===e.cell.column.index?(e.node.setAttribute("colspan",y.toString()),e.node.classList.add(Mi)):e.node.style.display="none"}this.parent.trigger(Wi,e)},e.prototype.updateWrapper=function(e,i){if(e.querySelectorAll(".e-headercelldiv").length>0||e.querySelectorAll(".e-stackedheadercelldiv").length>0){var a=(0,t.createElement)("div",{className:"e-pivotcell-container"}),r=(0,t.createElement)("div",{className:(i?"e-stackedheadertext":"e-headertext")+" "+Ge,innerHTML:e.querySelectorAll(".e-headercelldiv").length>0?e.querySelector(".e-headercelldiv").innerHTML:e.querySelector(".e-stackedheadercelldiv").innerHTML});i&&a.append(i),a.append(r),e.children[0].innerHTML="",e.children[0].append(a)}return e},e.prototype.onOlapColumnCellBoundEvent=function(e,t){e.setAttribute("fieldname",3===t.memberType?t.actualText.toString():t.hierarchy);var i=this.engine.headerContent[t.rowIndex]?this.engine.headerContent[t.rowIndex][t.colIndex-1]:void 0;return i&&i.actualText===t.actualText&&i.type===t.type&&i.colSpan>1&&(e.style.display="none"),t.rowIndex===this.engine.headerContent.length-1&&2===t.memberType&&(e.style.display=this.isSpannedCell(this.engine.headerContent.length,t)?"none":e.style.display),e},e.prototype.isSpannedCell=function(e,t){for(var i,a,r=this.engine.headerContent[t.rowIndex-1]?this.engine.headerContent[t.rowIndex-1][t.colIndex]:void 0;r&&(r.memberType===t.memberType||r.type&&t.type);)r.rowSpan>0&&(i=r.rowSpan,a=r.rowIndex),r=this.engine.headerContent[r.rowIndex-1]?this.engine.headerContent[r.rowIndex-1][t.colIndex]:void 0;return a+i>=e},e.prototype.onHyperCellClick=function(e){var i=e.target.closest("td.e-rowcell")?e.target.closest("td.e-rowcell"):e.target.closest("th"),a={currentCell:i,data:this.engine.pivotValues[Number(i.getAttribute("index"))][parseInt(i.getAttribute("aria-colindex"),10)-1],cancel:!0,nativeEvent:e};this.parent.trigger(Qi,a,(function(e){if(!e.cancel){a.currentCell=(0,t.getElement)(a.currentCell);var i=a.currentCell.getAttribute("data-url")?a.currentCell.getAttribute("data-url"):a.currentCell.querySelector("a").getAttribute("data-url");window.open(i)}}))},e.prototype.getRowStartPos=function(){for(var e,t=this.parent.pivotValues,i=0;i<(t?t.length:0);i++)if(t[i]&&t[i][0]&&"row"===t[i][0].axis){e=i;break}return e},e.prototype.frameDataSource=function(e){var t=[];if(("pivot"===this.parent.dataType&&this.parent.dataSourceSettings.dataSource&&this.parent.engineModule.data.length>0||"olap"===this.parent.dataType&&""!==this.parent.dataSourceSettings.url||"Server"===this.parent.dataSourceSettings.mode&&""!==this.parent.dataSourceSettings.url&&this.engine.pivotValues.length>0)&&this.parent.dataSourceSettings.values.length>0&&!this.engine.isEmptyData)if(this.parent.enableValueSorting||!this.engine.isEngineUpdated||"Tabular"===this.gridSettings.layout){for(var i=0,a=this.parent.pivotValues,r="value"===e?this.rowStartPos:0,n="value"===e?a?a.length:0:this.rowStartPos,s=r;s<n;s++)if(a[s]){t[i="header"===e?s:i]={};for(var o=0;o<a[s].length;o++)a[s][o]&&(t[i][o]=a[s][o]);i++}}else t="value"===e?this.engine.valueContent:this.engine.headerContent;else t=this.frameEmptyData();return t},e.prototype.frameEmptyData=function(){return[{0:{formattedText:this.parent.localeObj.getConstant("grandTotal")},1:{formattedText:this.parent.localeObj.getConstant("emptyData")}}]},e.prototype.calculateColWidth=function(e){(0,t.isNullOrUndefined)(this.parent.resizedValue)||(this.parent.resizedValue=this.parent.showGroupingBar&&this.parent.resizedValue<250?250:this.parent.resizedValue),this.resColWidth=(0,t.isNullOrUndefined)(this.parent.resizedValue)?this.resColWidth:this.parent.resizedValue;var i=this.calculateGridWidth(),a=this.parent.element.getBoundingClientRect().width?this.parent.element.getBoundingClientRect().width:this.parent.element.offsetWidth,r=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*a:i:Number(this.parent.width);if(r-=this.gridSettings.columnWidth>this.resColWidth?this.gridSettings.columnWidth:this.parent.isTabular?(this.parent.engineModule.rowMaxLevel+1)*this.resColWidth:this.resColWidth,e=this.parent.isTabular?e-(this.parent.engineModule.rowMaxLevel+1):e-1,this.isOverflows=!(e*this.gridSettings.columnWidth<r),!this.isOverflows){var n=this.calculateGridHeight(),s="auto"===n?this.parent.getHeightAsNumber():n,o=this.engine&&this.engine.headerContent?Object.keys(this.engine.headerContent).length:1,l=s-this.gridSettings.rowHeight*o;this.engine&&this.engine.valueContent&&this.gridSettings.rowHeight*this.engine.valueContent.length>l&&(r-=(0,gs.getScrollBarWidth)())}var d=e*this.gridSettings.columnWidth<r?r/e:this.gridSettings.columnWidth;return this.isOverflows||this.gridSettings.allowAutoResizing?d:this.gridSettings.columnWidth},e.prototype.resizeColWidth=function(e){(0,t.isNullOrUndefined)(this.parent.resizedValue)||(this.parent.resizedValue=this.parent.showGroupingBar&&this.parent.resizedValue<250?250:this.parent.resizedValue),this.resColWidth=(0,t.isNullOrUndefined)(this.parent.resizedValue)?this.resColWidth:this.parent.resizedValue;var i=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*this.parent.element.offsetWidth:this.parent.element.offsetWidth:Number(this.parent.width);e-=1,i-=this.gridSettings.columnWidth>this.resColWidth?this.gridSettings.columnWidth:this.resColWidth,this.isOverflows=!(e*this.gridSettings.columnWidth<i);var a=e*this.gridSettings.columnWidth<i?i/e:this.gridSettings.columnWidth;return this.isOverflows||this.gridSettings.allowAutoResizing?a:this.gridSettings.columnWidth},e.prototype.calculateGridWidth=function(){var e=this.parent.width,t=this.parent.element.getBoundingClientRect().width?this.parent.element.getBoundingClientRect().width:this.parent.element.offsetWidth;return 0===t&&(t=this.parent.element.parentElement.getBoundingClientRect().width?this.parent.element.parentElement.getBoundingClientRect().width:this.parent.element.parentElement.offsetWidth),"auto"===this.gridSettings.width?"auto"===this.parent.width?e=t:this.parent.width.toString().indexOf("%")>-1?e=parseFloat(this.parent.width.toString())/100*t:this.parent.width.toString().indexOf("px")>-1&&(e=this.parent.width.toString().split("px")[0]):e=this.gridSettings.width,!this.gridSettings.allowAutoResizing&&e>this.parent.totColWidth?this.parent.totColWidth:e},e.prototype.calculateGridHeight=function(e){var t=this.parent.element.querySelector("."+gt+" ."+R),i=this.parent.height,a=this.parent.getHeightAsNumber();if(t&&(a=isNaN(a)?a>this.parent.minHeight?a:this.parent.minHeight:t.offsetWidth<t.querySelector("."+He).offsetWidth?a-(0,gs.getScrollBarWidth)():a,this.parent.showToolbar&&"Chart"!==this.parent.currentView||!this.parent.showToolbar&&"Chart"!==this.parent.displayOption.view))if("auto"===this.gridSettings.height&&a&&this.parent.element.querySelector("."+Gt))if(i=(i=a-(this.parent.element.querySelector("."+Gt).offsetHeight+(this.parent.element.querySelector("."+di)?this.parent.element.querySelector("."+di).offsetHeight:0)+(this.parent.element.querySelector("."+Xt)?42:0)+(this.parent.element.querySelector("."+gi)?this.parent.element.querySelector("."+gi).offsetHeight:0))-1)<40?40:i,e){var r=t.querySelector("."+He).offsetHeight,n=t.querySelector("."+He).offsetHeight,s=t.querySelector("."+He).offsetWidth,o=t.offsetWidth<=s;i>=r&&(!o||i>=n)&&!!!(o&&i-r<18)?this.parent.grid.height="auto":(this.parent.grid.height=i,this.parent.grid.dataBind())}else i>this.engine.valueContent.length*this.gridSettings.rowHeight&&(i="auto");else i=this.gridSettings.height;return i<this.parent.gridSettings.rowHeight?this.parent.gridSettings.rowHeight:i},e.prototype.frameStackedHeaders=function(){var e=this.parent.pivotColumns,i="pivot"===this.parent.dataType?this.parent.engineModule:this.parent.olapEngineModule,a=this.parent.grid.columnModel,r=!1,n=!(!this.parent.toolbarModule||!this.parent.toolbarModule.isReportChange)||!!this.parent.actionObj&&("Sort value"===this.parent.actionObj.actionName&&1===i.valueAxis||"Sort field"===this.parent.actionObj.actionName&&"columns"===this.parent.actionObj.fieldInfo.axis||this.parent.pivotFieldListModule&&"Sort field"===this.parent.pivotFieldListModule.actionObj.actionName&&"columns"===this.parent.pivotFieldListModule.actionObj.fieldInfo.axis);if(this.pivotColumns=[],("olap"===this.parent.dataType&&""!==this.parent.dataSourceSettings.url||this.parent.dataSourceSettings.values.length>0&&this.parent.dataSourceSettings.dataSource&&this.parent.engineModule.data.length>0||"Server"===this.parent.dataSourceSettings.mode&&this.parent.dataSourceSettings.values.length>0&&""!==this.parent.dataSourceSettings.url&&this.engine.pivotValues.length>0)&&!this.engine.isEmptyData){var s=this.engine.headerContent.length,o=[],l=[],d=this.calculateColWidth(this.engine.pivotValues&&this.engine.pivotValues[0]?this.engine.pivotValues[0].length:0),h="olap"===this.parent.dataType&&!(0,t.isNullOrUndefined)(this.engine.colMeasurePos)&&this.engine.colDepth-1===this.parent.olapEngineModule.colMeasurePos;do{var p=[],u=0;s--;var c=this.engine.headerContent[s],g=c?Object.keys(c).length:0;if(c)for(var m=this.parent.isTabular?this.parent.engineModule.rowMaxLevel+1:c[0]?0:1,f=0,v=Object.keys(c).length+m;f<v;f++){var S=c[f]&&c[f].colSpan?3!==c[f].memberType||3===c[f].memberType&&!h||0===s?c[f].colSpan:o[f]:1;S="olap"===this.parent.dataType&&(0,t.isNullOrUndefined)(S)?1:S;var y=c[f]?"grand sum"===c[f].type?(0,t.isNullOrUndefined)(c[f].valueSort.axis)?this.parent.localeObj.getConstant("grandTotal"):c[f].formattedText:"sum"===c[f].type?c[f].formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total"):c[f].formattedText:"";if(y=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(y):y,s===this.engine.headerContent.length-1)S=1,r=e.length-1===g&&(!n&&!this.parent.isEmptyGrid&&e[u]&&e[u].autoFit),p[u]={field:f+".formattedText",headerText:y,customAttributes:{cell:this.cloneDataWithoutIndex(c[f])},width:r&&a[u]?a[u].width:c[f]&&c[f].valueSort?this.setSavedWidth(c[f].valueSort.levelName,d):this.resColWidth,minWidth:r&&u===g?a[a.length-1].minWidth:30,allowReordering:this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0,textAlign:this.parent.enableRtl?"Left":"Right",headerTextAlign:this.parent.enableRtl?"Right":"Left"},f===g&&(p[u].width=p[u].width-3,this.lastColumn=p[u]);else if(o[f]){for(var b=S,C=[],x=f;b>0;){if(p[u]){if(!this.pivotColumns[l[x]])break;C.push(this.pivotColumns[l[x]])}else p[u]={headerText:y,field:c[f]?c[f].valueSort.levelName:"",customAttributes:{cell:this.cloneDataWithoutIndex(c[f])},width:r&&0===u&&!n&&!this.parent.isEmptyGrid&&e[0].autoFit?a[0].width:c[f]?this.setSavedWidth(c[f].valueSort.levelName,d):this.resColWidth,minWidth:30,allowReordering:this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0,headerTextAlign:this.parent.enableRtl?"Right":"Left"},C=[this.pivotColumns[l[x]]];this.isAutoFitEnabled=!!this.isAutoFitEnabled||r,b-=o[x],x+=o[x]}p[u].columns=C}p[u]&&(p[u].clipMode=this.gridSettings.clipMode),o[f]=S,l[f]=u,u++,f=f+S-1}this.pivotColumns=p.length>0?p:this.pivotColumns}while(s>0);if(this.parent.isTabular)for(var w=0;w<this.parent.engineModule.rowMaxLevel+1;w++)if(this.parent.showGroupingBar&&!this.parent.isAdaptive){var T=this.parent.element.querySelector("."+Ti),M=T.querySelectorAll(".e-pvt-btn-div"),D=0;if(this.parent.engineModule.rowMaxLevel!==M.length-1&&w===this.parent.engineModule.rowMaxLevel)D=this.getTotalColumnWidth(M,w);else if(1===T.querySelectorAll(".e-pvt-btn-div").length)D=250;else if(.8*this.parent.element.getBoundingClientRect().width<=this.getTotalColumnWidth(M,0))D=this.gridSettings.columnWidth;else D=(T.querySelectorAll(".e-pvt-btn-div")[w].getBoundingClientRect().width<this.parent.gridSettings.columnWidth?this.parent.gridSettings.columnWidth:T.querySelectorAll(".e-pvt-btn-div")[w].getBoundingClientRect().width)+6;this.pivotColumns[w]={field:w+".formattedText",width:D>this.gridSettings.columnWidth?D:this.resColWidth,minWidth:30,headerText:"",allowReordering:!1,allowResizing:this.parent.gridSettings.allowResizing,visible:!0,clipMode:this.parent.gridSettings.clipMode}}else for(var O=0;O<this.parent.engineModule.rowMaxLevel+1;O++)this.updatePivotColumn(this.pivotColumns,O,r,n,a);else this.updatePivotColumn(this.pivotColumns,0,r,n,a)}else this.pivotColumns=this.frameEmptyColumns();return this.parent.toolbarModule&&this.parent.showToolbar&&(this.parent.toolbarModule.isReportChange=!1),this.parent.triggerColumnRenderEvent(this.pivotColumns),r=this.parent.pivotColumns.length>0&&this.parent.pivotColumns[this.parent.pivotColumns.length-1].autoFit,this.pivotColumns},e.prototype.setSavedWidth=function(e,i){if("0.formattedText"!==e||(0,t.isNullOrUndefined)(this.parent.resizedValue)){if(this.parent.isTabular&&this.parent.element.querySelector(".e-row").querySelector(".e-rowcell")&&this.parent.showGroupingBar&&"0.formattedText"===e&&0===this.parent.dataSourceSettings.values.length){for(var a=0,r=this.parent.element.querySelector("."+Ti).querySelectorAll(".e-pvt-btn-div"),n=0;n<r.length;n++)a+=r[n].getBoundingClientRect().width+6;i=a}i=this.parent.resizeInfo[e]?this.parent.resizeInfo[e]:i}else i=this.parent.resizedValue;return i},e.prototype.frameEmptyColumns=function(){var e=[],t=this.calculateColWidth(2);return e.push({field:"0.formattedText",headerText:"",minWidth:30,width:this.resColWidth}),e.push({field:"1.formattedText",headerText:this.parent.localeObj.getConstant("grandTotal"),minWidth:30,width:t-3}),e},e.prototype.getFormatList=function(){for(var e={},i=0;i<this.parent.dataSourceSettings.values.length;i++){var a=this.parent.dataSourceSettings.values[i],r="N";if("olap"===this.parent.dataType){if(this.parent.olapEngineModule.fieldList[a.name]&&!(0,t.isNullOrUndefined)(this.parent.olapEngineModule.fieldList[a.name].formatString)){var n=this.parent.olapEngineModule.formatFields[a.name]?this.parent.olapEngineModule.formatFields[a.name].format:this.parent.olapEngineModule.fieldList[a.name].formatString;r=(n="Standard"===n?"Number":n).indexOf("#")>-1||null!==n.match(/\d/)?n:n[0]+"2"}}else if(["PercentageOfDifferenceFrom","PercentageOfRowTotal","PercentageOfColumnTotal","PercentageOfGrandTotal","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal"].indexOf(a.type)>-1?r="P2":["PopulationStDev","SampleStDev","PopulationVar","SampleVar","Index"].indexOf(a.type)>-1&&(r=void 0),this.parent.dataSourceSettings.formatSettings.length>0)for(var s=0;s<this.parent.dataSourceSettings.formatSettings.length;s++){var o=this.parent.dataSourceSettings.formatSettings[s];if(a.name===o.name){r=o.format;break}}e[a.name]=r}return e},e.prototype.getValidHeader=function(e,i){var a,r=this.parent.dataSourceSettings.values;if("row"===i){var n=e;if(0===this.parent.dataSourceSettings.rows.length||0===this.parent.dataSourceSettings.columns.length){if(0===this.parent.dataSourceSettings.rows.length&&"row"===this.parent.dataSourceSettings.valueAxis&&this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+n.value===n.data[0].valueSort.levelName)return this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(this.parent.engineModule.fieldList[n.value.toString()].aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+n.value.toString();if(1===r.length&&0===this.parent.dataSourceSettings.rows.length)return this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(r[r.length-1].type)+" "+this.parent.localeObj.getConstant("of")+" "+((0,t.isNullOrUndefined)(r[r.length-1].caption)?r[r.length-1].name:r[r.length-1].caption)}a=n.value}else if("column"===i){n=e;if((0===this.parent.dataSourceSettings.rows.length||0===this.parent.dataSourceSettings.columns.length)&&!(0,t.isNullOrUndefined)(e.gridCell.column.customAttributes)&&0===this.parent.dataSourceSettings.columns.length&&"column"===this.parent.dataSourceSettings.valueAxis&&this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+n.gridCell.column.customAttributes.cell.formattedText===n.gridCell.column.customAttributes.cell.valueSort.levelName)return this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(this.parent.engineModule.fieldList[n.gridCell.column.customAttributes.cell.actualText].aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+n.gridCell.column.customAttributes.cell.formattedText;a=n.cell.value}return a},e.prototype.excelColumnEvent=function(e){0===this.parent.dataSourceSettings.columns.length&&"column"===this.parent.dataSourceSettings.valueAxis&&(e.cell.value=this.getValidHeader(e,"column")),void 0!==e.gridCell&&"auto"===e.gridCell.column.width&&(this.parent.lastColumn=e.gridCell.column,e.gridCell.column.width=e.gridCell.column.minWidth),e=this.exportHeaderEvent(e,"XLSX"),this.parent.trigger(Vi,e)},e.prototype.pdfColumnEvent=function(e){0===this.parent.dataSourceSettings.columns.length&&"column"===this.parent.dataSourceSettings.valueAxis&&(e.cell.value=this.getValidHeader(e,"column")),void 0!==e.gridCell&&"auto"===e.gridCell.column.width&&(this.parent.lastColumn=e.gridCell.column,e.gridCell.column.width=e.gridCell.column.minWidth),0===e.gridCell.column.index&&(e.cell.colSpan=this.parent.isTabular?this.parent.engineModule.rowMaxLevel+1:1),this.parent.trigger(Hi,e)},e.prototype.excelRowEvent=function(e){var i,a=this.parent.isTabular?this.parent.engineModule.rowMaxLevel:0,r=e.column?e.column.index:void 0;if(r>=0&&r<=a){var n=e.data[r],s=n.type&&"value"===n.type,o=0;if("olap"===this.parent.dataType)o=this.indentCollection[n.rowIndex];else{var l=n.valueSort?n.valueSort.levelName.toString():"",d=n.actualText?n.actualText.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length:0,h=l.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length-(d?d-1:d);o=h?h-1:0}this.colPos=0,e.style={hAlign:"Left",indent:2*o},this.lastSpan=s?this.lastSpan:o,0!==e.data[r].rowSpan&&0!==e.data[r].colSpan||"CSV"!==this.parent.exportType||!this.parent.isTabular||(e.value="")}else if(this.colPos++,i=e.data[e.column.customAttributes.cell?e.column.customAttributes.cell.colIndex:this.colPos],(0,t.isNullOrUndefined)(i.value)||(0,t.isNullOrUndefined)(i.formattedText)||""===i.formattedText)e.value="Excel"===this.parent.exportType?null:"";else{var p="pivot"===this.parent.dataType&&this.parent.engineModule?this.parent.engineModule.aggregatedValueMatrix:void 0;p&&p[i.rowIndex]&&p[i.rowIndex][i.colIndex]?e.value=p[i.rowIndex][i.colIndex]:e.value=(0,t.isNullOrUndefined)(i.value)||"#DIV/0!"===i.formattedText?i.formattedText:i.value}e=this.exportContentEvent(e),0===this.parent.dataSourceSettings.rows.length&&"row"===this.parent.dataSourceSettings.valueAxis&&(e.value="0.formattedText"===e.column.field?this.getValidHeader(e,"row"):e.value),this.parent.trigger(Ui,e),i&&!(0,t.isNullOrUndefined)(e.value)&&""!==e.value&&(e.style&&this.formatList[i.actualText]?(e.style.type="number",e.style.numberFormat=e.style.numberFormat?e.style.numberFormat:this.formatList[i.actualText]):this.formatList[i.actualText]&&(e.style={numberFormat:this.formatList[i.actualText]}),e.column.format=this.formatList[i.actualText])},e.prototype.pdfRowEvent=function(e){if("0.formattedText"===(e=this.exportContentEvent(e)).column.field){var t=0,i=e.data[0],a=i.type&&"value"===i.type;if("olap"===this.parent.dataType)t=this.indentCollection[i.rowIndex];else{var r=i.valueSort?i.valueSort.levelName.toString():"",n=i.actualText?i.actualText.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length:0,s=r.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length-(n?n-1:n);t=s?s-1:0}e.style={paragraphIndent:10*t},this.lastSpan=a?this.lastSpan:t,0===this.parent.dataSourceSettings.rows.length&&"row"===this.parent.dataSourceSettings.valueAxis&&(e.value=this.getValidHeader(e,"row"))}this.parent.trigger(_i,e)},e.prototype.excelDataBound=function(e){for(var t=e.excelRows,i=Object.keys(this.engine.headerContent).length,a=0;a<i;a++){for(var r=t[a].cells,n=[],s=0;s<r.length;s++)-1!==r[s].rowSpan&&n.push(r[s]);t[a].cells=n}},e.prototype.exportHeaderEvent=function(e,i){var a=1;if(e.gridCell.column.customAttributes){var r=e.gridCell.column.customAttributes.cell;a=r.rowSpan>0?r.rowSpan:1,"XLSX"===i&&(r.rowSpan>0?a=r.rowSpan:(0,t.isNullOrUndefined)(r.type)||0===r.level||(a=1,e.cell.rowSpan=1)),this.actualText=r.actualText}else a=Object.keys(this.engine.headerContent).length;return e.cell.rowSpan!==a&&a>0&&(e.cell.rowSpan=a),e},e.prototype.frameGridDataSource=function(e){for(var t=[],i=0;i<e.length;i++){var a=0;t[i]={};for(var r=Object.keys(e[i]),n=0;null!=e[i]&&n<r.length;n++)for(;a<r.length;)t[i][Number(r[a])]=this.cloneDataWithoutIndex(e[i][Number(r[a])]),a++}return t},e.prototype.cloneDataWithoutIndex=function(e){if(!(0,t.isNullOrUndefined)(e)){for(var i=Object.keys(e),a=0,r={};a<i.length;)"indexObject"!==i[a]&&"index"!==i[a]&&(r[i[a]]=e[i[a]]),a++;return r}return e},e.prototype.exportContentEvent=function(e){var i=e.data[Number(e.column.field.split(".formattedText")[0])];return i.rowSpan>0&&"row"===i.axis&&(e.cell.rowSpan=i.rowSpan),i.colSpan>0&&"row"===i.axis&&(e.colSpan=i.colSpan),e.value="grand sum"===i.type?(0,t.isNullOrUndefined)(i.valueSort.axis)?this.parent.localeObj.getConstant("grandTotal"):i.formattedText:e.value,e},e.prototype.unWireEvents=function(e){e.querySelector(".e-hyperlinkcell")&&t.EventHandler.remove(e.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick)},e.prototype.wireEvents=function(e){e.querySelector(".e-hyperlinkcell")&&t.EventHandler.add(e.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick,this)},e.prototype.setSpanAttributes=function(e,t,i){i.setAttribute(e,t?t.toString():"1"),i.classList.add(_e,Mi,"e-tabular-layout-header"),0===t&&i.classList.add(l)},e.prototype.updatePivotColumn=function(e,t,i,a,r){e[t]={field:t+".formattedText",width:i&&!a&&!this.parent.isEmptyGrid&&e[t].autoFit?r[t].width:this.resColWidth,minWidth:30,headerText:"",allowReordering:!1,allowResizing:this.parent.gridSettings.allowResizing,visible:!0,clipMode:this.parent.gridSettings.clipMode}},e.prototype.getTotalColumnWidth=function(e,t){for(var i=0,a=t;a<e.length;a++){i+=(e[a].getBoundingClientRect().width<this.parent.gridSettings.columnWidth?this.parent.gridSettings.columnWidth:e[a].getBoundingClientRect().width)+6}return i},e}(),bs=function(){function e(e){this.keyConfigs={shiftF:"shift+F",shiftS:"shift+S",shiftE:"shift+E",delete:"delete",enter:"enter",escape:"escape",upArrow:"upArrow",downArrow:"downArrow",altJ:"alt+J"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.keyboardModule=new t.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return e.prototype.keyActionHandler=function(e){switch(e.action){case"shiftF":this.processFilter(e);break;case"shiftS":this.processSort(e);break;case"shiftE":this.processEdit(e);break;case"delete":this.processDelete(e);break;case"enter":this.processEnter(e);break;case"escape":this.processClose(e);break;case"upArrow":case"downArrow":this.processFilterNodeSelection(e);break;case"altJ":this.processComponentFocus(e)}},e.prototype.processComponentFocus=function(e){if(this.parent.element)return this.parent.element.focus(),e.stopPropagation(),void e.preventDefault()},e.prototype.getButtonElement=function(e){for(var t=[].slice.call(this.parent.element.querySelectorAll("."+A)),i=0,a=t.length;i<a;i++)if(t[i].getAttribute("data-uid")===e.getAttribute("data-uid"))return t[i];return e},e.prototype.processEnter=function(e){var i=e.target;if(i&&(0,t.closest)(i,"."+A))return i.querySelector("."+g)&&(0,t.closest)(i,"."+le)?i.querySelector("."+g).click():i.querySelector("."+bt)?i.querySelector("."+bt).click():!i.querySelector("."+j)||(0,t.closest)(i,"."+le)||(0,t.closest)(i,"."+ct)?i.querySelector("."+H)&&!(0,t.closest)(i,"."+le)&&i.querySelector("."+H).click():(i.querySelector("."+j).click(),this.getButtonElement(i).focus()),void e.preventDefault()},e.prototype.processSort=function(e){var i=e.target;if(i&&(0,t.closest)(i,"."+A)&&i.querySelector("."+j)&&!(0,t.closest)(i,"."+le)&&!(0,t.closest)(i,"."+ct))return i.querySelector("."+j).click(),this.getButtonElement(i).focus(),void e.preventDefault()},e.prototype.processEdit=function(e){var i=e.target;if(i&&(0,t.closest)(i,"."+A)&&i.querySelector("."+bt))return i.querySelector("."+bt).click(),void e.preventDefault()},e.prototype.processFilter=function(e){var i=e.target;if(i&&(0,t.closest)(i,"."+A)&&i.querySelector("."+H)&&!(0,t.closest)(i,"."+le)){if(i.querySelector("."+H).click(),this.parent&&this.parent.control&&"pivotview"===this.parent.moduleName&&this.parent.control.grid&&this.parent.control.showGroupingBar&&this.parent.control.groupingBarModule&&(0,t.closest)(i,"."+ue)&&this.parent.filterDialog&&this.parent.filterDialog.dialogPopUp&&!this.parent.filterDialog.dialogPopUp.isDestroyed&&this.parent.filterDialog.dialogPopUp.element){var a=this.parent.filterDialog.dialogPopUp.element,r=this.parent.filterDialog.allowExcelLikeFilter;clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout((function(){a&&a.classList.contains("e-popup-open")&&(r&&a.querySelector(".e-dlg-closeicon-btn")?a.querySelector(".e-dlg-closeicon-btn").focus():a.querySelector("input")&&a.querySelector("input").focus())}))}e.preventDefault()}else;},e.prototype.processFilterNodeSelection=function(e){var i=e.target;if(i&&(0,t.closest)(i,"."+Je)&&40===e.keyCode){if((r=(0,t.closest)(i,"."+Y).querySelector("."+K))&&r.querySelector("li")){var a=r.querySelector("li");return r.querySelector("li#_active")&&((0,t.removeClass)([r.querySelector("li#_active")],["e-node-focus"]),r.querySelector("li#_active").removeAttribute("id")),a.setAttribute("id","_active"),(0,t.addClass)([a],["e-node-focus"]),a.focus(),void e.preventDefault()}}else if(i&&(0,t.closest)(i,"."+K)&&38===e.keyCode){var r;if((r=(0,t.closest)(i,"."+K)).querySelector("li#_active.e-node-focus")&&r.querySelector("li")&&r.querySelector("li").classList.contains("e-prev-active-node")&&r.querySelector("li")===r.querySelector("li#_active.e-node-focus")){(0,t.removeClass)(r.querySelectorAll("li.e-prev-active-node"),"e-prev-active-node");var n=(0,t.closest)(i,"."+Y).querySelector("."+Je);if(n&&n.querySelector("li"))return(a=n.querySelector("li")).setAttribute("id","_active"),(0,t.addClass)([a],["e-node-focus"]),a.focus(),void e.preventDefault()}}else i&&i.id===this.parent.parentID+"_inputbox"&&("upArrow"===e.action?i.parentElement.querySelector(".e-spin-up").click():"downArrow"===e.action&&i.parentElement.querySelector(".e-spin-down").click())},e.prototype.processDelete=function(e){var i=e.target;if(i&&(0,t.closest)(i,"."+A)&&i.querySelector("."+B))return i.querySelector("."+B).click(),void e.preventDefault()},e.prototype.processClose=function(e){var i=e.target;if(i&&(0,t.closest)(i,".e-popup.e-popup-open")){var a=(0,t.getInstance)((0,t.closest)(i,".e-popup.e-popup-open"),Ni.Dialog);if(a&&!a.closeOnEscape){var r=a.element.getAttribute("data-fieldName");if(a.hide(),this.parent.element)for(var n=0,s=[].slice.call(this.parent.element.querySelectorAll(".e-pivot-button"));n<s.length;n++){var o=s[n];if(o.getAttribute("data-uid")===r){o.focus();break}}return void e.preventDefault()}}},e.prototype.destroy=function(){this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null)},e}(),Cs=function(){function e(e){this.searchListItem=[],this.parent=e}return e.prototype.updateSorting=function(e){if(!e.target.classList.contains(H)&&!e.target.classList.contains(B)){this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();var i=e.target,a=void 0,r=void 0,n=void 0;i.id?(a=i.getAttribute("data-uid"),r=[].slice.call(i.querySelectorAll("."+V))):(a=i.parentElement.getAttribute("data-uid"),r=[].slice.call(i.parentElement.querySelectorAll("."+V))),n=0!==r.length;var s=Di.getFieldByName(a,this.parent.dataSourceSettings.sortSettings),o=this.parent.engineModule&&this.parent.engineModule.fieldList[a]&&this.parent.engineModule.fieldList[a].membersOrder?this.parent.engineModule.fieldList[a].membersOrder.slice():[];if((0,t.isNullOrUndefined)(s)){d={name:a,order:n?"Ascending":"Descending",membersOrder:s?s.membersOrder:o};this.parent.dataSourceSettings.sortSettings.push(d)}else{for(var l=0;l<this.parent.dataSourceSettings.sortSettings.length;l++)if(this.parent.dataSourceSettings.sortSettings[l].name===a){this.parent.dataSourceSettings.sortSettings.splice(l,1);break}var d={name:a,order:n?"Ascending":"Descending",membersOrder:s?s.membersOrder:o};this.parent.dataSourceSettings.sortSettings.push(d)}this.parent.control.lastSortInfo=this.parent.dataSourceSettings.sortSettings[this.parent.dataSourceSettings.sortSettings.length-1],n?(0,t.removeClass)([i],V):(0,t.addClass)([i],V)}},e.prototype.updateFiltering=function(e){var i=e.target,a=i.parentElement.getAttribute("data-uid"),r=i.parentElement.textContent,n=!1,s=[],o=[];if(this.parent.dataSourceSettings.allowMemberFilter)if("olap"===this.parent.dataType)o=this.getOlapData(a,n);else{var l=this.parent.engineModule.fieldList[a],d=Di.getClonedData(l.dateMember);this.parent.isDateField=Di.isDateField(a,this.parent.engineModule);var h=l&&l.membersOrder?l.membersOrder.slice():[],p=void 0;"Out of Range"===d[0].actualText?(p=d[0],d.splice(0,1)):"Out of Range"===d[d.length-1].actualText&&(p=d[d.length-1],d.splice(d.length-1,1));var u={fieldName:a,sortOrder:l.sort,members:h&&h.length>0?h:Object.keys(d),IsOrderChanged:!1},c=!1,g=!(!l||!l.isAlphanumeric)||void 0;if(h&&h.length>0)d=Di.applyCustomSort(u,d,g);else{var m=this.parent.dataSourceSettings.groupSettings.filter((function(e){return e.name===a&&"number"===e.type.toLocaleLowerCase()})),f=!(0,t.isNullOrUndefined)(m)&&m.length>0;d=Di.applyHeadersSort(d,u.sortOrder,g,f),c=!0}var v=Di.getFilterItemByName(a,this.parent.dataSourceSettings.filterSettings);if((0,t.isNullOrUndefined)(v)||(n=!(!this.isValidFilterItemsAvail(a,v)||"Include"!==v.type),s=v.items?v.items:[]),p&&("Ascending"===u.sortOrder?"Grand Total"===d[d.length-1].actualText?d.splice(d.length-1,0,p):d.splice(d.length,0,p):"Grand Total"===d[0].actualText?d.splice(1,0,p):d.splice(0,0,p)),c){for(var S=[],y=0,b=0;y<d.length;y++)"Grand Total"!==d[y].actualText&&(S[b++]=d[y].actualText);u.members=S}this.parent.control.trigger(Ga,u),u.IsOrderChanged&&(d=Di.applyCustomSort(u,d,g,!0)),o=this.getTreeData(n,d,s,a)}this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();var C=this.parent.control.filterTargetID;(0,t.isNullOrUndefined)(C)&&(C="pivotfieldlist"!==this.parent.moduleName?this.parent.element:document.getElementById(this.parent.parentID+"_Container")),this.parent.filterDialog.createFilterDialog(o,a,r,C)},e.prototype.isValidFilterItemsAvail=function(e,t){var i=!1;if(t&&["Include","Exclude"].indexOf(t.type)>=0)if("Include"===t.type&&0===t.items.length)i=!0;else{var a=this.parent.engineModule,r=a.fieldList[e],n=void 0;n="Server"===this.parent.dataSourceSettings.mode||"olap"===this.parent.dataType?r.members:Di.getFormattedMembers(r.members,e,a);for(var s=0,o=t.items;s<o.length;s++){if(n[o[s]]){i=!0;break}}}return i},e.prototype.getOlapData=function(e,i){var a=[],r=[];this.parent.filterDialog.isSearchEnabled=!1;var n=this.parent.engineModule,s=Di.getFilterItemByName(e,this.parent.dataSourceSettings.filterSettings);0===n.fieldList[e].filterMembers.length?this.parent.control.loadOnDemandInMemberEditor?s&&s.levelCount>1&&n.fieldList[e].levels.length>1?n.getFilterMembers(this.parent.dataSourceSettings,e,s.levelCount):(n.fieldList[e].levelCount=1,n.getMembers(this.parent.dataSourceSettings,e)):n.getMembers(this.parent.dataSourceSettings,e,!0):(n.fieldList[e].currrentMembers={},n.fieldList[e].searchMembers=[]);var o=n.fieldList[e].isHierarchy;a=n.fieldList[e].filterMembers,(0,t.isNullOrUndefined)(s)||(i=!s.type||"Include"===s.type,r=s.items?s.items:[]);for(var l={},d={},h=n.fieldList[e].members,p=0,u=r;p<u.length;p++){var c=u[p];l[c]=c,d[c]=c,h[c]&&(d=this.getParentNode(e,c,d))}return a=this.getFilteredTreeNodes(e,a,d,[]),a=this.getOlapTreeData(i,Di.getClonedData(a),l,e,o),a=this.sortOlapFilterData(a,n.fieldList[e].sort)},e.prototype.sortOlapFilterData=function(e,t){if(e.length>0){for(var i=!1,a=[],r=0;r<e.length;r++)a.push(e[r].caption);var n="Grand Total"!==e[0].caption||void 0===e[0].caption?e[0].htmlAttributes["data-fieldName"]:e[1].htmlAttributes["data-fieldName"],s=this.parent.engineModule.fieldList[n],o=s&&s.membersOrder?s.membersOrder.slice():[],l={fieldName:n,sortOrder:t,members:o&&o.length>0?o:a,IsOrderChanged:!1};if(o&&o.length>0?this.applyFilterCustomSort(e,l):(e="Ascending"===t?e.sort((function(e,t){return e.caption>t.caption?1:t.caption>e.caption?-1:0})):"Descending"===t?e.sort((function(e,t){return e.caption<t.caption?1:t.caption<e.caption?-1:0})):e,i=!0),i){for(var d=[],h=0,p=0;h<e.length;h++)"Grand Total"!==e[h].caption&&(d[p++]=e[h].caption);l.members=d}this.parent.control.trigger(Ga,l),l.IsOrderChanged&&this.applyFilterCustomSort(e,l,!0)}return e},e.prototype.applyFilterCustomSort=function(e,t,i){var a,r=[],n=[];r=t.IsOrderChanged?t.members:"Ascending"===t.sortOrder||"None"===t.sortOrder||void 0===t.sortOrder?[].concat(t.members):[].concat(t.members).reverse(),"Grand Total"===e[0].caption&&(a=e[0],e.shift());for(var s=0,o=0;s<e.length;s++){var l=e[s].caption;if(r[o]===l){if(e.splice(o++,0,e[s]),e.splice(++s,1),!(o<r.length)){i||n.splice(--o,0,l);break}s=-1}s>=0&&!i&&(n[s]=e[s].caption)}if(!i){for(s=n.length;s<e.length;s++)n[s]=e[s].caption;"Grand Total"===n[n.length-1]&&n.pop(),t.members=n}return a&&e.splice(0,0,a),e},e.prototype.getParentIDs=function(e,t,i){for(var a,r=0,n=e.fields.dataSource;r<n.length;r++){var s=n[r];if(s.id===t){a=s.pid;break}}return a&&(i.push(a),this.getParentIDs(e,a,i)),i},e.prototype.getChildIDs=function(e,t,i){for(var a,r=0,n=e.fields.dataSource;r<n.length;r++){var s=n[r];if(s.pid===t){a=s.id;break}}return a&&(i.push(a),this.getParentIDs(e,a,i)),i},e.prototype.searchTreeNodes=function(e,i,a,r){if(a){for(var n=[],s=[],o=0,d=[].slice.call(i.element.querySelectorAll("li"));o<d.length;o++){var h=d[o];h.querySelector(".e-list-text").textContent.toLowerCase().indexOf(e.value.toLowerCase())>-1?n.push(h):s.push(h)}if(i.enableNodes(n),(0,t.removeClass)(n,l),i.disableNodes(s),(0,t.addClass)(s,l),n.length>0&&s.length>0)for(var p=0,u=n;p<u.length;p++){var c=u[p].getAttribute("data-uid"),g=this.getParentIDs(i,c,[]),m=this.getChildIDs(i,c,[]),f=[];if(g.length>0)for(var v=0,S=s;v<S.length;v++){var y=S[v];-1!==Di.inArray(y.getAttribute("data-uid"),g)&&f.push(y)}if(m.length>0)for(var b=0,C=s;b<C.length;b++){y=C[b];-1!==Di.inArray(y.getAttribute("data-uid"),m)&&f.push(y)}i.enableNodes(f),(0,t.removeClass)(f,l)}0===[].slice.call(i.element.querySelectorAll("li."+l)).length?i.collapseAll():i.expandAll(void 0,void 0,!0),this.searchListItem=n}else if(this.parent.searchTreeItems=[],"olap"!==this.parent.dataType||r){n=[];var x=0;x=1;for(var w=0,T=this.parent.currentTreeItems;w<T.length;w++){var M=T[w];M.name.toLowerCase().indexOf(e.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(M),x<=this.parent.control.maxNodeLimitInMemberEditor&&n.push(M),x++)}--x>this.parent.control.maxNodeLimitInMemberEditor?(this.parent.editorLabelElement.innerText=x-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"),this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"440px":"400px",this.parent.isDataOverflow=!0):(this.parent.editorLabelElement.innerText="",this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"400px":"350px",this.parent.isDataOverflow=!1),this.parent.isDataOverflow=x>this.parent.control.maxNodeLimitInMemberEditor,this.parent.editorLabelElement.parentElement.style.display=this.parent.isDataOverflow?"block":"none",i.fields={dataSource:n,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},i.dataBind()}else this.updateOlapSearchTree(e,i,r)},e.prototype.updateOlapSearchTree=function(e,t,i){var a=[],r=this.parent.filterDialog.dialogPopUp.element.getAttribute("data-fieldname");if(""===e.value.toLowerCase()){this.parent.filterDialog.isSearchEnabled=!1,this.parent.engineModule.fieldList[r].searchMembers=[];for(var n={},s={},o=this.parent.engineModule.fieldList[r].members,l=[],d=0,h=Object.keys(o);d<h.length;d++){o[c=h[d]].isSelected&&(o[c].parent&&o[o[c].parent].isSelected||l.push(c))}for(var p=0,u=l;p<u.length;p++){var c;n[c=u[p]]=c,s[c]=c,o[c]&&(s=this.getParentNode(r,c,s))}var g=this.parent.engineModule.fieldList[r].filterMembers;a=this.getFilteredTreeNodes(r,g,s,[]),a=this.getOlapTreeData(!0,Di.getClonedData(a),n,r,i,!0)}else{this.parent.filterDialog.isSearchEnabled=!0;g=this.parent.engineModule.fieldList[r].searchMembers;a=Di.getClonedData(g),a=this.getOlapSearchTreeData(!0,a,r)}t.fields={dataSource:a,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},t.dataBind()},e.prototype.getTreeData=function(e,i,a,r){this.parent.currentTreeItems=[],this.parent.searchTreeItems=[],this.parent.currentTreeItemsPos={},this.parent.savedTreeFilterPos={};for(var n=this.parent.engineModule,s=[],o=1,l={},d=0,h=a;d<h.length;d++){var p=h[d];l[p]=p}for(var u=r.replace(/[^a-zA-Z0-9 ]/g,"_"),c=0,g=i;c<g.length;c++){var m=g[c],f=m.actualText.toString();f=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(f):f;var v=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(m.actualText):m.actualText,S={id:u+"_"+o,htmlAttributes:{"data-fieldName":r,"data-memberId":v.toString()},actualText:v,name:this.parent.isDateField?m.formattedText:n.getFormattedValue(v,r).formattedText,isSelected:!e},y="Server"===this.parent.dataSourceSettings.mode?m.actualText:m.formattedText;void 0!==l[this.parent.isDateField?y:f]&&(S.isSelected=!!e),o<=this.parent.control.maxNodeLimitInMemberEditor&&s.push(S),S.isSelected||(this.parent.savedTreeFilterPos[o-1]=this.parent.isDateField?m.formattedText:f),this.parent.currentTreeItems.push(S),this.parent.searchTreeItems.push(S),this.parent.currentTreeItemsPos[v]={index:o-1,isSelected:S.isSelected},o++}return this.parent.isDataOverflow=o-1>this.parent.control.maxNodeLimitInMemberEditor,s},e.prototype.getOlapTreeData=function(e,t,i,a,r,n){var s=this.parent.engineModule.fieldList[a];this.parent.currentTreeItems=[],this.parent.searchTreeItems=[],this.parent.currentTreeItemsPos={};for(var o=[],l=1,d=0,h=t;d<h.length;d++){var p=h[d],u=p,c=p.id.toString();n||(u.isSelected=!e),void 0!==i[c]&&(u.isSelected=!!e),!n&&p.hasChildren&&this.updateChildNodeStates(s.filterMembers,a,p.id,u.isSelected),s.members[c].isSelected=u.isSelected,s.currrentMembers&&s.currrentMembers[c]&&(s.currrentMembers[c].isSelected=u.isSelected),l<=this.parent.control.maxNodeLimitInMemberEditor&&r&&o.push(u),this.parent.currentTreeItems.push(u),this.parent.searchTreeItems.push(u),this.parent.currentTreeItemsPos[c]={index:l-1,isSelected:u.isSelected},l++}return this.parent.isDataOverflow=!!r&&l-1>this.parent.control.maxNodeLimitInMemberEditor,r?o:t},e.prototype.getOlapSearchTreeData=function(e,t,i){for(var a=this.parent.engineModule.fieldList[i].members,r=0,n=t;r<n.length;r++){var s=n[r],o=s.id.toString();a[o]&&(s.isSelected=a[o].isSelected),this.parent.searchTreeItems.push(s)}return t},e.prototype.updateChildNodeStates=function(e,t,i,a){for(var r=this.parent.engineModule.fieldList[t].members,n=this.parent.engineModule.fieldList[t].currrentMembers,s=0,o=e;s<o.length;s++){var l=o[s];l.pid&&l.pid.toString()===i&&(r[l.id].isSelected=a,n&&n[l.id]&&(n[l.id].isSelected=a),l.hasChildren&&this.updateChildNodeStates(e,t,l.id,a))}},e.prototype.getParentNode=function(e,t,i){var a=this.parent.engineModule.fieldList[e].members;if(a[t].parent&&t!==a[t].parent){var r=a[t].parent;i[r]=r,this.getParentNode(e,r,i)}return i},e.prototype.getFilteredTreeNodes=function(e,i,a,r){for(var n=[],s=this.parent.engineModule.fieldList[e].members,o=0,l=a?Object.keys(a):[];o<l.length;o++){var d=l[o],h=s[d]?s[d].parent:void 0;void 0!==h&&-1===Di.inArray(h,n)&&n.push(h)}for(var p=0,u=i;p<u.length;p++){var c=u[p];(0,t.isNullOrUndefined)(c.pid)||-1!==Di.inArray(c.pid,n)?(r.push(c),(0,t.isNullOrUndefined)(c.pid)&&-1!==Di.inArray(c.id,n)?s[c.id].isNodeExpand=!0:(0,t.isNullOrUndefined)(c.pid)||-1===Di.inArray(c.pid,n)?s[c.id].isNodeExpand=!1:(s[c.id].isNodeExpand=!1,s[c.pid].isNodeExpand=!0)):s[c.id].isNodeExpand=!1}return r},e}(),xs=function(){function e(e){this.parent=e}return e.prototype.onStateModified=function(e,i){var a="",r=(0,t.closest)(e.target,"."+ne),n=-1;if(this.parent.dataSourceUpdate.btnElement=e.element?e.element.parentElement:void 0,r&&(a=r.classList[1]===se?"rows":r.classList[1]===oe?"columns":r.classList[1]===le?"values":r.classList[1]===de?"filters":""),"olap"===this.parent.dataType||"pivot"===this.parent.dataType){var s="olap"===this.parent.dataType&&this.parent.engineModule.fieldList[i]&&this.parent.engineModule.fieldList[i].isCalculatedField?this.parent.engineModule.fieldList[i].tag:i;if(e.cancel&&""===a)return!1;if(this.parent.dataSourceUpdate.btnElement&&"true"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&("filters"===a||"values"===a)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&s.toLowerCase().indexOf("[measures].")>-1&&"olap"===this.parent.dataType&&("filters"===a||"rows"===a||"columns"===a)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&"olap"===this.parent.dataType&&-1===s.toLowerCase().indexOf("[measures].")&&this.parent.engineModule.fieldList[i]&&this.parent.engineModule.fieldList[i].isNamedSets&&("filters"===a||"values"===a)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&"olap"===this.parent.dataType&&-1===s.toLowerCase().indexOf("[measures].")&&"values"===a){var o=this.parent.localeObj.getConstant("warning"),l=this.parent.localeObj.getConstant("fieldDropErrorAction");return this.parent.errorDialog.createErrorDialog(o,l),!1}}else if(e.cancel&&""===a||this.parent.dataSourceUpdate.btnElement&&"true"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&("filters"===a||"values"===a||a.indexOf(this.parent.dataSourceSettings.valueAxis)>-1))return!1;if(""!==a){if("olap"===this.parent.dataType||"pivot"===this.parent.dataType)if((s="olap"===this.parent.dataType&&this.parent.engineModule.fieldList[i]&&this.parent.engineModule.fieldList[i].isCalculatedField?this.parent.engineModule.fieldList[i].tag:i).toLowerCase().indexOf("[measures].")>-1&&"olap"===this.parent.dataType&&("filters"===a||"rows"===a||"columns"===a)||this.parent.engineModule.fieldList[i]&&this.parent.engineModule.fieldList[i].isNamedSets&&"filters"===a||"olap"===this.parent.dataType&&"values"===a&&-1===s.toLowerCase().indexOf("[measures].")){o=this.parent.localeObj.getConstant("warning"),l=this.parent.localeObj.getConstant("fieldDropErrorAction");return this.parent.errorDialog.createErrorDialog(o,l),!1}if("pivot"===this.parent.dataType&&this.parent.engineModule.fieldList[i]&&"CalculatedField"===this.parent.engineModule.fieldList[i].aggregateType&&"values"!==a){o=this.parent.localeObj.getConstant("warning"),l=this.parent.localeObj.getConstant("dropAction");return this.parent.errorDialog.createErrorDialog(o,l),!1}n=this.getButtonPosition(e.target,a)}else this.parent.engineModule.fieldList[i]&&(this.parent.engineModule.fieldList[i].isSelected=!1,"olap"===this.parent.dataType&&this.parent.engineModule.updateFieldlistData(i));return this.parent.dataSourceUpdate.updateDataSource(i,a,n)},e.prototype.getButtonPosition=function(e,i){var a=-1,r=(0,t.closest)(e,"."+L);if(!(0,t.isNullOrUndefined)(r)){r=r.querySelector("."+A);for(var n=this.parent.element.querySelector(".e-"+i),s=[].slice.call(n.querySelectorAll("."+A)),o=0,l=s.length;o<l;o++)if(s[o].id===r.id){a=o;break}}return a},e}(),ws=function(){function e(e){this.parent=e}return e.prototype.updateDataSource=function(e,i,a){for(var r,n,s=this,o=-1,l=!0,d=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],h=0,p=d.length;h<p;h++)if(d[h])for(var u=0,c=d[h].length;u<c;u++)(d[h][u].name===e||"olap"===this.parent.dataType&&"[measures]"===d[h][u].name.toLowerCase()&&d[h][u].name.toLowerCase()===e)&&(n=0===h?"rows":1===h?"columns":2===h?"values":"filters",o=u),n||(n="fieldList");var g={fieldName:e,dropField:Di.getFieldInfo(e,this.control).fieldItem,dataSourceSettings:Di.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:i,dropPosition:a,draggedAxis:n,cancel:!1},m="pivotfieldlist"===this.control.getModuleName()&&this.control.isPopupView?this.control.pivotGridModule:this.control;return m.trigger(Ai,g,(function(d){if(d.cancel)l=!1;else{if(i=d.dropAxis,a=d.dropPosition,e=d.dropField?d.dropField.name:d.fieldName,r=d.dropField,s.control&&s.btnElement&&"true"===s.btnElement.getAttribute("isvalue"))switch(i){case"":s.control.setProperties({dataSourceSettings:{values:[]}},!0);break;case"rows":a=a===s.parent.dataSourceSettings.rows.length?-1:a,s.control.setProperties({dataSourceSettings:{valueAxis:"row",valueIndex:a}},!0);break;case"columns":a=a===s.parent.dataSourceSettings.columns.length?-1:a,s.control.setProperties({dataSourceSettings:{valueAxis:"column",valueIndex:a}},!0)}else{if(s.removeFieldFromReport(e.toString()),"pivot"===s.parent.dataType&&s.control.showValuesButton&&s.parent.dataSourceSettings.values.length>1){var h="row"===s.parent.dataSourceSettings.valueAxis&&"rows"===i?s.parent.dataSourceSettings.rows:"column"===s.parent.dataSourceSettings.valueAxis&&"columns"===i?s.parent.dataSourceSettings.columns:void 0;o<s.parent.dataSourceSettings.valueIndex&&("row"===s.parent.dataSourceSettings.valueAxis&&"rows"===n||"column"===s.parent.dataSourceSettings.valueAxis&&"columns"===n)&&s.control.setProperties({dataSourceSettings:{valueIndex:s.parent.dataSourceSettings.valueIndex-1}},!0),(0,t.isNullOrUndefined)(h)||(-1===a&&-1===s.parent.dataSourceSettings.valueIndex?s.control.setProperties({dataSourceSettings:{valueIndex:h.length}},!0):a>-1&&a<=s.parent.dataSourceSettings.valueIndex?s.control.setProperties({dataSourceSettings:{valueIndex:s.parent.dataSourceSettings.valueIndex+1}},!0):s.parent.dataSourceSettings.valueIndex>-1&&a>s.parent.dataSourceSettings.valueIndex&&(a-=1))}"CalculatedField"===(r=s.getNewField(e.toString(),d.dropField)).type&&""!==i&&(i="values")}if("olap"===s.parent.dataType&&(s.removeFieldFromReport(e.toString()),r=s.getNewField(e.toString(),d.dropField),0===s.parent.dataSourceSettings.values.length&&s.removeFieldFromReport("[measures]"),"CalculatedField"===r.type&&""!==i&&(i="values")),s.control){var p={fieldName:e,droppedField:r,dataSourceSettings:Di.getClonedDataSourceSettings(s.parent.dataSourceSettings),droppedAxis:i,droppedPosition:a};m.trigger(Li,p,(function(e){if(r=e.droppedField){switch(a=e.droppedPosition,i=e.droppedAxis){case"filters":-1!==a?s.parent.dataSourceSettings.filters.splice(a,0,r):s.parent.dataSourceSettings.filters.push(r);break;case"rows":-1!==a?s.parent.dataSourceSettings.rows.splice(a,0,r):s.parent.dataSourceSettings.rows.push(r);break;case"columns":-1!==a?s.parent.dataSourceSettings.columns.splice(a,0,r):s.parent.dataSourceSettings.columns.push(r);break;case"values":if(-1!==a?s.parent.dataSourceSettings.values.splice(a,0,r):s.parent.dataSourceSettings.values.push(r),!("olap"!==s.parent.dataType||s.parent.engineModule.isMeasureAvail||s.parent.dataSourceSettings.values.length>1)){("row"===s.parent.dataSourceSettings.valueAxis?s.parent.dataSourceSettings.rows:s.parent.dataSourceSettings.columns).push({name:"[Measures]",caption:"Measures",showRemoveIcon:!0,allowDragAndDrop:!0})}}var t="columns"===i?m.dataSourceSettings.columns.length:"rows"===i?m.dataSourceSettings.rows.length:0;0!==t&&m.dataSourceSettings.valueIndex===t&&s.control.setProperties({dataSourceSettings:{valueIndex:-1}},!0)}}))}}})),l},e.prototype.removeFieldFromReport=function(e){for(var t,i=!1,a=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],r=this.parent.engineModule.fieldList[e],n=0,s=a.length;n<s;n++)if(!i&&a[n])for(var o=0,l=a[n].length;o<l;o++)if(a[n][o].name===e||"olap"===this.parent.dataType&&"[measures]"===a[n][o].name.toLowerCase()&&a[n][o].name.toLowerCase()===e){if((t=a[n][o].properties?a[n][o].properties:a[n][o]).type=r&&"number"===r.type?t.type:"Count",a[n].splice(o,1),"olap"===this.parent.dataType){var d=this.parent.engineModule;d&&d.fieldList[e]&&(d.fieldList[e].currrentMembers={},d.fieldList[e].searchMembers=[])}i=!0;break}return t},e.prototype.getNewField=function(e,t){var i;if("olap"===this.parent.dataType){var a=this.parent.engineModule.fieldList[e];i={name:t?t.name:e,caption:t?t.caption:a.caption,isNamedSet:t?t.isNamedSet:a.isNamedSets,isCalculatedField:t?t.isCalculatedField:a.isCalculatedField,type:t?void 0===t.type?"number"===a.type?"Sum":"Count":t.type:void 0===a.aggregateType?"number"===a.type?"Sum":"Count":a.aggregateType,showFilterIcon:t?t.showFilterIcon:a.showFilterIcon,showSortIcon:t?t.showSortIcon:a.showSortIcon,showEditIcon:t?t.showEditIcon:a.showEditIcon,showRemoveIcon:t?t.showRemoveIcon:a.showRemoveIcon,showValueTypeIcon:t?t.showValueTypeIcon:a.showValueTypeIcon,allowDragAndDrop:t?t.allowDragAndDrop:a.allowDragAndDrop,showSubTotals:t?t.showSubTotals:a.showSubTotals,expandAll:t?t.expandAll:a.expandAll}}else{a=this.parent.engineModule.fieldList[e];i={name:t?t.name:e,caption:t?t.caption:a.caption,type:t?void 0===t.type||null===t.type?"number"===a.type?"Sum":"Count":t.type:void 0===a.aggregateType||null===a.aggregateType?"number"===a.type?"Sum":"Count":a.aggregateType,showNoDataItems:t?t.showNoDataItems:a.showNoDataItems,baseField:t?t.baseField:a.baseField,baseItem:t?t.baseItem:a.baseItem,allowDragAndDrop:t?t.allowDragAndDrop:a.allowDragAndDrop,showSubTotals:t?t.showSubTotals:a.showSubTotals,showFilterIcon:t?t.showFilterIcon:a.showFilterIcon,showSortIcon:t?t.showSortIcon:a.showSortIcon,showEditIcon:t?t.showEditIcon:a.showEditIcon,showRemoveIcon:t?t.showRemoveIcon:a.showRemoveIcon,showValueTypeIcon:t?t.showValueTypeIcon:a.showValueTypeIcon,expandAll:t?t.expandAll:a.expandAll}}return i},e}(),Ts=function(){function e(e){this.parent=e}return e.prototype.createErrorDialog=function(e,i){var a=(0,t.createElement)("div",{id:this.parent.parentID+"_ErrorDialog",className:re});this.parent.element.appendChild(a),this.errorPopUp=new Ni.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:e,content:i,isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.closeErrorDialog.bind(this),isFlat:!1,buttonModel:{cssClass:ie+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}}],cssClass:this.parent.cssClass,closeOnEscape:!0,target:document.body,close:this.removeErrorDialog.bind(this)}),this.errorPopUp.isStringTemplate=!0,this.errorPopUp.appendTo(a)},e.prototype.closeErrorDialog=function(){this.errorPopUp.close()},e.prototype.removeErrorDialog=function(){this.errorPopUp&&!this.errorPopUp.isDestroyed&&(this.errorPopUp.destroy(),this.errorPopUp=null),document.getElementById(this.parent.parentID+"_ErrorDialog")&&(0,t.remove)(document.getElementById(this.parent.parentID+"_ErrorDialog"))},e}(),Ms=v(570),Ds=v(295),Os=v(741),Ps=function(){function e(e){this.parent=e}return e.prototype.createFilterDialog=function(e,i,a,r){var n=this,s=(0,t.createElement)("div",{id:this.parent.parentID+"_EditorTreeView",className:"e-member-editor-dialog "+("olap"===this.parent.dataType?"e-olap-editor-dialog":"")+(this.parent.isDataOverflow?" "+vi:""),attrs:{"data-fieldName":i,"aria-label":a}}),o=this.parent.engineModule.fieldList[i].caption,d=this.parent.localeObj.getConstant("filter")+' "'+a+'" '+this.parent.localeObj.getConstant("by");this.filterObject=this.getFilterObject(i),this.isSearchEnabled=!1,this.allowExcelLikeFilter=this.isExcelFilter(i),this.parent.element.appendChild(s),this.dialogPopUp=new Ni.Dialog({animationSettings:{effect:this.allowExcelLikeFilter?"None":"Fade"},allowDragging:!1,header:this.allowExcelLikeFilter?d:o,content:"",isModal:!0,visible:!0,showCloseIcon:!!this.allowExcelLikeFilter,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"320px",height:this.parent.isDataOverflow?this.allowExcelLikeFilter?"440px":"400px":this.allowExcelLikeFilter?"400px":"350px",position:{X:"center",Y:"center"},buttons:[{isFlat:!1,buttonModel:{cssClass:"e-clear-filter-button"+(this.allowExcelLikeFilter?"":" "+l)+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.filterObject}},{isFlat:!1,buttonModel:{cssClass:ie+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.closeFilterDialog.bind(this),isFlat:!1,buttonModel:{cssClass:ae+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:"Popup"!==this.parent.renderMode,target:r,cssClass:this.parent.cssClass,close:this.removeFilterDialog.bind(this)}),this.dialogPopUp.isStringTemplate=!0,this.dialogPopUp.appendTo(s);var h={cancel:!1,fieldName:i,fieldMembers:this.parent.dataSourceSettings.allowMemberFilter?e:[],filterSetting:this.filterObject};("pivotfieldlist"===this.parent.moduleName&&this.parent.control.isPopupView?this.parent.control.pivotGridModule:this.parent.control).trigger($a,h,(function(r){r.cancel?(n.dialogPopUp.close(),n.dialogPopUp=void 0):(e=r.fieldMembers,n.allowExcelLikeFilter?(n.createTabMenu(e,a,i),(0,t.addClass)([n.dialogPopUp.element],"e-excel-filter"),n.updateCheckedState()):(n.dialogPopUp.content=n.createTreeView(e,a,i),n.updateCheckedState()),(0,t.setStyleAttribute)(n.dialogPopUp.element,{visibility:"visible"}),n.allowExcelLikeFilter&&n.dialogPopUp.element.querySelector(".e-dlg-closeicon-btn").focus(),n.memberTreeView.nodeChecked=n.parent.control.pivotButtonModule.nodeStateModified.bind(n.parent.control.pivotButtonModule),n.allMemberSelect.nodeChecked=n.parent.control.pivotButtonModule.nodeStateModified.bind(n.parent.control.pivotButtonModule))}))},e.prototype.createTreeView=function(e,i,a){var r=this,n=(0,t.createElement)("div",{id:this.parent.parentID+"EditorDiv",className:Y+(this.allowExcelLikeFilter?" e-excelfilter":"")}),s=(0,t.createElement)("button",{id:this.parent.parentID+"_LevelDiv",className:"e-level-container-class",attrs:{type:"button"}}),o=(0,t.createElement)("div",{id:this.parent.parentID+"_SearchDiv",attrs:{tabindex:"-1"},className:Ke}),d=this.parent.engineModule.fieldList[a].caption,h=(0,t.createElement)("input",{attrs:{type:"text",className:"e-editor-search-input"}}),p=this.parent.isDataOverflow?this.parent.currentTreeItems.length-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"):"",u=(0,t.createElement)("div",{id:this.parent.parentID+"_LabelDiv",attrs:{tabindex:"-1",title:p},className:"e-editor-label-container"});this.parent.editorLabelElement=(0,t.createElement)("label",{className:"e-editor-label"}),this.parent.editorLabelElement.innerText=p,u.style.display=this.parent.isDataOverflow?"block":"none",u.appendChild(this.parent.editorLabelElement),o.appendChild(h),this.createSortOptions(a,o,e);var c=(0,t.createElement)("div",{id:this.parent.parentID+"_AllDiv",attrs:{tabindex:"-1"},className:"e-select-all-container"}),g=(0,t.createElement)("div",{id:this.parent.parentID+"_SelectAllContainer",className:Je}),m=(0,t.createElement)("div",{className:K+"-outer-div"}),f=(0,t.createElement)("div",{className:K}),v=(0,t.createElement)("div",{className:yt+" "+l});v.innerText=this.parent.localeObj.getConstant("noMatches"),"olap"!==this.parent.dataType||!this.parent.control.loadOnDemandInMemberEditor||this.parent.engineModule.fieldList[a].isHierarchy||this.parent.engineModule.fieldList[a].isNamedSets||(o.appendChild(s),this.createLevelWrapper(s,a)),c.appendChild(g),n.appendChild(o),n.appendChild(c),n.appendChild(v),this.editorSearch=new fs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("search")+" &#8220"+d+"&#8220",enableRtl:this.parent.enableRtl,cssClass:Xe+(this.parent.cssClass?" "+this.parent.cssClass:""),showClearButton:!0,change:function(e){if("olap"===r.parent.dataType)r.searchOlapTreeView(e,v);else{r.parent.eventBase.searchTreeNodes(e,r.memberTreeView,!1);var i=r.dialogPopUp.element;0===[].slice.call(r.memberTreeView.element.querySelectorAll("li")).length?(r.allMemberSelect.disableNodes([r.allMemberSelect.element.querySelector("li")]),i.querySelector("."+ie).setAttribute("disabled","disabled"),(0,t.removeClass)([v],l)):(r.allMemberSelect.enableNodes([r.allMemberSelect.element.querySelector("li")]),i.querySelector("."+ie).removeAttribute("disabled"),(0,t.addClass)([v],l)),r.updateCheckedState()}}}),this.editorSearch.isStringTemplate=!0,this.editorSearch.appendTo(h);var S={"data-fieldName":a,"data-memberId":"all"},y=[{id:"all",name:this.parent.localeObj.getConstant("all"),isSelected:!0,htmlAttributes:S}];if(this.allMemberSelect=new ms.TreeView({fields:{dataSource:y,id:"id",text:"name",isChecked:"isSelected"},showCheckBox:!0,expandOn:"None",enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,nodeClicked:this.nodeCheck.bind(this,!0),keyPress:this.nodeCheck.bind(this,!0),nodeSelected:function(e){(0,t.removeClass)([e.node],"e-active"),e.cancel=!0},cssClass:this.parent.cssClass}),this.allMemberSelect.isStringTemplate=!0,!(0,t.isNullOrUndefined)(this.parent.currentTreeItems))for(var b=0;b<this.parent.currentTreeItems.length;b++)(this.parent.currentTreeItems[b].id.indexOf("\n")||0===this.parent.currentTreeItems[b].id.indexOf("\n"))&&(this.parent.currentTreeItems[b].id=this.parent.currentTreeItems[b].id.replace("\n"," "));return this.allMemberSelect.appendTo(g),m.appendChild(f),n.appendChild(m),this.memberTreeView=new ms.TreeView({fields:{dataSource:e,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},showCheckBox:!0,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,nodeChecking:this.validateTreeNode.bind(this),nodeClicked:this.nodeCheck.bind(this,!1),keyPress:this.nodeCheck.bind(this,!1),nodeExpanding:this.updateChildNodes.bind(this),nodeSelected:function(e){(0,t.removeClass)([e.node],"e-active"),e.cancel=!0},expandOn:"None",cssClass:this.parent.cssClass}),this.memberTreeView.isStringTemplate=!0,this.memberTreeView.appendTo(f),this.parent.isDataOverflow&&this.parent.control.maxNodeLimitInMemberEditor<this.parent.currentTreeItems.length&&n.appendChild(u),n},e.prototype.createSortOptions=function(e,i,a){if("pivot"===this.parent.dataType&&a&&a.length>0){var r=this.parent.engineModule.fieldList[e].sort,s=(0,t.createElement)("div",{className:Ae+" e-btn-group"+(this.parent.enableRtl?" "+n:"")+(this.parent.cssClass?" "+this.parent.cssClass:""),id:this.parent.element.id+"_Member_Sort"});this.parent.element.appendChild(s);var l=(0,t.createElement)("button",{className:("Ascending"===r?je+" ":"")+q,id:this.parent.element.id+"_Sort_Ascend",attrs:{type:"button","aria-label":"button"}}),d=(0,t.createElement)("button",{className:("Descending"===r?je+" ":"")+q,id:this.parent.element.id+"_Sort_Descend",attrs:{type:"button","aria-label":"button"}}),h=new Os.Button({iconCss:o+" "+Re,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});h.appendTo(l),(h=new Os.Button({iconCss:o+" "+ke,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass,enableHtmlSanitizer:this.parent.enableHtmlSanitizer})).appendTo(d),s.appendChild(l),s.appendChild(d),i.appendChild(s),this.unWireEvent(l),this.unWireEvent(d),this.wireEvent(l,e),this.wireEvent(d,e)}},e.prototype.createLevelWrapper=function(e,i){for(var a=this,r=this.parent.engineModule,n=r.fieldList[i].levels,s=r.fieldList[i].levelCount,o=[],l=0,d=n.length;l<d;l++)o.push({id:n[l].id,text:n[l].name});this.dropMenu=new Ds.DropDownButton({cssClass:"e-level-drop e-caret-hide"+(this.parent.cssClass?" "+this.parent.cssClass:""),items:o,iconCss:"e-icons e-dropdown-icon",disabled:s===n.length,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,beforeOpen:function(e){var r=[].slice.call(e.element.querySelectorAll("li")),n=a.parent.engineModule.fieldList[i].levelCount;(0,t.removeClass)(r,vt);for(var s=0,o=r.length;s<o;s++)s<n&&(0,t.addClass)([r[s]],vt)},select:function(e){for(var t,i=a.dialogPopUp.element.getAttribute("data-fieldname"),r=a.parent.engineModule,n=0,s=o.length;n<s;n++)o[n].id===e.item.id&&(t=n);r.getFilterMembers(a.parent.dataSourceSettings,i,t+1,!1,!0)},close:function(){var e=a.parent.engineModule,t=e.fieldList[i].levels;e.fieldList[i].levelCount===t.length?(a.dropMenu.disabled=!0,a.dropMenu.dataBind()):a.dropMenu.disabled=!1}}),this.dropMenu.appendTo(e)},e.prototype.searchOlapTreeView=function(e,i){var a=this;clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout((function(){var r=a.parent.engineModule,n=a.dialogPopUp.element,s=n.getAttribute("data-fieldname"),o=a.parent.control.maxNodeLimitInMemberEditor?a.parent.control.maxNodeLimitInMemberEditor:5e3;if(r.fieldList[s].isHierarchy)a.parent.eventBase.searchTreeNodes(e,a.memberTreeView,!1,!0);else{if(a.dropMenu&&""!==e.value?a.dropMenu.disabled=!0:a.dropMenu.disabled=!1,a.parent.control.loadOnDemandInMemberEditor){var d=r.fieldList[s].levelCount?r.fieldList[s].levelCount:1;r.getSearchMembers(a.parent.dataSourceSettings,s,e.value.toLowerCase(),o,!1,d)}else r.getSearchMembers(a.parent.dataSourceSettings,s,e.value.toLowerCase(),o,!0);a.parent.eventBase.searchTreeNodes(e,a.memberTreeView,!1,!1)}0===[].slice.call(a.memberTreeView.element.querySelectorAll("li")).length?(a.allMemberSelect.disableNodes([a.allMemberSelect.element.querySelector("li")]),n.querySelector("."+ie).setAttribute("disabled","disabled"),(0,t.removeClass)([i],l)):(a.allMemberSelect.enableNodes([a.allMemberSelect.element.querySelector("li")]),n.querySelector("."+ie).removeAttribute("disabled"),(0,t.addClass)([i],l)),a.updateCheckedState()}),500)},e.prototype.nodeCheck=function(e,i){var a=[i.node];if(i.event.target.classList.contains("e-fullrow")||"Enter"===i.event.key){var r=e?this.allMemberSelect:this.memberTreeView;"true"===r.getNode(i.node).isChecked?r.uncheckAll(a):r.checkAll(a)}else 38!==i.event.keyCode||e||((0,t.removeClass)(this.memberTreeView.element.querySelectorAll("li.e-prev-active-node"),"e-prev-active-node"),(0,t.addClass)(a,"e-prev-active-node"))},e.prototype.applySorting=function(e,i){var a=(0,t.closest)(i.target,"."+q);if(a){var r=[].slice.call((0,t.closest)(a,"."+Ae).querySelectorAll("."+q));a.querySelector("."+Re)&&!a.classList.contains(je)?(this.updateFilterMembers("Ascending",e),(0,t.addClass)([a],je),(0,t.removeClass)([r[1]],je)):a.querySelector("."+ke)&&!a.classList.contains(je)?(this.updateFilterMembers("Descending",e),(0,t.addClass)([a],je),(0,t.removeClass)([r[0]],je)):(this.updateFilterMembers("None",e),(0,t.removeClass)(r,je))}},e.prototype.updateFilterMembers=function(e,i){var a=this.parent.engineModule.fieldList[i],r="None"===e?Di.getClonedData(a.dateMember):this.parent.currentTreeItems.slice(),n=!!a.isAlphanumeric||void 0,s=!1,o=a&&a.membersOrder?a.membersOrder.slice():[],l={fieldName:i,sortOrder:e,members:o&&o.length>0?o:Object.keys(r),IsOrderChanged:!1};if(o&&o.length>0)r=Di.applyCustomSort(l,r,n);else{var d=this.parent.dataSourceSettings.groupSettings.filter((function(e){return e.name===i&&"number"===e.type.toLocaleLowerCase()})),h=!(0,t.isNullOrUndefined)(d)&&d.length>0;r=Di.applyHeadersSort(r,l.sortOrder,n,h),s=!0}var p="pivotfieldlist"===this.parent.moduleName&&this.parent.control.isPopupView?this.parent.control.pivotGridModule:this.parent.control;if(s){for(var u=[],c=0,g=0;c<r.length;c++)"Grand Total"!==r[c].actualText&&(u[g++]=r[c].actualText);l.members=u}p.trigger(Ga,l),l.IsOrderChanged&&(r=Di.applyCustomSort(l,r,n,!0)),this.parent.currentTreeItems=[],this.parent.searchTreeItems=[];for(var m=[],f=i.replace(/[^a-zA-Z0-9 ]/g,"_"),v=this.parent.engineModule,S=0,y=r.length;S<y;S++){if("None"===e){var b=r[S].actualText.toString(),C={id:f+"_"+(S+1),htmlAttributes:{"data-fieldName":i,"data-memberId":b},actualText:r[S].actualText,name:this.parent.isDateField?r[S].formattedText:v.getFormattedValue(b,i).formattedText,isSelected:this.parent.currentTreeItemsPos[r[S].actualText].isSelected};this.parent.currentTreeItems.push(C),""!==this.editorSearch.value?C.name.toLowerCase().indexOf(this.editorSearch.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(C),m.push(C)):(this.parent.searchTreeItems.push(C),m.push(C))}else this.parent.currentTreeItems.push(r[S]),""!==this.editorSearch.value?r[S].name.toLowerCase().indexOf(this.editorSearch.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(r[S]),m.push(r[S])):(this.parent.searchTreeItems.push(r[S]),m.push(r[S]));this.parent.currentTreeItemsPos[r[S].actualText].index=S}var x=this.memberTreeView.fields.dataSource.length;this.memberTreeView.fields={dataSource:m.slice(0,x),id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},this.memberTreeView.dataBind()},e.prototype.updateChildNodes=function(e){if("olap"===this.parent.dataType){var i=this.parent.engineModule,a=e.node.getAttribute("data-fieldname"),r=i.fieldList[a],n=[];if(r&&r.filterMembers.length>0&&!this.isSearchEnabled&&!r.members[e.nodeData.id].isNodeExpand){for(var s=[],o=0,l=r.filterMembers;o<l.length;o++){var d=l[o];d.pid===e.nodeData.id.toString()&&s.push(d)}0===s.length&&(r.childMembers=[],i.getChildMembers(this.parent.dataSourceSettings,e.nodeData.id.toString(),a),s=r.childMembers,r.childMembers=[]);var h=Di.getClonedData(s),p=this.memberTreeView.fields.dataSource,u=!1;(0,t.isNullOrUndefined)(this.filterObject)||(u="Include"===this.filterObject.type,n=this.filterObject.items?this.filterObject.items:[]),h=this.updateChildData(u,h,n,a,e.nodeData);for(var c=0,g=h=this.parent.eventBase.sortOlapFilterData(h,i.fieldList[a].sort);c<g.length;c++){var m=g[c];p.push(m)}r.members[e.nodeData.id].isNodeExpand=!0,this.memberTreeView.addNodes(h,e.node)}}},e.prototype.updateChildData=function(e,t,i,a,r){for(var n=Object.keys(this.parent.currentTreeItemsPos).length,s=this.parent.engineModule.fieldList[a],o=[],l=1,d=0,h=t;d<h.length;d++){var p=h[d],u=p,c=p.id.toString();s.members[c].isNodeExpand=!1,p.isSelected="true"===r.isChecked,l<=this.parent.control.maxNodeLimitInMemberEditor&&o.push(u),this.parent.currentTreeItems.push(u),this.parent.searchTreeItems.push(u),this.parent.currentTreeItemsPos[c]={index:n,isSelected:u.isSelected},n++,l++}return this.parent.isDataOverflow=!1,o},e.prototype.createTabMenu=function(e,i,a){var r=(0,t.createElement)("div",{id:this.parent.parentID+"_FilterTabContainer",className:"e-filter-tab-container",attrs:{tabindex:"-1"}});this.dialogPopUp.content=r,this.dialogPopUp.dataBind();for(var n=["Label","Value","Include","Exclude"],s="((-|\\+)?[0-9]+(\\.[0-9]+)?)+",o=Object.keys(this.parent.engineModule.fieldList[a].members)[0],l=this.parent.engineModule.fieldList[a].type,d=Di.getFieldByName(a,this.parent.dataSourceSettings.formatSettings),h=[{header:{text:this.parent.localeObj.getConstant("member"),iconCss:this.filterObject&&n.indexOf(this.filterObject.type)>1?Pe:""},content:this.createTreeView(e,i,a)}],p=0,u=n;p<u.length;p++){var c=u[p];if("Label"===c&&this.parent.dataSourceSettings.allowLabelFilter||"Value"===c&&this.parent.dataSourceSettings.allowValueFilter){var g="Label"===c&&o&&o.match(s)&&o.match(s)[0].length===o.length&&"number"===l?"Number":"Label"===c&&o&&"Invalid Date"!==new Date(o).toString()&&(d&&d.type||this.filterObject&&"Date"===this.filterObject.type)?"Date":c,m={header:{text:"Number"===g?this.parent.localeObj.getConstant("label"):this.parent.localeObj.getConstant(g.toLowerCase()),iconCss:this.filterObject&&this.filterObject.type===g?Pe:""},content:this.createCustomFilter(a,this.filterObject&&this.filterObject.type===g?this.filterObject:void 0,g.toLowerCase())};h.push(m)}}var f=this.filterObject?["Label","Date","Number"].indexOf(this.filterObject.type)>=0?1:"Value"===this.filterObject.type?this.parent.dataSourceSettings.allowLabelFilter&&this.parent.dataSourceSettings.allowValueFilter?2:1:0:0;f=this.parent.dataSourceSettings.allowMemberFilter||0!==f?f:1,this.tabObj=new ms.Tab({heightAdjustMode:"Auto",items:h,height:"100%",selectedItem:f,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass}),this.tabObj.isStringTemplate=!0,this.tabObj.appendTo(r),this.parent.dataSourceSettings.allowMemberFilter||this.tabObj.hideTab(0),f>0&&(0,t.addClass)([this.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===f&&this.parent.dataSourceSettings.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab")},e.prototype.createCustomFilter=function(e,i,a){for(var r=[],n=[],s=[],d=this.parent.dataSourceSettings.values,h="DoesNotEquals",p=0,u=0,c={label:["Equals","DoesNotEquals","BeginWith","DoesNotBeginWith","EndsWith","DoesNotEndsWith","Contains","DoesNotContains","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"],date:["Equals","DoesNotEquals","Before","BeforeOrEqualTo","After","AfterOrEqualTo","Between","NotBetween"],value:["Equals","DoesNotEquals","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"]},g=["Between","NotBetween"],m="label"===a?c.label:"date"===a?c.date:c.value,f=0,v=m;f<v.length;f++){var S=v[f];h=i&&S===i.condition?m.indexOf(i.condition)>=0?i.condition:m[0]:h,r.push({value:S,text:this.parent.localeObj.getConstant(S)})}for(var y=d.length;y--;)n.unshift({value:d[y].name,text:d[y].caption?d[y].caption:d[y].name}),p=i&&"Value"===i.type&&i.measure===d[y].name&&i.condition===h?y:p;if("olap"===this.parent.dataType){var b=this.parent.engineModule,C=b.fieldList[e].levels;if(this.parent.engineModule.fieldList[e].isHierarchy){for(var x=void 0,w=0,T=this.parent.engineModule.fieldListData;w<T.length;w++){var M=T[w];if(M&&M.pid===e){x=M;break}}s.push({value:x?x.id:e,text:x?x.caption:b.fieldList[e].name}),u=0,i&&i.name===e&&i.type.toLowerCase()===a&&(s[s.length-1].iconClass=o+" "+Ne)}else for(var D=0,O=C.length;D<O;D++){u=i&&i.selectedField===C[D].id?D:u,s.push({value:C[D].id,text:C[D].name});for(var P=0,N=this.parent.dataSourceSettings.filterSettings;P<N.length;P++){var E=N[P];if(E.name===e&&E.selectedField===C[D].id&&E.type.toLowerCase()===a){s[s.length-1].iconClass=o+" "+Ne;break}}}}var I=(0,t.createElement)("div",{className:"e-filter-div-content e-"+(["date","number"].indexOf(a)>=0?"label":a)+"-filter"+(this.parent.isDataOverflow?" "+vi:""),id:this.parent.parentID+"_"+a+"_filter_div_content",attrs:{"data-type":a,"data-fieldName":e,"data-operator":h,"data-selectedField":"olap"===this.parent.dataType&&s.length>0?s[u].value.toString():"","data-measure":this.parent.dataSourceSettings.values.length>0?this.parent.dataSourceSettings.values[p].name:"","data-value1":i&&h===i.condition&&i.value1?i.value1.toString():"","data-value2":i&&h===i.condition&&i.value2?i.value2.toString():""}}),F=(0,t.createElement)("div",{className:"e-filter-text-div"});F.innerText=this.parent.localeObj.getConstant(a+"TextContent");var L=(0,t.createElement)("div",{className:Ee+" "+(-1===g.indexOf(h)?l:"")});L.innerText=this.parent.localeObj.getConstant("And");var A=(0,t.createElement)("div",{className:"e-separator-div"}),R=(0,t.createElement)("div",{className:"e-filter-option-container-1"}),k=(0,t.createElement)("div",{className:"e-level-option-container "+("olap"===this.parent.dataType?"":l)}),j=(0,t.createElement)("div",{className:"e-measure-option-container "+(["label","date","number"].indexOf(a)>=0?l:"")}),q=(0,t.createElement)("div",{className:"e-condition-option-container"}),V=(0,t.createElement)("div",{className:"e-filter-option-container-2"}),H=(0,t.createElement)("div",{id:this.parent.parentID+"_"+a+"_level_option_container"}),U=(0,t.createElement)("div",{id:this.parent.parentID+"_"+a+"_measure_option_container"}),_=(0,t.createElement)("div",{id:this.parent.parentID+"_"+a+"_contition_option_container"}),B=(0,t.createElement)("div",{className:"e-filter-input-div-1"}),G=(0,t.createElement)("div",{className:Ie+" "+(-1===g.indexOf(h)?l:"")}),z=(0,t.createElement)("input",{id:this.parent.parentID+"_"+a+"_input_option_1",attrs:{type:"text"}}),W=(0,t.createElement)("input",{id:this.parent.parentID+"_"+a+"_input_option_2",attrs:{type:"text"}});return B.appendChild(z),G.appendChild(W),k.appendChild(H),k.appendChild(A.cloneNode(!0)),j.appendChild(U),j.appendChild(A),q.appendChild(_),R.appendChild(k),R.appendChild(j),R.appendChild(q),V.appendChild(B),V.appendChild(L),V.appendChild(G),this.createElements(i,g,U,_,z,W,n,r,p,h,a,H,s,u),I.appendChild(F),I.appendChild(R),I.appendChild(V),I},e.prototype.createElements=function(e,i,a,r,n,s,o,d,h,p,u,c,g,m){var f=this;if("olap"===this.parent.dataType){var v=new vs.DropDownList({dataSource:g,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text",iconCss:"iconClass"},index:m,cssClass:"e-level-options"+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(e){var i=f.dialogPopUp.element.querySelector(".e-selected-tab"),a=i.getAttribute("data-fieldName"),r=i.getAttribute("data-type");if(!(0,t.isNullOrUndefined)(i)){var l;f.updateInputValues(i,r,n,s),(0,gs.setStyleAndAttributes)(i,{"data-selectedField":e.value});for(var d=0,h=f.parent.dataSourceSettings.filterSettings;d<h.length;d++){var p=h[d];if(p.name===a&&p.selectedField===e.value){l=p;break}}if(l){"value"===r&&l.measure&&""!==l.measure&&(S.value=l.measure?l.measure:o[0].value),l.condition?y.value=l.condition?l.condition:"DoesNotEquals":y.value="DoesNotEquals";var u=void 0,c=void 0;"value"===r?(u=(0,t.getInstance)(n,fs.NumericTextBox),c=(0,t.getInstance)(s,fs.NumericTextBox),u&&(u.value=l.value1?parseInt(l.value1,10):void 0),c&&(c.value=l.value2?parseInt(l.value2,10):void 0)):(u=(0,t.getInstance)(n,fs.MaskedTextBox),c=(0,t.getInstance)(s,fs.MaskedTextBox),u&&(u.value=l.value1?l.value1:""),c&&(c.value=l.value2?l.value2:""))}f.updateInputValues(i,r,n,s)}}});v.isStringTemplate=!0,v.appendTo(c)}var S=new vs.DropDownList({dataSource:o,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},index:h,cssClass:Fe+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(e){var i=f.dialogPopUp.element.querySelector(".e-selected-tab");(0,t.isNullOrUndefined)(i)||(f.updateInputValues(i,u,n,s),(0,gs.setStyleAndAttributes)(i,{"data-measure":e.value}))}});S.isStringTemplate=!0,S.appendTo(a);var y=new vs.DropDownList({dataSource:d,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:p,cssClass:Le+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(e){var a=f.dialogPopUp.element.querySelector(".e-selected-tab");if(!(0,t.isNullOrUndefined)(a)){f.updateInputValues(a,u,n,s);for(var r=0,o=[Ee,Ie];r<o.length;r++){var d=o[r];i.indexOf(e.value)>=0?(0,t.removeClass)([a.querySelector("."+d)],l):(0,t.addClass)([a.querySelector("."+d)],l)}(0,gs.setStyleAndAttributes)(a,{"data-operator":e.value})}}});if(y.isStringTemplate=!0,y.appendTo(r),"date"===u){var b=new Ms.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",showClearButton:!0,value:e&&p===e.condition?"string"==typeof e.value1?new Date(e.value1):e.value1:null,change:function(e){var i=f.dialogPopUp.element.querySelector(".e-selected-tab");(0,t.isNullOrUndefined)(i)||(0,gs.setStyleAndAttributes)(i,{"data-value1":e.value,"data-value2":C.value})},width:"100%",cssClass:this.parent.cssClass}),C=new Ms.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",showClearButton:!0,value:e&&p===e.condition?"string"==typeof e.value2?new Date(e.value2):e.value2:null,change:function(e){var i=f.dialogPopUp.element.querySelector(".e-selected-tab");(0,t.isNullOrUndefined)(i)||(0,gs.setStyleAndAttributes)(i,{"data-value1":b.value,"data-value2":e.value})},width:"100%",cssClass:this.parent.cssClass});b.isStringTemplate=!0,b.appendTo(n),C.isStringTemplate=!0,C.appendTo(s)}else if("value"===u){var x=new fs.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###.##",value:e&&p===e.condition?parseInt(e.value1,10):void 0,change:function(e){var i=f.dialogPopUp.element.querySelector(".e-selected-tab");(0,t.isNullOrUndefined)(i)||(0,gs.setStyleAndAttributes)(i,{"data-value1":e.value?e.value.toString():"0","data-value2":w.value?w.value.toString():"0"})},width:"100%",cssClass:this.parent.cssClass}),w=new fs.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###.##",value:e&&p===e.condition?parseInt(e.value2,10):void 0,change:function(e){var i=f.dialogPopUp.element.querySelector(".e-selected-tab");(0,t.isNullOrUndefined)(i)||(0,gs.setStyleAndAttributes)(i,{"data-value1":x.value?x.value.toString():"0","data-value2":e.value?e.value.toString():"0"})},width:"100%",cssClass:this.parent.cssClass});x.isStringTemplate=!0,x.appendTo(n),w.isStringTemplate=!0,w.appendTo(s)}else{var T=new fs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,value:e&&p===e.condition?e.value1:"",change:function(e){var i=f.dialogPopUp.element.querySelector(".e-selected-tab");(0,t.isNullOrUndefined)(i)||(0,gs.setStyleAndAttributes)(i,{"data-value1":e.value,"data-value2":M.value})},width:"100%",cssClass:this.parent.cssClass}),M=new fs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,value:e&&p===e.condition?e.value2:"",change:function(e){var i=f.dialogPopUp.element.querySelector(".e-selected-tab");(0,t.isNullOrUndefined)(i)||(0,gs.setStyleAndAttributes)(i,{"data-value1":T.value,"data-value2":e.value})},width:"100%",cssClass:this.parent.cssClass});T.isStringTemplate=!0,T.appendTo(n),M.isStringTemplate=!0,M.appendTo(s)}},e.prototype.updateInputValues=function(e,i,a,r){var n=(0,t.getInstance)(a,"date"===i?Ms.DateTimePicker:"value"===i?fs.NumericTextBox:fs.MaskedTextBox),s=(0,t.getInstance)(r,"date"===i?Ms.DateTimePicker:"value"===i?fs.NumericTextBox:fs.MaskedTextBox),o=(0,t.isNullOrUndefined)(n.value)?"":n.value.toString(),l=(0,t.isNullOrUndefined)(s.value)?"":s.value.toString();(0,gs.setStyleAndAttributes)(e,{"data-value1":o,"data-value2":l})},e.prototype.validateTreeNode=function(e){e.node.classList.contains(l)&&(e.cancel=!0)},e.prototype.updateCheckedState=function(){var e=this.dialogPopUp.element,i=[].slice.call(this.memberTreeView.element.querySelectorAll("li")),a=e.getAttribute("data-fieldname"),r=this.getUnCheckedNodes(a),n=this.getCheckedNodes(a),s=this.allMemberSelect.element.querySelector("li").querySelector("span."+$);if(i.length>0)if(n>0){if(r>0)(0,t.removeClass)([s],ee),(0,t.addClass)([s],te),this.allMemberSelect.element.querySelector("li").setAttribute("aria-checked","false");else 0===r&&((0,t.removeClass)([s],te),(0,t.addClass)([s],ee));this.dialogPopUp.buttons[0].buttonModel.disabled=!1,e.querySelector("."+ie).removeAttribute("disabled")}else r>0&&0===n&&((0,t.removeClass)([s],[ee,te]),this.getCheckedNodes(a)===n&&(this.dialogPopUp.buttons[0].buttonModel.disabled=!0,e.querySelector("."+ie).setAttribute("disabled","disabled")));else this.dialogPopUp.buttons[0].buttonModel.disabled=!0,e.querySelector("."+ie).setAttribute("disabled","disabled")},e.prototype.getCheckedNodes=function(e){var t=this.parent.engineModule,i=[];if("olap"===this.parent.dataType&&t&&!t.fieldList[e].isHierarchy)return this.memberTreeView.getAllCheckedNodes().length;for(var a=0,r=this.parent.searchTreeItems;a<r.length;a++){var n=r[a];n.isSelected&&i.push(n)}return i.length},e.prototype.getUnCheckedNodes=function(e){var t=[],i=[],a=this.parent.engineModule;if("olap"===this.parent.dataType&&a&&!a.fieldList[e].isHierarchy)return i=this.memberTreeView.getAllCheckedNodes(),this.memberTreeView.fields.dataSource.length-i.length;for(var r=0,n=this.parent.searchTreeItems;r<n.length;r++){var s=n[r];s.isSelected||t.push(s)}return t.length},e.prototype.isExcelFilter=function(e){for(var t=!1,i=0,a=this.parent.dataSourceSettings.filters;i<a.length;i++){if(a[i].name===e){t=!0;break}}return!(t||!this.parent.dataSourceSettings.allowLabelFilter&&!this.parent.dataSourceSettings.allowValueFilter)},e.prototype.getFilterObject=function(e){var t=Di.getFilterItemByName(e,Di.cloneFilterSettings(this.parent.dataSourceSettings.filterSettings));if(t&&(["Label","Date","Number"].indexOf(t.type)>=0&&this.parent.dataSourceSettings.allowLabelFilter||"Value"===t.type&&this.parent.dataSourceSettings.allowValueFilter||["Include","Exclude"].indexOf(t.type)>=0&&this.parent.eventBase.isValidFilterItemsAvail(e,t)))return t},e.prototype.wireEvent=function(e,i){t.EventHandler.add(e,"click",this.applySorting.bind(this,i),this)},e.prototype.unWireEvent=function(e){t.EventHandler.remove(e,"click",this.applySorting)},e.prototype.closeFilterDialog=function(){this.dialogPopUp.close()},e.prototype.removeFilterDialog=function(){this.editorSearch&&!this.editorSearch.isDestroyed&&(this.editorSearch.destroy(),this.editorSearch=null),this.allowExcelLikeFilter&&this.tabObj&&!this.tabObj.isDestroyed&&(this.tabObj.destroy(),this.tabObj=null),this.dropMenu&&!this.dropMenu.isDestroyed&&(this.dropMenu.destroy(),this.dropMenu=null),this.memberTreeView&&!this.memberTreeView.isDestroyed&&(this.memberTreeView.destroy(),this.memberTreeView=null),this.allMemberSelect&&!this.allMemberSelect.isDestroyed&&(this.allMemberSelect.destroy(),this.allMemberSelect=null),document.getElementById(this.parent.parentID+"_LevelDiv-popup")&&(0,t.remove)(document.getElementById(this.parent.parentID+"_LevelDiv-popup")),this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&(this.dialogPopUp.destroy(),this.dialogPopUp=null,setTimeout(this.setFocus.bind(this))),document.getElementById(this.parent.parentID+"_EditorTreeView")&&(0,t.remove)(document.getElementById(this.parent.parentID+"_EditorTreeView"))},e.prototype.setFocus=function(){if(this.parent.control.pivotButtonModule.parentElement)for(var e=0,t=[].slice.call(this.parent.control.pivotButtonModule.parentElement.querySelectorAll(".e-pivot-button"));e<t.length;e++){var i=t[e];if(i.getAttribute("data-uid")===this.parent.control.pivotButtonModule.fieldName){i.focus();break}}},e}(),Ns=function(){function e(e){return this.currentTreeItems=[],this.savedTreeFilterPos={},this.currentTreeItemsPos={},this.searchTreeItems=[],this.isDataOverflow=!1,this.isDateField=!1,this.element=e.element,this.moduleName=e.moduleName,this.dataSourceSettings=e.dataSourceSettings,this.engineModule=e.pivotEngine,this.enableRtl=e.enableRtl,this.enableHtmlSanitizer=e.enableHtmlSanitizer,this.isAdaptive=e.isAdaptive,this.renderMode=e.renderMode,this.parentID=e.id,this.localeObj=e.localeObj,this.dataType=e.dataType,this.cssClass=e.cssClass,this.nodeStateModified=new xs(this),this.dataSourceUpdate=new ws(this),this.eventBase=new Cs(this),this.filterDialog=new Ps(this),this.errorDialog=new Ts(this),this.keyboardModule=new bs(this),this}return e.prototype.destroy=function(){this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null)},e}(),Es=function(){function e(e){this.parent=e,this.parent.commonModule=this,this.addEventListener()}return e.prototype.getModuleName=function(){return"common"},e.prototype.initiateCommonModule=function(){if(this.parent.pivotCommon)this.parent.pivotCommon.element=this.parent.element,this.parent.pivotCommon.engineModule="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.parent.pivotCommon.parentID=this.parent.element.id,this.parent.pivotCommon.dataSourceSettings=this.parent.dataSourceSettings.properties?this.parent.dataSourceSettings.properties:this.parent.dataSourceSettings,this.parent.pivotCommon.moduleName=this.parent.getModuleName(),this.parent.pivotCommon.enableRtl=this.parent.enableRtl,this.parent.pivotCommon.isAdaptive=t.Browser.isDevice,this.parent.pivotCommon.renderMode="Popup",this.parent.pivotCommon.localeObj=this.parent.localeObj,this.parent.pivotCommon.dataType=this.parent.dataType,this.parent.pivotCommon.cssClass=this.parent.cssClass;else{var e={pivotEngine:"olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,dataSourceSettings:this.parent.dataSourceSettings.properties?this.parent.dataSourceSettings.properties:this.parent.dataSourceSettings,id:this.parent.element.id,element:this.parent.element,moduleName:this.parent.getModuleName(),enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,isAdaptive:t.Browser.isDevice,renderMode:"Popup",localeObj:this.parent.localeObj,dataType:this.parent.dataType,cssClass:this.parent.cssClass};this.parent.pivotCommon=new Ns(e)}this.parent.pivotCommon.control=this.parent},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(hr,this.initiateCommonModule,this),this.parent.on(pr,this.initiateCommonModule,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(hr,this.initiateCommonModule),this.parent.off(pr,this.initiateCommonModule))},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotCommon&&(this.parent.pivotCommon.destroy(),this.parent.pivotCommon=null)},e}(),Is=(e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)},function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}),Fs=function(e,t,i,a){var r,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(n<3?r(s):n>3?r(t,i,s):r(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s},Ls=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Is(i,e),Fs([(0,t.Property)()],i.prototype,"name",void 0),Fs([(0,t.Property)()],i.prototype,"caption",void 0),Fs([(0,t.Property)("Sum")],i.prototype,"type",void 0),Fs([(0,t.Property)()],i.prototype,"axis",void 0),Fs([(0,t.Property)(!1)],i.prototype,"showNoDataItems",void 0),Fs([(0,t.Property)()],i.prototype,"baseField",void 0),Fs([(0,t.Property)()],i.prototype,"baseItem",void 0),Fs([(0,t.Property)(!0)],i.prototype,"showSubTotals",void 0),Fs([(0,t.Property)(!1)],i.prototype,"isNamedSet",void 0),Fs([(0,t.Property)(!1)],i.prototype,"isCalculatedField",void 0),Fs([(0,t.Property)(!0)],i.prototype,"showFilterIcon",void 0),Fs([(0,t.Property)(!0)],i.prototype,"showSortIcon",void 0),Fs([(0,t.Property)(!0)],i.prototype,"showRemoveIcon",void 0),Fs([(0,t.Property)(!0)],i.prototype,"showValueTypeIcon",void 0),Fs([(0,t.Property)(!0)],i.prototype,"showEditIcon",void 0),Fs([(0,t.Property)(!0)],i.prototype,"allowDragAndDrop",void 0),Fs([(0,t.Property)()],i.prototype,"dataType",void 0),Fs([(0,t.Property)(!1)],i.prototype,"expandAll",void 0),Fs([(0,t.Property)()],i.prototype,"groupName",void 0),i}(t.ChildProperty),As=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Is(t,e),t}(Ls),Rs=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Is(i,e),Fs([(0,t.Property)()],i.prototype,"backgroundColor",void 0),Fs([(0,t.Property)()],i.prototype,"color",void 0),Fs([(0,t.Property)()],i.prototype,"fontFamily",void 0),Fs([(0,t.Property)()],i.prototype,"fontSize",void 0),i}(t.ChildProperty),ks=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Is(i,e),Fs([(0,t.Property)()],i.prototype,"name",void 0),Fs([(0,t.Property)("Include")],i.prototype,"type",void 0),Fs([(0,t.Property)()],i.prototype,"items",void 0),Fs([(0,t.Property)("DoesNotEquals")],i.prototype,"condition",void 0),Fs([(0,t.Property)()],i.prototype,"value1",void 0),Fs([(0,t.Property)()],i.prototype,"value2",void 0),Fs([(0,t.Property)()],i.prototype,"measure",void 0),Fs([(0,t.Property)(1)],i.prototype,"levelCount",void 0),Fs([(0,t.Property)()],i.prototype,"selectedField",void 0),i}(t.ChildProperty),js=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Is(i,e),Fs([(0,t.Property)()],i.prototype,"measure",void 0),Fs([(0,t.Property)()],i.prototype,"label",void 0),Fs([(0,t.Property)()],i.prototype,"conditions",void 0),Fs([(0,t.Property)()],i.prototype,"value1",void 0),Fs([(0,t.Property)()],i.prototype,"value2",void 0),Fs([(0,t.Property)()],i.prototype,"style",void 0),Fs([(0,t.Property)(!0)],i.prototype,"applyGrandTotals",void 0),i}(t.ChildProperty),qs=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Is(i,e),Fs([(0,t.Property)()],i.prototype,"name",void 0),Fs([(0,t.Property)("Ascending")],i.prototype,"order",void 0),Fs([(0,t.Property)([])],i.prototype,"membersOrder",void 0),i}(t.ChildProperty),Vs=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Is(i,e),Fs([(0,t.Property)()],i.prototype,"name",void 0),Fs([(0,t.Property)()],i.prototype,"minimumFractionDigits",void 0),Fs([(0,t.Property)()],i.prototype,"maximumFractionDigits",void 0),Fs([(0,t.Property)()],i.prototype,"minimumSignificantDigits",void 0),Fs([(0,t.Property)()],i.prototype,"maximumSignificantDigits",void 0),Fs([(0,t.Property)(!0)],i.prototype,"useGrouping",void 0),Fs([(0,t.Property)()],i.prototype,"skeleton",void 0),Fs([(0,t.Property)()],i.prototype,"type",void 0),Fs([(0,t.Property)()],i.prototype,"currency",void 0),Fs([(0,t.Property)()],i.prototype,"minimumIntegerDigits",void 0),Fs([(0,t.Property)()],i.prototype,"format",void 0),i}(t.ChildProperty),Hs=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Is(i,e),Fs([(0,t.Property)()],i.prototype,"name",void 0),Fs([(0,t.Property)()],i.prototype,"groupInterval",void 0),Fs([(0,t.Property)()],i.prototype,"startingAt",void 0),Fs([(0,t.Property)()],i.prototype,"endingAt",void 0),Fs([(0,t.Property)("Date")],i.prototype,"type",void 0),Fs([(0,t.Property)()],i.prototype,"rangeInterval",void 0),Fs([(0,t.Property)()],i.prototype,"caption",void 0),Fs([(0,t.Property)()],i.prototype,"customGroups",void 0),i}(t.ChildProperty),Us=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Is(i,e),Fs([(0,t.Property)()],i.prototype,"groupName",void 0),Fs([(0,t.Property)([])],i.prototype,"items",void 0),i}(t.ChildProperty),_s=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Is(i,e),Fs([(0,t.Property)()],i.prototype,"name",void 0),Fs([(0,t.Property)()],i.prototype,"formula",void 0),Fs([(0,t.Property)()],i.prototype,"hierarchyUniqueName",void 0),Fs([(0,t.Property)()],i.prototype,"formatString",void 0),i}(t.ChildProperty),Bs=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Is(i,e),Fs([(0,t.Property)()],i.prototype,"name",void 0),Fs([(0,t.Property)()],i.prototype,"items",void 0),Fs([(0,t.Property)()],i.prototype,"delimiter",void 0),i}(t.ChildProperty),Gs=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Is(i,e),Fs([(0,t.Property)()],i.prototype,"headerText",void 0),Fs([(0,t.Property)(".")],i.prototype,"headerDelimiter",void 0),Fs([(0,t.Property)("None")],i.prototype,"sortOrder",void 0),Fs([(0,t.Property)()],i.prototype,"measure",void 0),i}(t.ChildProperty),zs=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Is(i,e),Fs([(0,t.Property)()],i.prototype,"userName",void 0),Fs([(0,t.Property)()],i.prototype,"password",void 0),i}(t.ChildProperty),Ws=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Is(i,e),Fs([(0,t.Property)("Local")],i.prototype,"mode",void 0),Fs([(0,t.Property)()],i.prototype,"catalog",void 0),Fs([(0,t.Property)()],i.prototype,"cube",void 0),Fs([(0,t.Property)()],i.prototype,"roles",void 0),Fs([(0,t.Property)("Relational")],i.prototype,"providerType",void 0),Fs([(0,t.Property)()],i.prototype,"url",void 0),Fs([(0,t.Property)(1033)],i.prototype,"localeIdentifier",void 0),Fs([(0,t.Property)()],i.prototype,"dataSource",void 0),Fs([(0,t.Collection)([],Ls)],i.prototype,"rows",void 0),Fs([(0,t.Collection)([],Ls)],i.prototype,"columns",void 0),Fs([(0,t.Collection)([],Ls)],i.prototype,"values",void 0),Fs([(0,t.Collection)([],Ls)],i.prototype,"filters",void 0),Fs([(0,t.Collection)([],Ls)],i.prototype,"fieldMapping",void 0),Fs([(0,t.Property)([])],i.prototype,"excludeFields",void 0),Fs([(0,t.Property)(!1)],i.prototype,"expandAll",void 0),Fs([(0,t.Property)("column")],i.prototype,"valueAxis",void 0),Fs([(0,t.Property)(-1)],i.prototype,"valueIndex",void 0),Fs([(0,t.Collection)([],ks)],i.prototype,"filterSettings",void 0),Fs([(0,t.Collection)([],qs)],i.prototype,"sortSettings",void 0),Fs([(0,t.Property)(!0)],i.prototype,"enableSorting",void 0),Fs([(0,t.Property)("JSON")],i.prototype,"type",void 0),Fs([(0,t.Property)(!0)],i.prototype,"allowMemberFilter",void 0),Fs([(0,t.Property)(!1)],i.prototype,"allowLabelFilter",void 0),Fs([(0,t.Property)(!1)],i.prototype,"allowValueFilter",void 0),Fs([(0,t.Property)(!0)],i.prototype,"showSubTotals",void 0),Fs([(0,t.Property)(!0)],i.prototype,"showRowSubTotals",void 0),Fs([(0,t.Property)(!0)],i.prototype,"showColumnSubTotals",void 0),Fs([(0,t.Property)("Auto")],i.prototype,"subTotalsPosition",void 0),Fs([(0,t.Property)(!0)],i.prototype,"showGrandTotals",void 0),Fs([(0,t.Property)("Bottom")],i.prototype,"grandTotalsPosition",void 0),Fs([(0,t.Property)(!0)],i.prototype,"showRowGrandTotals",void 0),Fs([(0,t.Property)(!0)],i.prototype,"showColumnGrandTotals",void 0),Fs([(0,t.Property)(!1)],i.prototype,"alwaysShowValueHeader",void 0),Fs([(0,t.Property)(!0)],i.prototype,"showHeaderWhenEmpty",void 0),Fs([(0,t.Property)(!0)],i.prototype,"showAggregationOnValueField",void 0),Fs([(0,t.Collection)([],Vs)],i.prototype,"formatSettings",void 0),Fs([(0,t.Collection)([],Bs)],i.prototype,"drilledMembers",void 0),Fs([(0,t.Complex)({},Gs)],i.prototype,"valueSortSettings",void 0),Fs([(0,t.Collection)([],_s)],i.prototype,"calculatedFieldSettings",void 0),Fs([(0,t.Collection)([],js)],i.prototype,"conditionalFormatSettings",void 0),Fs([(0,t.Property)()],i.prototype,"emptyCellsTextContent",void 0),Fs([(0,t.Collection)([],Hs)],i.prototype,"groupSettings",void 0),Fs([(0,t.Complex)({},zs)],i.prototype,"authentication",void 0),i}(t.ChildProperty),Qs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ys=function(e,t,i,a){var r,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(n<3?r(s):n>3?r(t,i,s):r(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s},Ks=(function(e){function i(){return null!==e&&e.apply(this,arguments)||this}Qs(i,e),Ys([(0,t.Property)("Row")],i.prototype,"mode",void 0),Ys([(0,t.Property)("Flow")],i.prototype,"cellSelectionMode",void 0),Ys([(0,t.Property)("Single")],i.prototype,"type",void 0),Ys([(0,t.Property)(!1)],i.prototype,"checkboxOnly",void 0),Ys([(0,t.Property)(!1)],i.prototype,"persistSelection",void 0),Ys([(0,t.Property)("Default")],i.prototype,"checkboxMode",void 0),Ys([(0,t.Property)(!1)],i.prototype,"enableSimpleMultiRowSelection",void 0)}(t.ChildProperty),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Qs(i,e),Ys([(0,t.Property)("auto")],i.prototype,"height",void 0),Ys([(0,t.Property)("auto")],i.prototype,"width",void 0),Ys([(0,t.Property)("Both")],i.prototype,"gridLines",void 0),Ys([(0,t.Property)(!1)],i.prototype,"allowTextWrap",void 0),Ys([(0,t.Property)(!1)],i.prototype,"allowReordering",void 0),Ys([(0,t.Property)(!0)],i.prototype,"allowResizing",void 0),Ys([(0,t.Property)(!0)],i.prototype,"allowAutoResizing",void 0),Ys([(0,t.Property)(null)],i.prototype,"rowHeight",void 0),Ys([(0,t.Property)(110)],i.prototype,"columnWidth",void 0),Ys([(0,t.Property)("Compact")],i.prototype,"layout",void 0),Ys([(0,t.Property)("Ellipsis")],i.prototype,"clipMode",void 0),Ys([(0,t.Property)(!1)],i.prototype,"allowSelection",void 0),Ys([(0,t.Property)(-1)],i.prototype,"selectedRowIndex",void 0),Ys([(0,t.Property)({mode:"Row",cellSelectionMode:"Flow",type:"Single"})],i.prototype,"selectionSettings",void 0),Ys([(0,t.Property)({wrapMode:"Both"})],i.prototype,"textWrapSettings",void 0),Ys([(0,t.Property)("AllPages")],i.prototype,"printMode",void 0),Ys([(0,t.Property)()],i.prototype,"contextMenuItems",void 0),Ys([(0,t.Event)()],i.prototype,"beforeCopy",void 0),Ys([(0,t.Event)()],i.prototype,"printComplete",void 0),Ys([(0,t.Event)()],i.prototype,"beforePrint",void 0),Ys([(0,t.Event)()],i.prototype,"beforePdfExport",void 0),Ys([(0,t.Event)()],i.prototype,"beforeExcelExport",void 0),Ys([(0,t.Event)()],i.prototype,"contextMenuOpen",void 0),Ys([(0,t.Event)()],i.prototype,"contextMenuClick",void 0),Ys([(0,t.Event)()],i.prototype,"queryCellInfo",void 0),Ys([(0,t.Event)()],i.prototype,"headerCellInfo",void 0),Ys([(0,t.Event)()],i.prototype,"rowSelecting",void 0),Ys([(0,t.Event)()],i.prototype,"rowSelected",void 0),Ys([(0,t.Event)()],i.prototype,"rowDeselecting",void 0),Ys([(0,t.Event)()],i.prototype,"rowDeselected",void 0),Ys([(0,t.Event)()],i.prototype,"cellSelecting",void 0),Ys([(0,t.Event)()],i.prototype,"cellSelected",void 0),Ys([(0,t.Event)()],i.prototype,"cellDeselecting",void 0),Ys([(0,t.Event)()],i.prototype,"cellDeselected",void 0),Ys([(0,t.Event)()],i.prototype,"resizeStart",void 0),Ys([(0,t.Event)()],i.prototype,"resizing",void 0),Ys([(0,t.Event)()],i.prototype,"resizeStop",void 0),Ys([(0,t.Event)()],i.prototype,"pdfHeaderQueryCellInfo",void 0),Ys([(0,t.Event)()],i.prototype,"pdfQueryCellInfo",void 0),Ys([(0,t.Event)()],i.prototype,"excelHeaderQueryCellInfo",void 0),Ys([(0,t.Event)()],i.prototype,"excelQueryCellInfo",void 0),Ys([(0,t.Event)()],i.prototype,"columnDragStart",void 0),Ys([(0,t.Event)()],i.prototype,"columnDrag",void 0),Ys([(0,t.Event)()],i.prototype,"columnDrop",void 0),Ys([(0,t.Event)()],i.prototype,"columnRender",void 0),i}(t.ChildProperty)),Xs=function(){function e(e){this.keyConfigs={tab:"tab",shiftTab:"shift+tab",enter:"enter",shiftUp:"shift+upArrow",shiftDown:"shift+downArrow",shiftLeft:"shift+leftArrow",shiftRight:"shift+rightArrow",shiftEnter:"shift+enter",ctrlEnter:"ctrl+enter",upArrow:"upArrow",downArrow:"downArrow",leftArrow:"leftArrow",rightArrow:"rightArrow",escape:"escape",ctrlShiftF:"ctrl+shift+f"},this.parent=e,this.event=void 0,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.pivotViewKeyboardModule=new t.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return e.prototype.keyActionHandler=function(e){switch(e.action){case"tab":this.processTab(e);break;case"shiftTab":this.processShiftTab(e);break;case"enter":case"shiftEnter":case"ctrlEnter":this.processEnter(e);break;case"shiftUp":case"shiftDown":case"shiftLeft":case"shiftRight":case"upArrow":case"downArrow":case"leftArrow":case"rightArrow":this.processSelection(e);break;case"escape":this.clearSelection();break;case"ctrlShiftF":this.toggleFieldList(e)}},e.prototype.getNextButton=function(e){var i=this.allpivotButtons(e);if((0,t.removeClass)(i,"e-btn-focused"),this.parent.grid.element.querySelector("."+A))for(var a=i.length,r=0;r<a;r++)if(i[r].getAttribute("data-uid")===e.getAttribute("data-uid"))return i[r+1]?i[r+1]:e;return e},e.prototype.getPrevButton=function(e){var i=this.allpivotButtons(e);if((0,t.removeClass)(i,"e-btn-focused"),this.parent.grid.element.querySelector("."+A))for(var a=i.length,r=0;r<a;r++)if(i[r].getAttribute("data-uid")===e.getAttribute("data-uid"))return i[r-1]?i[r-1]:e;return e},e.prototype.allpivotButtons=function(e){var i=[];if(e&&this.parent.showGroupingBar){var a=(0,t.closest)(e,"."+di),r=(0,t.closest)(e,"."+ui),n=(0,t.closest)(e,"."+si),s=e.classList.contains(_e),o=void 0,l=void 0,d=void 0;if(null!==a?l=a.classList.contains(di):null!==r?d=r.classList.contains(ui):null!==n&&(o=n.classList.contains(si)),l||d||s){var h=[].slice.call(this.parent.element.querySelector("."+di).querySelectorAll("."+A)),p=[].slice.call(this.parent.element.querySelector("."+ui).querySelectorAll("."+A));i=h.concat(p)}else o&&(i=[].slice.call(this.parent.element.querySelector("."+si).querySelectorAll("."+A)))}return i},e.prototype.processTab=function(e){var i=e.target;if(i&&((0,t.closest)(i,"."+A)||i.classList.contains("e-group-row"))){if(this.parent.grid){var a=this.parent.grid.serviceLocator.getService("focus");if(i.classList.contains("e-group-row")&&i.querySelector(".e-btn-focused"))i=i.querySelector(".e-btn-focused");else if(i.classList.contains("e-group-row")){a.focus();var r=a.getFocusedElement();return(0,t.addClass)([r],["e-focused","e-focus"]),r.setAttribute("tabindex","0"),void e.preventDefault()}var n=this.getNextButton(i);if(n.getAttribute("data-uid")!==i.getAttribute("data-uid"))this.parent.element.querySelector(".e-focused")?(this.parent.element.querySelector(".e-focused").setAttribute("tabindex","-1"),(0,t.removeClass)(this.parent.element.querySelectorAll(".e-focus"),"e-focus"),(0,t.removeClass)(this.parent.element.querySelectorAll(".e-focused"),"e-focused"),a.setFocusedElement(this.parent.element.querySelector(".e-headercell")),this.parent.element.querySelector(".e-headercell").setAttribute("tabindex","0")):a.currentInfo.skipAction=!0,(0,t.addClass)([n],"e-btn-focused"),n.focus();else{a.focus();r=a.getFocusedElement();(0,t.addClass)([r],["e-focused","e-focus"]),r.setAttribute("tabindex","0")}return void e.preventDefault()}}else if(!this.parent.showGroupingBar&&this.parent.showFieldList&&i&&(0,t.closest)(i,"."+f)){if(this.parent.grid){(a=this.parent.grid.serviceLocator.getService("focus")).focus();r=a.getFocusedElement();return(0,t.addClass)([r],["e-focused","e-focus"]),r.setAttribute("tabindex","0"),void e.preventDefault()}}else if(this.parent.showGroupingBar||this.parent.showFieldList||!i||!(0,t.closest)(i,"."+mt)||(0,t.closest)(i,".e-popup.e-popup-open")){if(i&&(0,t.closest)(i,"."+Xt)&&this.parent.toolbar&&this.parent.toolbarModule)clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout((function(){(0,t.removeClass)((0,t.closest)(i,"."+Xt).querySelectorAll(".e-menu-item.e-focused"),"e-focused"),document.activeElement&&document.activeElement.classList.contains("e-menu-item")&&(0,t.addClass)([document.activeElement],"e-focused")}));else if(i.classList.contains("e-numerictextbox")){(a=this.parent.grid.serviceLocator.getService("focus")).focus();r=a.getFocusedElement();(0,t.removeClass)([r],["e-focused","e-focus"]),r.setAttribute("tabindex","0"),e.preventDefault()}}else if(this.parent.grid){var s=(0,t.closest)(i,"."+mt),a=this.parent.grid.serviceLocator.getService("focus"),o=[].slice.call(s.getElementsByTagName("tr"));if(i.innerHTML!==o[o.length-1].lastChild.innerHTML){a.focus();var r=a.getFocusedElement();return(0,t.addClass)([r],["e-focused","e-focus"]),r.setAttribute("tabindex","0"),void e.preventDefault()}a.currentInfo.skipAction=!0}},e.prototype.processShiftTab=function(e){var i=e.target;if(i&&((0,t.closest)(i,"."+A)||i.classList.contains("e-group-row"))){if(this.parent.grid){var a=this.parent.grid.serviceLocator.getService("focus");if(i.classList.contains("e-group-row")&&i.querySelector(".e-btn-focused"))i=i.querySelector(".e-btn-focused");else if(i.classList.contains("e-group-row")){i=this.parent.element.querySelector(".e-btn-focused")?this.parent.element.querySelector(".e-btn-focused"):this.parent.element.querySelector("."+di);var r=this.allpivotButtons(i);if(r.length>0&&r[r.length-1])return a.currentInfo.skipAction=!0,r[r.length-1].focus(),(0,t.removeClass)(r,"e-btn-focused"),(0,t.addClass)([r[r.length-1]],"e-btn-focused"),void e.preventDefault()}var n=this.getPrevButton(i);if(n.getAttribute("data-uid")!==i.getAttribute("data-uid"))return a.currentInfo.skipAction=!0,n.focus(),void e.preventDefault()}}else if(i&&this.parent.grid&&(i.classList.contains("e-movablefirst")||i.classList.contains("e-rowsheader")&&(0,t.closest)(i,"tr").getAttribute("data-uid")===this.parent.grid.element.querySelector(".e-frozencontent tr").getAttribute("data-uid"))){a=this.parent.grid.serviceLocator.getService("focus");if(i.classList.contains("e-movablefirst")){i=this.parent.element.querySelector("."+ue+" .e-btn-focused")?this.parent.element.querySelector("."+ue+" .e-btn-focused"):this.parent.element.querySelector("."+ue);var s=a.getFocusedElement();(0,t.removeClass)([s],["e-focused","e-focus"])}var o=this.allpivotButtons(i);if(o.length>0)return a.currentInfo.skipAction=!0,setTimeout((function(){o[o.length-1].focus()})),(0,t.removeClass)(o,"e-btn-focused"),(0,t.addClass)([o[o.length-1]],"e-btn-focused"),void e.preventDefault()}else if(i&&(0,t.closest)(i,"."+Xt)&&this.parent.toolbar&&this.parent.toolbarModule)clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout((function(){(0,t.removeClass)((0,t.closest)(i,"."+Xt).querySelectorAll(".e-menu-item.e-focused"),"e-focused"),document.activeElement&&document.activeElement.classList.contains("e-menu-item")&&(0,t.addClass)([document.activeElement],"e-focused")}));else if(i.classList.contains("e-numerictextbox")){(a=this.parent.grid.serviceLocator.getService("focus")).focus();s=a.getFocusedElement();(0,t.removeClass)([s],["e-focused","e-focus"]),s.setAttribute("tabindex","0"),e.preventDefault()}},e.prototype.processEnter=function(e){var i=e.target;if(i&&(0,t.closest)(i,"."+gt)){var a=this.parent.grid.serviceLocator.getService("focus");if(13!==e.keyCode||e.shiftKey||e.ctrlKey)if(13===e.keyCode&&e.shiftKey&&!e.ctrlKey){if(this.parent.enableValueSorting){this.event=e,i.click(),a.focus();r=a.getFocusedElement();(0,t.addClass)([r],["e-focused","e-focus"]),r.setAttribute("tabindex","0")}}else 13===e.keyCode&&!e.shiftKey&&e.ctrlKey&&this.parent.hyperlinkSettings&&i.querySelector("a")&&i.querySelector("a").click();else if(i.querySelector("."+o)){this.event=e,i.querySelector("."+o).click(),a.focus();var r=a.getFocusedElement();(0,t.addClass)([r],["e-focused","e-focus"]),r.setAttribute("tabindex","0")}else if(i.classList.contains("e-valuescontent"))i.dispatchEvent(new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0})),i.querySelector(".e-numerictextbox")&&i.click();else if(i.classList.contains("e-numerictextbox")){a.focus();var r=a.getFocusedElement();(0,t.removeClass)([r],["e-focused","e-focus"])}e.preventDefault()}else;},e.prototype.clearSelection=function(){var e=this.parent;(0,t.removeClass)(e.element.querySelectorAll("."+Rt+",."+kt),[kt,Rt,Ut]),this.parent.renderModule.selected()},e.prototype.processSelection=function(e){var i=e.target;if(this.parent.grid&&this.parent.gridSettings.allowSelection&&"Row"!==this.parent.gridSettings.selectionSettings.mode&&!i.classList.contains("e-numerictextbox")){var a,r=this.parent,n=parseInt(e.target.getAttribute("aria-colindex"),10)-1,s=Number(e.target.getAttribute("index"));if("TH"!==i.nodeName&&"TD"!==i.nodeName||(a="shiftUp"===e.action||"upArrow"===e.action?0===s||0===n||"TH"!==i.nodeName&&r.renderModule.rowStartPos!==s?null:this.getParentElement(r,a,n,s-1):"shiftDown"===e.action||"downArrow"===e.action?r.element.querySelector('th[aria-colindex="'+(n+1)+'"][index="'+(s+1)+'"]'):"shiftLeft"===e.action||"leftArrow"===e.action?e.target.previousSibling:e.target.nextSibling),(0,t.isNullOrUndefined)(a))"upArrow"===e.action?(a=r.element.querySelector('[aria-colindex="'+(n+1)+'"][index="'+(s-1)+'"]'),s--):"downArrow"===e.action&&(a=r.element.querySelector('[aria-colindex="'+(n+1)+'"][index="'+(s+1)+'"]'),s++),(0,t.isNullOrUndefined)(a)||r.clearSelection(a,e);else if("Both"===r.gridSettings.selectionSettings.mode&&a.classList.contains(Ht))r.clearSelection(a,e);else{n=parseInt(a.getAttribute("aria-colindex"),10)-1,s=Number(a.getAttribute("index"));var o=Number(a.getAttribute("aria-colspan"));r.clearSelection(a,e);var l={cancel:!1,isCellClick:!0,currentCell:a,data:r.pivotValues[s][n]};r.trigger(ta,l,(function(t){t.cancel||r.applyColumnSelection(e,a,n,n+(o>0?o-1:0),s)}))}}else if(i&&(37===e.keyCode||38===e.keyCode)&&this.parent&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&!i.classList.contains("e-numerictextbox")){if(this.parent.grid&&this.parent.element.querySelector(".e-frozenheader")&&this.parent.element.querySelector(".e-frozenheader").querySelectorAll(".e-focus").length>0)return(0,t.removeClass)(this.parent.element.querySelector(".e-frozenheader").querySelectorAll(".e-focus"),"e-focus"),(0,t.removeClass)(this.parent.element.querySelector(".e-frozenheader").querySelectorAll(".e-focused"),"e-focused"),this.parent.element.querySelector(".e-headercell").setAttribute("tabindex","-1"),this.parent.grid.serviceLocator.getService("focus").setFocusedElement(i),(0,t.addClass)([i],["e-focused","e-focus"]),i.setAttribute("tabindex","0"),i.focus(),void e.preventDefault()}else!i.classList.contains("e-numerictextbox")||"rightArrow"!==e.action&&"leftArrow"!==e.action||i.click()},e.prototype.getParentElement=function(e,t,i,a){for(;!t;)t=e.element.querySelector('[aria-colindex="'+(i+1)+'"][index="'+a+'"]'),i--;return t},e.prototype.toggleFieldList=function(e){if(this.parent&&!this.parent.isDestroyed&&this.parent.showFieldList&&this.parent.pivotFieldListModule&&!this.parent.pivotFieldListModule.isDestroyed&&this.parent.element.querySelector("."+f)){if(!this.parent.element.querySelector("."+f).classList.contains(d))return this.parent.element.querySelector("."+f).click(),void e.preventDefault();this.parent.element.querySelector("."+f).classList.contains(d)&&this.parent.pivotFieldListModule.dialogRenderer&&this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog&&!this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog.isDestroyed&&this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog.hide()}},e.prototype.destroy=function(){this.pivotViewKeyboardModule&&this.pivotViewKeyboardModule.destroy()},e}(),Js=function(){function e(e){this.parent=e,this.parent.contextMenuModule=this}return e.prototype.render=function(){this.renderContextMenu()},e.prototype.renderContextMenu=function(){var e=[{text:this.parent.localeObj.getConstant("addToFilter"),id:this.parent.element.id+"_Filters"},{text:this.parent.localeObj.getConstant("addToRow"),id:this.parent.element.id+"_Rows"},{text:this.parent.localeObj.getConstant("addToColumn"),id:this.parent.element.id+"_Columns"},{text:this.parent.localeObj.getConstant("addToValue"),id:this.parent.element.id+"_Values"}],i={cssClass:"e-pivot-context-menu"+(this.parent.cssClass?" "+this.parent.cssClass:""),items:e,enableRtl:this.parent.enableRtl,locale:this.parent.locale,beforeOpen:this.onBeforeMenuOpen.bind(this),select:this.onSelectContextMenu.bind(this)},a=(0,t.createElement)("ul",{id:this.parent.element.id+"_PivotContextMenu"});this.parent.element.appendChild(a),this.menuObj=new ms.ContextMenu(i),this.menuObj.isStringTemplate=!0,this.menuObj.appendTo(a)},e.prototype.onBeforeMenuOpen=function(e){var i=[].slice.call(e.element.querySelectorAll("li")),a="olap"===this.parent.dataType?this.fieldElement.getAttribute("data-type"):this.fieldElement.querySelector("."+k).getAttribute("data-type");if((0,t.removeClass)(i,vt),"CalculatedField"===a||"isMeasureFieldsAvail"===a)for(var r=0,n=i;r<n.length;r++){(u=n[r]).textContent!==this.parent.localeObj.getConstant("addToValue")&&(0,t.addClass)([u],vt)}else if("isMeasureAvail"===a)for(var s=0,o=i;s<o.length;s++){(u=o[s]).textContent!==this.parent.localeObj.getConstant("addToRow")&&u.textContent!==this.parent.localeObj.getConstant("addToColumn")&&(0,t.addClass)([u],vt)}else if("olap"===this.parent.dataType)for(var l=0,d=i;l<d.length;l++){if((u=d[l]).textContent===this.parent.localeObj.getConstant("addToValue")){(0,t.addClass)([u],vt);break}}else if("true"===this.fieldElement.getAttribute("isvalue"))for(var h=0,p=i;h<p.length;h++){var u;(u=p[h]).textContent!==this.parent.localeObj.getConstant("addToValue")&&u.textContent!==this.parent.localeObj.getConstant("addToFilter")||(0,t.addClass)([u],vt)}},e.prototype.onSelectContextMenu=function(e){if(null!==e.element.textContent){var t=this.fieldElement.getAttribute("data-uid"),i=e.item.id.replace(this.parent.element.id+"_","").toLowerCase();this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.dataSourceUpdate.btnElement=this.fieldElement,this.parent.pivotCommon.dataSourceUpdate.updateDataSource(t,i,-1),this.parent.updateDataSource(!0),this.fieldElement=void 0}},e.prototype.destroy=function(){this.parent.isDestroyed&&this.menuObj&&!this.menuObj.isDestroyed&&(this.menuObj.destroy(),(0,t.select)("#"+this.parent.element.id+"_PivotContextMenu",document)&&(0,t.remove)((0,t.select)("#"+this.parent.element.id+"_PivotContextMenu",document)))},e}(),Zs=function(){function e(e){this.previousValues={top:0,left:0},this.frozenPreviousValues={top:0,left:0},this.eventType="",this.isFireFox=t.Browser.userAgent.toLowerCase().indexOf("firefox")>-1,this.isScrolling=!1,this.scrollingDirection="Up",this.parent=e,this.addInternalEvents()}return e.prototype.getModuleName=function(){return"virtualscroll"},e.prototype.addInternalEvents=function(){this.parent.isDestroyed||this.parent.on(mr,this.wireEvents,this)},e.prototype.wireEvents=function(){if(this.engineModule="pivot"===this.parent.dataType?this.parent.engineModule:this.parent.olapEngineModule,"Chart"!==this.parent.displayOption.view){var e=this.parent.element.querySelector("."+Ft),i=this.parent.element.querySelector("."+zt),a=this.parent.element.querySelector("."+At),r=i.querySelector("."+It);if(t.EventHandler.clearEvents(e),this.isFireFox&&t.EventHandler.clearEvents(a),this.engineModule){var n=this.parent.isAdaptive?e:i.querySelector("."+It);t.EventHandler.add(n,"scroll touchmove pointermove",this.onHorizondalScroll(a,e),this),t.EventHandler.add(e.parentElement,"scroll wheel touchmove pointermove",this.onHorizondalScroll(a,e),this),t.EventHandler.add(e.parentElement,"scroll wheel touchmove pointermove keyup keydown",this.onVerticalScroll(e.parentElement,e),this),this.isFireFox?(t.EventHandler.add(n,"mouseup touchend scroll",this.common(a,e,e),this),this.parent.isAdaptive||t.EventHandler.add(e.parentElement,"mouseup touchend scroll",this.common(a,e.parentElement,e),this)):(t.EventHandler.add(n,"mouseup touchend",this.common(a,e,e),this),this.parent.isAdaptive||t.EventHandler.add(e.parentElement,"mouseup touchend",this.common(a,e.parentElement,e),this)),t.EventHandler.add(r,"scroll",this.onCustomScrollbarScroll(e,a),this),t.EventHandler.add(e,"scroll",this.onCustomScrollbarScroll(r,a),this),t.EventHandler.add(a,"scroll",this.onCustomScrollbarScroll(r,e),this),t.EventHandler.add(a,"touchstart pointerdown",this.setPageXY(),this),t.EventHandler.add(a,"touchmove pointermove",this.onTouchScroll(a,e),this),t.EventHandler.add(e,"touchstart pointerdown",this.setPageXY(),this),t.EventHandler.add(e,"touchmove pointermove",this.onTouchScroll(a,e),this)}this.parent.grid.on("check-scroll-reset",(function(e){e.cancel=!0})),this.parent.grid.on("prevent-frozen-scroll-refresh",(function(e){e.cancel=!0})),this.parent.grid.isPreventScrollEvent=!0}},e.prototype.onWheelScroll=function(e){var t=this,i=e;return function(e){var a=i.scrollTop+(1===e.deltaMode?30*e.deltaY:e.deltaY);t.frozenPreviousValues.top!==a&&(e.preventDefault(),t.frozenPreviousValues.top=a,t.eventType=e.type)}},e.prototype.getPointXY=function(e){var t={x:0,y:0};return e.touches&&e.touches.length?(t.x=e.touches[0].pageX,t.y=e.touches[0].pageY):(t.x=e.pageX,t.y=e.pageY),t},e.prototype.onCustomScrollbarScroll=function(e,t){var i=this,a=e,r=t;return function(e){if(null!==i.parent.element.querySelector("."+R).querySelector("tbody")){var t=e.target,n=t.scrollLeft;i.previousValues.left===n||i.isFireFox&&t.classList.contains(At)||(a.scrollLeft=n,r.scrollLeft=n,i.parent.isDestroyed)}}},e.prototype.onTouchScroll=function(e,t){var i=this,a=t;return function(r){if("mouse"!==r.pointerType){var n=i.getPointXY(r),s=i.parent.element.querySelector("."+gt+" ."+R).scrollTop+(i.pageXY.y-n.y),o=i.parent.isAdaptive?t:a.parentElement.parentElement.querySelector("."+It),l=o.scrollLeft+(i.pageXY.x-n.x);i.frozenPreviousValues.left===l||l<0||(e.scrollLeft=l,o.scrollLeft=l,i.pageXY.x=n.x,i.frozenPreviousValues.left=l,i.frozenPreviousValues.top===s||s<0||(i.pageXY.y=n.y,i.frozenPreviousValues.top=s,i.eventType=r.type))}}},e.prototype.update=function(e,i,a,r,n,s){var o=this,l=this.parent.element.querySelector("."+Ft);this.parent.isScrolling=!0;var d="pivot"===this.parent.dataType?this.parent.engineModule:this.parent.olapEngineModule,h={dataSourceSettings:Di.getClonedDataSourceSettings(this.parent.dataSourceSettings)},p=this.parent.virtualScrollSettings&&this.parent.virtualScrollSettings.allowSinglePage&&"pivot"===this.parent.dataType,u=this.parent.engineModule?this.parent.engineModule.viewportPageCount:3;if(this.parent.pageSettings&&d.pageSettings){if("vertical"===this.direction){var c=s.parentElement.scrollHeight-(e+s.parentElement.offsetHeight),g="pivot"===this.parent.dataType&&"row"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.values.length:1,m=this.parent.pageSettings.rowPageSize*g*this.parent.gridSettings.rowHeight,f="Up"===this.scrollingDirection?Math.ceil(e/m):Math.ceil(e/m)-1;if(f+=p&&c<=0?1:0,(this.parent.scrollPosObject.vertical===f||d.pageSettings.rowPageSize>=d.rowCount||l&&l.scrollHeight<l.parentElement.clientHeight*u)&&!p)return;this.parent.actionObj.actionName=cr,p&&this.parent.grid&&this.parent.grid.element.querySelector(".e-spinner-inner")&&(0,t.addClass)([this.parent.grid.element.querySelector(".e-spinner-inner")],[bi]),this.parent.actionBeginMethod(),p||this.parent.showWaitingPopup(),this.parent.scrollPosObject.vertical=f,this.parent.pageSettings.currentRowPage=d.pageSettings.currentRowPage=f>1?f:1;var v=0;this.parent.trigger(Ii,h,(function(){"pivot"===o.parent.dataType?"Server"===o.parent.dataSourceSettings.mode?o.parent.getEngine("onScroll",null,null,null,null,null,null):(o.parent.engineModule.generateGridData(o.parent.dataSourceSettings,!0,!1,o.parent.engineModule.headerCollection,!0),v=o.parent.engineModule.rowStartPos):(o.parent.olapEngineModule.scrollPage(),v=o.parent.olapEngineModule.pageRowStartPos),o.enginePopulatedEventMethod(d)}));var S=m*Math.ceil(v/(this.parent.pageSettings.rowPageSize*g))-d.rowFirstLvl*g*this.parent.gridSettings.rowHeight;this.parent.scrollPosObject.verticalSection=S}else{var y=r.scrollWidth-(r.scrollLeft+r.offsetWidth),b="pivot"===this.parent.dataType&&"column"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.values.length:1,C=(m=this.parent.pageSettings.columnPageSize*b*this.parent.gridSettings.columnWidth,f=Math.ceil(Math.abs(i)/m),this.parent.virtualScrollSettings&&this.parent.virtualScrollSettings.allowSinglePage&&"pivot"===this.parent.dataType);if(f+=C&&y<=0?1:0,(this.parent.scrollPosObject.horizontal===f||l&&l.scrollWidth<l.parentElement.clientWidth*u)&&!C)return;this.parent.actionObj.actionName=gr,C&&this.parent.grid&&this.parent.grid.element.querySelector(".e-spinner-inner")&&((0,t.addClass)([this.parent.grid.element.querySelector(".e-spinner-inner")],[bi]),n&&(0,t.removeClass)([n,s],["e-virtual-pivot-content"])),this.parent.actionBeginMethod(),C||this.parent.showWaitingPopup();var x=this.parent;x.scrollPosObject.horizontal=f,this.parent.pageSettings.currentColumnPage=d.pageSettings.currentColumnPage=f>1?f:1;var w=0;this.parent.trigger(Ii,h,(function(){"pivot"===x.dataType?"Server"===o.parent.dataSourceSettings.mode?o.parent.getEngine("onScroll",null,null,null,null,null,null):(x.engineModule.generateGridData(x.dataSourceSettings,!0,!1,x.engineModule.headerCollection),w=x.engineModule.colStartPos):(x.olapEngineModule.scrollPage(),w=x.olapEngineModule.pageColStartPos),o.enginePopulatedEventMethod(d)}));S=m*Math.ceil(w/(x.pageSettings.columnPageSize*b))-d.colFirstLvl*b*x.gridSettings.columnWidth;x.scrollPosObject.horizontalSection=S}this.parent.actionObj.actionName=this.parent.getActionCompleteName(),this.parent.actionObj.actionName&&this.parent.actionCompleteMethod()}},e.prototype.enginePopulatedEventMethod=function(e,t){var i=this,a=t||this.parent,r={dataSourceSettings:a.dataSourceSettings,pivotValues:e.pivotValues};a.trigger(Fi,r,(function(e){i.parent.pivotValues=e.pivotValues}))},e.prototype.setPageXY=function(){var e=this;return function(t){"mouse"!==t.pointerType&&(e.pageXY=e.getPointXY(t))}},e.prototype.common=function(e,i,a){var r=this;return function(n){var s=r.parent.virtualScrollSettings&&r.parent.virtualScrollSettings.allowSinglePage&&"pivot"===r.parent.dataType;if(r.isScrolling||!s){r.isScrolling=!1;var o=r.parent.isAdaptive?i:(0,t.closest)(i,"."+zt).querySelector("."+It);s&&("vertical"===r.direction?r.parent.element.querySelector("."+yi)&&((0,t.addClass)([a],["e-virtual-pivot-content"]),(0,t.removeClass)([r.parent.element.querySelector("."+yi)],[bi])):r.parent.element.querySelector("."+yi)&&((0,t.addClass)([e,i],["e-virtual-pivot-content"]),(0,t.removeClass)([r.parent.element.querySelector("."+yi)],[bi]))),r.update(r.parent.element.querySelector("."+gt+" ."+R).scrollTop*r.parent.verticalScrollScale,o.scrollLeft*r.parent.horizontalScrollScale,n,o,e,i)}}},e.prototype.onHorizondalScroll=function(e,i){var a,r=this,n=this.parent.isAdaptive?i:(0,t.closest)(i,"."+zt).querySelector("."+It),s=Math.abs(n.scrollLeft),o=s*this.parent.horizontalScrollScale,l=o-this.parent.scrollPosObject.horizontalSection-s;return l=this.parent.enableRtl?l:-l,"none"!==n.style.display&&this.alignFreezedCells(l,!1),function(d){if(s=Math.abs(n.scrollLeft),o=s*r.parent.horizontalScrollScale,"wheel"!==d.type&&"touchmove"!==d.type&&"wheel"!==r.eventType&&"touchmove"!==r.eventType||(clearTimeout(a),a=setTimeout((function(){o="touchmove"===d.type?s:o,r.update(i.parentElement.scrollTop*r.parent.verticalScrollScale,o,d,n,e,i)}),300)),r.previousValues.left!==o){r.parent.scrollDirection=r.direction="horizondal",r.isScrolling=!0,l=o-r.parent.scrollPosObject.horizontalSection-s,l=r.parent.enableRtl?l:-l;var h=i.querySelector("."+He).style.transform.split(",").length>1?i.querySelector("."+He).style.transform.split(",")[1].trim():"0px)";s<r.parent.scrollerBrowserLimit&&((0,t.setStyleAttribute)(i.querySelector("."+He),{transform:"translate("+l+"px,"+h}),(0,t.setStyleAttribute)(e.querySelector("."+He),{transform:"translate("+l+"px,0px)"}),r.alignFreezedCells(l,!1));var p=r.parent.scrollPosObject.horizontalSection>o?-(r.parent.scrollPosObject.horizontalSection-o):o+(e.offsetWidth-e.querySelector(".e-headercell.e-leftfreeze").offsetWidth)-(r.parent.scrollPosObject.horizontalSection+(i.querySelector("."+He).offsetWidth-i.querySelector("."+He).querySelector(".e-leftfreeze.e-rowsheader").offsetWidth)),u=Math.ceil(r.parent.scrollPosObject.horizontalSection/r.parent.horizontalScrollScale)<r.parent.scrollerBrowserLimit;if(r.parent.scrollPosObject.horizontalSection>o||p>1&&u){r.parent.virtualScrollSettings&&r.parent.virtualScrollSettings.allowSinglePage&&"pivot"===r.parent.dataType&&r.parent.element.querySelector("."+yi)&&((0,t.addClass)([e,i],["e-virtual-pivot-content"]),(0,t.removeClass)([r.parent.element.querySelector("."+yi)],[bi])),o>e.clientWidth?(r.parent.scrollPosObject.left<1&&(r.parent.scrollPosObject.left=e.clientWidth),r.parent.scrollPosObject.left=r.parent.scrollPosObject.left-50,p=r.parent.scrollPosObject.horizontalSection>o?p-r.parent.scrollPosObject.left:p+r.parent.scrollPosObject.left):p=-r.parent.scrollPosObject.horizontalSection,l=-(o-(r.parent.scrollPosObject.horizontalSection+p)-(0,t.closest)(i,"."+zt).querySelector("."+It).scrollLeft);var c=r.parent.gridSettings.columnWidth*r.engineModule.columnCount;c>r.parent.scrollerBrowserLimit&&(r.parent.horizontalScrollScale=c/r.parent.scrollerBrowserLimit,c=r.parent.scrollerBrowserLimit),l>c&&l>o&&(l=o,p=0),(0,t.setStyleAttribute)(i.querySelector("."+He),{transform:"translate("+l+"px,"+h}),(0,t.setStyleAttribute)(e.querySelector("."+He),{transform:"translate("+l+"px,0px)"}),r.alignFreezedCells(l,!1),r.parent.scrollPosObject.horizontalSection=r.parent.scrollPosObject.horizontalSection+p}var g=n.scrollWidth-(s+(n.offsetWidth-r.parent.element.querySelector("."+gt).querySelector("."+Be+"."+Si).offsetWidth));if(g<=0){var m=i.querySelector("."+Et);m.style.display="none";var f=i.scrollWidth-(i.scrollLeft+i.offsetWidth);m.style.display="";var v=i.scrollWidth-(i.scrollLeft+i.offsetWidth);r.parent.scrollPosObject.horizontalSection-=f>g?f:-v,l=s>r.parent.scrollerBrowserLimit?Number(i.querySelector("."+He).style.transform.split(",")[0].split("px")[0].trim()):-(s*r.parent.horizontalScrollScale-r.parent.scrollPosObject.horizontalSection-s),(0,t.setStyleAttribute)(i.querySelector("."+He),{transform:"translate("+l+"px,"+h}),(0,t.setStyleAttribute)(e.querySelector("."+He),{transform:"translate("+l+"px,0px)"}),r.alignFreezedCells(l,!1)}r.previousValues.left=o,r.frozenPreviousValues.left=o,r.eventType="",e.scrollLeft=n.scrollLeft,i.scrollLeft=n.scrollLeft}}},e.prototype.alignFreezedCells=function(e,t){for(var i=0,a=this.parent.element.querySelectorAll("."+Si);i<a.length;i++)if(this.parent.isTabular&&this.parent.dataSourceSettings.rows.length>1){var r=a[i];this.setFrozenColumnPosition(e,r,i,a,t)}else t?this.parent.enableRtl?a[i].style.right=-e+"px":a[i].style.left=e+"px":this.parent.enableRtl?a[i].style.right=Number(e)+"px":a[i].style.left=Number(-e)+"px"},e.prototype.onVerticalScroll=function(e,i){var a,r=this,n=e.querySelector("."+Ft)?e.querySelector("."+Ft):e;return function(s){var o=r.parent.engineModule?r.parent.engineModule.viewportPageCount:3;if(r.parent.isAdaptive||n.scrollHeight>n.parentElement.clientHeight*o){var l=e.scrollTop*r.parent.verticalScrollScale;if("wheel"===s.type||"touchmove"===s.type||"scroll"===s.type||"wheel"===r.eventType||"touchmove"===r.eventType||"keyup"===s.type||"keydown"===s.type){var d=r.parent.isAdaptive?e:(0,t.closest)(e,"."+zt).querySelector("."+It);clearTimeout(a),a=setTimeout((function(){var t=0;if(r.parent.isAdaptive){var i=d.querySelector("."+Ft);t=d.scrollLeft===i.scrollLeft?d.scrollLeft:i.scrollLeft}else t=d.scrollLeft;r.update(e.scrollTop*r.parent.verticalScrollScale,t*r.parent.horizontalScrollScale,s,d,null,e)}),300)}if(r.previousValues.top===l)return;r.parent.scrollPosObject.horizontalSection<0&&(r.parent.scrollPosObject.horizontalSection=0),r.parent.scrollDirection=r.direction="vertical",r.isScrolling=!0;var h=-(l-r.parent.scrollPosObject.verticalSection-e.scrollTop),p=e.querySelector("."+He).style.transform.split(",")[0].trim();h>r.parent.virtualDiv.clientHeight&&(h=r.parent.virtualDiv.clientHeight),e.scrollTop<r.parent.scrollerBrowserLimit&&((0,t.setStyleAttribute)(e.querySelector("."+He),{transform:"translate(0px,"+h+"px)"}),(0,t.setStyleAttribute)(e.querySelector("."+He),{transform:p+","+h+"px)"}));var u=r.parent.scrollPosObject.verticalSection>l?-(r.parent.scrollPosObject.verticalSection-l):l+e.clientHeight-(r.parent.scrollPosObject.verticalSection+e.querySelector("."+He).offsetHeight),c=Math.ceil(r.parent.scrollPosObject.verticalSection/r.parent.verticalScrollScale)<r.parent.scrollerBrowserLimit;if(r.parent.scrollPosObject.verticalSection>l||u>1&&c){r.parent.virtualScrollSettings&&r.parent.virtualScrollSettings.allowSinglePage&&"pivot"===r.parent.dataType&&r.parent.element.querySelector("."+yi)&&((0,t.addClass)([i],["e-virtual-pivot-content"]),(0,t.removeClass)([r.parent.element.querySelector("."+yi)],[bi])),l>e.clientHeight?(r.parent.scrollPosObject.top<1&&(r.parent.scrollPosObject.top=e.clientHeight),r.parent.scrollPosObject.top=r.parent.scrollPosObject.top-50,u=r.parent.scrollPosObject.verticalSection>l?u-r.parent.scrollPosObject.top:u+r.parent.scrollPosObject.top):u=-r.parent.scrollPosObject.verticalSection;var g=r.parent.element.querySelector("."+R).querySelector("."+He);h=-(l-(r.parent.scrollPosObject.verticalSection+u)-e.scrollTop);var m=r.parent.gridSettings.rowHeight*r.engineModule.rowCount+.1-g.clientHeight;m>r.parent.scrollerBrowserLimit&&(r.parent.verticalScrollScale=m/r.parent.scrollerBrowserLimit,m=r.parent.scrollerBrowserLimit),h>m&&h>l&&(h=l,u=0),h>r.parent.virtualDiv.clientHeight&&(h=r.parent.virtualDiv.clientHeight),(0,t.setStyleAttribute)(e.querySelector("."+He),{transform:"translate(0px,"+h+"px)"}),(0,t.setStyleAttribute)(e.querySelector("."+He),{transform:p+","+h+"px)"}),r.parent.scrollPosObject.verticalSection=r.parent.scrollPosObject.verticalSection+u}r.scrollingDirection=r.previousValues.top<e.scrollTop?"Up":"Down",r.previousValues.top=l,r.frozenPreviousValues.top=l,r.eventType=""}}},e.prototype.removeInternalEvents=function(){this.parent.isDestroyed||this.parent.off(mr,this.wireEvents)},e.prototype.destroy=function(){this.removeInternalEvents()},e.prototype.setFrozenColumnPosition=function(e,t,i,a,r){if(t&&t instanceof HTMLTableCellElement){var n=0,s=t.cellIndex+1;if(s>1)for(var o=0;o<s-1;o++)n+=this.parent.pivotColumns[o].width;r?this.parent.enableRtl?a[i].style.right=-(e-n)+"px":a[i].style.left=e+n+"px":this.parent.enableRtl?a[i].style.right=Number(e+n)+"px":a[i].style.left=Number(-(e-n))+"px"}},e}(),$s=function(){function e(e){this.indexString=[],this.isUpdated=!1,this.parent=e,this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule}return e.prototype.showDrillThroughDialog=function(e){for(var i=this,a=e.rawData,r=[],n={},s=0;s<e.rawData.length;s++)r.push(Di.frameHeaderWithKeys(e.rawData[s]));try{if("Table"===this.parent.currentView&&this.parent.editSettings.allowInlineEditing&&this.parent.editSettings.allowEditing&&1===e.rawData.length){if(this.parent.actionObj.actionName=cn,this.parent.actionBeginMethod())return;this.editCell(e,a)}else{this.removeDrillThroughDialog();var o=(0,t.createElement)("div",{id:this.parent.element.id+"_drillthrough",className:"e-drillthrough-dialog"});this.parent.element.appendChild(o),this.dialogPopUp=new Ni.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("details"),content:this.createDrillThroughGrid(e,a),cssClass:this.parent.cssClass,beforeOpen:function(){i.drillThroughGrid.setProperties({dataSource:i.parent.editSettings.allowEditing?i.dataWithPrimarykey(e,a,n):a,height:i.parent.editSettings.allowEditing?220:300},!1)},beforeClose:function(){if(i.parent.editSettings.allowEditing&&i.isUpdated){"CSV"===i.parent.dataSourceSettings.type&&i.updateData(i.drillThroughGrid.dataSource);for(var e=[],s=0,o=Object.keys(n);s<o.length;s++){var l=o[s];e.push(n[l])}for(var d=Object.keys(n).length,h=[],p=[],u=0,c=0,g=i.drillThroughGrid.dataSource;c<g.length;c++){if("0"===(T=g[c]).__index||""===T.__index){for(var m=0,f=i.engine.fields;m<f.length;m++){var v=f[m];(0,t.isNullOrUndefined)(T[v])&&delete T[v]}delete T.__index,h.push(T)}else d>0&&(delete n[T.__index.toString()],p.push(T),d--);"Server"===i.parent.dataSourceSettings.mode&&(T.__index&&delete T.__index,a[u].__index&&delete a[u].__index),u++}if(d=0,"Server"===i.parent.dataSourceSettings.mode){for(var S=[],y=Object.keys(n),b=0;b<y.length;b++)delete i.parent.drillThroughValue.indexObject[n[y[b]]],S.push({Key:y[b],Value:n[y[b]]});i.parent.getEngine("updateRawData",null,null,null,null,null,null,null,{addedData:h,removedData:S,updatedData:p,indexObject:i.parent.drillThroughValue.indexObject})}else{for(var C=[],x=0,w=i.parent.allowDataCompression?i.parent.engineModule.actualData:i.parent.engineModule.data;x<w.length;x++){var T;delete(T=w[x]).__index,void 0===n[d.toString()]&&C.push(T),d++}C=C.concat(h);var M={currentData:i.drillThroughGrid.dataSource,previousData:r,previousPosition:e,cancel:!1};i.parent.trigger(la,M),M.cancel||(i.parent.setProperties({dataSourceSettings:{dataSource:C}},!0),i.engine.updateGridData(i.parent.dataSourceSettings),i.parent.pivotValues=i.engine.pivotValues)}i.parent.actionObj.actionName=ss;var D={editInfo:{type:i.drillThroughGrid.editSettings.mode,action:"Update",currentData:i.drillThroughGrid.dataSource,previousData:r,previousPosition:e}};i.parent.actionObj.actionInfo=D}i.isUpdated=!1,n={}},isModal:!0,visible:!0,showCloseIcon:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:this.parent.isAdaptive?"100%":"60%",position:{X:"center",Y:"center"},closeOnEscape:!this.parent.editSettings.allowEditing,target:document.body,close:this.removeDrillThroughDialog.bind(this)}),this.dialogPopUp.isStringTemplate=!0,this.dialogPopUp.appendTo(o),(0,t.setStyleAttribute)(this.dialogPopUp.element,{visibility:"visible"});this.parent.editSettings.allowEditing&&(this.drillthroughKeyboardModule=new t.KeyboardEvents(this.dialogPopUp.element,{keyAction:this.drillthroughKeyActionHandler.bind(this),keyConfigs:{escape:"escape"},eventName:"keydown"}))}}catch(e){this.parent.actionFailureMethod(e)}},e.prototype.editCell=function(e,i){var a=this,r=this.parent.gridSettings.allowResizing,n=e.currentCell.actualText.toString(),s=Number(Object.keys(e.currentCell.indexObject));e.currentTarget.firstElementChild.style.display="none";var o=Number(e.rawData[0][n]),l=Di.frameHeaderWithKeys(e.rawData[e.rawData.length-1]),d=e.rawData[e.rawData.length-1],h={editInfo:{type:"Inline editing",action:"update",data:i}};this.parent.actionObj.actionInfo=h;var p=new fs.NumericTextBox({value:o,enableRtl:this.parent.enableRtl,enabled:!0,format:"####.##",locale:this.parent.locale,cssClass:this.parent.cssClass,change:function(){var i=(0,t.isNullOrUndefined)(p.value)?0:p.value,r=e.currentCell.indexObject[s];e.rawData[0][n]=i,a.parent.engineModule.data[r]=e.rawData[0]},blur:function(){var e={currentData:[d],previousData:[l],previousPosition:[d.index],cancel:!1};if(a.parent.trigger(la,e),!e.cancel)if("Server"===a.parent.dataSourceSettings.mode){var t={};t[s]=s;var i=[d];a.parent.getEngine("updateRawData",null,null,null,null,null,null,null,{addedData:[],removedData:[],updatedData:i,indexObject:t})}else a.parent.setProperties({dataSourceSettings:{dataSource:a.parent.engineModule.data}},!0),a.engine.updateGridData(a.parent.dataSourceSettings),a.parent.pivotValues=a.engine.pivotValues,a.parent.gridSettings.allowResizing=r}}),u=(0,t.createElement)("input",{id:this.parent.element.id+"_inputbox"});e.currentTarget.appendChild(u),p.appendTo(u),e.currentCell.value=p.value,p.focusIn(),this.parent.gridSettings.allowResizing=!1},e.prototype.updateData=function(e){for(var i=0,a=this.parent.allowDataCompression?this.parent.engineModule.actualData:this.parent.engineModule.data;i<e.length;){for(var r=Object.keys(e[i]),n=0,s=[];n<r.length;)(0,t.isNullOrUndefined)(this.parent.engineModule.fieldKeys[r[n]])||(s[this.parent.engineModule.fieldKeys[r[n]]]=e[i][r[n]]),n++;a[Number(e[i].__index)]=s,i++}this.parent.allowDataCompression?this.parent.engineModule.actualData=a:this.parent.engineModule.data=a},e.prototype.removeDrillThroughDialog=function(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&(this.parent.actionObj.actionName=os,this.parent.actionObj.actionName&&this.parent.actionCompleteMethod(),this.dialogPopUp.destroy());var e=document.getElementById(this.parent.element.id+"_drillthrough");e&&(0,t.remove)(e),document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg")&&(0,t.remove)(document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg"))},e.prototype.createDrillThroughGrid=function(e,i){var a=this,r=(0,t.createElement)("div",{id:this.parent.element.id+"_drillthroughbody",className:"e-drillthrough-body"}),n=(0,t.createElement)("div",{id:this.parent.element.id+"_drillthroughbodyheader",className:"e-drillthrough-body-header-container"});if(""!==e.rowHeaders&&(n.innerHTML="<span class="+J+"><span class="+X+">"+this.parent.localeObj.getConstant("row")+"</span> : <span class="+Z+">"+e.rowHeaders+"</span></span>"),""!==e.columnHeaders&&(n.innerHTML=n.innerHTML+"<span class="+J+"><span class="+X+">"+this.parent.localeObj.getConstant("column")+"</span> : <span class="+Z+">"+e.columnHeaders+"</span></span>"),""!==e.value){var s=e.value.split("(")[0],o=e.value.split("(")[1].split(")")[0];"0"!==o&&(n.innerHTML=n.innerHTML+"<span class="+J+"><span class="+X+">"+s+"</span> : <span class="+Z+">"+o+"</span></span>")}var l=["ColumnChooser"];this.parent.editSettings.allowEditing&&(l=this.parent.editSettings.allowCommandColumns?["ColumnChooser","Add"]:"Batch"===this.parent.editSettings.mode?["ColumnChooser","Add","Delete","Update","Cancel"]:"Dialog"===this.parent.editSettings.mode?["ColumnChooser","Add","Edit","Delete"]:["ColumnChooser","Add","Edit","Delete","Update","Cancel"]);var d=(0,t.createElement)("div",{id:this.parent.element.id+"_drillthroughgrid",className:"e-drillthrough-grid"});gs.Grid.Inject(gs.Selection,gs.Reorder,gs.Resize,gs.Toolbar,gs.ColumnChooser),this.drillThroughGrid=new gs.Grid({cssClass:this.parent.cssClass,gridLines:"Default",allowResizing:!0,allowReordering:!0,showColumnChooser:!0,enableHover:!1,toolbar:l,columns:e.gridColumns,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableVirtualization:!this.parent.editSettings.allowEditing,allowPaging:this.parent.editSettings.allowEditing,pageSettings:{pageSize:20},rowHeight:this.parent.gridSettings.rowHeight,height:"100%"}),"olap"===this.parent.dataType&&this.formatData(i);var h=this;if(this.parent.trigger(oa,{cellInfo:e,gridObj:this.drillThroughGrid,type:"editing"}),this.drillThroughGrid.allowExcelExport&&gs.Grid.Inject(gs.ExcelExport),this.drillThroughGrid.allowPdfExport&&gs.Grid.Inject(gs.PdfExport),this.parent.editSettings.allowEditing){gs.Grid.Inject(gs.Edit,gs.Page);try{this.drillThroughGrid.editSettings=this.parent.editSettings,this.drillThroughGrid.actionBegin=function(e){var t="save"===e.requestType?gn:"add"===e.requestType?mn:"delete"===e.requestType?fn:"";a.parent.actionObj.actionName=t,!a.parent.actionObj.actionName||a.parent.actionBeginMethod()},this.parent.editSettings.allowCommandColumns?(this.drillThroughGrid.editSettings.mode="Normal",this.drillThroughGrid.editSettings.allowEditOnDblClick=!1,gs.Grid.Inject(gs.CommandColumn),this.drillThroughGrid.columns.push({headerText:this.parent.localeObj.getConstant("manageRecords"),width:160,showInColumnChooser:!1,commands:[{type:"Edit",buttonOption:{iconCss:" e-icons e-edit",cssClass:"e-flat"+(this.parent.cssClass?" "+this.parent.cssClass:"")}},{type:"Delete",buttonOption:{iconCss:"e-icons e-delete",cssClass:"e-flat"+(this.parent.cssClass?" "+this.parent.cssClass:"")}},{type:"Save",buttonOption:{iconCss:"e-icons e-update",cssClass:"e-flat"+(this.parent.cssClass?" "+this.parent.cssClass:"")}},{type:"Cancel",buttonOption:{iconCss:"e-icons e-cancel-icon",cssClass:"e-flat"+(this.parent.cssClass?" "+this.parent.cssClass:"")}}]})):this.drillThroughGrid.editSettings.allowEditOnDblClick=this.parent.editSettings.allowEditOnDblClick,this.drillThroughGrid.columns.push({field:"__index",visible:!1,isPrimaryKey:!0,type:"string",showInColumnChooser:!1,defaultValue:"0",validationRules:{required:!0}})}catch(e){this.parent.actionFailureMethod(e)}this.drillThroughGrid.actionComplete=function(e){"batchsave"!==e.requestType&&"save"!==e.requestType&&"delete"!==e.requestType||(h.isUpdated=!0),a.parent.actionObj.actionName=a.parent.getActionCompleteName();var t={editInfo:{type:a.drillThroughGrid.editSettings.mode,action:e.requestType,data:i}};a.parent.actionObj.actionInfo=t,a.parent.actionObj.actionName&&a.parent.actionCompleteMethod(),("Normal"===h.drillThroughGrid.editSettings.mode&&"save"===e.requestType&&h.drillThroughGrid.element.querySelectorAll(".e-tbar-btn:hover").length>0&&!h.parent.editSettings.allowCommandColumns||"batchsave"===e.requestType)&&h.dialogPopUp.hide()},this.drillThroughGrid.beforeBatchSave=function(){h.isUpdated=!0}}else gs.Grid.Inject(gs.VirtualScroll);return document.body.appendChild(d),this.drillThroughGrid.isStringTemplate=!0,this.drillThroughGrid.appendTo(d),r.appendChild(n),r.appendChild(d),r},e.prototype.frameGridColumns=function(e){this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;var i="olap"===this.parent.dataType?e[0]?Object.keys(e[0]):[]:Object.keys(this.engine.fieldList),a=[],r={};if(this.parent.dataSourceSettings.formatSettings.length>0)for(var n=0;n<this.parent.dataSourceSettings.formatSettings.length;n++)r[this.parent.dataSourceSettings.formatSettings[n].name]=this.parent.dataSourceSettings.formatSettings[n].format;if("olap"===this.parent.dataType)for(var s=0,o=i;s<o.length;s++){var l=o[s];a.push({field:l.replace(/_x005B_|_x0020_|_x005D_|_x0024_/g,"").replace("].[","").split(".").reverse().join(""),headerText:l.replace(/_x005B_|_x005D_|_x0024_/g,"").replace(/_x0020_/g," ").replace("].[","").split(".").reverse().join("."),width:120,visible:!0,validationRules:{required:!0},format:(0,t.isNullOrUndefined)(r[l])?null:r[l],type:(0,t.isNullOrUndefined)(r[l])?"string":null})}else for(var d=0,h=i;d<h.length;d++){l=h[d];if("CalculatedField"!==this.engine.fieldList[l].aggregateType){var p="",u=null,c=!("date"!==this.engine.fieldList[l].type&&"datetime"!==this.engine.fieldList[l].type||!(this.isDateFieldExist(l)||e[0]&&e[0][l]&&-1===e[0][l].toString().indexOf(" ")));"number"===this.engine.fieldList[l].type?(p="numericedit",u="number"):"date"===this.engine.fieldList[l].type&&c?(p="datepickeredit",u="date"):"datetime"===this.engine.fieldList[l].type&&c?(p="datetimepickeredit",u="date"):p="defaultedit",this.parent.engineModule.formatFields[l]&&(u=this.parent.engineModule.formatFields[l].type);var g=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(this.engine.fieldList[l].caption):this.engine.fieldList[l].caption;a.push({field:l,headerText:g,width:120,visible:this.engine.fieldList[l].isSelected,validationRules:{required:!0},editType:p,format:(0,t.isNullOrUndefined)(r[l])?void 0:r[l],type:(0,t.isNullOrUndefined)(r[l])?"string":u})}}return a},e.prototype.isDateFieldExist=function(e){for(var t=0;t<this.parent.dataSourceSettings.formatSettings.length;t++)if(this.parent.dataSourceSettings.formatSettings[t].name===e&&this.parent.dataSourceSettings.formatSettings[t].type.indexOf("date")>-1)return!0;for(t=0;t<this.parent.dataSourceSettings.fieldMapping.length;t++)if(this.parent.dataSourceSettings.fieldMapping[t].name===e&&this.parent.dataSourceSettings.fieldMapping[t].dataType&&this.parent.dataSourceSettings.fieldMapping[t].dataType.indexOf("date")>-1)return!0;return!1},e.prototype.formatData=function(e){for(var t=0;t<e.length;){for(var i=e[t],a=Object.keys(e[t]),r={},n=0;n<a.length;){r[a[n].replace(/_x005B_|_x0020_|_x005D_|_x0024_/g,"").replace("].[","").split(".").reverse().join("")]=i[a[n]],n++}e[t]=r,t++}},e.prototype.dataWithPrimarykey=function(e,t,i){for(var a=this.indexString.length>0?this.indexString:Object.keys(e.currentCell.indexObject),r=t,n=0,s=0,o=r;s<o.length;s++){o[s].__index=a[n],i[a[n].toString()]=Number(a[n]),n++}return r},e.prototype.drillthroughKeyActionHandler=function(e){if("escape"===e.action)this.processClose(e)},e.prototype.processClose=function(e){var i=e.target;if(i&&(0,t.closest)(i,".e-popup.e-popup-open")){var a=(0,t.getInstance)((0,t.closest)(i,".e-popup.e-popup-open"),Ni.Dialog);if(a&&!a.closeOnEscape){var r=a.element.getAttribute("data-fieldName");if(a.hide(),this.parent.element)for(var n=0,s=[].slice.call(this.parent.element.querySelectorAll(".e-pivot-button"));n<s.length;n++){var o=s[n];if(o.getAttribute("data-uid")===r){o.focus();break}}return void e.preventDefault()}}},e.prototype.destroy=function(){this.parent.isDestroyed||this.drillthroughKeyboardModule&&!this.drillthroughKeyboardModule.isDestroyed&&(this.drillthroughKeyboardModule.destroy(),this.drillthroughKeyboardModule=null)},e}(),eo=function(){function e(e){this.parent=e,this.drillThroughDialog=new $s(this.parent),this.addInternalEvents()}return e.prototype.getModuleName=function(){return"drillThrough"},e.prototype.addInternalEvents=function(){this.parent.on(mr,this.wireEvents,this)},e.prototype.wireEvents=function(){this.unWireEvents(),t.EventHandler.add(this.parent.element,"dblclick",this.mouseClickHandler,this)},e.prototype.unWireEvents=function(){this.parent.isDestroyed||t.EventHandler.remove(this.parent.element,"dblclick",this.mouseClickHandler)},e.prototype.mouseClickHandler=function(e){var i=e.target,a=null;if(i.classList.contains("e-stackedheadercelldiv")||i.classList.contains("e-headercelldiv")||i.classList.contains("e-stackedheadertext")||i.classList.contains("e-headertext")?a=(0,t.closest)(i.parentElement,"th"):i.classList.contains("e-cellvalue")?a=i.parentElement:(i.classList.contains("e-headercell")||i.classList.contains("e-rowcell"))&&(a=i),a&&this.parent.pivotValues.length>0&&this.parent.dataSourceSettings.values.length>0&&(this.parent.allowDrillThrough||this.parent.editSettings.allowEditing)&&a.classList.contains("e-valuescontent")){var r=parseInt(a.getAttribute("aria-colindex"),10)-1,n=Number(a.getAttribute("index"));(0,t.isNullOrUndefined)(this.parent.pivotValues[n])||(0,t.isNullOrUndefined)(this.parent.pivotValues[n][r])||this.executeDrillThrough(this.parent.pivotValues[n][r],n,r,a)}},e.prototype.executeDrillThrough=function(e,i,a,r){this.parent.drillThroughElement=r,this.parent.drillThroughValue=e;var n="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,s="",o="",l=[];if(!(0,t.isNullOrUndefined)(e.rowHeaders)&&!(0,t.isNullOrUndefined)(e.columnHeaders)){if("olap"===this.parent.dataType){var d=void 0,h=(d="row"===this.parent.dataSourceSettings.valueAxis?n.tupRowInfo[e.rowOrdinal]:n.tupColumnInfo[e.colOrdinal])?n.getUniqueName(d.measureName):e.actualText;if(n.fieldList[h]&&n.fieldList[h].isCalculatedField)return void this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("drillError"));s=n.fieldList[h||e.actualText].caption,o=n.fieldList[h||e.actualText].aggregateType;try{this.parent.olapEngineModule.getDrillThroughData(e,this.parent.maxRowsInDrillThrough),l=JSON.parse(n.gridJSON)}catch(e){return this.parent.olapEngineModule.errorInfo&&this.parent.actionFailureMethod(this.parent.olapEngineModule.errorInfo),this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.olapEngineModule.errorInfo?this.parent.olapEngineModule.errorInfo:n.gridJSON),void(this.parent.olapEngineModule.errorInfo=void 0)}}else if(s=n.fieldList[e.actualText.toString()]?n.fieldList[e.actualText.toString()].caption:e.actualText.toString(),o=n.fieldList[e.actualText]?n.fieldList[e.actualText].aggregateType:"","Server"===this.parent.dataSourceSettings.mode)this.parent.getEngine("fetchRawData",null,null,null,null,null,null,{rowIndex:i,columnIndex:a});else if(this.parent.allowDataCompression){var p=Object.keys(e.indexObject);this.drillThroughDialog.indexString=[];for(var u=0,c=p;u<c.length;u++)for(var g=c[u],m=0,f=this.parent.engineModule.groupRawIndex[Number(g)];m<f.length;m++){var v=f[m];l.push(this.parent.engineModule.actualData[v]),this.drillThroughDialog.indexString.push(v.toString())}}else for(var S=0,y=p=Object.keys(e.indexObject);S<y.length;S++){var b=y[S];l.push(this.parent.engineModule.data[Number(b)])}"Server"!==this.parent.dataSourceSettings.mode&&this.triggerDialog(s,o,l,e,r)}},e.prototype.frameData=function(e){for(var t=0,i=0,a=[];i<e.rawData.length;){for(var r={};t<e.gridColumns.length;)r[e.gridColumns[t].field]="Server"===this.parent.dataSourceSettings.mode?e.rawData[i][-1!==this.parent.engineModule.fields.indexOf(e.gridColumns[t].field)?this.parent.engineModule.fields.indexOf(e.gridColumns[t].field):0]:e.rawData[i][this.parent.engineModule.fieldKeys[e.gridColumns[t].field]],t++;a.push(r),i++,t=0}return e.rawData=a,e},e.prototype.triggerDialog=function(e,i,a,r,n){var s="CalculatedField"===i?e.toString():""!==i?this.parent.localeObj.getConstant(i)+" "+this.parent.localeObj.getConstant("of")+" "+e:e;s=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(s):s;var o="row"===this.parent.dataSourceSettings.valueAxis?this.parent.getRowText(Number(n.getAttribute("index")),0):""===r.rowHeaders?"":r.rowHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - "),l={currentTarget:n,currentCell:r,rawData:a,rowHeaders:o,columnHeaders:""===r.columnHeaders?"":r.columnHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - "),value:s+"("+r.formattedText+")",gridColumns:this.drillThroughDialog.frameGridColumns(a),cancel:!1};"CSV"===this.parent.dataSourceSettings.type&&(l=this.frameData(l));var d=this;this.parent.trigger(Ji,l,(function(e){l.cancel||d.drillThroughDialog.showDrillThroughDialog(e)}))},e.prototype.destroy=function(){this.unWireEvents(),this.drillThroughDialog&&(this.drillThroughDialog.destroy(),this.drillThroughDialog=null)},e}(),to=v(60),io=function(){function e(e){this.headerColl={},this.maxLevel=0,this.columnGroupObject={},this.selectedLegend=0,this.chartSeriesInfo={},this.measurePos=-1,this.measuresNames={},this.accumulationType=["Pie","Pyramid","Doughnut","Funnel"],this.isChartInitial=!0,this.parent=e}return e.prototype.getModuleName=function(){return"pivotChart"},e.prototype.loadChart=function(e,a){if(this.parent=e,this.measuresNames={},this.engineModule="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.dataSourceSettings=this.parent.dataSourceSettings,this.chartSettings=a,!("olap"===e.dataType?""!==e.dataSourceSettings.url&&!e.olapEngineModule.isEmptyData&&e.olapEngineModule.tupColumnInfo.length>0&&e.olapEngineModule.tupRowInfo.length>0&&(!(0,t.isNullOrUndefined)(e.olapEngineModule.colMeasurePos)||!(0,t.isNullOrUndefined)(e.olapEngineModule.rowMeasurePos)):"Server"===this.parent.dataSourceSettings.mode?!(0,t.isNullOrUndefined)(e.dataSourceSettings.url)&&""!==e.dataSourceSettings.url&&e.dataSourceSettings.values.length>0&&!e.engineModule.isEmptyData:e.dataSourceSettings.values.length>0&&e.dataSourceSettings.dataSource&&(e.dataSourceSettings.dataSource.length>0||e.dataSourceSettings.dataSource instanceof i.DataManager)&&!e.engineModule.isEmptyData))return this.parent.chart?(this.parent.element.querySelector(".e-chart")?(this.parent.chart.series=[],this.parent.chart.rows=[],this.parent.chart.primaryXAxis.title="",this.parent.chart.primaryYAxis.title="",this.parent.chart.primaryXAxis.multiLevelLabels=[],this.parent.chart.primaryYAxis.multiLevelLabels=[],this.parent.chart.axes.length>0&&(this.parent.chart.axes[0].title=""),this.parent.chart.primaryXAxis.zoomFactor=(0,t.isNullOrUndefined)(this.parent.chartSettings.primaryXAxis.zoomFactor)?1:this.parent.chartSettings.primaryXAxis.zoomFactor):this.parent.element.querySelector(".e-accumulationchart")&&(this.parent.chart.series[0].dataSource=[{}],this.parent.chart.series[0].dataLabel={}),void this.parent.chart.refresh()):(this.parent.appendChartElement(),this.parent.enableVirtualization&&this.isChartInitial&&(this.isChartInitial=!1,this.parent.onContentReady()),void this.parent.notify(mr,{}));this.parent.chart||!this.parent.element.querySelector(".e-chart")&&!this.parent.element.querySelector(".e-accumulationchart")||(0,t.remove)((0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element)),this.chartSettings.enableMultipleAxis&&this.accumulationType.indexOf(a.chartSeries.type)<0&&"Pareto"!==this.chartSettings.chartSeries.type?this.measureList=this.dataSourceSettings.values.map((function(e){return e.name})):this.measureList=[""===a.value?this.dataSourceSettings.values[0].name:a.value];for(var r=0,n=this.dataSourceSettings.values;r<n.length;r++){var s=(O=n[r]).name.replace(/[^A-Z0-9]+/gi,"_");this.measuresNames[O.name]=s,this.measuresNames[s]=O.name,"Polar"!==this.chartSettings.chartSeries.type&&"Radar"!==this.chartSettings.chartSeries.type||(this.measuresNames[O.caption?O.caption:O.name]=O.name)}this.columnGroupObject={},this.accEmptyPoint=!1;var o=this.engineModule.pivotValues;this.currentMeasure=a.enableMultipleAxis&&this.accumulationType.indexOf(a.chartSeries.type)<0&&"Pareto"!==this.chartSettings.chartSeries.type?this.measureList[0]:(""===a.value||0===this.dataSourceSettings.values.filter((function(e){return e.name===a.value})).length)&&this.dataSourceSettings.values.length>0?this.dataSourceSettings.values[0].name:a.value;var l,d,h,p=this.getColumnTotalIndex(o),u=Object.keys(o),c={},g=0,m=-.5;this.headerColl={},this.maxLevel=0;var f,v={},S="",y="",b="";this.chartSeriesInfo={},this.selectedLegend=0;for(var C=!1,x={},w=!1,T=this.parent.dataSourceSettings.valueSortSettings.headerDelimiter,M=0,D=this.dataSourceSettings.values;M<D.length;M++){var O;x[s=(O=D[M]).name]=O.caption?O.caption:s,x[O.caption?O.caption:s]=s}if("olap"===this.parent.dataType){var P=[];v=this.groupHierarchyWithLevels(o,P),S=P[P.length-1],b=y=this.measurePos===P.length-1&&P.length>1?P[P.length-2]:S}for(var N=0,E=0,I=0,F=!1,L=0,A=0,R=0,k=0,j=u;k<j.length;k++){var q=j[k],V=Number(q),H=void 0,U=!1,_=void 0,B=void 0;if((_=F?o[V-A][this.parent.engineModule.rowMaxLevel]:o[V]["Tabular"===this.parent.gridSettings.layout?this.parent.engineModule.rowMaxLevel:0])&&(B=A===_.level?1:A+1),"Tabular"===this.parent.gridSettings.layout&&(!this.parent.dataSourceSettings.showSubTotals||!this.parent.dataSourceSettings.showRowSubTotals&&this.parent.dataSourceSettings.showColumnSubTotals)&&_&&o[V-(A===_.level?1:A+1)]&&o[V-B][this.parent.engineModule.rowMaxLevel]){var G=F?o[V-(A+1)][this.parent.engineModule.rowMaxLevel]:o[V-B][this.parent.engineModule.rowMaxLevel],z=G.valueSort.levelName.split(T),W=_.valueSort.levelName.split(T),Q=G.formattedText.split(" ");H=this.isMemberDrilled(G,Q);for(var Y=z.length-2-R;Y>=0;Y--)if(z[Y]!==W[Y]&&!H){if(1!==L){_=F?o[V-(A+1)][Y]:o[V-(A===_.level?1:A+1)][Y],U=!0,F=!0,L++,A++;var K=Number(u[u.length-1])+1;u[u.length]=K.toString(),z[Y-1]&&z[Y-1]!==W[Y-1]?(L=0,R++):R=0}else L--;break}}if(!(0,t.isNullOrUndefined)(o[V-A])){var X="Tabular"===this.parent.gridSettings.layout?this.parent.engineModule.rowMaxLevel:0,J=o[V-A][X],Z=J&&J.valueSort&&!(0,t.isNullOrUndefined)(J.valueSort.levelName)?J.valueSort.levelName.toString().split(T):void 0;if(w=!1,Z&&"Grand Total"!==Z[0]&&((a.enableMultipleAxis&&this.accumulationType.indexOf(a.chartSeries.type)<0&&"Pareto"!==this.chartSettings.chartSeries.type||Z.indexOf(x[this.currentMeasure])>-1)&&(w=!0),!w)){for(var $=0,ee=Z;$<ee.length;$++){if(x[pe=ee[$]]){w=!0;break}}w=!w}if(J&&"row"===J.axis&&(0===this.dataSourceSettings.rows.length||"grand sum"!==J.type&&w)){if("Tabular"!==this.parent.gridSettings.layout&&_.isSum)continue;var te="olap"===this.parent.dataType?this.engineModule.tupRowInfo[_.ordinal]:void 0,ie=-1,ae=_.level;if("olap"===this.parent.dataType)C="[Measures]"===_.hierarchy?C:this.isAttributeDrill(_.hierarchy,te.drillInfo),b=b===y||"[Measures]"===_.hierarchy||_.isNamedSet||this.engineModule.fieldList[_.hierarchy]&&!this.engineModule.fieldList[_.hierarchy].hasAllMember?y:b,ie=te.drillInfo.length-1,3===_.memberType||te.measureName&&te.measureName!==this.dataSourceSettings.values[0].name||(c=0===(g=(d=void 0===d?_.levelUniqueName:d)===_.levelUniqueName?0:g)?{}:c,g=h&&d!==_.levelUniqueName?h.hierarchy===_.hierarchy?g+(_.level-h.level):(0,t.isNullOrUndefined)(c[_.levelUniqueName])?v[_.hierarchy].start:c[_.levelUniqueName]:g,c[_.levelUniqueName]=g,ae=g,m+=!h||b!==h.hierarchy||h.isDrilled&&h.hasChild?0:1,b=C?_.hierarchy:y,l=g,h=_);else if("value"!==_.type){if("Tabular"===this.parent.gridSettings.layout){W=_.valueSort.levelName.split(T);var re=_.formattedText.split(" ");H=this.isMemberDrilled(_,W);for(var ne=Z.length-2!=this.parent.engineModule.rowMaxLevel-1?Z.length-2:this.parent.engineModule.rowMaxLevel-1,se=0;se<=this.parent.engineModule.rowMaxLevel;se++)if(this.headerColl[m]&&this.headerColl[m][se]||U){if(_.isSum||U){if(_.level>0){m-=_.level===this.parent.engineModule.rowMaxLevel-1?N-1:E-1,_.formattedText=!this.parent.dataSourceSettings.showSubTotals||!this.parent.dataSourceSettings.showRowSubTotals&&this.parent.dataSourceSettings.showColumnSubTotals?_.formattedText:re.length>2?re.slice(0,re.length-1).join(" "):re[0],_.hasChild=!0;break}m-=I-1,_.formattedText=!this.parent.dataSourceSettings.showSubTotals||!this.parent.dataSourceSettings.showRowSubTotals&&this.parent.dataSourceSettings.showColumnSubTotals?_.formattedText:re.length>2?re.slice(0,re.length-1).join(" "):re[0],_.hasChild=!0;break}if(this.headerColl[m][se]&&Z[ne]!==this.headerColl[m][se].name){m++;break}}_.isSum||U||(N++,E++,I++),this.parent.dataSourceSettings.expandAll?_.isDrilled=!H:_.isDrilled=!!H}else void 0===l||l<ae||m++;l=ae}this.maxLevel=ae>this.maxLevel?ae:this.maxLevel;var oe="olap"===this.parent.dataType?_.formattedText:_.actualText?_.actualText.toString():_.formattedText.toString(),le=this.engineModule.fieldList[this.currentMeasure],de=0===this.parent.dataSourceSettings.rows.length?this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(le.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+((0,t.isNullOrUndefined)(le.caption)?le.name:le.caption):_.formattedText?_.formattedText.toString():oe,he=_.hasChild&&!_.isNamedSet?(_.isDrilled?" - ":" + ")+de:de,pe=te?te.uNameCollection:_.valueSort.levelName.toString(),ue={name:oe,text:he,hasChild:_.hasChild,isDrilled:_.isDrilled,levelName:pe,level:ae,fieldName:_.valueSort.axis?_.valueSort.axis.toString():"",rowIndex:V-A,colIndex:0,cell:_};("olap"===this.parent.dataType?3!==_.memberType:"value"!==_.type)&&(this.headerColl[m]||(this.headerColl[m]={}),this.headerColl[m][ae]=ue,"Tabular"===this.parent.gridSettings.layout&&((_.isSum||U)&&(_.level>0?m+=_.level===this.parent.engineModule.rowMaxLevel-1?N-1:E-1:m+=I-1),0===_.level?(E=0,N=0,I=0):_.level===this.parent.engineModule.rowMaxLevel-1?N=0:_.level<this.parent.engineModule.rowMaxLevel-1&&0!==_.level&&(E=0)));var ce="Tabular"===this.parent.gridSettings.layout?o[V-A]:o[V],ge=Object.keys(ce),me=void 0;if("olap"===this.parent.dataType)f=3!==_.memberType?_:f;else if(f="value"!==_.type?_:f,"value"!==_.type)f=_;else{var fe=_&&_.valueSort&&_.valueSort.levelName&&_.valueSort.levelName.toString().split(T),ve=void 0;if(fe&&fe.length>0&&(fe.splice(fe.length-1,1),ve=fe.join(T)),this.parent.dataSourceSettings.valueIndex<=0||this.engineModule.valueAxis&&this.dataSourceSettings.rows.length===this.engineModule.measureIndex||(0,t.isNullOrUndefined)(f.valueSort)||ve===f.valueSort.levelName);else for(var Se=V;Se>-1;)o[Se]&&o[Se][0]&&o[Se][0].valueSort&&o[Se][0].valueSort.levelName===ve&&(f=o[Se][0],Se=0),Se--}for(var ye="Tabular"===this.parent.gridSettings.layout?this.parent.engineModule.rowMaxLevel:0;ye<ge.length;ye++){var be=ge[ye],Ce=Number(be),xe=o[V-A][Ce],we=!(0,t.isNullOrUndefined)(xe.rowHeaders)||0===this.dataSourceSettings.rows.length,Te="olap"===this.parent.dataType&&te&&te.measureName?te.measureName:xe.actualText;if(("olap"!==this.parent.dataType||!xe.isGrandSum)&&!p[xe.colIndex]&&"value"===xe.axis&&"header"!==_.type&&""!==Te&&(a.enableMultipleAxis&&this.accumulationType.indexOf(a.chartSeries.type)<0&&"Pareto"!==this.chartSettings.chartSeries.type||Te===this.currentMeasure)){if((0,t.isNullOrUndefined)(_.members)&&(_.members=[]),"olap"===this.parent.dataType?S!==_.hierarchy&&!C||(3===_.memberType&&me?ie!==this.measurePos||me.isDrilled&&me.hasChild:_.isDrilled&&_.hasChild):("value"===_.type&&me?!(0,t.isNullOrUndefined)(me.members)&&me.hasChild&&me.isDrilled:_.hasChild&&_.isDrilled)||!we)break;if("olap"===this.parent.dataType&&!0===xe.isSum&&"row"===this.parent.dataSourceSettings.valueAxis)continue;var Me="";if("olap"===this.parent.dataType)Me=xe.columnHeaders.toString().split(/~~|::/).join(" - ");else{var De=xe.columnHeaders.toString().split(T);Me=Di.formatChartHeaders(De,this,!0,xe)}var Oe="";if("olap"===this.parent.dataType)Oe=xe.rowHeaders.toString().split(/~~|::/).join(" - ");else{var Pe=xe.rowHeaders.toString().split(T);Oe=Di.formatChartHeaders(Pe,this,!1,xe)}var Ne=Me+" | "+Te;this.chartSeriesInfo[Me]={uniqueName:Me,caption:xe.hierarchyName&&xe.hierarchyName.toString().split(T).join(" - "),colorIndex:[]},this.chartSeriesInfo[this.chartSeriesInfo[Me].caption]=this.chartSeriesInfo[Me];var Ee="pivot"===this.parent.dataType&&this.engineModule.aggregatedValueMatrix[V]&&!(0,t.isNullOrUndefined)(this.engineModule.aggregatedValueMatrix[V][Ce])?Number(this.engineModule.aggregatedValueMatrix[V][Ce]):(0,t.isNullOrUndefined)(xe.value)?xe.value:Number(xe.value);0===(Ee=Ee===1/0?null:Ee)&&(this.accEmptyPoint=!0),this.columnGroupObject[Ne]?this.columnGroupObject[Ne].push({x:0===this.dataSourceSettings.rows.length?_.formattedText:Oe,y:Ee,rIndex:V-A,cIndex:Ce}):this.columnGroupObject[Ne]=[{x:0===this.dataSourceSettings.rows.length?_.formattedText:Oe,y:Ee,rIndex:V-A,cIndex:Ce}]}me=f}}}}this.refreshChart()},e.prototype.refreshChart=function(){this.chartSeries=[];var e=0,i={},a=Object.keys(this.columnGroupObject);this.persistSettings=JSON.parse(this.parent.getChartSettings()).chartSettings;for(var r=this.persistSettings.palettes&&this.persistSettings.palettes.length>0?this.persistSettings.palettes:(0,to.getSeriesColor)(this.chartSettings.theme),n=this.parent.chartSettings.columnDelimiter?this.parent.chartSettings.columnDelimiter:"-",s=this.parent.chartSettings.columnHeader&&""!==this.parent.chartSettings.columnHeader?this.parent.chartSettings.columnHeader.split(n).join(" - "):"",o=this.chartSettings.chartSeries?this.chartSettings.chartSeries.type:void 0,l={},d=0;d<this.parent.dataSourceSettings.values.length;d++)l[this.parent.dataSourceSettings.values[d].name]=(0,t.isNullOrUndefined)(this.parent.dataSourceSettings.values[d].caption)?void 0:this.parent.dataSourceSettings.values[d].caption;if(this.accumulationType.indexOf(o)>-1&&a.length>0){this.currentColumn=a.indexOf(s+" | "+this.currentMeasure)>-1&&void 0!==s?s+" | "+this.currentMeasure:a[0];var h={};h=this.persistSettings.chartSeries?this.frameChartSeries(this.persistSettings.chartSeries):h,((0,t.isNullOrUndefined)(h.palettes)||0===h.palettes.length)&&!(0,t.isNullOrUndefined)(this.persistSettings.palettes)&&this.persistSettings.palettes.length>0&&(h.palettes=this.persistSettings.palettes),h.dataSource=this.columnGroupObject[this.currentColumn],h.xName="x",h.yName="y",this.persistSettings.chartSeries&&this.persistSettings.chartSeries.dataLabel?(h.dataLabel=this.persistSettings.chartSeries.dataLabel,h.dataLabel.name="x"):(h.dataLabel={visible:!0,position:"Outside",name:"x"},this.parent.setProperties({chartSettings:{chartSeries:{dataLabel:{visible:!0,position:"Outside"}}}},!0)),this.accEmptyPoint&&h.emptyPointSettings?h.emptyPointSettings.mode="Zero":this.accEmptyPoint&&(h.emptyPointSettings={mode:"Zero"}),h.name=this.currentColumn,"Doughnut"===o?(h.type="Pie",h.innerRadius=this.chartSettings.chartSeries.innerRadius?this.chartSettings.chartSeries.innerRadius:"40%"):"Pie"===o&&(h.innerRadius=this.chartSettings.chartSeries.innerRadius?this.chartSettings.chartSeries.innerRadius:"0"),this.chartSeries=this.chartSeries.concat(h)}else for(var p=0,u=a;p<u.length;p++){var c=u[p];h={};h=this.persistSettings.chartSeries?this.frameChartSeries(this.persistSettings.chartSeries):h,!(0,t.isNullOrUndefined)(h.palettes)&&h.palettes.length>0&&((0,t.isNullOrUndefined)(this.persistSettings.palettes)||0===this.persistSettings.palettes.length)&&(this.chartSettings.palettes=h.palettes);for(d=0;d<this.columnGroupObject[c].length;d++){var g=this.engineModule.fieldList[this.currentMeasure];this.columnGroupObject[c][d].x=0!==this.parent.dataSourceSettings.rows.length||this.chartSettings.showMultiLevelLabels?""===this.columnGroupObject[c][d].x?this.parent.localeObj.getConstant("blank"):this.columnGroupObject[c][d].x:this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(g.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+((0,t.isNullOrUndefined)(g.caption)?g.name:g.caption)}h.dataSource=this.columnGroupObject[c],h.xName="x",h.yName="y",h.visible=!0;for(var m=void 0,f=void 0,v=void 0,S=(d=0,c.split(" | "));d<S.length;d++)this.measuresNames&&this.measuresNames[S[d]]&&(f=S[d],v=c.split(" | "+f)[0]);if(this.chartSettings.enableMultipleAxis){var y=f;m=v+" | "+(y=(0,t.isNullOrUndefined)(l[y])?y:l[y])}if(h.name=this.chartSettings.enableMultipleAxis?m:v,this.chartSettings.showPointColorByMembers&&this.chartSettings.enableMultipleAxis){h.name=v;var b=this.chartSeriesInfo[h.name].caption;h.name=null!=b?b:h.name,i[h.name]?(h.fill=i[h.name].color,this.chartSeriesInfo[h.name].colorIndex.push(this.selectedLegend++),h.name=void 0):(e=r[e]?e:0,i[h.name]={name:h.name,color:r[e]},h.fill=r[e++],this.chartSeriesInfo[h.name].colorIndex.push(this.selectedLegend++))}if(["Radar","Polar"].indexOf(o)<0){var C=f;h.tooltipMappingName=this.measuresNames[C],h.yAxisName=this.chartSettings.enableMultipleAxis&&"Combined"===this.chartSettings.multipleAxisMode?this.measureList.join("_"):this.measuresNames[C]?this.measuresNames[C]:C}this.persistSettings.chartSeries&&this.persistSettings.chartSeries.emptyPointSettings&&(h.emptyPointSettings=this.persistSettings.chartSeries.emptyPointSettings),h.emptyPointSettings||(h.emptyPointSettings={mode:"Zero"}),this.chartSeries=this.chartSeries.concat(h)}var x={series:this.chartSeries,cancel:!1},w=this;this.parent.trigger(_a,x,(function(e){e.cancel?(w.element&&(0,t.remove)(w.element),w.parent.notify(mr,{})):w.bindChart()}))},e.prototype.frameObjectWithKeys=function(e){for(var t=Object.keys(e),i=0,a={};i<t.length;)a[t[i]]=e[t[i]],i++;return a},e.prototype.frameChartSeries=function(e){for(var t=Object.keys(e),i=0,a={};i<t.length;)this.accumulationType.indexOf(this.parent.chartSettings.chartSeries.type)>-1&&["fill","dashArray","width","segmentAxis","drawType","isClosed","segments","stackingGroup","marker","errorBar","trendlines","minRadius","splineType","maxRadius","cardinalSplineTension","columnWidth","columnSpacing","cornerRadius"].indexOf(t[i])>-1||this.accumulationType.indexOf(this.parent.chartSettings.chartSeries.type)<0&&["endAngle","explode","explodeAll","explodeIndex","explodeOffset","gapRatio","groupMode","groupTo","neckHeight","neckWidth","pyramidMode","startAngle","dataLabel","innerRadius"].indexOf(t[i])>-1||(a[t[i]]=e[t[i]]),i++;return a},e.prototype.bindChart=function(){this.parent.showWaitingPopup();var e=this.configXAxis(),i=this.configTooltipSettings(),a=this.configLegendSettings(),r=this.configZoomSettings(),n=this.frameAxesWithRows(),s=this.chartSettings.chartSeries.type;"Both"===this.parent.displayOption.view?this.element="Chart"===this.parent.displayOption.primary?this.parent.element.insertBefore(this.element?this.element:(0,t.createElement)("div",{className:ei,id:this.parent.element.id+"_chart"}),this.parent.element.querySelector("."+gt)):this.parent.element.appendChild(this.element?this.element:(0,t.createElement)("div",{className:ei,id:this.parent.element.id+"_chart"})):this.element||(this.element=this.parent.element.appendChild((0,t.createElement)("div",{className:ei,id:this.parent.element.id+"_chart"}))),!this.chartElement&&this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&"Pareto"!==this.chartSettings.chartSeries.type&&(this.parent.element.querySelector("."+ei).innerHTML="",this.chartElement=this.parent.element.querySelector("."+ei).appendChild((0,t.createElement)("div",{className:pi,id:this.parent.element.id+"_chartInner"}))),this.parent.element.querySelector("."+pi)&&(this.parent.element.querySelector("."+pi).innerHTML=""),this.parent.showGroupingBar?this.element.style.minWidth=this.parent.minWidth?this.parent.minWidth+"px":"400px !important":this.element.style.minWidth=this.parent.minWidth?this.parent.minWidth+"px":"310px !important";var o=this.parent.width.toString();this.parent.showToolbar&&this.parent.grid&&(o=this.parent.getGridWidthAsNumber().toString());var l=this.getChartHeight();this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&this.accumulationType.indexOf(s)<0&&"Pareto"!==this.chartSettings.chartSeries.type&&(this.parent.element.querySelector("."+ei).style.height=("auto"===l?this.getChartAutoHeight():l)+"px",this.parent.element.querySelector("."+ei).style.width=o+"px","Polar"!==this.parent.chartSettings.chartSeries.type&&"Radar"!==this.parent.chartSettings.chartSeries.type&&(this.parent.element.querySelector("."+ei).style.overflow="auto",this.parent.element.querySelector("."+ei).style.overflowX="hidden")),this.parent.chart&&("accumulationchart"===this.parent.chart.getModuleName()&&this.accumulationType.indexOf(s)<0||"chart"===this.parent.chart.getModuleName()&&this.accumulationType.indexOf(s)>-1&&"Pareto"!==this.chartSettings.chartSeries.type)&&(this.parent.chart.destroy(),(0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element)&&((0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element).innerHTML="",(0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element).appendChild((0,t.createElement)("div",{className:pi,id:this.parent.element.id+"_chartInner"})))),!(this.parent.chart&&this.parent.chart.element&&this.parent.element.querySelector(".e-chart")||this.parent.element.querySelector(".e-accumulationchart"))||this.parent.toolbarModule&&this.parent.toolbarModule.isMultiAxisChange?(this.parent.toolbarModule&&this.parent.toolbarModule.isMultiAxisChange&&this.parent.chart&&(this.parent.chart.isDestroyed||this.parent.chart.destroy(),this.parent.chart=void 0,(0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element).innerHTML="",(0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element).appendChild((0,t.createElement)("div",{className:pi,id:this.parent.element.id+"_chartInner"})),this.parent.toolbarModule.isMultiAxisChange=!1),to.Chart.Inject(to.ColumnSeries,to.StackingColumnSeries,to.RangeColumnSeries,to.BarSeries,to.StackingBarSeries,to.ScatterSeries,to.BubbleSeries,to.LineSeries,to.StepLineSeries,to.SplineSeries,to.SplineAreaSeries,to.MultiColoredLineSeries,to.PolarSeries,to.RadarSeries,to.AreaSeries,to.RangeAreaSeries,to.StackingAreaSeries,to.StepAreaSeries,to.StackingLineSeries,to.MultiColoredAreaSeries,to.ParetoSeries,to.Legend,to.Tooltip,to.Category,to.MultiLevelLabel,to.ScrollBar,to.Zoom,to.Export,to.Crosshair,to.Selection,to.StripLine,to.DataLabel),to.AccumulationChart.Inject(to.PieSeries,to.FunnelSeries,to.PyramidSeries,to.AccumulationDataLabel,to.AccumulationLegend,to.AccumulationTooltip,to.Export),this.accumulationType.indexOf(s)>-1?this.parent.chart=new to.AccumulationChart({series:this.chartSeries.length>0?this.chartSeries:[{}],legendSettings:a,tooltip:i,width:o,height:l.toString(),title:this.chartSettings.title,enableSmartLabels:this.chartSettings.enableSmartLabels,center:this.chartSettings.pieCenter,enableBorderOnMouseMove:this.chartSettings.enableBorderOnMouseMove,highlightMode:this.chartSettings.highlightMode,highlightPattern:this.chartSettings.highlightPattern,titleStyle:this.chartSettings.titleStyle,subTitle:this.chartSettings.subTitle,subTitleStyle:this.chartSettings.subTitleStyle,margin:this.chartSettings.margin,border:this.chartSettings.border,background:this.chartSettings.background,theme:this.chartSettings.theme,selectionMode:this.chartSettings.accumulationSelectionMode,isMultiSelect:this.chartSettings.isMultiSelect,enableExport:this.chartSettings.enableExport,selectedDataIndexes:this.chartSettings.selectedDataIndexes,enableAnimation:this.chartSettings.enableAnimation,useGroupingSeparator:this.chartSettings.useGroupingSeparator,locale:this.parent.locale,enableRtl:this.parent.enableRtl,beforePrint:this.beforePrint.bind(this),animationComplete:this.animationComplete.bind(this),legendRender:this.legendRender.bind(this),textRender:this.textRender.bind(this),pointRender:this.pointRender.bind(this),seriesRender:this.seriesRender.bind(this),chartMouseMove:this.chartMouseMove.bind(this),chartMouseClick:this.chartMouseClick.bind(this),pointMove:this.pointMove.bind(this),pointClick:this.pointClick.bind(this),chartMouseLeave:this.chartMouseLeave.bind(this),chartMouseDown:this.chartMouseDown.bind(this),chartMouseUp:this.chartMouseUp.bind(this),tooltipRender:this.tooltipRender.bind(this),loaded:this.loaded.bind(this),load:this.load.bind(this),resized:this.resized.bind(this)}):this.parent.chart=new to.Chart({series:this.chartSeries.length>0?this.chartSeries:[{}],legendSettings:a,tooltip:i,zoomSettings:r,axes:"Polar"===s||"Radar"===s?[]:n.axes,rows:"Polar"===s||"Radar"===s?[{}]:"Bar"===s||"StackingBar"===s||"StackingBar100"===s||"Pareto"===s&&this.chartSettings.enableMultipleAxis?[{height:"100%"}]:n.rows,columns:"Polar"===s||"Radar"===s?[{}]:"Bar"===s||"StackingBar"===s||"StackingBar100"===s&&this.chartSettings.enableMultipleAxis?n.columns:[{width:"100%"}],primaryYAxis:"Polar"===s||"Radar"===s?n.axes[0]:{visible:!1},primaryXAxis:e,width:o,height:"Polar"!==this.parent.chartSettings.chartSeries.type&&"Radar"!==this.parent.chartSettings.chartSeries.type&&this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&"Pareto"!==this.parent.chartSettings.chartSeries.type&&this.parent.dataSourceSettings.values.length>0?Number(l)>235*this.parent.dataSourceSettings.values.length+100?isNaN(Number(l))?l.toString():(Number(l)-5).toString():!isNaN(Number(l))||this.parent.dataSourceSettings.values.length>1?(235*this.parent.dataSourceSettings.values.length+100).toString():l.toString():l.toString(),title:this.chartSettings.title,titleStyle:this.chartSettings.titleStyle,subTitle:this.chartSettings.subTitle,subTitleStyle:this.chartSettings.subTitleStyle,margin:this.chartSettings.margin,border:this.chartSettings.border,background:this.chartSettings.background,chartArea:(0,t.isNullOrUndefined)(this.persistSettings.chartArea)?this.chartSettings.chartArea:this.persistSettings.chartArea,palettes:this.chartSettings.palettes,theme:this.chartSettings.theme,crosshair:this.chartSettings.crosshair,selectionMode:this.chartSettings.selectionMode,isMultiSelect:this.chartSettings.isMultiSelect,enableExport:this.chartSettings.enableExport,selectedDataIndexes:this.chartSettings.selectedDataIndexes,isTransposed:this.chartSettings.isTransposed,enableAnimation:this.chartSettings.enableAnimation,enableCanvas:this.chartSettings.enableCanvas,useGroupingSeparator:this.chartSettings.useGroupingSeparator,description:this.chartSettings.description,tabIndex:this.chartSettings.tabIndex,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableSideBySidePlacement:this.chartSettings.enableSideBySidePlacement,beforePrint:this.beforePrint.bind(this),animationComplete:this.animationComplete.bind(this),legendRender:this.legendRender.bind(this),textRender:this.textRender.bind(this),pointRender:this.pointRender.bind(this),seriesRender:this.seriesRender.bind(this),chartMouseMove:this.chartMouseMove.bind(this),chartMouseClick:this.chartMouseClick.bind(this),pointMove:this.pointMove.bind(this),pointClick:this.pointClick.bind(this),chartMouseLeave:this.chartMouseLeave.bind(this),chartMouseDown:this.chartMouseDown.bind(this),chartMouseUp:this.chartMouseUp.bind(this),dragComplete:this.dragComplete.bind(this),zoomComplete:this.zoomComplete.bind(this),scrollStart:this.scrollStart.bind(this),scrollEnd:this.scrollEnd.bind(this),scrollChanged:this.scrollChanged.bind(this),tooltipRender:this.tooltipRender.bind(this),legendClick:this.legendClick.bind(this),loaded:this.loaded.bind(this),load:this.load.bind(this),resized:this.resized.bind(this),axisLabelRender:this.axisLabelRender.bind(this),multiLevelLabelClick:this.multiLevelLabelClick.bind(this),axisMultiLabelRender:this.multiLevelLabelRender.bind(this)}),this.parent.chart.isStringTemplate=!0):(this.parent.chart.series=this.chartSeries,this.parent.chart.title=this.parent.chartSettings.title,this.parent.chart.subTitle=this.parent.chartSettings.subTitle,this.parent.chart.background=this.parent.chartSettings.background,this.parent.chart.theme=this.parent.chartSettings.theme,this.parent.chart.legendSettings=a,this.parent.chart.selectionMode=this.parent.chartSettings.selectionMode,this.parent.chart.enableExport=this.chartSettings.enableExport,this.parent.chart.isMultiSelect=this.parent.chartSettings.isMultiSelect,this.parent.chart.enableAnimation=this.parent.chartSettings.enableAnimation,this.parent.chart.useGroupingSeparator=this.parent.chartSettings.useGroupingSeparator,this.parent.chart.highlightPattern=this.parent.chartSettings.highlightPattern,this.accumulationType.indexOf(s)>-1?(this.parent.chart.enableBorderOnMouseMove=this.parent.chartSettings.enableBorderOnMouseMove,this.parent.chart.highlightMode=this.parent.chartSettings.highlightMode,this.parent.chart.enableSmartLabels=this.parent.chartSettings.enableSmartLabels):(this.parent.chart.palettes=this.parent.chartSettings.palettes,this.parent.chart.isTransposed=this.parent.chartSettings.isTransposed,this.parent.chart.enableSideBySidePlacement=this.parent.chartSettings.enableSideBySidePlacement,this.parent.chart.tabIndex=this.parent.chartSettings.tabIndex,this.parent.chart.description=this.parent.chartSettings.description,this.parent.chart.enableCanvas=this.parent.chartSettings.enableCanvas),"Polar"===s||"Radar"===s?(this.parent.chart.primaryXAxis=e,this.parent.chart.primaryYAxis.visible=!0,this.parent.chart.primaryYAxis=n.axes[0],this.parent.chart.axes=[],this.parent.chart.rows=[{}]):this.accumulationType.indexOf(s)<0&&"chart"===this.parent.chart.getModuleName()&&(this.parent.chart.primaryYAxis.visible=!1,this.parent.chart.primaryXAxis=e,this.parent.chart.axes=n.axes,"Bar"===s||"StackingBar"===s||"StackingBar100"===s&&this.chartSettings.enableMultipleAxis?(this.parent.chart.rows=[{height:"100%"}],this.parent.chart.columns=n.columns):"Pareto"===s&&this.chartSettings.enableMultipleAxis?(this.parent.chart.rows=[{height:"100%"}],this.parent.chart.columns=[{width:"100%"}]):(this.parent.chart.rows=n.rows,this.parent.chart.columns=[{width:"100%"}])),this.parent.chart.refresh(),this.accumulationType.indexOf(s)>-1&&"accumulationchart"===this.parent.chart.getModuleName()&&(0===this.parent.dataSourceSettings.rows.length||0===this.parent.dataSourceSettings.columns.length)&&(this.parent.hideWaitingPopup(),this.parent.pivotFieldListModule&&(0,Ni.hideSpinner)(this.parent.pivotFieldListModule.fieldListSpinnerElement))),this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis?this.parent.chart.appendTo((0,t.select)("#"+this.parent.element.id+"_chartInner",this.parent.element)):this.parent.chart.appendTo((0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element))},e.prototype.legendClick=function(e){if(this.chartSettings.showPointColorByMembers&&this.chartSettings.enableMultipleAxis)for(var t=this.chartSeriesInfo[e.legendText].colorIndex,i=1;i<t.length;i++)e.chart.series[t[i]].visible=!e.chart.series[t[i]].visible;this.parent.trigger(ya,e)},e.prototype.pointClick=function(e){var t=e.series.dataSource?e.series.dataSource:this.parent.chart.series[e.seriesIndex].dataSource;if((["Pie","Funnel","Doughnut","Pyramid","Radar","Polar"].indexOf(this.parent.chartSettings.chartSeries.type)>-1||!this.parent.chartSettings.showMultiLevelLabels)&&("olap"===this.parent.dataType||this.parent.dataSourceSettings.rows.length>1)){this.pivotIndex={rIndex:t?t[e.pointIndex].rIndex:void 0,cIndex:t?t[e.pointIndex].cIndex:void 0},this.creatMenu();var i=this.parent.element.getBoundingClientRect(),a=(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:0)+(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:0)+(window.scrollY||document.documentElement.scrollTop)+i.top;this.accumulationMenu.open(a+e.y,e.x+i.left+(window.scrollX||document.documentElement.scrollLeft))}else if((this.parent.allowDrillThrough||this.parent.editSettings.allowEditing)&&this.parent.drillThroughModule){var r=t[e.pointIndex].rIndex,n=t[e.pointIndex].cIndex;this.parent.drillThroughModule.executeDrillThrough(this.parent.pivotValues[r][n],r,n)}this.parent.trigger(rr,e)},e.prototype.frameAxesWithRows=function(){var e=[],i=[],a=[],r=[],n=this.persistSettings.chartSeries&&("StackingColumn100"===this.persistSettings.chartSeries.type||"StackingBar100"===this.persistSettings.chartSeries.type||"StackingArea100"===this.persistSettings.chartSeries.type||"StackingLine100"===this.persistSettings.chartSeries.type),s=["PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal"];if(this.chartSettings.enableMultipleAxis)for(var o=0,l=100/this.dataSourceSettings.values.length+"%",d=0,h=this.dataSourceSettings.values;d<h.length;d++){var p=h[d],u=this.engineModule.fieldList[p.name],c=("olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(u.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" ")+u.caption;r.push(c);for(var g=void 0,m=0,f=this.dataSourceSettings.formatSettings;m<f.length;m++){var v=f[m];if(v.name===p.name){g=v;break}}var S=-1!==Di.inArray(u.aggregateType,s)?"P2":g?g.format:"olap"===this.parent.dataType?this.getFormat(u.formatString):"N",y="Polar"===this.chartSettings.chartSeries.type||"Radar"===this.chartSettings.chartSeries.type,b={};(b=this.persistSettings.primaryYAxis?this.frameObjectWithKeys(this.persistSettings.primaryYAxis):b).labelFormat=b.labelFormat?b.labelFormat:n?"":y?"N":S,b.title=b.title?b.title:"Combined"===this.chartSettings.multipleAxisMode?r.join(" - "):c,b.zoomFactor=(0,t.isNullOrUndefined)(this.chartSettings.primaryYAxis.zoomFactor)?1:this.chartSettings.primaryYAxis.zoomFactor,b.edgeLabelPlacement=this.chartSettings.primaryYAxis.edgeLabelPlacement?this.chartSettings.primaryYAxis.edgeLabelPlacement:this.persistSettings.primaryYAxis.edgeLabelPlacement,"Bar"===this.chartSettings.chartSeries.type||"StackingBar"===this.chartSettings.chartSeries.type||"StackingBar100"===this.chartSettings.chartSeries.type?b.plotOffsetRight=b.plotOffsetRight?b.plotOffsetRight:30:b.plotOffsetTop=b.plotOffsetTop?b.plotOffsetTop:30,y||(b.name="Combined"===this.chartSettings.multipleAxisMode?this.measureList.join("_"):this.measuresNames[p.name]?this.measuresNames[p.name]:p.name),e=e.concat(b),"Combined"===this.chartSettings.multipleAxisMode&&(e=[e[e.length-1]]),"Stacked"===this.chartSettings.multipleAxisMode?(b.rowIndex=o,b.columnIndex=o,i.push({height:l}),a.push({width:l})):(b.rowIndex=0,b.columnIndex=0,i=[{height:"100%"}],a=[{width:"100%"}]),o++}else{u=this.engineModule.fieldList[this.currentMeasure],c=("olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(u.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" ")+u.caption,g=void 0;for(var C=0,x=this.dataSourceSettings.formatSettings;C<x.length;C++){if((p=x[C]).name===this.currentMeasure){g=p;break}}b={},S=-1!==Di.inArray(u.aggregateType,s)?"P2":g?g.format:"olap"===this.parent.dataType?this.getFormat(u.formatString):"N";(b=this.persistSettings.primaryYAxis?this.frameObjectWithKeys(this.persistSettings.primaryYAxis):b).zoomFactor=(0,t.isNullOrUndefined)(this.chartSettings.primaryYAxis.zoomFactor)?1:this.chartSettings.primaryYAxis.zoomFactor,b.rowIndex=0,b.columnIndex=0,b.edgeLabelPlacement=this.chartSettings.primaryYAxis.edgeLabelPlacement?this.chartSettings.primaryYAxis.edgeLabelPlacement:this.persistSettings.primaryYAxis.edgeLabelPlacement,"Polar"!==this.chartSettings.chartSeries.type&&"Radar"!==this.chartSettings.chartSeries.type&&(b.name=this.measuresNames[this.currentMeasure]?this.measuresNames[this.currentMeasure]:this.currentMeasure),b.labelFormat=b.labelFormat?b.labelFormat:n?"":S,b.title=b.title?b.title:c,e=e.concat(b),i.push({height:"100%"}),a.push({width:"100%"})}return{axes:e,rows:i,columns:a}},e.prototype.getFormat=function(e){return e="Currency"===e?"C":"Percent"===e?"P":"N"},e.prototype.getColumnTotalIndex=function(e){for(var i={},a=0,r=Object.keys(e);a<r.length;a++){var n=r[a],s=e[Number(n)];if(!(0,t.isNullOrUndefined)(s))for(var o=0,l=Object.keys(s);o<l.length;o++){var d=l[o],h=s[Number(d)];if(!(0,t.isNullOrUndefined)(h)){if("column"!==h.axis)return i;"sum"!==h.type&&(this.dataSourceSettings&&this.dataSourceSettings.columns&&0===this.dataSourceSettings.columns.length||"grand sum"!==h.type)||-1===h.rowSpan||(i[h.colIndex]=h.colIndex)}}}return i},e.prototype.groupHierarchyWithLevels=function(e,i){var a,r,n={},s=0,o={};this.measurePos=this.engineModule.tupRowInfo[0].measurePosition;for(var l=0;l<e.length;l++){var d=e[l][0];d&&"row"===d.axis&&"grand sum"!==d.type&&((0,t.isNullOrUndefined)(n[d.hierarchy])?(3===d.memberType?s===this.measurePos?(i[this.measurePos]=d.hierarchy,n[d.hierarchy]=((a={})[d.levelUniqueName]=d.levelUniqueName,a)):s--:(i[s]=d.hierarchy,n[d.hierarchy]=((r={})[d.levelUniqueName]=d.levelUniqueName,r)),s++):n[d.hierarchy][d.levelUniqueName]=d.levelUniqueName)}for(var h=-1,p=0;p<i.length;p++)this.measurePos!==p&&(o[i[p]]={start:h+1,end:h+Object.keys(n[i[p]]).length},h=o[i[p]].end);return o},e.prototype.frameMultiLevelLabels=function(){for(var e=Object.keys(this.headerColl),t=this.headerColl[-.5],i=0,a=e;i<a.length;i++){for(var r=a[i],n=Number(r),s=this.headerColl[n],o=0,l=!1;o<=this.maxLevel;)l?s[o]||(s[o]={name:s[o-1].name,text:"",hasChild:s[o-1].hasChild,isDrilled:s[o-1].isDrilled,levelName:s[o-1].levelName,level:s[o-1].level,fieldName:s[o-1].fieldName,rowIndex:s[o-1].rowIndex,colIndex:s[o-1].colIndex,span:-1}):s[o]?l=!0:s[o]=t[o],o++;t=this.headerColl[n]}for(var d={},h=0,p=e;h<p.length;h++){r=p[h],n=Number(r),s=this.headerColl[n];for(var u=0,c=Object.keys(s);u<c.length;u++){var g=c[u],m=Number(g);if(d[m]){var f=d[m].length;s[m].levelName===t[m].levelName?d[m][f-1].end=d[m][f-1].end+1:d[m].push({start:n,end:n+1,text:s[m].text,type:-1===s[m].span?"WithoutTopandBottomBorder":"WithoutTopBorder",customAttributes:s[m]})}else d[m]=[{start:n,end:n+1,text:s[m].text,type:-1===s[m].span?"WithoutTopandBottomBorder":"WithoutTopBorder",customAttributes:s[m]}]}t=s}for(var v=[],S=Object.keys(d).length-1;S>-1;S--)v.push({categories:d[S],border:{width:1},overflow:"Trim"});return v},e.prototype.getZoomFactor=function(){this.calculatedWidth=this.getCalulatedWidth();var e=10*this.chartSeries.length>120?10*this.chartSeries.length:120,t=this.chartSeries.length>0?this.calculatedWidth/(Object.keys(this.chartSeries[0].dataSource).length*e):1;return t=t<1&&t>0?t:1},e.prototype.getCalulatedWidth=function(){return isNaN(Number(this.parent.width))?this.parent.width.indexOf("%")>-1?this.calculatedWidth=this.parent.element.clientWidth*(parseFloat(this.parent.width)/100):this.parent.width.indexOf("px")>-1?this.calculatedWidth=Number(this.parent.width.toString().split("px")[0]):this.calculatedWidth=this.parent.element.clientWidth:this.calculatedWidth=Number(this.parent.width),this.calculatedWidth},e.prototype.configTooltipSettings=function(){var e=this.persistSettings.tooltip?this.persistSettings.tooltip:this.chartSettings.tooltip;return e.enable=void 0===e.enable||e.enable,e.enable&&e.template&&(this.templateFn=this.parent.templateParser(e.template)),this.parent.tooltipTemplate&&(e.template=e.template?e.template:this.parent.tooltipTemplate),e.header=e.header?e.header:"",e.enableMarker=void 0===e.enableMarker||e.enableMarker,e},e.prototype.configLegendSettings=function(){var e={};if(this.chartSettings.legendSettings)for(var t=0,i=Object.keys(this.chartSettings.legendSettings);t<i.length;)e[i[t]]=this.chartSettings.legendSettings[i[t]],t++;return e.visible=!1!==e.visible,e.padding=e.padding?e.padding:25,e.shapePadding=e.shapePadding?e.shapePadding:10,e},e.prototype.configXAxis=function(){var e={};return(e=this.persistSettings.primaryXAxis?this.frameObjectWithKeys(this.persistSettings.primaryXAxis):e).valueType="Category",e.labelIntersectAction=e.labelIntersectAction?e.labelIntersectAction:"Rotate45",e.title=e.title?e.title:this.dataSourceSettings.rows.map((function(e){return e.caption||e.name})).join(" / "),e.zoomFactor=(0,t.isNullOrUndefined)(this.parent.chartSettings.primaryXAxis.zoomFactor)?this.getZoomFactor():this.parent.chartSettings.primaryXAxis.zoomFactor,this.parent.chartSettings.zoomSettings.enableScrollbar||(e.zoomFactor=1),this.chartSettings.showMultiLevelLabels&&"Pareto"!==this.chartSettings.chartSeries.type?(e.multiLevelLabels=this.frameMultiLevelLabels(),e.border={width:1,type:"WithoutTopandBottomBorder"},e.majorTickLines={width:0,height:-10}):(e.multiLevelLabels=[],e.border={width:1,type:"Rectangle"},e.majorTickLines={width:0,height:5}),e},e.prototype.configZoomSettings=function(){var e=this.chartSettings.zoomSettings;return e.enableSelectionZooming=void 0===e.enableSelectionZooming||e.enableSelectionZooming,e.enableScrollbar=void 0===e.enableScrollbar||e.enableScrollbar,e},e.prototype.tooltipRender=function(e){var i=this.chartSettings.enableMultipleAxis&&"Combined"===this.chartSettings.multipleAxisMode&&this.accumulationType.indexOf(this.chartSettings.chartSeries.type)<0&&"Radar"!==this.chartSettings.chartSeries.type&&"Polar"!==this.chartSettings.chartSeries.type?e.series.tooltipMappingName:e.series.yAxisName?e.series.yAxisName.split("_CumulativeAxis")[0]:this.chartSettings.enableMultipleAxis&&this.accumulationType.indexOf(this.chartSettings.chartSeries.type)<0&&"Pareto"!==this.chartSettings.chartSeries.type?e.series.name?e.series.name.split(" | ")[1]:e.data.seriesName?e.data.seriesName.split(" | ")[1]:this.currentMeasure:this.measuresNames[this.currentMeasure]?this.measuresNames[this.currentMeasure]:this.currentMeasure,a=e.series.dataSource?e.series.dataSource:this.parent.chart.series[e.data.seriesIndex].dataSource,r=a?a[e.data.pointIndex].rIndex:void 0,n=a?a[e.data.pointIndex].cIndex:void 0,s=this.engineModule.fieldList[this.measuresNames[i]?this.measuresNames[i]:i],o="olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(s.aggregateType),l=("olap"===this.parent.dataType?"":o+" "+this.parent.localeObj.getConstant("of")+" ")+s.caption,d=this.engineModule.pivotValues[r][n].formattedText,h=this.engineModule.formatFields[s.id],p=this.engineModule.getFormattedValue(e.point.y,s.id,d),u=h&&h.format&&null!==h.format.toLowerCase().match(/n|p|c/)&&this.chartSettings.useGroupingSeparator?"olap"===this.parent.dataType?p.toString():p.formattedText:d,c=this.parent.pivotValues[r][n],g=c.columnHeaders,m="";if((0,t.isNullOrUndefined)(g))m=void 0;else if("olap"===this.parent.dataType)m=this.chartSeriesInfo[g.toString().split(/~~|::/).join(" - ")].uniqueName;else{var f=g.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter);g=Di.formatChartHeaders(f,this,!0,c),m=this.chartSeriesInfo[g.toString()].uniqueName}var v=e.point.x;if(this.parent.tooltipTemplate&&void 0!==this.parent.getTooltipTemplate()||this.chartSettings.tooltip.template){var S=a?this.parent.getHeaderField(r,n,"row"):"",y=a?this.parent.getHeaderField(r,n,"Column"):"",b={rowHeaders:v,columnHeaders:m,aggregateType:o,value:u,valueField:s.caption,rowFields:S,columnFields:y},C=void 0;C=this.parent.chartSettings&&this.parent.chartSettings.tooltip&&this.parent.chartSettings.tooltip.enable&&this.parent.chartSettings.tooltip.template?this.tooltipTemplateFn()(b,this,"tooltipTemplate",this.element.id+"1tooltipTemplate")[0].outerHTML:this.parent.getTooltipTemplate()(b,this,"tooltipTemplate",this.element.id+"tooltipTemplate")[0].outerHTML,e.template=C}else e.text=l+": "+u+(0===this.dataSourceSettings.columns.length?"":" <br/>"+this.parent.localeObj.getConstant("column")+": "+m)+(0===this.dataSourceSettings.rows.length?"":" <br/>"+this.parent.localeObj.getConstant("row")+": "+v)+(e.data&&"Pareto"===e.data.seriesName?" <br/>"+this.parent.localeObj.getConstant("pareto")+": "+e.data.pointY+"%":""),this.parent.trigger(Sa,e)},e.prototype.tooltipTemplateFn=function(){return this.templateFn},e.prototype.loaded=function(e){this.parent.isChartLoaded=!0;var i=this.parent.grid?this.parent.getGridWidthAsNumber().toString():this.parent.getWidthAsNumber().toString();if(this.parent.chart&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.showFieldList&&"Chart"===this.parent.currentView&&this.parent.groupingBarModule.alignIcon(),this.chartSettings.showMultiLevelLabels){var a=Di.inArray(this.chartSettings.chartSeries.type,["Bar","StackingBar","StackingBar100"])>-1?"_chartYAxisMultiLevelLabel0":"_chartXAxisMultiLevelLabel0";(0,t.isNullOrUndefined)((0,t.select)("#"+this.parent.element.id+a,this.parent.element))||this.parent.element.querySelector("#"+this.parent.element.id+a).setAttribute("cursor","pointer")}var r=this.getChartHeight();this.parent.chart.height=r,this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&(["Pie","Funnel","Pyramid","Doughnut","Radar","Polar","Pareto"].indexOf(this.parent.chartSettings.chartSeries.type)>=0?this.parent.element.querySelector("."+ei).style.overflow="visible":(this.parent.element.querySelector("."+ei).style.overflow="auto",this.parent.element.querySelector("."+ei).style.overflowX="hidden"),this.parent.element.querySelector("."+ei).style.width=i+"px",this.parent.element.querySelector("."+ei).style.height=r+"px"),this.updateView(),"Chart"!==this.parent.displayOption.primary&&"Chart"!==this.parent.displayOption.view||this.parent.notify(mr,{}),this.parent.trigger(ba,e),("Server"===this.parent.dataSourceSettings.mode&&this.parent.isServerWaitingPopup||"Local"===this.parent.dataSourceSettings.mode)&&this.parent.hideWaitingPopup()},e.prototype.updateView=function(){if(this.parent.grid&&this.parent.chart&&this.parent.showToolbar){var e=this.parent.element.querySelector(".e-pivot-grouping-bar"),t=this.parent.element.querySelector(".e-chart-grouping-bar");"Table"===this.parent.currentView?(this.parent.grid.element.style.display="",this.parent.chart.element.style.display="none",this.parent.showGroupingBar&&this.parent.groupingBarModule&&(e&&(e.style.display="",e.querySelector("."+E)&&null!=this.parent.groupingBarModule.gridPanel&&!this.parent.groupingBarModule.gridPanel.isDestroyed&&this.parent.groupingBarModule.gridPanel.refreshOverflow()),t&&(t.style.display="none")),this.parent.chartSettings.enableMultipleAxis&&this.parent.chartSettings.enableScrollOnMultiAxis&&(this.parent.element.querySelector(".e-pivotchart").style.display="none")):(this.parent.grid.element.style.display="none",this.parent.chart.element.style.display="",this.parent.showGroupingBar&&this.parent.groupingBarModule&&(e&&(e.style.display="none"),t&&(t.style.display="",t.querySelector("."+E)&&null!=this.parent.groupingBarModule.chartPanel&&!this.parent.groupingBarModule.chartPanel.isDestroyed&&this.parent.groupingBarModule.chartPanel.refreshOverflow())),this.parent.chartSettings.enableMultipleAxis&&this.parent.chartSettings.enableScrollOnMultiAxis&&(this.parent.element.querySelector(".e-pivotchart").style.display=""))}},e.prototype.creatMenu=function(){this.accumulationMenu&&!this.accumulationMenu.isDestroyed&&this.accumulationMenu.destroy();for(var e=(this.parent.allowDrillThrough||this.parent.editSettings.allowEditing)&&this.parent.drillThroughModule?["expand","collapse","drillThrough","exit"]:["expand","collapse","exit"],i=[],a=0;a<e.length;a++)i.push({id:this.parent.element.id+"_DrillMenuChart_"+e[a],text:this.parent.localeObj.getConstant(e[a]),items:[]});var r=this.getMenuItems(),n=[],s=[];for(a=0;a<r.length;a++)"expand"===r[a].type?n.push({id:this.element.id+"drillExpand_"+r[a].key,text:r[a].value}):s.push({id:this.element.id+"drillCollapse_"+r[a].key,text:r[a].value});n.length>0&&(i[0].items=n),s.length>0&&(i[1].items=s);var o,l={cssClass:this.parent.element.id+"_accumulationChart"+(this.parent.cssClass?" "+this.parent.cssClass:""),items:i,enableRtl:this.parent.enableRtl,beforeOpen:this.drillMenuOpen.bind(this),select:this.drillMenuSelect.bind(this),locale:this.parent.locale};this.accumulationMenu=new ms.ContextMenu(l),(0,t.select)("#"+this.parent.element.id+"_accumulationChart",this.parent.element)?(o=(0,t.select)("#"+this.parent.element.id+"_accumulationChart",this.parent.element)).innerHTML="":(o=(0,t.createElement)("ul",{id:this.parent.element.id+"_accumulationChart"}),this.parent.element.appendChild(o)),this.accumulationMenu.isStringTemplate=!0,this.accumulationMenu.appendTo(o)},e.prototype.drillMenuOpen=function(e){e.items[0]&&e.items[0].text===this.parent.localeObj.getConstant("expand")&&e.items[0].items&&0===e.items[0].items.length&&this.accumulationMenu.enableItems([this.parent.localeObj.getConstant("expand")],!1),e.items[1]&&e.items[1].text===this.parent.localeObj.getConstant("collapse")&&e.items[1].items&&0===e.items[1].items.length&&this.accumulationMenu.enableItems([this.parent.localeObj.getConstant("collapse")],!1)},e.prototype.getMenuItems=function(){for(var e=this.pivotIndex.rIndex,t=[],i=this.engineModule.pivotValues,a=[],r=i[e][this.pivotIndex.cIndex],n=!i[e][0].isNamedSet&&i[e][0].hasChild?i[e][0].level:void 0,s="olap"===this.parent.dataType?r.rowHeaders.toString().split(/~~|::/):r.rowHeaders.toString().split(this.engineModule.valueSortSettings.headerDelimiter);i[e][0];){if(r=i[e][0],0!==s.length&&s.indexOf(r.formattedText.toString())===s.length-1){r.hasChild&&!r.isNamedSet&&a.indexOf(r.level)<0&&(n?n>=r.level:0!==n||0===r.level)&&(r.isDrilled&&r.hasChild?t.push({key:e,type:"collapse",value:r.formattedText}):t.push({key:e,type:"expand",value:r.formattedText}),a.push(r.level),n=n?n-1:r.level-1);var o=s.indexOf(r.formattedText.toString());s.splice(o,1)}0===r.level&&r.hasChild&&!r.isNamedSet&&(n=void 0,a=[]),e--}return t},e.prototype.drillMenuSelect=function(e){var t="olap"===this.parent.dataType?this.parent.olapEngineModule.pivotValues:this.parent.engineModule.pivotValues,i=e.element.id.split("_DrillMenuChart_")[1];if(0===e.element.id.indexOf(this.element.id+"drill")){var a=e.element.id.split(this.element.id+"drill")[1].indexOf("Expand")>=0?"drillExpand":"drillCollapse",r=Number(e.element.id.split(this.element.id+a+"_")[1]),n=t[r][0],s="olap"===this.parent.dataType?n.formattedText:n.actualText?n.actualText.toString():n.formattedText.toString(),o=n.formattedText?n.formattedText.toString():s,l=n.hasChild&&!n.isNamedSet?(n.isDrilled?" - ":" + ")+o:o,d="olap"===this.parent.dataType?this.engineModule.tupRowInfo[n.ordinal]:void 0,h=d?d.uNameCollection:n.valueSort.levelName.toString(),p={fieldName:n.valueSort.axis,level:n.level,hasChild:n.hasChild,levelName:h,name:s,text:l,rowIndex:r,colIndex:0,isDrilled:n.isDrilled,cell:n};"olap"===this.parent.dataType?this.parent.onDrill(void 0,p):this.onDrill({customAttributes:p})}else"drillThrough"===i?this.parent.drillThroughModule.executeDrillThrough(t[this.pivotIndex.rIndex][this.pivotIndex.cIndex],this.pivotIndex.rIndex,this.pivotIndex.rIndex):"exit"===i&&this.accumulationMenu.close()},e.prototype.getChartHeight=function(){var e,i;if((0,t.isNullOrUndefined)(this.parent.getHeightAsNumber()))e="auto";else{var a=this.parent.showToolbar?6:5;e=(this.parent.getHeightAsNumber()-a).toString(),i=this.parent.getHeightAsNumber()-a}if((0,t.isNullOrUndefined)(this.parent.getHeightAsNumber()))e="auto";else{var r=!1;null!==this.parent.element.querySelector(".e-chart-grouping-bar")&&"none"===this.parent.element.querySelector(".e-chart-grouping-bar").style.display.toLowerCase()&&(r=!0,this.parent.element.querySelector(".e-chart-grouping-bar").style.display="block"),this.parent.showToolbar&&this.parent.showGroupingBar?e=(i-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:62)).toString():this.parent.showToolbar?e=(i-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)).toString():this.parent.showGroupingBar?e=(i-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:62)).toString():(this.parent.chart&&parseInt(this.parent.chart.height,10)<200||i<200)&&(e="200"),r&&(this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none")}return e},e.prototype.getChartAutoHeight=function(){var e=this.parent.element.offsetHeight<this.parent.minHeight?this.parent.minHeight:this.parent.element.offsetHeight;return this.parent.showToolbar&&this.parent.showGroupingBar?e=e-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:62):this.parent.showToolbar?e-=this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42:this.parent.showGroupingBar&&(e-=this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:62),e},e.prototype.axisLabelRender=function(e){if(this.chartSettings.showMultiLevelLabels&&"Pareto"!==this.chartSettings.chartSeries.type&&"primaryXAxis"===e.axis.name&&(e.text=""),"primaryXAxis"!==e.axis.name&&"StackingColumn100"!==this.parent.chartSettings.chartSeries.type&&"StackingBar100"!==this.parent.chartSettings.chartSeries.type&&"StackingArea100"!==this.parent.chartSettings.chartSeries.type&&"StackingLine100"!==this.parent.chartSettings.chartSeries.type){var t=this.chartSettings.enableMultipleAxis&&"Combined"===this.chartSettings.multipleAxisMode?this.currentMeasure:"olap"===this.parent.dataType?this.measuresNames[e.axis.name]:e.axis.name,i=this.engineModule.formatFields[t]||null,a=this.engineModule.getFormattedValue(e.value,this.chartSettings.enableMultipleAxis&&"Combined"===this.chartSettings.multipleAxisMode?this.currentMeasure:e.axis.name,e.text),r=i&&i.format&&this.chartSettings.useGroupingSeparator?"olap"===this.parent.dataType?a.toString():a.formattedText:e.value.toString();e.text=r}this.parent.trigger(Ua,e)},e.prototype.multiLevelLabelClick=function(e){var i={axis:e.axis,text:e.text,cell:(0,t.isNullOrUndefined)(e.customAttributes)?void 0:e.customAttributes.cell,cancel:!1};this.parent.trigger(da,i),!i.cancel&&e.customAttributes&&e.customAttributes.hasChild&&!e.customAttributes.cell.isNamedSet&&("olap"===this.parent.dataType?this.parent.onDrill(void 0,e.customAttributes):this.onDrill(e))},e.prototype.onDrill=function(e){var t=e.customAttributes,i=this.dataSourceSettings.drilledMembers[0]&&this.dataSourceSettings.drilledMembers[0].delimiter?this.dataSourceSettings.drilledMembers[0].delimiter:"**",a=t.fieldName,r="Tabular"===this.parent.gridSettings.layout?!this.parent.dataSourceSettings.showSubTotals||!this.parent.dataSourceSettings.showRowSubTotals&&this.parent.dataSourceSettings.showColumnSubTotals?t.level:this.parent.engineModule.rowMaxLevel:t.colIndex,n=this.engineModule.pivotValues[t.rowIndex][r],s=n.valueSort.levelName.split(this.engineModule.valueSortSettings.headerDelimiter).join(i),o=!1;if(0===this.dataSourceSettings.drilledMembers.length)this.parent.setProperties({dataSourceSettings:{drilledMembers:[{name:a,items:[s],delimiter:i}]}},!0);else{for(var l=0;l<this.dataSourceSettings.drilledMembers.length;l++){var d=this.dataSourceSettings.drilledMembers[l];if(s=s.split(i).join(d.delimiter?d.delimiter:i),i=d.delimiter=d.delimiter?d.delimiter:i,d.name===a){o=!0;var h=d.items.indexOf(s);h>-1?d.items.splice(h,1):d.items.push(s)}}o||this.dataSourceSettings.drilledMembers.push({name:a,items:[s],delimiter:i})}this.parent.showWaitingPopup();var p=this,u={fieldName:a,memberName:s,delimiter:i,axis:"row",action:t.isDrilled?"up":"down",currentCell:n},c={drillInfo:u,pivotview:p.parent};p.parent.trigger(ia,c);var g={dataSourceSettings:Di.getClonedDataSourceSettings(this.parent.dataSourceSettings)};this.parent.trigger(Ii,g),this.parent.setProperties({dataSourceSettings:g.dataSourceSettings},!0),p.parent.enableVirtualization||p.parent.enablePaging?"Server"===p.parent.dataSourceSettings.mode?p.parent.getEngine("onDrill",u,null,null,null,null,null):(p.engineModule.drilledMembers=p.dataSourceSettings.drilledMembers,p.engineModule.onDrill(u)):"Server"===p.parent.dataSourceSettings.mode?p.parent.getEngine("onDrill",u,null,null,null,null,null):p.engineModule.generateGridData(p.dataSourceSettings,!0),p.parent.allowServerDataBinding=!1,p.parent.setProperties({pivotValues:p.engineModule.pivotValues},!0),p.parent.allowServerDataBinding=!0;var m={dataSourceSettings:Di.getClonedDataSourceSettings(this.parent.dataSourceSettings),pivotValues:this.parent.pivotValues};this.parent.trigger(Fi,m),p.engineModule.pivotValues=m.pivotValues,p.parent.renderPivotGrid()},e.prototype.isAttributeDrill=function(e,t){for(var i=!1,a=0;a<this.dataSourceSettings.drilledMembers.length;a++)if(this.dataSourceSettings.drilledMembers[a].name===e)for(var r=0;r<this.dataSourceSettings.drilledMembers[a].items.length;r++){for(var n=this.dataSourceSettings.drilledMembers[a].items[r].split(this.dataSourceSettings.drilledMembers[a].delimiter),s="",o=0;o<n.length;o++)t[o]&&t[o].uName&&(s=s+(""===s?"":this.dataSourceSettings.drilledMembers[a].delimiter)+(t[o].uName.indexOf("[Measures]")>-1?"[Measures]":t[o].uName));if(s===this.dataSourceSettings.drilledMembers[a].items[r]){i=!0;break}}return i},e.prototype.load=function(e){e.chart.zoomModule&&(e.chart.zoomModule.isZoomed=!0),this.parent.trigger(Va,e)},e.prototype.beforePrint=function(e){this.parent.trigger(xa,e)},e.prototype.animationComplete=function(e){this.parent.trigger(wa,e)},e.prototype.legendRender=function(e){this.parent.trigger(Ta,e)},e.prototype.textRender=function(e){this.parent.trigger(Ma,e)},e.prototype.pointRender=function(e){this.parent.trigger(Da,e)},e.prototype.seriesRender=function(e){this.parent.trigger(Oa,e)},e.prototype.chartMouseMove=function(e){this.parent.trigger(Pa,e)},e.prototype.chartMouseClick=function(e){this.parent.trigger(Na,e)},e.prototype.pointMove=function(e){this.parent.trigger(Ea,e)},e.prototype.chartMouseLeave=function(e){this.parent.trigger(Ia,e)},e.prototype.chartMouseDown=function(e){this.parent.trigger(Fa,e)},e.prototype.chartMouseUp=function(e){this.parent.trigger(La,e)},e.prototype.dragComplete=function(e){this.parent.trigger(Aa,e)},e.prototype.zoomComplete=function(e){this.parent.trigger(Ra,e)},e.prototype.scrollStart=function(e){this.parent.trigger(ka,e)},e.prototype.scrollEnd=function(e){this.parent.trigger(ja,e)},e.prototype.scrollChanged=function(e){this.parent.trigger(qa,e)},e.prototype.multiLevelLabelRender=function(e){this.parent.trigger(Ca,e)},e.prototype.resized=function(e){this.accumulationType.indexOf(this.chartSettings.chartSeries.type)<0&&(e.chart.primaryXAxis.zoomFactor=(0,t.isNullOrUndefined)(this.parent.chartSettings.primaryXAxis.zoomFactor)?this.getZoomFactor():this.parent.chartSettings.primaryXAxis.zoomFactor,this.parent.chartSettings.zoomSettings.enableScrollbar||(e.chart.primaryXAxis.zoomFactor=(0,t.isNullOrUndefined)(this.parent.chartSettings.primaryXAxis.zoomFactor)?1:this.parent.chartSettings.primaryXAxis.zoomFactor)),this.parent.trigger(Ha,e)},e.prototype.isMemberDrilled=function(e,t){for(var i=!1,a=0;a<this.parent.dataSourceSettings.drilledMembers.length;a++)for(var r=this.parent.dataSourceSettings.drilledMembers[a].items,n=0;n<r.length;n++){var s=r[n].split(this.parent.dataSourceSettings.drilledMembers[a].delimiter);if(s[s.length-1]===e.formattedText.split(" ")[0]&&s[0]===t[0]){i=!0;break}}return i},e.prototype.getResizedChartHeight=function(){return["Pie","Funnel","Pyramid","Doughnut","Radar","Polar","Pareto"].indexOf(this.parent.chartSettings.chartSeries.type)<0&&this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&this.parent.dataSourceSettings.values.length>0?Number(this.parent.chart.height)>235*this.parent.dataSourceSettings.values.length+100?isNaN(Number(this.getChartHeight()))?this.getChartHeight().toString():(Number(this.getChartHeight())-5).toString():!isNaN(Number(this.getChartHeight()))||this.parent.dataSourceSettings.values.length>1?(235*this.parent.dataSourceSettings.values.length+100).toString():this.getChartHeight().toString():this.getChartHeight().toString()},e.prototype.destroy=function(){this.parent&&this.parent.isDestroyed||(this.engineModule&&!this.parent.destroyEngine&&(this.engineModule.fieldList={},this.engineModule={}),this.chartSeries&&(this.chartSeries=null),this.columnGroupObject&&(this.columnGroupObject=null),this.chartSeriesInfo&&(this.chartSeriesInfo={},this.selectedLegend=null),this.chartSettings&&(this.chartSettings=null),this.dataSourceSettings&&(this.dataSourceSettings=null),this.accumulationMenu&&!this.accumulationMenu.isDestroyed&&(this.accumulationMenu.destroy(),this.accumulationMenu=null),this.parent&&this.parent.chart&&!this.parent.chart.isDestroyed&&(this.parent.chart.destroy(),this.parent.chart=null))},e}(),ao={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},ro={size:"14px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},no={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},so={size:"11px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},oo={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},lo={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},ho={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},po={size:"12px",fontWeight:"Regular",color:"#353535",fontStyle:"Normal",fontFamily:"Segoe UI"},uo={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},co=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),go=function(e,t,i,a){var r,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(n<3?r(s):n>3?r(t,i,s):r(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s},mo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(!0)],i.prototype,"enable",void 0),go([(0,t.Property)(1e3)],i.prototype,"duration",void 0),go([(0,t.Property)(0)],i.prototype,"delay",void 0),i}(t.ChildProperty),fo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(null)],i.prototype,"value",void 0),go([(0,t.Property)(null)],i.prototype,"color",void 0),go([(0,t.Property)("0")],i.prototype,"dashArray",void 0),i}(t.ChildProperty),vo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)("Normal")],i.prototype,"fontStyle",void 0),go([(0,t.Property)("16px")],i.prototype,"size",void 0),go([(0,t.Property)("Normal")],i.prototype,"fontWeight",void 0),go([(0,t.Property)("")],i.prototype,"color",void 0),go([(0,t.Property)("Center")],i.prototype,"textAlignment",void 0),go([(0,t.Property)("Segoe UI")],i.prototype,"fontFamily",void 0),go([(0,t.Property)(1)],i.prototype,"opacity",void 0),go([(0,t.Property)("Trim")],i.prototype,"textOverflow",void 0),i}(t.ChildProperty),So=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(10)],i.prototype,"left",void 0),go([(0,t.Property)(10)],i.prototype,"right",void 0),go([(0,t.Property)(10)],i.prototype,"top",void 0),go([(0,t.Property)(10)],i.prototype,"bottom",void 0),i}(t.ChildProperty),yo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)("")],i.prototype,"color",void 0),go([(0,t.Property)(1)],i.prototype,"width",void 0),i}(t.ChildProperty),bo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(0)],i.prototype,"x",void 0),go([(0,t.Property)(0)],i.prototype,"y",void 0),i}(t.ChildProperty),Co=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(0)],i.prototype,"series",void 0),go([(0,t.Property)(0)],i.prototype,"point",void 0),i}(t.ChildProperty),xo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Complex)({},yo)],i.prototype,"border",void 0),go([(0,t.Property)("transparent")],i.prototype,"background",void 0),go([(0,t.Property)(1)],i.prototype,"opacity",void 0),go([(0,t.Property)(null)],i.prototype,"backgroundImage",void 0),i}(t.ChildProperty),wo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(!1)],i.prototype,"enable",void 0),go([(0,t.Property)("")],i.prototype,"dashArray",void 0),go([(0,t.Complex)({color:null,width:1},yo)],i.prototype,"line",void 0),go([(0,t.Property)("Both")],i.prototype,"lineType",void 0),i}(t.ChildProperty),To=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(!1)],i.prototype,"visible",void 0),go([(0,t.Property)(null)],i.prototype,"name",void 0),go([(0,t.Property)("transparent")],i.prototype,"fill",void 0),go([(0,t.Property)(1)],i.prototype,"opacity",void 0),go([(0,t.Property)(0)],i.prototype,"angle",void 0),go([(0,t.Property)(!1)],i.prototype,"enableRotation",void 0),go([(0,t.Property)("Auto")],i.prototype,"position",void 0),go([(0,t.Property)(5)],i.prototype,"rx",void 0),go([(0,t.Property)(5)],i.prototype,"ry",void 0),go([(0,t.Property)("Center")],i.prototype,"alignment",void 0),go([(0,t.Complex)({width:null,color:null},yo)],i.prototype,"border",void 0),go([(0,t.Complex)({left:5,right:5,top:5,bottom:5},So)],i.prototype,"margin",void 0),go([(0,t.Complex)({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},vo)],i.prototype,"font",void 0),go([(0,t.Property)(null)],i.prototype,"template",void 0),i}(t.ChildProperty),Mo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)("Line")],i.prototype,"type",void 0),go([(0,t.Property)(null)],i.prototype,"color",void 0),go([(0,t.Property)(1)],i.prototype,"width",void 0),go([(0,t.Property)(null)],i.prototype,"length",void 0),go([(0,t.Property)("")],i.prototype,"dashArray",void 0),i}(t.ChildProperty),Do=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(!0)],i.prototype,"visible",void 0),go([(0,t.Complex)({width:null,color:null},yo)],i.prototype,"border",void 0),go([(0,t.Complex)({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},vo)],i.prototype,"font",void 0),go([(0,t.Property)("transparent")],i.prototype,"fill",void 0),go([(0,t.Property)(0)],i.prototype,"angle",void 0),go([(0,t.Property)(!1)],i.prototype,"enableRotation",void 0),go([(0,t.Property)("Outside")],i.prototype,"position",void 0),go([(0,t.Property)(5)],i.prototype,"rx",void 0),go([(0,t.Property)(5)],i.prototype,"ry",void 0),go([(0,t.Property)(null)],i.prototype,"template",void 0),go([(0,t.Complex)({},Mo)],i.prototype,"connectorStyle",void 0),i}(t.ChildProperty),Oo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(!1)],i.prototype,"visible",void 0),go([(0,t.Property)("Circle")],i.prototype,"shape",void 0),go([(0,t.Property)("")],i.prototype,"imageUrl",void 0),go([(0,t.Property)(5)],i.prototype,"width",void 0),go([(0,t.Property)(5)],i.prototype,"height",void 0),go([(0,t.Complex)({width:2,color:null},yo)],i.prototype,"border",void 0),go([(0,t.Complex)({x:0,y:0},bo)],i.prototype,"offset",void 0),go([(0,t.Property)(null)],i.prototype,"fill",void 0),go([(0,t.Property)(1)],i.prototype,"opacity",void 0),go([(0,t.Complex)({},To)],i.prototype,"dataLabel",void 0),i}(t.ChildProperty),Po=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(1)],i.prototype,"width",void 0),go([(0,t.Property)(10)],i.prototype,"length",void 0),go([(0,t.Property)(null)],i.prototype,"color",void 0),go([(0,t.Property)(1)],i.prototype,"opacity",void 0),i}(t.ChildProperty),No=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(!1)],i.prototype,"visible",void 0),go([(0,t.Property)("Fixed")],i.prototype,"type",void 0),go([(0,t.Property)("Both")],i.prototype,"direction",void 0),go([(0,t.Property)("Vertical")],i.prototype,"mode",void 0),go([(0,t.Property)(1)],i.prototype,"verticalError",void 0),go([(0,t.Property)(null)],i.prototype,"color",void 0),go([(0,t.Property)(1)],i.prototype,"width",void 0),go([(0,t.Property)(1)],i.prototype,"horizontalError",void 0),go([(0,t.Property)(3)],i.prototype,"verticalNegativeError",void 0),go([(0,t.Property)(3)],i.prototype,"verticalPositiveError",void 0),go([(0,t.Property)(1)],i.prototype,"horizontalNegativeError",void 0),go([(0,t.Property)(1)],i.prototype,"horizontalPositiveError",void 0),go([(0,t.Complex)(null,Po)],i.prototype,"errorBarCap",void 0),i}(t.ChildProperty),Eo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)("")],i.prototype,"name",void 0),go([(0,t.Property)("0")],i.prototype,"dashArray",void 0),go([(0,t.Property)(!0)],i.prototype,"visible",void 0),go([(0,t.Property)(2)],i.prototype,"period",void 0),go([(0,t.Property)("Linear")],i.prototype,"type",void 0),go([(0,t.Property)(0)],i.prototype,"backwardForecast",void 0),go([(0,t.Property)(0)],i.prototype,"forwardForecast",void 0),go([(0,t.Property)(2)],i.prototype,"polynomialOrder",void 0),go([(0,t.Complex)({},Oo)],i.prototype,"marker",void 0),go([(0,t.Property)(!0)],i.prototype,"enableTooltip",void 0),go([(0,t.Complex)({},mo)],i.prototype,"animation",void 0),go([(0,t.Property)("")],i.prototype,"fill",void 0),go([(0,t.Property)(1)],i.prototype,"width",void 0),go([(0,t.Property)(null)],i.prototype,"intercept",void 0),go([(0,t.Property)("SeriesType")],i.prototype,"legendShape",void 0),i}(t.ChildProperty),Io=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(null)],i.prototype,"fill",void 0),go([(0,t.Complex)({color:"transparent",width:0},yo)],i.prototype,"border",void 0),go([(0,t.Property)("Zero")],i.prototype,"mode",void 0),i}(t.ChildProperty),Fo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(0)],i.prototype,"topLeft",void 0),go([(0,t.Property)(0)],i.prototype,"topRight",void 0),go([(0,t.Property)(0)],i.prototype,"bottomLeft",void 0),go([(0,t.Property)(0)],i.prototype,"bottomRight",void 0),i}(t.ChildProperty),Lo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(!1)],i.prototype,"enable",void 0),go([(0,t.Property)(null)],i.prototype,"fill",void 0),go([(0,t.Complex)(oo,vo)],i.prototype,"textStyle",void 0),i}(t.ChildProperty),Ao=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(!0)],i.prototype,"visible",void 0),go([(0,t.Property)(!1)],i.prototype,"startFromAxis",void 0),go([(0,t.Property)(null)],i.prototype,"start",void 0),go([(0,t.Property)(null)],i.prototype,"end",void 0),go([(0,t.Property)(null)],i.prototype,"size",void 0),go([(0,t.Property)("#808080")],i.prototype,"color",void 0),go([(0,t.Property)(null)],i.prototype,"dashArray",void 0),go([(0,t.Property)("Auto")],i.prototype,"sizeType",void 0),go([(0,t.Property)(!1)],i.prototype,"isRepeat",void 0),go([(0,t.Property)(null)],i.prototype,"repeatEvery",void 0),go([(0,t.Property)(null)],i.prototype,"repeatUntil",void 0),go([(0,t.Property)(!1)],i.prototype,"isSegmented",void 0),go([(0,t.Property)(null)],i.prototype,"segmentStart",void 0),go([(0,t.Property)(null)],i.prototype,"segmentEnd",void 0),go([(0,t.Property)(null)],i.prototype,"segmentAxisName",void 0),go([(0,t.Complex)({color:"transparent",width:1},yo)],i.prototype,"border",void 0),go([(0,t.Property)("")],i.prototype,"text",void 0),go([(0,t.Property)(null)],i.prototype,"rotation",void 0),go([(0,t.Property)("Middle")],i.prototype,"horizontalAlignment",void 0),go([(0,t.Property)("Middle")],i.prototype,"verticalAlignment",void 0),go([(0,t.Complex)(po,vo)],i.prototype,"textStyle",void 0),go([(0,t.Property)("Behind")],i.prototype,"zIndex",void 0),go([(0,t.Property)(1)],i.prototype,"opacity",void 0),i}(t.ChildProperty),Ro=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)("")],i.prototype,"color",void 0),go([(0,t.Property)(1)],i.prototype,"width",void 0),go([(0,t.Property)("Rectangle")],i.prototype,"type",void 0),i}(t.ChildProperty),ko=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(1)],i.prototype,"width",void 0),go([(0,t.Property)("")],i.prototype,"dashArray",void 0),go([(0,t.Property)(null)],i.prototype,"color",void 0),i}(t.ChildProperty),jo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(.7)],i.prototype,"width",void 0),go([(0,t.Property)("")],i.prototype,"dashArray",void 0),go([(0,t.Property)(null)],i.prototype,"color",void 0),i}(t.ChildProperty),qo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(1)],i.prototype,"width",void 0),go([(0,t.Property)("")],i.prototype,"dashArray",void 0),go([(0,t.Property)(null)],i.prototype,"color",void 0),i}(t.ChildProperty),Vo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(1)],i.prototype,"width",void 0),go([(0,t.Property)(5)],i.prototype,"height",void 0),go([(0,t.Property)(null)],i.prototype,"color",void 0),i}(t.ChildProperty),Ho=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(.7)],i.prototype,"width",void 0),go([(0,t.Property)(5)],i.prototype,"height",void 0),go([(0,t.Property)(null)],i.prototype,"color",void 0),i}(t.ChildProperty),Uo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(0)],i.prototype,"x",void 0),go([(0,t.Property)(0)],i.prototype,"y",void 0),i}(t.ChildProperty),_o=(function(){function e(){}go([(0,t.Property)("")],e.prototype,"color",void 0),go([(0,t.Property)(1)],e.prototype,"width",void 0)}(),function(){function e(){}go([(0,t.Property)(!0)],e.prototype,"enable",void 0),go([(0,t.Property)(1e3)],e.prototype,"duration",void 0),go([(0,t.Property)(0)],e.prototype,"delay",void 0)}(),function(){function e(){}go([(0,t.Property)(null)],e.prototype,"value",void 0),go([(0,t.Property)(null)],e.prototype,"color",void 0),go([(0,t.Property)("0")],e.prototype,"dashArray",void 0)}(),function(){function e(){}go([(0,t.Property)(!1)],e.prototype,"visible",void 0),go([(0,t.Property)("Circle")],e.prototype,"shape",void 0),go([(0,t.Property)("")],e.prototype,"imageUrl",void 0),go([(0,t.Property)(5)],e.prototype,"height",void 0),go([(0,t.Property)(5)],e.prototype,"width",void 0),go([(0,t.Complex)({width:2,color:null},yo)],e.prototype,"border",void 0),go([(0,t.Property)(null)],e.prototype,"fill",void 0),go([(0,t.Property)(1)],e.prototype,"opacity",void 0),go([(0,t.Complex)({},To)],e.prototype,"dataLabel",void 0)}(),function(){function e(){}go([(0,t.Property)(!1)],e.prototype,"visible",void 0),go([(0,t.Property)("Fixed")],e.prototype,"type",void 0),go([(0,t.Property)("Both")],e.prototype,"direction",void 0),go([(0,t.Property)("Vertical")],e.prototype,"mode",void 0),go([(0,t.Property)(null)],e.prototype,"color",void 0),go([(0,t.Property)(1)],e.prototype,"verticalError",void 0),go([(0,t.Property)(1)],e.prototype,"width",void 0),go([(0,t.Property)(1)],e.prototype,"horizontalError",void 0),go([(0,t.Property)(3)],e.prototype,"verticalPositiveError",void 0),go([(0,t.Property)(3)],e.prototype,"verticalNegativeError",void 0),go([(0,t.Property)(1)],e.prototype,"horizontalPositiveError",void 0),go([(0,t.Property)(1)],e.prototype,"horizontalNegativeError",void 0),go([(0,t.Complex)(null,Po)],e.prototype,"errorBarCap",void 0)}(),function(){function e(){}go([(0,t.Property)("")],e.prototype,"name",void 0),go([(0,t.Property)("Linear")],e.prototype,"type",void 0),go([(0,t.Property)(2)],e.prototype,"period",void 0),go([(0,t.Property)(2)],e.prototype,"polynomialOrder",void 0),go([(0,t.Property)(0)],e.prototype,"backwardForecast",void 0),go([(0,t.Property)(0)],e.prototype,"forwardForecast",void 0),go([(0,t.Complex)({},mo)],e.prototype,"animation",void 0),go([(0,t.Complex)({},Oo)],e.prototype,"marker",void 0),go([(0,t.Property)(!0)],e.prototype,"enableTooltip",void 0),go([(0,t.Property)(null)],e.prototype,"intercept",void 0),go([(0,t.Property)("")],e.prototype,"fill",void 0),go([(0,t.Property)(1)],e.prototype,"width",void 0),go([(0,t.Property)("SeriesType")],e.prototype,"legendShape",void 0)}(),function(){function e(){}go([(0,t.Property)(null)],e.prototype,"fill",void 0),go([(0,t.Complex)({color:"transparent",width:0},yo)],e.prototype,"border",void 0),go([(0,t.Property)("Zero")],e.prototype,"mode",void 0)}(),function(){function e(){}go([(0,t.Property)(0)],e.prototype,"topLeft",void 0),go([(0,t.Property)(0)],e.prototype,"topRight",void 0),go([(0,t.Property)(0)],e.prototype,"bottomLeft",void 0),go([(0,t.Property)(0)],e.prototype,"bottomRight",void 0)}(),function(){function e(){}go([(0,t.Property)("Normal")],e.prototype,"fontStyle",void 0),go([(0,t.Property)("16px")],e.prototype,"size",void 0),go([(0,t.Property)("Normal")],e.prototype,"fontWeight",void 0),go([(0,t.Property)("")],e.prototype,"color",void 0),go([(0,t.Property)("Center")],e.prototype,"textAlignment",void 0),go([(0,t.Property)("Segoe UI")],e.prototype,"fontFamily",void 0),go([(0,t.Property)(1)],e.prototype,"opacity",void 0),go([(0,t.Property)("Trim")],e.prototype,"textOverflow",void 0)}(),function(){function e(){}go([(0,t.Property)(!1)],e.prototype,"enable",void 0),go([(0,t.Property)(null)],e.prototype,"fill",void 0),go([(0,t.Complex)(oo,vo)],e.prototype,"textStyle",void 0)}(),function(){function e(){}go([(0,t.Property)(1)],e.prototype,"width",void 0),go([(0,t.Property)(5)],e.prototype,"height",void 0),go([(0,t.Property)(null)],e.prototype,"color",void 0)}(),function(){function e(){}go([(0,t.Property)(1)],e.prototype,"width",void 0),go([(0,t.Property)("")],e.prototype,"dashArray",void 0),go([(0,t.Property)(null)],e.prototype,"color",void 0)}(),function(){function e(){}go([(0,t.Property)(.7)],e.prototype,"width",void 0),go([(0,t.Property)(5)],e.prototype,"height",void 0),go([(0,t.Property)(null)],e.prototype,"color",void 0)}(),function(){function e(){}go([(0,t.Property)(.7)],e.prototype,"width",void 0),go([(0,t.Property)("")],e.prototype,"dashArray",void 0),go([(0,t.Property)(null)],e.prototype,"color",void 0)}(),function(){function e(){}go([(0,t.Property)(1)],e.prototype,"width",void 0),go([(0,t.Property)("")],e.prototype,"dashArray",void 0),go([(0,t.Property)(null)],e.prototype,"color",void 0)}(),function(){function e(){}go([(0,t.Property)(!0)],e.prototype,"visible",void 0),go([(0,t.Property)(!1)],e.prototype,"startFromAxis",void 0),go([(0,t.Property)(null)],e.prototype,"start",void 0),go([(0,t.Property)(null)],e.prototype,"end",void 0),go([(0,t.Property)(null)],e.prototype,"size",void 0),go([(0,t.Property)("#808080")],e.prototype,"color",void 0),go([(0,t.Property)(null)],e.prototype,"dashArray",void 0),go([(0,t.Property)("Auto")],e.prototype,"sizeType",void 0),go([(0,t.Property)(!1)],e.prototype,"isRepeat",void 0),go([(0,t.Property)(null)],e.prototype,"repeatEvery",void 0),go([(0,t.Property)(null)],e.prototype,"repeatUntil",void 0),go([(0,t.Property)(!1)],e.prototype,"isSegmented",void 0),go([(0,t.Property)(null)],e.prototype,"segmentStart",void 0),go([(0,t.Property)(null)],e.prototype,"segmentEnd",void 0),go([(0,t.Property)(null)],e.prototype,"segmentAxisName",void 0),go([(0,t.Complex)({color:"transparent",width:1},yo)],e.prototype,"border",void 0),go([(0,t.Property)("")],e.prototype,"text",void 0),go([(0,t.Property)(null)],e.prototype,"rotation",void 0),go([(0,t.Property)("Middle")],e.prototype,"horizontalAlignment",void 0),go([(0,t.Property)("Middle")],e.prototype,"verticalAlignment",void 0),go([(0,t.Complex)(po,vo)],e.prototype,"textStyle",void 0),go([(0,t.Property)("Behind")],e.prototype,"zIndex",void 0),go([(0,t.Property)(1)],e.prototype,"opacity",void 0)}(),function(){function e(){}go([(0,t.Property)("")],e.prototype,"color",void 0),go([(0,t.Property)(1)],e.prototype,"width",void 0),go([(0,t.Property)("Rectangle")],e.prototype,"type",void 0)}(),function(){function e(){}go([(0,t.Complex)({},yo)],e.prototype,"border",void 0),go([(0,t.Property)("transparent")],e.prototype,"background",void 0),go([(0,t.Property)(1)],e.prototype,"opacity",void 0)}(),function(){function e(){}go([(0,t.Property)(!1)],e.prototype,"enable",void 0),go([(0,t.Property)("")],e.prototype,"dashArray",void 0),go([(0,t.Complex)({color:null,width:1},yo)],e.prototype,"line",void 0),go([(0,t.Property)("Both")],e.prototype,"lineType",void 0)}(),function(){function e(){}go([(0,t.Property)(!0)],e.prototype,"visible",void 0),go([(0,t.Property)(null)],e.prototype,"height",void 0),go([(0,t.Property)(null)],e.prototype,"width",void 0),go([(0,t.Complex)({x:0,y:0},Uo)],e.prototype,"location",void 0),go([(0,t.Property)("Auto")],e.prototype,"position",void 0),go([(0,t.Property)(8)],e.prototype,"padding",void 0),go([(0,t.Property)("Center")],e.prototype,"alignment",void 0),go([(0,t.Complex)(ho,vo)],e.prototype,"textStyle",void 0),go([(0,t.Property)(10)],e.prototype,"shapeHeight",void 0),go([(0,t.Property)(10)],e.prototype,"shapeWidth",void 0),go([(0,t.Complex)({},yo)],e.prototype,"border",void 0),go([(0,t.Complex)({left:0,right:0,top:0,bottom:0},So)],e.prototype,"margin",void 0),go([(0,t.Property)(5)],e.prototype,"shapePadding",void 0),go([(0,t.Property)("transparent")],e.prototype,"background",void 0),go([(0,t.Property)(1)],e.prototype,"opacity",void 0),go([(0,t.Property)(!0)],e.prototype,"toggleVisibility",void 0),go([(0,t.Property)(null)],e.prototype,"description",void 0),go([(0,t.Property)(3)],e.prototype,"tabIndex",void 0)}(),function(){function e(){}go([(0,t.Property)(0)],e.prototype,"series",void 0),go([(0,t.Property)(0)],e.prototype,"point",void 0)}(),function(){function e(){}go([(0,t.Property)(10)],e.prototype,"left",void 0),go([(0,t.Property)(10)],e.prototype,"right",void 0),go([(0,t.Property)(10)],e.prototype,"top",void 0),go([(0,t.Property)(10)],e.prototype,"bottom",void 0)}(),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(null)],i.prototype,"fill",void 0),go([(0,t.Property)(null)],i.prototype,"endAngle",void 0),go([(0,t.Property)(!1)],i.prototype,"explode",void 0),go([(0,t.Property)(!1)],i.prototype,"explodeAll",void 0),go([(0,t.Property)(null)],i.prototype,"explodeIndex",void 0),go([(0,t.Property)(null)],i.prototype,"innerRadius",void 0),go([(0,t.Property)("30%")],i.prototype,"explodeOffset",void 0),go([(0,t.Property)(0)],i.prototype,"gapRatio",void 0),go([(0,t.Property)("Value")],i.prototype,"groupMode",void 0),go([(0,t.Property)(null)],i.prototype,"groupTo",void 0),go([(0,t.Property)("20%")],i.prototype,"neckHeight",void 0),go([(0,t.Property)("20%")],i.prototype,"neckWidth",void 0),go([(0,t.Property)("Linear")],i.prototype,"pyramidMode",void 0),go([(0,t.Property)([])],i.prototype,"palettes",void 0),go([(0,t.Property)(0)],i.prototype,"startAngle",void 0),go([(0,t.Complex)(null,mo)],i.prototype,"animation",void 0),go([(0,t.Complex)(null,Do)],i.prototype,"dataLabel",void 0),go([(0,t.Property)("0")],i.prototype,"dashArray",void 0),go([(0,t.Property)(1)],i.prototype,"width",void 0),go([(0,t.Property)("X")],i.prototype,"segmentAxis",void 0),go([(0,t.Property)("Line")],i.prototype,"drawType",void 0),go([(0,t.Property)(!0)],i.prototype,"isClosed",void 0),go([(0,t.Collection)([],fo)],i.prototype,"segments",void 0),go([(0,t.Property)("")],i.prototype,"stackingGroup",void 0),go([(0,t.Complex)({color:"transparent",width:0},yo)],i.prototype,"border",void 0),go([(0,t.Property)(!0)],i.prototype,"visible",void 0),go([(0,t.Property)(1)],i.prototype,"opacity",void 0),go([(0,t.Property)("Line")],i.prototype,"type",void 0),go([(0,t.Complex)(null,Oo)],i.prototype,"marker",void 0),go([(0,t.Complex)(null,No)],i.prototype,"errorBar",void 0),go([(0,t.Property)(!0)],i.prototype,"enableTooltip",void 0),go([(0,t.Collection)([],Eo)],i.prototype,"trendlines",void 0),go([(0,t.Property)("")],i.prototype,"tooltipMappingName",void 0),go([(0,t.Property)("SeriesType")],i.prototype,"legendShape",void 0),go([(0,t.Property)(1)],i.prototype,"minRadius",void 0),go([(0,t.Property)(null)],i.prototype,"selectionStyle",void 0),go([(0,t.Property)("Natural")],i.prototype,"splineType",void 0),go([(0,t.Property)(3)],i.prototype,"maxRadius",void 0),go([(0,t.Property)(.5)],i.prototype,"cardinalSplineTension",void 0),go([(0,t.Property)(null)],i.prototype,"columnWidth",void 0),go([(0,t.Complex)(null,Io)],i.prototype,"emptyPointSettings",void 0),go([(0,t.Complex)(null,Fo)],i.prototype,"cornerRadius",void 0),go([(0,t.Property)(0)],i.prototype,"columnSpacing",void 0),i}(t.ChildProperty)),Bo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)("Rotate45")],i.prototype,"labelIntersectAction",void 0),go([(0,t.Complex)(ao,vo)],i.prototype,"labelStyle",void 0),go([(0,t.Property)("")],i.prototype,"title",void 0),go([(0,t.Property)(null)],i.prototype,"zoomFactor",void 0),go([(0,t.Complex)({},Lo)],i.prototype,"crosshairTooltip",void 0),go([(0,t.Property)("")],i.prototype,"labelFormat",void 0),go([(0,t.Complex)(ro,vo)],i.prototype,"titleStyle",void 0),go([(0,t.Property)(!1)],i.prototype,"isIndexed",void 0),go([(0,t.Property)(0)],i.prototype,"plotOffset",void 0),go([(0,t.Property)("Shift")],i.prototype,"edgeLabelPlacement",void 0),go([(0,t.Property)("BetweenTicks")],i.prototype,"labelPlacement",void 0),go([(0,t.Property)("Outside")],i.prototype,"tickPosition",void 0),go([(0,t.Property)(!1)],i.prototype,"opposedPosition",void 0),go([(0,t.Property)(!0)],i.prototype,"visible",void 0),go([(0,t.Property)("Outside")],i.prototype,"labelPosition",void 0),go([(0,t.Property)(0)],i.prototype,"labelRotation",void 0),go([(0,t.Property)(0)],i.prototype,"minorTicksPerInterval",void 0),go([(0,t.Property)(null)],i.prototype,"maximum",void 0),go([(0,t.Property)(null)],i.prototype,"minimum",void 0),go([(0,t.Property)(34)],i.prototype,"maximumLabelWidth",void 0),go([(0,t.Property)(null)],i.prototype,"interval",void 0),go([(0,t.Complex)({},Vo)],i.prototype,"majorTickLines",void 0),go([(0,t.Property)(!1)],i.prototype,"enableTrim",void 0),go([(0,t.Complex)({},ko)],i.prototype,"majorGridLines",void 0),go([(0,t.Complex)({},Ho)],i.prototype,"minorTickLines",void 0),go([(0,t.Complex)({},qo)],i.prototype,"lineStyle",void 0),go([(0,t.Complex)({},jo)],i.prototype,"minorGridLines",void 0),go([(0,t.Property)(!1)],i.prototype,"isInversed",void 0),go([(0,t.Property)(null)],i.prototype,"description",void 0),go([(0,t.Property)(0)],i.prototype,"startAngle",void 0),go([(0,t.Property)(100)],i.prototype,"coefficient",void 0),go([(0,t.Collection)([],Ao)],i.prototype,"stripLines",void 0),go([(0,t.Property)(2)],i.prototype,"tabIndex",void 0),go([(0,t.Complex)({color:null,width:0,type:"Rectangle"},Ro)],i.prototype,"border",void 0),i}(t.ChildProperty),Go=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(!1)],i.prototype,"enableMarker",void 0),go([(0,t.Property)(!0)],i.prototype,"enable",void 0),go([(0,t.Property)(null)],i.prototype,"fill",void 0),go([(0,t.Property)(!1)],i.prototype,"shared",void 0),go([(0,t.Property)(.75)],i.prototype,"opacity",void 0),go([(0,t.Property)(null)],i.prototype,"header",void 0),go([(0,t.Property)(null)],i.prototype,"format",void 0),go([(0,t.Complex)(lo,vo)],i.prototype,"textStyle",void 0),go([(0,t.Property)(null)],i.prototype,"template",void 0),go([(0,t.Complex)({color:"#cccccc",width:.5},yo)],i.prototype,"border",void 0),go([(0,t.Property)(!0)],i.prototype,"enableAnimation",void 0),i}(t.ChildProperty),zo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)("50%")],i.prototype,"x",void 0),go([(0,t.Property)("50%")],i.prototype,"y",void 0),i}(t.ChildProperty),Wo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Property)(!1)],i.prototype,"enablePinchZooming",void 0),go([(0,t.Property)(!0)],i.prototype,"enableSelectionZooming",void 0),go([(0,t.Property)(!1)],i.prototype,"enableDeferredZooming",void 0),go([(0,t.Property)(!1)],i.prototype,"enableMouseWheelZooming",void 0),go([(0,t.Property)("XY")],i.prototype,"mode",void 0),go([(0,t.Property)(["Zoom","ZoomIn","ZoomOut","Pan","Reset"])],i.prototype,"toolbarItems",void 0),go([(0,t.Property)(!0)],i.prototype,"enableScrollbar",void 0),go([(0,t.Property)(!1)],i.prototype,"enablePan",void 0),i}(t.ChildProperty),Qo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return co(i,e),go([(0,t.Complex)({},_o)],i.prototype,"chartSeries",void 0),go([(0,t.Complex)({},Bo)],i.prototype,"primaryXAxis",void 0),go([(0,t.Complex)({},Bo)],i.prototype,"primaryYAxis",void 0),go([(0,t.Property)("")],i.prototype,"value",void 0),go([(0,t.Property)("")],i.prototype,"columnHeader",void 0),go([(0,t.Property)("-")],i.prototype,"columnDelimiter",void 0),go([(0,t.Property)(!1)],i.prototype,"enableMultipleAxis",void 0),go([(0,t.Property)("Stacked")],i.prototype,"multipleAxisMode",void 0),go([(0,t.Property)(!1)],i.prototype,"enableScrollOnMultiAxis",void 0),go([(0,t.Property)(!1)],i.prototype,"showMemberSeries",void 0),go([(0,t.Property)(!1)],i.prototype,"showPointColorByMembers",void 0),go([(0,t.Complex)({border:{color:null,width:.5},background:"transparent"},to.titleSettings)],i.prototype,"titleStyle",void 0),go([(0,t.Property)("")],i.prototype,"title",void 0),go([(0,t.Complex)({border:{color:null,width:.5},background:"transparent"},to.titleSettings)],i.prototype,"subTitleStyle",void 0),go([(0,t.Property)("")],i.prototype,"subTitle",void 0),go([(0,t.Complex)({color:"#DDDDDD",width:0},yo)],i.prototype,"border",void 0),go([(0,t.Complex)({},So)],i.prototype,"margin",void 0),go([(0,t.Complex)({border:{color:null,width:.5},background:"transparent"},xo)],i.prototype,"chartArea",void 0),go([(0,t.Property)(null)],i.prototype,"background",void 0),go([(0,t.Property)("Material")],i.prototype,"theme",void 0),go([(0,t.Property)([])],i.prototype,"palettes",void 0),go([(0,t.Complex)({},wo)],i.prototype,"crosshair",void 0),go([(0,t.Complex)({},Go)],i.prototype,"tooltip",void 0),go([(0,t.Complex)(null,zo)],i.prototype,"pieCenter",void 0),go([(0,t.Complex)({},Wo)],i.prototype,"zoomSettings",void 0),go([(0,t.Property)()],i.prototype,"legendSettings",void 0),go([(0,t.Property)("None")],i.prototype,"selectionMode",void 0),go([(0,t.Property)("None")],i.prototype,"accumulationSelectionMode",void 0),go([(0,t.Property)(!0)],i.prototype,"enableSmartLabels",void 0),go([(0,t.Property)(!0)],i.prototype,"enableBorderOnMouseMove",void 0),go([(0,t.Property)("None")],i.prototype,"highlightMode",void 0),go([(0,t.Property)("None")],i.prototype,"highlightPattern",void 0),go([(0,t.Property)(!0)],i.prototype,"enableExport",void 0),go([(0,t.Property)(!1)],i.prototype,"isMultiSelect",void 0),go([(0,t.Collection)([],Co)],i.prototype,"selectedDataIndexes",void 0),go([(0,t.Property)(!0)],i.prototype,"enableAnimation",void 0),go([(0,t.Property)(!1)],i.prototype,"enableCanvas",void 0),go([(0,t.Property)(!0)],i.prototype,"useGroupingSeparator",void 0),go([(0,t.Property)(!1)],i.prototype,"isTransposed",void 0),go([(0,t.Property)(1)],i.prototype,"tabIndex",void 0),go([(0,t.Property)(null)],i.prototype,"description",void 0),go([(0,t.Event)()],i.prototype,"resized",void 0),go([(0,t.Property)(!0)],i.prototype,"enableSideBySidePlacement",void 0),go([(0,t.Event)()],i.prototype,"loaded",void 0),go([(0,t.Event)()],i.prototype,"beforePrint",void 0),go([(0,t.Event)()],i.prototype,"animationComplete",void 0),go([(0,t.Event)()],i.prototype,"load",void 0),go([(0,t.Event)()],i.prototype,"textRender",void 0),go([(0,t.Event)()],i.prototype,"legendRender",void 0),go([(0,t.Event)()],i.prototype,"seriesRender",void 0),go([(0,t.Event)()],i.prototype,"multiLevelLabelRender",void 0),go([(0,t.Event)()],i.prototype,"pointRender",void 0),go([(0,t.Event)()],i.prototype,"tooltipRender",void 0),go([(0,t.Event)()],i.prototype,"legendClick",void 0),go([(0,t.Event)()],i.prototype,"axisLabelRender",void 0),go([(0,t.Event)()],i.prototype,"multiLevelLabelClick",void 0),go([(0,t.Event)()],i.prototype,"chartMouseClick",void 0),go([(0,t.Event)()],i.prototype,"chartMouseMove",void 0),go([(0,t.Event)()],i.prototype,"pointMove",void 0),go([(0,t.Event)()],i.prototype,"pointClick",void 0),go([(0,t.Event)()],i.prototype,"chartMouseDown",void 0),go([(0,t.Event)()],i.prototype,"chartMouseLeave",void 0),go([(0,t.Event)()],i.prototype,"dragComplete",void 0),go([(0,t.Event)()],i.prototype,"chartMouseUp",void 0),go([(0,t.Event)()],i.prototype,"scrollStart",void 0),go([(0,t.Event)()],i.prototype,"zoomComplete",void 0),go([(0,t.Event)()],i.prototype,"scrollChanged",void 0),go([(0,t.Event)()],i.prototype,"scrollEnd",void 0),go([(0,t.Property)(!0)],i.prototype,"showMultiLevelLabels",void 0),i}(t.ChildProperty),Yo=function(){function e(){}return e.getCellSets=function(e,i,a,r,n){this.engine=i,this.isMondrian=i.isMondrian,this.isMeasureAvail=i.isMeasureAvail,this.isPaging=i.isPaging,this.pageSettings=i.pageSettings,this.rows=i.rows,this.columns=i.columns,this.values=i.values,this.filters=i.filters,this.allowLabelFilter=i.allowLabelFilter,this.allowValueFilter=i.allowValueFilter,this.drilledMembers=i.updateDrilledItems(e.drilledMembers),this.calculatedFieldSettings=i.calculatedFieldSettings,this.valueAxis="row"===e.valueAxis?"rows":"columns",r&&(r.axis="row"===r.axis?"rows":"columns"),this.filterMembers=(0,t.extend)({},i.filterMembers,null,!0),this.fieldDataObj=i.fieldListObj,this.fieldList=i.fieldList,this.cellSetInfo="\nDIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE";var s=this.getMeasuresQuery(this.values),o=this.getDimensionsQuery(this.rows,s,"rows",r).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;"),l=this.getDimensionsQuery(this.columns,s,"columns",r).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;");if(this.isPaging&&a&&void 0!==this.pageSettings)o=(d=this.getPagingQuery(o,l)).rowQuery,l=d.columnQuery;else if(this.isPaging&&!a&&void 0!==this.pageSettings){var d;o=(d=this.getPagingCountQuery(o,l)).rowQuery,l=d.columnQuery}o=o.length>0?o+(this.isPaging&&!a?"":this.cellSetInfo+" ON ROWS"):"",l=l.length>0?l+(this.isPaging&&!a?"":this.cellSetInfo+" ON COLUMNS"):"";var h=this.getSlicersQuery(this.filters,"filters").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;"),p=this.getfilterQuery(this.filterMembers,e.cube).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;"),u=this.getCalculatedFieldQuery(this.calculatedFieldSettings).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;"),c=this.frameMDXQuery(o,l,h,p,u,a),g={catalog:e.catalog,cube:e.cube,url:e.url,request:c,LCID:e.localeIdentifier.toString(),roles:e.roles};i.mdxQuery=c.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/%280/g,'"').replace(/&apos;/g,"'"),r&&(r.axis="rows"===r.axis?"row":"column"),n||this.getTableCellData(g,this.isPaging&&!a?this.engine.generatePagingData.bind(this.engine):this.engine.generateEngine.bind(this.engine),r?{action:r.action,drillInfo:r}:{dataSourceSettings:e,action:"loadTableElements"})},e.getTableCellData=function(e,t,i){var a=this.engine.getConnectionInfo(e.url,e.LCID),r='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement>'+e.request+"</Statement> </Command> <Properties> <PropertyList> <Catalog>"+e.catalog+"</Catalog> <LocaleIdentifier>"+a.LCID+"</LocaleIdentifier>"+(e.roles?"<Roles>"+e.roles+"</Roles>":"")+"</PropertyList> </Properties></Execute> </Body> </Envelope>";if(this.engine.doAjaxPost("POST",a.url,r,t,i),this.engine.errorInfo)throw this.engine.errorInfo},e.frameMDXQuery=function(e,t,i,a,r,n){var s=this.isPaging&&!n?""!==r?"":"\nWITH":"\nSelect ";return t.length>0&&(s+=t),e.length>0&&(s=s+(t.length>0?this.isPaging&&!n?"":", ":"")+e),s=r+s+(this.isPaging&&!n?"\nMEMBER [Measures].[3d268ce0-664d-4092-b9cb-fece97175006] AS Count([e16a30d0-2174-4874-8dae-a5085a75a3e2]) MEMBER [Measures].[8d7fe8c1-f09f-410e-b9ba-eaab75a1fc3e] AS Count ([d1876d2b-e50e-4547-85fe-5b8ed9d629de])\nSELECT { [Measures].[3d268ce0-664d-4092-b9cb-fece97175006] , [Measures].[8d7fe8c1-f09f-410e-b9ba-eaab75a1fc3e] } ON AXIS(0)":"")+" "+a+i+"\nCELL PROPERTIES VALUE, FORMAT_STRING, FORMATTED_VALUE\n"},e.getPagingQuery=function(e,t){e=e.replace("NON EMPTY ( ","").slice(0,-1),t=t.replace("NON EMPTY ( ","").slice(0,-1);var i=e,a=(this.pageSettings.currentRowPage-1)*this.pageSettings.rowPageSize,r=(this.pageSettings.currentColumnPage-1)*this.pageSettings.columnPageSize,n=this.engine.isExporting&&this.engine.exportSpeciedPages&&this.engine.exportSpeciedPages.rowSize?this.engine.exportSpeciedPages.rowSize:3*this.pageSettings.rowPageSize,s=this.engine.isExporting&&this.engine.exportSpeciedPages&&this.engine.exportSpeciedPages.columnSize?this.engine.exportSpeciedPages.columnSize:3*this.pageSettings.columnPageSize;return a=this.engine.rowCount<a+n?this.engine.rowCount>n?this.engine.rowCount-n:0:a,this.engine.pageRowStartPos=a,r=this.engine.columnCount<r+s?this.engine.columnCount>s?this.engine.columnCount-s:0:r,this.engine.pageColStartPos=r,{rowQuery:""!==e?"\nSUBSET ({ "+(this.isMondrian?"":"NONEMPTY")+" ("+e+(this.isMondrian||""===t?"":","+t)+")},"+a+","+n+")":"",columnQuery:""!==t?"\nSUBSET ({ "+(this.isMondrian?"":"NONEMPTY")+" ("+t+(this.isMondrian||""===i?"":","+i)+")},"+r+","+s+")":""}},e.getPagingCountQuery=function(e,t){e=e.replace("NON EMPTY ( ","").slice(0,-1),t=t.replace("NON EMPTY ( ","").slice(0,-1);var i=e;return{rowQuery:""!==e?"SET [d1876d2b-e50e-4547-85fe-5b8ed9d629de] as "+(this.isMondrian?"":"NONEMPTY")+" ("+e+(this.isMondrian||""===t?"":","+t)+")\n":"",columnQuery:""!==t?"\nSET [e16a30d0-2174-4874-8dae-a5085a75a3e2] as "+(this.isMondrian?"":"NONEMPTY")+" ("+t+(this.isMondrian||""===i?"":","+i)+")\n":""}},e.getDimensionsQuery=function(e,t,i,a){var r="";if(e.length>0){r="\nNON EMPTY ( "+(this.drilledMembers.length>0?"HIERARCHIZE ({":"");for(var n=0;n<e.length;){0===n?"[measures]"===e[n].name.toLowerCase()?""!==t&&(r+=t):r+="({"+this.getDimensionQuery(e[n],i)+"})":"[measures]"===e[n].name.toLowerCase()?""!==t&&(r=r+" * "+t):r=r+" * "+("({"+this.getDimensionQuery(e[n],i)+"})"),n++}var s=this.getDrillQuery(e,t,i,a);r=a&&a.axis===i?"\nNON EMPTY ( "+(this.drilledMembers.length>0?"HIERARCHIZE ({":"")+s.query:r+(""!==s.query?",":"")+s.query;var o=this.getAttributeDrillQuery(e,t,i,a);r=r+(this.isPaging?(""!==o?"-":"")+o:"")+(this.drilledMembers.length>0?"})":"")+(this.isPaging?"":(""!==o?"-":"")+o)+")"}return r},e.getAttributeDrillQuery=function(e,t,i,a){var r="",n=[];n=a&&a.axis===i&&"down"===a.action.toLowerCase()?[{name:a.fieldName,items:[a.memberName],delimiter:"~~"}]:this.drilledMembers;for(var s=i===this.valueAxis?this.getMeasurePos(i):0,o=0,l=n;o<l.length;o++){var d=l[o];if(!!this.engine.fieldList[d.name]&&this.engine.fieldList[d.name].isHierarchy)for(var h=0,p=d.items;h<p.length;h++){for(var u=p[h],c=[],g=u.split(d.delimiter?d.delimiter:"~~"),m=this.getDrillLevel(e,g),f=this.getDimensionPos(i,d.name),v=e.length-(s>f?1:0),S=!!this.isPaging&&this.isAttributeMemberExist(d.name,u.split(d.delimiter?d.delimiter:"~~"),d.delimiter,g,i);m.level>0&&m.isDrill&&f+1!==s&&!S;){for(var y=[],b=0;b<e.length;){if("[measures]"===e[b].name.toLowerCase())""!==t&&y.push(g[b]?"({{"+g[b]+"}})":"("+t+")");else if(g[b]&&(-1!==g[b].indexOf(e[b].name)||e[b].isNamedSet&&this.fieldList[e[b].name]&&-1!==g[b].indexOf(this.fieldList[e[b].name].pid.split("Sets_")[1])))y.push(this.getHierarchyQuery(g[b],!1,!1,!1,m.level,!0));else{if(g[b]||!e[b]){y=[];break}y.push(this.getHierarchyQuery(e[b].name,!!(this.isPaging&&2===m.level||!this.isPaging&&v>b),e[b].isNamedSet,e[b].isCalculatedField,m.level,!1))}b++}y.length>0&&c.push("("+y.join("*")+")"),m.level--,v--}c.length>0&&(r=r+(""!==r?"-":"")+c.join(this.isPaging?"+":"-"))}}return r},e.getDimensionPos=function(e,t){for(var i=0,a="rows"===e?this.rows:this.columns,r=0;r<a.length;r++)if(a[r].name===t){i=r;break}return i},e.getMeasurePos=function(e){for(var t=0,i="rows"===e?this.rows:this.columns,a=0;a<i.length;a++)if(0===i[a].name.indexOf("[Measures]")){t=a;break}return t},e.getDrillLevel=function(e,t){for(var i=e.length,a=!1,r=0;r<e.length;)t[r]&&-1!==t[r].indexOf(e[r].name)?(i-=1,e[r+1]&&!(e[r+1].isNamedSet||0===e[r+1].name.indexOf("[Measures]")||this.fieldList[e[r+1].name]&&!this.fieldList[e[r+1].name].hasAllMember)&&(a=!0)):(e[r].isNamedSet||0===e[r].name.indexOf("[Measures]")||this.fieldList[e[r].name]&&!this.fieldList[e[r].name].hasAllMember)&&(i-=1),r++;return{level:this.isPaging?2:i,isDrill:a}},e.getHierarchyQuery=function(e,t,i,a,r,n){return e=a?this.fieldList[e].tag:e,!this.fieldList[e]||this.fieldList[e].hasAllMember||i||a?i||a?"({"+e+"})":this.isPaging?"({"+e+(t?".CHILDREN})":n||1!==r?"})":".[All]})"):"({DrilldownLevel({"+e+(t?".CHILDREN":"")+"},,,INCLUDE_CALC_MEMBERS)})":"(("+e+").levels(0).AllMembers)"},e.isAttributeMemberExist=function(e,t,i,a,r){t.splice(a.length-1,1);var n=!1;if(""!==t.join(i)&&(!this.isPaging||1!==t.length||"[Measures]"!==t.join(i))&&this.engine.fieldList[e]&&this.engine.fieldList[e].hasAllMember)for(var s=this.getDimensionPos(r,e),o=0;o<this.drilledMembers.length;o++){if(e!==this.drilledMembers[o].name)if(!!this.engine.fieldList[this.drilledMembers[o].name]&&this.engine.fieldList[this.drilledMembers[o].name].isHierarchy)for(var l=this.getDimensionPos(r,this.drilledMembers[o].name),d=0;d<this.drilledMembers[o].items.length;d++){var h=this.getDrillLevel("rows"===r?this.rows:this.columns,this.drilledMembers[o].items[d].split(this.drilledMembers[o].delimiter?this.drilledMembers[o].delimiter:"~~"));if((!this.isPaging||l<s&&h.isDrill)&&(0===this.drilledMembers[o].items[d].indexOf(t.join(i))||0===t.join(i).indexOf(this.drilledMembers[o].items[d]))){n=!0;break}}}return n},e.getDrillQuery=function(e,t,i,a){var r="",n=[],s=[],o=!1,l="";a&&a.axis===i&&"down"===a.action.toLowerCase()?(o=!0,s=[{name:a.fieldName,items:[a.memberName],delimiter:"~~"}]):s=this.drilledMembers;for(var d=0,h=s;d<h.length;d++){var p=h[d];if(!(!!this.engine.fieldList[p.name]&&this.engine.fieldList[p.name].isHierarchy))for(var u=0,c=p.items;u<c.length;u++){for(var g=c[u],m=[],f=[],v=0,S=g.split(p.delimiter?p.delimiter:"~~"),y=this.isAttributeMemberExist(p.name,g.split(p.delimiter?p.delimiter:"~~"),p.delimiter?p.delimiter:"~~",S,i);v<e.length&&!y;){if(S[v]&&-1!==S[v].indexOf(e[v].name))-1!==S[S.length-1].indexOf(e[v].name)?o?l=l+(""!==l?" * ":"")+"({"+S[v]+".CHILDREN})":(m.push("("+S[v]+".CHILDREN)"),f.push("("+S[v]+")")):"[measures]"===S[v].toLowerCase()&&""!==t?o?l=l+(""!==l?" * ":"")+"("+t+")":(m.push("("+t+")"),f.push("("+t+")")):-1!==S[v].toLowerCase().indexOf("[measures]")?o?l=l+(""!==l?" * ":"")+"({"+S[v]+"})":(m.push("({"+S[v]+"})"),f.push("({"+S[v]+"})")):o?l=l+(""!==l?" * ":"")+"({"+S[v]+"})":(m.push("("+S[v]+")"),f.push("("+S[v]+")"));else{if(S[v]||!e[v]){m=[];break}if("[measures]"===e[v].name.toLowerCase()&&""!==t)o?l=l+(""!==l?" * ":"")+"("+t+")":(m.push("("+t+")"),f.push("("+t+")"));else{var b=this.getDimensionQuery(e[v],i);o?l=l+(""!==l?" * ":"")+"({"+b+"})":(m.push("("+b+")"),f.push("("+b+")"))}}v++}m.length>0&&m.length<S.length&&(m=[],f=[]),r=r+(""!==r&&m.length>0?",":"")+(m.length>0?"("+m.toString()+")":""),f.length>0&&n.push("("+f.toString()+")")}}return{query:o?l:r,collection:o?[l]:n}},e.getSlicersQuery=function(e,i){var a=this,r="",n=(0,t.extend)([],this.rows,null,!0);if(n=n.concat(this.columns),e.length>0){for(var s=0;s<e.length;){n.filter((function(t){var i=a.getDimensionUniqueName(t.name),r=a.getDimensionUniqueName(e[s].name);return i===r&&!(a.isMondrian&&""===r&&""===i)})).length>0||(void 0===e[s].name||this.filterMembers[e[s].name]?this.filterMembers[e[s].name]&&(r=r+(""!==r?" * ":"")+"{"+this.filterMembers[e[s].name].toString()+"}"):r=r+(""!==r?" * ":"")+"{"+this.getDimensionQuery(e[s],i)+"}"),s++}r=""===r?"":"\nWHERE ("+r.replace(/DrilldownLevel/g,"")+")"}return r},e.getDimensionQuery=function(e,t){var i=e.isCalculatedField?this.fieldList[e.name].tag:e.name;return this.fieldList[e.name]&&this.fieldList[e.name].hasAllMember||e.isNamedSet||e.isCalculatedField?e.isNamedSet||e.isCalculatedField?"{"+i+"}":this.isPaging?i+".CHILDREN":"DrilldownLevel({"+i+"}"+("rows"===t||"columns"===t?",,,INCLUDE_CALC_MEMBERS":"")+")":"(("+i+").levels(0).AllMembers)"},e.getDimensionUniqueName=function(e){var t=this.fieldDataObj.hierarchy,i=[];if(t){for(var a=0,r=t;a<r.length;a++){var n=r[a];n.id.toLowerCase()===e.toLowerCase()&&i.push(n)}return i.length>0?i[0].pid:""}return e.split(".")[0]},e.getMeasuresQuery=function(e){var t="";if(e.length>0){t="{{";for(var i="",a=0,r=e;a<r.length;a++){var n=r[a],s=n.isCalculatedField?this.fieldList[n.name].tag:n.name;i=i.length>0?i+", "+s:s}t=t+i+"}}"}return t},e.getfilterQuery=function(e,t){for(var i="\nFROM ["+t+"]",a="\nFROM( SELECT (",r=[],n=[],s=[],o=[],l=0,d=this.rows;l<d.length;l++){e[(m=d[l]).name]&&e[m.name].length>0&&("string"==typeof e[m.name][0]?s.push(e[m.name]):(e[m.name][1]=e[m.name][0].type,r.push(e[m.name]),delete e[m.name]))}for(var h=0,p=this.columns;h<p.length;h++){if(e[(m=p[h]).name]&&e[m.name].length>0)if("string"==typeof e[m.name][0])o.push(e[m.name]);else{var u=e[m.name];u[1]=u[0].type,r.push(e[m.name]),delete e[m.name]}}for(var c=0,g=this.filters;c<g.length;c++){for(var m=g[c],f=!1,v=0,S=this.columns;v<S.length;v++){var y=S[v];f||this.getDimensionUniqueName(y.name)!==this.getDimensionUniqueName(m.name)||e[m.name]&&(o.push(e[m.name]),f=!0)}if(!f)for(var b=0,C=this.rows;b<C.length;b++){var x=C[b];f||this.getDimensionUniqueName(x.name)!==this.getDimensionUniqueName(m.name)||e[m.name]&&(s.push(e[m.name]),f=!0)}}if((this.allowLabelFilter||this.allowValueFilter)&&r.length>0)for(var w=0,T=["Value","Label"];w<T.length;w++)for(var M=T[w],D=0,O=r;D<O.length;D++){var P=O[D];P&&2===P.length&&"string"==typeof P[1]&&P[1]===M&&n.push(this.getAdvancedFilterQuery(P[0],a,"COLUMNS"))}for(var N=0,E=o.length;N<E;N++)a=0===N?a+"{"+o[N].toString()+"}":a+",{"+o[N].toString()+"}";o.length>0&&(a=s.length>0?a+" ) ON COLUMNS ,(":a+" ) ON COLUMNS");for(N=0,E=s.length;N<E;N++)a=N>0?a+",{"+s[N].toString()+"}":a+"{"+s[N].toString()+"}";a=o.length>0&&s.length>0?a+=") ON ROWS ":0===o.length&&s.length>0?a+") ON COLUMNS ":a;var I="";return n.length>0&&(I=n.join(" ")+" "+(o.length>0||s.length>0?a:"")+" "+i+Array(n.length+1+(o.length>0||s.length>0?1:0)).join(")")),i=0===o.length&&0===s.length?i:a+i+")",I.length>0?I:i},e.getAdvancedFilterQuery=function(e,t,i){return"\nFROM (SELECT Filter("+e.selectedField+".AllMembers, "+this.getAdvancedFilterCondtions(e.name,e.condition,e.value1,e.value2,e.type,e.measure)+")) on "+i},e.getAdvancedFilterCondtions=function(e,t,i,a,r,n){var s="";switch(t){case"Equals":s="("+("Value"!==r?e+'.CurrentMember.member_caption ="'+i+'"':n+" = "+i);break;case"DoesNotEquals":s="("+("Value"!==r?e+'.CurrentMember.member_caption <>"'+i+'"':n+" <>"+i);break;case"Contains":default:s="( InStr (1,"+e+'.CurrentMember.member_caption,"'+i+'") >0';break;case"DoesNotContains":s="( InStr (1,"+e+'.CurrentMember.member_caption,"'+i+'")=0';break;case"BeginWith":s="( Left ("+e+".CurrentMember.member_caption,"+i.length+')="'+i+'"';break;case"DoesNotBeginWith":s="( Left ("+e+".CurrentMember.member_caption,"+i.length+') <>"'+i+'"';break;case"EndsWith":s="( Right ("+e+".CurrentMember.member_caption,"+i.length+')="'+i+'"';break;case"DoesNotEndsWith":s="( Right ("+e+".CurrentMember.member_caption,"+i.length+') <>"'+i+'"';break;case"GreaterThan":s="("+("Value"!==r?e+'.CurrentMember.member_caption >"'+i+'"':n+" >"+i);break;case"GreaterThanOrEqualTo":s="("+("Value"!==r?e+'.CurrentMember.member_caption >="'+i+'"':n+" >="+i);break;case"LessThan":s="("+("Value"!==r?e+'.CurrentMember.member_caption <"'+i+'"':n+" <"+i);break;case"LessThanOrEqualTo":s="("+("Value"!==r?e+'.CurrentMember.member_caption <="'+i+'"':n+" <="+i);break;case"Between":s="("+("Value"!==r?e+'.CurrentMember.member_caption >="'+i+'"AND '+e+'.CurrentMember.member_caption <="'+a+'"':n+" >="+i+" AND "+n+" <="+a);break;case"NotBetween":s="("+("Value"!==r?e+'.CurrentMember.member_caption >="'+i+'"OR '+e+'.CurrentMember.member_caption <="'+a+'"':n+" >="+i+" OR "+n+" <="+a)}return s},e.getCalculatedFieldQuery=function(e){var i="";if(e.length>0){i="\nWITH";for(var a=0,r=e;a<r.length;a++){var n=r[a],s=(n.formula.indexOf("Measure")>-1?"[Measures].":n.hierarchyUniqueName+".")+"["+n.name+"]",o=(0,t.isNullOrUndefined)(n.formatString)?null:n.formatString;i+="\nMEMBER "+s+"as ("+n.formula+") "+((0,t.isNullOrUndefined)(o)?"":', FORMAT_STRING ="'+o.trim()+'"')}}return i},e}(),Ko=function(){function e(){this.fieldList={},this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.pageColStartPos=0,this.enableSort=!1,this.enableValueSorting=!1,this.dataFields={},this.formatFields={},this.filterMembers={},this.drilledSets={},this.isExporting=!1,this.aggregatedValueMatrix=[],this.mappingFields={},this.formatRegex=/^(?:[ncpae])(?:([0-9]|1[0-9]|20))?$/i,this.clonedValTuple=[],this.clonedColumnTuple=[],this.clonedRowTuple=[],this.pivotValues=[],this.valueContent=[],this.headerContent=[],this.rowStartPos=0,this.pageRowStartPos=0,this.tupColumnInfo=[],this.tupRowInfo=[],this.gridJSON="",this.namedSetsPosition={},this.colDepth=0,this.totalCollection=[],this.parentObjCollection={},this.curDrillEndPos=-1,this.headerGrouping={},this.lastLevel=[],this.showRowSubTotals=!0,this.showColumnSubTotals=!0,this.hideRowTotalsObject={},this.hideColumnTotalsObject={},this.sortObject={},this.isColDrill=!1}return e.prototype.renderEngine=function(e,i,a){if(this.isEmptyData=!1,this.getHeaderSortInfo=a,this.mdxQuery="",this.isMeasureAvail=!1,this.allowMemberFilter=!1,this.allowLabelFilter=!1,this.allowValueFilter=!1,this.isMondrian=!1,this.aggregatedValueMatrix=[],this.measureReportItems=[],this.calcChildMembers=[],this.selectedItems=[],this.savedFieldList=void 0,this.savedFieldListData=void 0,this.formatFields={},this.filterMembers={},this.dataFields={},this.valueAxis="",this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.pageColStartPos=0,this.sortObject={},this.globalize=new t.Internationalization,this.locale=this.globalize.culture?this.globalize.culture:"en-US",this.localeObj=i?i.localeObj:void 0,this.enableValueSorting=!!i&&i.enableValueSorting,e.url){this.dataSourceSettings=e,this.measureIndex=(0,t.isNullOrUndefined)(e.valueIndex)?-1:e.valueIndex,this.valueAxis="row"===e.valueAxis?"row":"column",this.getAxisFields(),this.formats=e.formatSettings?e.formatSettings:[],this.enableSort=void 0===e.enableSorting||e.enableSorting,this.valueSortSettings=e.valueSortSettings?e.valueSortSettings:void 0,this.filterSettings=e.filterSettings?e.filterSettings:[],this.sortSettings=e.sortSettings?e.sortSettings:[],this.allowMemberFilter=!!e.allowMemberFilter,this.allowLabelFilter=!!e.allowLabelFilter,this.allowValueFilter=!!e.allowValueFilter,this.drilledMembers=e.drilledMembers?this.updateDrilledItems(e.drilledMembers):[],this.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.emptyCellTextContent=e.emptyCellsTextContent?e.emptyCellsTextContent:"",this.pageSettings=i?i.pageSettings?i.pageSettings:this.pageSettings:void 0,this.isPaging=!(!this.pageSettings||!i.enablePaging&&!i.enableVirtualization),this.frameSortObject(),this.getFormattedFields(this.formats),this.savedFieldList=i?i.savedFieldList:void 0,this.savedFieldListData=i?i.savedFieldListData:void 0,this.fieldListData=[],this.fieldListObj={},this.setNamedSetsPosition(),this.savedFieldList&&Object.keys(this.savedFieldList).length>0&&this.savedFieldListData?this.updateFieldlist(!0):(this.getCubes(e),this.getFieldList(e)),this.loadCalculatedMemberElements(this.calculatedFieldSettings);var r=this.getMeasureInfo();this.olapVirtualization=this.isPaging&&e.showSubTotals&&r.measureIndex===("column"===r.measureAxis?e.columns.length-1:e.rows.length-1)&&!(0,t.isNullOrUndefined)(this.pageSettings)&&e.showGrandTotals,this.isPaging=this.isPaging?!this.olapVirtualization:this.isPaging,this.measureReportItems=[],this.updateFilterItems(this.filterSettings),this.generateGridData(e)}},e.prototype.generateGridData=function(e,t){var i=!(!t||"navPaging"!==t||!this.isPaging||void 0===this.pageSettings);this.rows.length>0||this.columns.length>0||this.values.length>0||this.filters.length>0?Yo.getCellSets(e,this,i):(Yo.getCellSets(e,this,!0,void 0,!0),this.generateEngine(void 0,void 0,{dataSourceSettings:e,action:"loadTableElements"}))},e.prototype.generatePagingData=function(e,t,i){var a=[].slice.call(e.querySelectorAll("Axes, CellData")),r=a[1]?a[1].querySelectorAll("FmtValue"):null;r&&r.length>0&&(this.columnCount=Number(r[0].textContent),this.rowCount=Number(r[1].textContent));var n=i.dataSourceSettings;Yo.getCellSets(n,this,!0)},e.prototype.scrollPage=function(){if(this.olapVirtualization){var e=this.getVirtualScrollingData(this.clonedColumnTuple,this.clonedRowTuple);e.isCalculated&&(this.pivotValues=[],this.clearEngineProperties(),this.performEngine(e.columnTuple,e.rowTuple,e.valueTuple)),this.pivotValues=this.pivotValues.slice()}else Yo.getCellSets(this.dataSourceSettings,this,!0)},e.prototype.getVirtualScrollingData=function(e,i){var a=this.clonedValTuple.slice(),r=!1,n=(this.pageSettings.currentColumnPage-1)*this.pageSettings.columnPageSize,s=(this.pageSettings.currentRowPage-1)*this.pageSettings.rowPageSize,o=3*this.pageSettings.columnPageSize,l=3*this.pageSettings.rowPageSize;if(n=this.columnCount<n+o?this.columnCount>o?this.columnCount-o:0:n,s=this.rowCount<s+l?this.rowCount>l?this.rowCount-l:0:s,n!==this.pageColStartPos||s!==this.pageRowStartPos||!(e.length<=o&&i.length<=l)){r=!0;var d=this.getMeasureInfo(),h=!(0,t.isNullOrUndefined)(e[0])&&0===Number(e[0].querySelectorAll("Member")[0].querySelector("LNum").textContent),p=!(0,t.isNullOrUndefined)(i[0])&&0===Number(i[0].querySelectorAll("Member")[0].querySelector("LNum").textContent),u=!!h&&n+o>=e.length-1,c=!!p&&s+l>=i.length-1,g=h?this.getAxisdepth(e):"column"===d.measureAxis?d.valueInfo.length:1,m=p?this.getAxisdepth(i):"row"===d.measureAxis?d.valueInfo.length:1,f=(h?g:0)+n,v=(p?m:0)+s,S=e.slice(f,f+o),y=i.slice(v,v+l),b=S[0]?Number(S[0].querySelectorAll("Member")[0].querySelector("LNum").textContent):0,C=y[0]?Number(y[0].querySelectorAll("Member")[0].querySelector("LNum").textContent):0,x=this.getVirtualTotals(e.slice(0,f),b,u,"column",g),w=this.getVirtualTotals(i.slice(0,v),C,c,"row",m);f=S.length+x.totalsCollection.length>o?Math.max(S.length+x.totalsCollection.length-o):0,v=y.length+w.totalsCollection.length>l?Math.max(y.length+w.totalsCollection.length-l):0,S=x.totalsCollection.concat(S.slice(f,S.length)),y=w.totalsCollection.concat(y.slice(v,y.length));var T=this.getVirtualValues(a,n+f,s+v,o,l,x.indexCollection,w.indexCollection,e.length,i.length,g,m,p);e=S.slice(),i=y.slice(),a=T.slice()}return this.pageColStartPos=n,this.pageRowStartPos=s,{columnTuple:e,rowTuple:i,valueTuple:a,isCalculated:r}},e.prototype.getAxisdepth=function(e){for(var t=0,i=0;i<e.length;i++){if(0!==Number(e[i].querySelectorAll("Member")[0].querySelector("LNum").textContent))break;t++}return t},e.prototype.getVirtualTotals=function(e,t,i,a,r){var n=[],s=[];if(1!==t)for(var o=e.length-1;o>0;o--){var l=Number(e[o].querySelectorAll("Member")[0].querySelector("LNum").textContent);if(0===l)break;if(t>l)if(t=l,Number(e[o-1].querySelectorAll("Member")[0].querySelector("LNum").textContent)===l){for(var d=0;d<r;d++)n[n.length]=e[o-d],s[s.length]=o-d;o=r>1?o-(r-1):o}else n[n.length]=e[o],s[s.length]=o;else if(1===l)break}if(i)for(o=r;o>0;o--)n=n.concat([e[o-1]]),s=s.concat([o-1]);return{totalsCollection:n.reverse(),indexCollection:s.reverse()}},e.prototype.getVirtualValues=function(e,t,i,a,r,n,s,o,l,d,h,p){var u=[],c=e;if(l>r){var g=((p?h:0)+i)*o;c=e.slice(g,g+r*o);for(var m=[],f=0;f<s.length;f++)m=m.concat(e.slice(s[f]*o,s[f]*o+o));c=m.concat(c)}f=0;for(var v=c.length/o;f<v;f++){for(var S=c.slice(f*o,f*o+o),y=S.slice(t+d,t+d+a),b=[],C=0;C<n.length;C++)b[b.length]=S[n[C]];u=u.concat(b.concat(y))}return u},e.prototype.generateEngine=function(e,i,a){"down"!==a.action&&this.clearEngineProperties(),this.xmlDoc=e?e.cloneNode(!0):void 0,this.request=i,this.customArgs=a,this.parentObjCollection={},this.curDrillEndPos=-1,this.onDemandDrillEngine=[],this.getSubTotalsVisibility(),this.xmlaCellSet=e?e.querySelectorAll("Axes, CellData"):void 0;var r=this.xmlaCellSet&&this.xmlaCellSet.length>0?[].slice.call(this.xmlaCellSet[0].querySelectorAll('Axis[name|="Axis0"] Tuple')):[],n=this.xmlaCellSet&&this.xmlaCellSet.length>0?[].slice.call(this.xmlaCellSet[0].querySelectorAll('Axis[name|="Axis1"] Tuple')):[],s=this.xmlaCellSet&&this.xmlaCellSet.length>1?[].slice.call(this.xmlaCellSet[1].querySelectorAll("Cell")):[];if(this.olapVirtualization&&!(0,t.isNullOrUndefined)(this.pageSettings)){if(r.length*n.length!==s.length){for(var o=[],l=0;l<s.length;l++)(0,t.isNullOrUndefined)(s[l])||(o[Number(s[l].getAttribute("CellOrdinal"))]=s[l]);s=o}this.clonedValTuple=s;var d=this.getDrillInfo("columns"),h=this.getActualTuples(r,d);d=this.getDrillInfo("rows");var p=this.getActualTuples(n,d,h.indexColls,r.length);this.clonedColumnTuple=h.tupColls,this.clonedRowTuple=p.tupColls,this.columnCount=this.clonedColumnTuple.length,this.rowCount=this.clonedRowTuple.length,h=p=void 0;var u=this.getVirtualScrollingData(this.clonedColumnTuple,this.clonedRowTuple);this.performEngine(u.columnTuple,u.rowTuple,u.valueTuple)}else this.performEngine(r,n,s)},e.prototype.getDrillInfo=function(e){var t={},i=[];if("columns"===e?i=this.dataSourceSettings.columns.map((function(e){return e.name})):"rows"===e&&(i=this.dataSourceSettings.rows.map((function(e){return e.name}))),i.length>0)for(var a=0,r=this.drilledMembers.length;a<r;a++){var n=this.drilledMembers[a],s=i.indexOf(n.name);s>-1&&(t[s]||(t[s]=[]),t[s]=t[s].concat(n.items))}return t},e.prototype.getActualTuples=function(e,t,i,a){var r=[],n=[],s=[];if(e.length>0)for(var o=function(o,d){for(var h=e[o],p=!0,u=!1,c=!1,g=h.getElementsByTagName("MEMBER_TYPE"),m=h.getElementsByTagName("UName"),f=0,v=g.length;f<v;f++){var S=Number(g[f].textContent),y=m[f].textContent;if(c&&S<2?p=!1:2===S?u=!0:u&&S<2&&(p=!1),t[f]&&t[f].indexOf(y)>-1&&(c=!0),!p)break}if(p)if(r[r.length]=h,i){var b=l.clonedValTuple.slice(o*a,o*a+a);s=s.concat(i.map((function(e){return b[e]})))}else n[n.length]=o},l=this,d=0,h=e.length;d<h;d++)o(d);else if(i){var p=this.clonedValTuple.slice(0,a);s=s.concat(i.map((function(e){return p[e]})))}return s.length>0&&(this.clonedValTuple=s),{tupColls:r,indexColls:n}},e.prototype.clearEngineProperties=function(){this.pivotValues=[],this.valueContent=[],this.headerContent=[],this.colDepth=0,this.tupColumnInfo=[],this.tupRowInfo=[],this.colMeasures={},this.colMeasurePos=void 0,this.rowMeasurePos=void 0,this.rowStartPos=-1},e.prototype.performEngine=function(e,i,a){this.totalCollection=[];var r=this.getMeasureInfo();if(this.drilledMembers.length>0){var n=void 0,s=e.length&&i.length?e.length*i.length:e.length?e.length:i.length;e=(n=this.frameMeasureOrder(r,"column",e,a,e.length,s)).orderedHeaderTuples,a=n.orderedValueTuples,i=(n=this.frameMeasureOrder(r,"row",i,a,e.length,s)).orderedHeaderTuples,a=n.orderedValueTuples}"down"===this.customArgs.action&&this.updateTupCollection("row"===this.customArgs.drillInfo.axis?i.length:e.length);for(var o,l={},d=0;d<a.length;d++)(0,t.isNullOrUndefined)(a[d])||(l[this.olapVirtualization?d:Number(a[d].getAttribute("CellOrdinal"))]=a[d]);if(this.valueSortSettings.columnIndex=void 0,this.enableValueSorting&&this.valueSortSettings&&!this.isPaging&&!this.olapVirtualization&&(o=this.getValueSortInfo(e,i,r)),"down"===this.customArgs.action&&"column"!==this.customArgs.drillInfo.axis||(this.frameColumnHeader(e),this.isPaging||this.olapVirtualization||this.performColumnSorting(l,o)),"down"===this.customArgs.action&&"row"!==this.customArgs.drillInfo.axis||(this.frameRowHeader(i),this.isPaging||this.olapVirtualization||this.performRowSorting(l,o)),this.frameValues(l,e.length),this.performColumnSpanning(),!this.isPaging&&!this.olapVirtualization&&this.enableSort)for(var h=0;h<this.headerContent.length;h++)this.headerContent[h]=this.pivotValues[h];this.isEngineUpdated=!0,this.isEmptyData=0===e.length},e.prototype.getValueSortInfo=function(e,t,i){var a;if(this.valueSortSettings.headerText){var r=this.valueSortSettings.headerText.split(this.valueSortSettings.headerDelimiter),n=r.indexOf("Grand Total");if(n>-1){var s=r.join("").split(r[n]).join("");(r=[])[i.measureIndex]=s}for(var o="",l=i.measureIndex,d=0;d<this.dataSourceSettings.values.length;d++)if(l=r.indexOf(this.dataSourceSettings.values[d].caption),this.dataSourceSettings.values[d].caption===r[l]){r[l]=this.fieldList[this.dataSourceSettings.values[d].name].name,o=r[l];break}if(-1!==l){l<i.measureIndex&&(r=this.reArrangeHeaders(r,i.measureIndex,o));var h="column"===this.olapValueAxis?e:t;if(h.length>0){var p=h[0].getElementsByTagName("Member").length-(n>-1?l:0),u=this.getParentElement(h,r,p,i.measureIndex,o,n>-1)[0];a=h.indexOf(u)}}}return{memberIndex:a,columnLength:e.length,rowLength:t.length,isValueSorting:a>-1}},e.prototype.getParentElement=function(e,i,a,r,n,s){for(var o=[],l=0,d=!1,h=!1,p=e[0].getElementsByTagName("Member").length-a,u=0;u<e.length;u++){if((0,t.isNullOrUndefined)(e[u].getElementsByTagName("Member")[p])){o=[];break}var c=e[u].getElementsByTagName("UName")[p].textContent,g=e[u].getElementsByTagName("Caption")[p].textContent,m=Number(e[u].getElementsByTagName("LNum")[p].textContent),f=c===i[p]||g===i[p]||(0,t.isNullOrUndefined)(i[p])&&0===m;if(f){if(o[o.length]=e[u],d=!0,l=m,s)break}else{if(d&&l<m){for(var v=[],S=u;S<e.length;S++){var y=e[S].getElementsByTagName("UName")[p].textContent,b=e[S].getElementsByTagName("Caption")[p].textContent,C=Number(e[S].getElementsByTagName("LNum")[p].textContent),x=y===i[p+1]||b===i[p+1]||(0,t.isNullOrUndefined)(i[p+1])&&0===C;if(l+1===C&&x)v[v.length]=e[S],h=!0;else if(l+1<C){if(!h)break;v[v.length]=e[S]}else if(l+1>C)break}if(h){var w=i.slice(0,p).concat(i.slice(p+1,i.length));w.indexOf(n)<r&&(w=this.reArrangeHeaders(w,r,n)),o=this.getParentElement(v,w,v[0].getElementsByTagName("Member").length,r,n)}break}if(d&&!f)break}}return s||p<i.length-1&&o.length>0&&!h&&(o=this.getParentElement(o,i,a-1,r,n)),o},e.prototype.reArrangeHeaders=function(e,t,i){var a=e.indexOf(i),r=e.slice(0,a),n=e.slice(a+1,e.length);return r[t]=e[a],r.concat(n)},e.prototype.getSubTotalsVisibility=function(){this.showRowSubTotals=this.dataSourceSettings.showRowSubTotals&&this.dataSourceSettings.showSubTotals,this.showColumnSubTotals=this.dataSourceSettings.showColumnSubTotals&&this.dataSourceSettings.showSubTotals,this.showSubTotalsAtTop=this.showColumnSubTotals&&"Top"===this.dataSourceSettings.subTotalsPosition,this.showSubTotalsAtBottom=this.showRowSubTotals&&"Bottom"===this.dataSourceSettings.subTotalsPosition,this.hideRowTotalsObject={},this.hideColumnTotalsObject={};var e=1;do{if(1===e){if(this.showColumnSubTotals)for(var t=0;t<this.dataSourceSettings.columns.length;t++)!1===this.dataSourceSettings.columns[t].showSubTotals&&(this.hideColumnTotalsObject[this.dataSourceSettings.columns[t].name]=t)}else if(this.showRowSubTotals)for(var i=0;i<this.dataSourceSettings.rows.length;i++)!1===this.dataSourceSettings.rows[i].showSubTotals&&(this.hideRowTotalsObject[this.dataSourceSettings.rows[i].name]=i);e++}while(e<3)},e.prototype.frameRowHeader=function(e){var t=this;this.headerGrouping={},this.lastLevel=[];var i=!0,a=this.pivotValues.length,r=[],n=[];"down"!==this.customArgs.action?(r=this.pivotValues,n=this.valueContent):a=this.customArgs.drillInfo.currentCell.rowIndex+1,this.rowStartPos=this.rowStartPos>0?this.rowStartPos:a;for(var s,o,l,d,h=0,p=[],u={},c=[],g=!1,m=-1,f=-1,v=[],S=[{actualText:"Grand Total",axis:"row",colIndex:0,formattedText:"Grand Total",hasChild:!1,level:-1,rowIndex:0,index:[],type:"grand sum",ordinal:0,colSpan:1,rowSpan:1,memberType:2,isDrilled:!1,valueSort:{"Grand Total":1,levelName:"Grand Total"}}],y=[],b=this.customArgs.drillInfo&&"row"===this.customArgs.drillInfo.axis?this.customArgs.drillInfo.currentCell.ordinal+1:0;h<e.length;){var C=e[h].querySelectorAll("Member");y=this.frameTupCollection(C,y,h+b,this.tupRowInfo,this.showRowSubTotals,this.hideRowTotalsObject,"row"),h++}h=0;var x=e.length;if("down"===this.customArgs.action){var w=this.customArgs.drillInfo.currentCell.ordinal+1;h=w,x+=w,o=this.tupRowInfo[w-1].allCount,s=this.tupRowInfo[w-1].allStartPos,d=this.tupRowInfo[w-1]}for(var T=h,M=0,D=!1,O=[];h<x;){C=e["down"===this.customArgs.action?h-(this.customArgs.drillInfo.currentCell.ordinal+1):h].querySelectorAll("Member");var P=0,N=void 0,E=this.tupRowInfo[h].allCount,I=this.tupRowInfo[h].allStartPos,F=this.tupRowInfo[h].measure,L=this.tupRowInfo[h].typeCollection,A=this.tupRowInfo[h].drillStartPos,R=this.tupRowInfo[h].startDrillUniquename;if(0===h||h===T){for(var k="down"===this.customArgs.action?this.tupRowInfo[0].members:C;P<k.length;)"1"===k[P].querySelector("MEMBER_TYPE").textContent&&0===Number(k[P].querySelector("LNum").textContent)?v[P]=0:v[P]=Number(k[P].querySelector("LNum").textContent),"1"===k[P].querySelector("MEMBER_TYPE").textContent?(u[P]=0,m=-1===m?P:m,f=P):(u[P]=1,g="3"!==k[P].querySelector("MEMBER_TYPE").textContent||g),P++;l=L.indexOf("3")}if(P=0,0===h&&(C.length>E+(F?1:0)||1===C.length&&F)&&S.pop(),0===h&&this.isPaging?0===S.length:!g||E===o||I!==s||1===C.length&&F){var j=this.checkAttributeDrill(this.tupRowInfo[h].drillInfo,"rows"),q=!(A>-1)||(!(E>0)||(j||I>A));q=d&&q&&A>-1?d.startDrillUniquename!==R||!(f>d.measurePosition||d.measureName===this.tupRowInfo[h].measureName||I!==A+1&&this.tupRowInfo[h].measurePosition!==A+1):q;var V=!(m>-1&&E>0)||(j||I>f);if((D="Top"===this.dataSourceSettings.grandTotalsPosition&&0===this.olapRowValueIndex&&"row"===this.olapValueAxis&&this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals&&("row"!==this.olapValueAxis||this.dataSourceSettings.rows.length>1))&&1===S.length&&(S=this.frameGrandTotalValues(e,S,L,l)),C.length===E+(F?1:0)&&F&&!D){var H="Grand Total"+this.valueSortSettings.headerDelimiter+this.dataFields[this.getUniqueName(C[l].querySelector("UName").textContent)].caption?this.dataFields[this.getUniqueName(C[l].querySelector("UName").textContent)].caption:0,U="3"===L[l]&&this.dataFields[this.getUniqueName(C[l].querySelector("UName").textContent)]&&this.dataFields[this.getUniqueName(C[l].querySelector("UName").textContent)].caption?this.dataFields[this.getUniqueName(C[l].querySelector("UName").textContent)].caption:C[l].querySelector("Caption").textContent;(S=this.frameGrandTotalAxisSet(S,this.getUniqueName(C[l].querySelector("UName").textContent),U,a,h,Number(L[l]),C[l].querySelector("PARENT_UNIQUE_NAME")?C[l].querySelector("PARENT_UNIQUE_NAME").textContent:void 0,C[l].querySelector("LName").textContent,C[l].getAttribute("Hierarchy"),{levelName:H,axis:C[l].getAttribute("Hierarchy")}))[S.length-1].valueSort[H]=1}else if(0!==I&&(0!==l||1!==I)&&q&&V){"Top"===this.dataSourceSettings.grandTotalsPosition&&i&&this.dataSourceSettings.showGrandTotals&&("row"!==this.olapValueAxis||this.dataSourceSettings.rows.length>1)&&(this.insertRowGrandTotal(S,n,r,e,a),a=this.pivotValues.length,i=!1),d=this.tupRowInfo[h];var _=a,B=P;N={};for(var G=!1;P<C.length;){var z=C[P];if(z.querySelector("UName").textContent!==p[P]&&"2"!==L[P]&&(!(Object.keys(N).length>0?N.isDrilled&&!this.fieldList[N.hierarchy].isHierarchy:G)||"3"===L[P]&&u[P-1]&&0!==u[P+1])){var W=Number(z.querySelector("LNum").textContent)-(u[P]&&"3"!==L[P]?1:v[P]),Q=!!this.namedSetsPosition.row[P],Y=this.getUniqueName(z.querySelector("UName").textContent),K=this.getDepth(this.tupRowInfo[h],Y,Number(L[P]));H=this.getCaptionCollectionWithMeasure(this.tupRowInfo[h],P,!0);if(this.showSubTotalsAtBottom&&a>this.rowStartPos&&(_=a=this.insertRowSubTotal(r,n,O,a,W,H)),!(this.isPaging&&r[M][0]&&this.fieldList[r[M][0].hierarchy]&&this.fieldList[r[M][0].hierarchy].isHierarchy&&r[M][0].hasChild&&!r[M][0].isDrilled&&!this.rows[P].isNamedSet&&(0===this.rows[P].name.indexOf("[Measures]")||this.fieldList[z.getAttribute("Hierarchy")]&&(this.fieldList[z.getAttribute("Hierarchy")].isHierarchy||this.fieldList[z.getAttribute("Hierarchy")].hasAllMember))&&r[M][0].depth<K)){r[a]=[{axis:"row",actualText:Y,colIndex:0,formattedText:"3"===L[P]&&this.dataFields[Y]&&this.dataFields[Y].caption?this.dataFields[Y].caption:z.querySelector("Caption").textContent,hasChild:!!(this.fieldList[z.getAttribute("Hierarchy")]&&this.fieldList[z.getAttribute("Hierarchy")].isHierarchy&&P<this.rows.length-1&&!this.rows[P+1].isNamedSet&&this.rows[P+1].name.indexOf("[Measures]")<0&&this.fieldList[this.rows[P+1].name]&&this.fieldList[this.rows[P+1].name].hasAllMember)||Number(z.querySelector("CHILDREN_CARDINALITY").textContent)>0,level:W,depth:K,rowIndex:a,index:[],ordinal:h,type:"header",colSpan:1,rowSpan:1,memberType:Number(L[P]),isDrilled:!(!this.fieldList[z.getAttribute("Hierarchy")]||!this.fieldList[z.getAttribute("Hierarchy")].isHierarchy||this.isAttributeDrill(z.getAttribute("Hierarchy"),this.tupRowInfo[h].drillInfo,"rows"))||this.tupRowInfo[h].drillInfo[P].isDrilled,parentUniqueName:z.querySelector("PARENT_UNIQUE_NAME")?z.querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:z.querySelector("LName").textContent,hierarchy:z.getAttribute("Hierarchy"),isNamedSet:Q,valueSort:{levelName:"",axis:z.getAttribute("Hierarchy")}}],this.olapVirtualization&&"header"===r[a][0].type&&delete r[a][0].type,(N="3"!==L[P]?r[a][0]:N)||c.push(z.querySelector("Caption").textContent),H=this.getCaptionCollectionWithMeasure(this.tupRowInfo[h],P,!1),r[a][0].valueSort.levelName=H,r[a][0].valueSort[H]=1,n[a-this.rowStartPos]={},n[a-this.rowStartPos][0]=r[a][0],F&&l>P&&(p[l]="");for(var X=P+1;X<C.length;X++)p[X]="";p[P]=z.querySelector("UName").textContent,M=3!==Number(L[P])?a:M,a++,B=P}}else"2"===L[P]?B=P:this.tupRowInfo[h].drillInfo[P].isDrilled&&0===u[P]&&(G=!0);this.tupRowInfo[h].drillInfo[P].isDrilled&&this.tupRowInfo[h].showTotals&&(this.tupRowInfo[h].showTotals=!!this.showRowSubTotals&&void 0===this.hideRowTotalsObject[this.tupRowInfo[h].drillInfo[P].hierarchy]),P++}_<a&&B>=C.length-1&&(r[a-1][0].ordinal=h,"header"===r[a-1][0].type&&delete r[a-1][0].type)}o=E,s=I}h++}this.showSubTotalsAtBottom&&O.length>0&&(O.reverse(),O.forEach((function(e){r[a]=[e],n[a-t.rowStartPos]={},n[a-t.rowStartPos][0]=r[a][0],a++}))),("Top"!==this.dataSourceSettings.grandTotalsPosition||"row"===this.olapValueAxis&&1===this.dataSourceSettings.rows.length&&"Top"===this.dataSourceSettings.grandTotalsPosition||0===this.dataSourceSettings.rows.length)&&this.insertRowGrandTotal(S,n,r,e,a)},e.prototype.insertRowSubTotal=function(e,t,i,a,r,n){var s=Di.frameHeaderWithKeys(e[a-1][0]);if(s.level<r&&"grand sum"!==s.type&&(s.isDrilled||3===s.memberType))if(3===s.memberType){for(var o=[],l=1;3===e[a-l][0].memberType;)o[o.length]=e[a-l][0],l++;if(e[a-l][0].isDrilled&&0!==o.length){for(var d=0,h=o.length;d<h;d++)o[d].formattedText=e[a-l][0].formattedText+" "+o[d].formattedText,o[d].isSum=!0,o[d].type="sum",o[d].parentUniqueName=e[a-l][0].levelUniqueName,i[i.length]=o[d];a-=--l}}else s.hasChild=!1,s.isDrilled=!1,s.isSum=!0,s.type="sum",s.formattedText=s.formattedText+" Total",i[Object.keys(i).length]=s;if(i.length>0)for(var p=i.length-1,u=i[p].valueSort.levelName.split(".").length,c=n.split(".").length;u>=c&&(e[a]=[i[p]],t[a-this.rowStartPos]={},t[a-this.rowStartPos][0]=e[a][0],a++,i.splice(i.length-1,1),Object.keys(i).length>0);)u=i[--p].valueSort.levelName.split(".").length;return a},e.prototype.insertRowGrandTotal=function(e,t,i,a,r){if(e.length>1&&3!==e[0].memberType&&(e[0].ordinal=-1),"down"!==this.customArgs.action){var n=0===this.dataSourceSettings.rows.length||1===this.dataSourceSettings.rows.length&&"[Measures]"===this.dataSourceSettings.rows[0].name;if(this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals||n)for(var s=0;s<e.length;s++)e[s].rowIndex=r,i[r]=[e[s]],t[r-this.rowStartPos]={},t[r-this.rowStartPos][0]=i[r][0],r++}else this.updateRowEngine(i,t,a.length),this.onDemandDrillEngine=i;return e},e.prototype.frameGrandTotalAxisSet=function(e,t,i,a,r,n,s,o,l,d){return e.push({axis:"row",actualText:t,colIndex:0,formattedText:i,hasChild:!1,level:-1,rowIndex:a,index:[],ordinal:r,colSpan:1,rowSpan:1,memberType:n,isDrilled:!1,parentUniqueName:s,levelUniqueName:o,hierarchy:l,valueSort:d}),e},e.prototype.getDepth=function(e,t,i){var a=e.uNameCollection.indexOf(t),r=(e.uNameCollection.substring(0,a)+(3===i?"":t)).split("::[").map((function(e){return"["===e[0]?e:"["+e}));3===i&&this.rowMeasurePos===r.length&&r.push(t);for(var n=-1,s=0;s<r.length;s++){n+=r[s].split("~~").length}return n},e.prototype.checkAttributeDrill=function(e,t){for(var i=!1,a=0;a<e.length&&!(i=this.isAttributeDrill(e[a].hierarchy,e,t));a++);return i},e.prototype.frameTupCollection=function(e,i,a,r,n,s,o){for(var l,d,h,p,u,c,g=0,m=0,f=[],v=[],S=[],y="",b="",C=!0,x=-1;g<e.length;){var w=e[g],T=Number(w.querySelector("LNum").textContent),M=w.querySelector("UName").textContent;Number(w.querySelector("MEMBER_TYPE").textContent)>3&&(w.querySelector("MEMBER_TYPE").textContent=0===M.indexOf("[Measures]")?"3":"1");var D=0===M.indexOf("[Measures]")?"3":Number(w.querySelector("MEMBER_TYPE").textContent)>3?"1":w.querySelector("MEMBER_TYPE").textContent,O=w.querySelector("Caption").textContent;this.fieldList[O]&&"CalculatedField"===this.fieldList[O].type&&(O=this.fieldList[O].caption,w.querySelector("Caption").textContent=O);var P=w.getAttribute("Hierarchy"),N=w.querySelector("PARENT_UNIQUE_NAME")?w.querySelector("PARENT_UNIQUE_NAME").textContent:"";if("2"===D?(this.isPaging||m++,h=(0,t.isNullOrUndefined)(h)?g:h):"3"===D?(p=w,u=M,c=g,"column"===o?(this.colMeasures[M]=w,this.colMeasurePos=g):this.rowMeasurePos=g):x=s[P],"2"!==D){if(this.headerGrouping[g]){if(T>this.lastLevel[g])this.lastLevel[g]=T;else if(T<this.lastLevel[g]){for(var E=this.lastLevel[g];E>=T;)delete this.headerGrouping[g].UName[E],delete this.headerGrouping[g].Caption[E],E--;this.lastLevel[g]=T}this.headerGrouping[g].UName[T]=M,this.headerGrouping[g].Caption[T]=O}else this.lastLevel[g]=T,this.headerGrouping[g]={UName:(l={},l[T]=M,l),Caption:(d={},d[T]=O,d)};if(this.isPaging)for(var I=N;this.drilledSets[I];){var F=this.drilledSets[I].querySelector("Caption").textContent,L=Number(this.drilledSets[I].querySelector("LNum").textContent);this.headerGrouping[g].UName[L]=I,this.headerGrouping[g].Caption[L]=F,I=null===this.drilledSets[I].querySelector("PARENT_UNIQUE_NAME")?"":this.drilledSets[I].querySelector("PARENT_UNIQUE_NAME").textContent}for(var A="",R=Object.keys(this.headerGrouping[g].UName),k=0;k<R.length;k++){var j=R[k];A=0===k?this.headerGrouping[g].UName[Number(j)]:A+"~~"+this.headerGrouping[g].UName[Number(j)]}y=""===y?A:y+"::"+A;var q="",V=Object.keys(this.headerGrouping[g].Caption);for(k=0;k<V.length;k++){j=V[k];q=0===k?this.headerGrouping[g].Caption[Number(j)]:q+"~~"+this.headerGrouping[g].Caption[Number(j)]}g!==c&&(b=""===b?q:b+"::"+q)}if(f.push(D),v.push(T),((0,t.isNullOrUndefined)(i[g])||i[g]<T)&&(i[g]=T),S.push({level:T,uName:M,hierarchy:P,isDrilled:!1}),r[a-1]&&"1"===r[a-1].typeCollection[g]&&S[g].level>r[a-1].drillInfo[g].level){var H=y.split(/~~|::\[/).map((function(e){return"["===e[0]?e:"["+e}));H.pop();var U=H.join("~~");this.setDrillInfo(N,U,g,a,r)}g++}return x>-1&&(C="2"!==f[x+1]),r[a]={allCount:m,allStartPos:h,measure:p,measureName:u,measurePosition:c,members:e,typeCollection:f,uNameCollection:y,captionCollection:b,levelCollection:v,drillInfo:S,drillStartPos:-1,drillEndPos:-1,showTotals:!(!n&&m>0&&h>(0===c?1:0))&&C},i},e.prototype.getCaptionCollectionWithMeasure=function(e,t,i){var a=e.captionCollection,r=!0;if(!i&&"3"!==e.typeCollection[t])for(var n=0;n<this.measurePosition;n++)if(e.drillInfo[t].hierarchy===this.dataSourceSettings.rows[n].name){r=!1;break}if(e.measure&&r){var s=this.getUniqueName(e.measure.querySelector("UName").textContent),o=this.dataFields[s]&&this.dataFields[s].caption?this.dataFields[s].caption:e.measure.querySelector("Caption").textContent,l=e.uNameCollection.split(/[~~::]+/g).indexOf(e.measureName);(d=e.captionCollection.split(/[~~::]+/g)).splice(l,0,o),a=d.join(this.valueSortSettings.headerDelimiter)}else{var d;a=(d=e.captionCollection.split(/[~~::]+/g)).join(this.valueSortSettings.headerDelimiter)}return a},e.prototype.setNamedSetsPosition=function(){this.namedSetsPosition={};var e=0;do{for(var t={},i=e?this.dataSourceSettings.rows:this.dataSourceSettings.columns,a=0;a<i.length;a++)i[a].isNamedSet&&(t[a]=i[a].name);this.namedSetsPosition[e?"row":"column"]=t,e++}while(e<2)},e.prototype.updateRowEngine=function(e,t,i){for(var a=this.pivotValues.length-1,r=Object.keys(e).length;a>this.customArgs.drillInfo.currentCell.rowIndex;)this.pivotValues[a+r]=this.pivotValues[a],this.pivotValues[a+r][0].ordinal+=i,this.pivotValues[a+r][0].rowIndex+=r,this.valueContent[a+r-this.rowStartPos]=this.valueContent[a-this.rowStartPos],a--;for(var n=0;n<e.length;n++)this.pivotValues[n]=e[n],this.valueContent[Number(n)-this.rowStartPos]=t[Number(n)-this.rowStartPos];this.pivotValues[this.customArgs.drillInfo.currentCell.rowIndex][0].isDrilled=!0},e.prototype.updateTupCollection=function(e){for(var t="row"===this.customArgs.drillInfo.axis?this.tupRowInfo:this.tupColumnInfo,i=t.length-1;i>this.customArgs.drillInfo.currentCell.ordinal;)t[i+e]=t[i],i--},e.prototype.frameGrandTotalValues=function(e,t,i,a){for(var r=0,n=!1;r<e.length&&!n;){var s=e["down"===this.customArgs.action?r-(this.customArgs.drillInfo.currentCell.ordinal+1):r].querySelectorAll("Member"),o=this.tupRowInfo[r].allCount,l=this.tupRowInfo[r].allStartPos,d=this.tupRowInfo[r].measure,h=this.tupRowInfo[r].typeCollection;this.tupRowInfo[r].drillStartPos,this.tupRowInfo[r].startDrillUniquename;if(0===r&&(s.length>o+(d?1:0)||1===s.length&&d)&&t.pop(),0!==r||!this.isPaging||0===t.length){this.checkAttributeDrill(this.tupRowInfo[r].drillInfo,"rows");if(s.length===o+(d?1:0)&&d){var p="Grand Total"+this.valueSortSettings.headerDelimiter+s[a].querySelector("Caption").textContent,u="3"===h[a]&&this.dataFields[this.getUniqueName(s[a].querySelector("UName").textContent)]&&this.dataFields[this.getUniqueName(s[a].querySelector("UName").textContent)].caption?this.dataFields[this.getUniqueName(s[a].querySelector("UName").textContent)].caption:s[a].querySelector("Caption").textContent;(t=this.frameGrandTotalAxisSet(t,this.getUniqueName(s[a].querySelector("UName").textContent),u,this.pivotValues.length,r,Number(h[a]),s[a].querySelector("PARENT_UNIQUE_NAME")?s[a].querySelector("PARENT_UNIQUE_NAME").textContent:void 0,s[a].querySelector("LName").textContent,s[a].getAttribute("Hierarchy"),{levelName:p,axis:s[a].getAttribute("Hierarchy")}))[t.length-1].valueSort["Grand Total"+this.valueSortSettings.headerDelimiter+s[a].querySelector("Caption").textContent]=1}0}n=this.dataSourceSettings.values.length+1===t.length,r++}return t},e.prototype.frameColumnHeader=function(e){var t=this;this.headerGrouping={},this.lastLevel=[];for(var i=0,a=[],r=[],n=[],s=-1,o=-1,l=this.customArgs.drillInfo&&"column"===this.customArgs.drillInfo.axis?this.customArgs.drillInfo.currentCell.ordinal+1:0;i<e.length;){var d=e[i].querySelectorAll("Member");a=this.frameTupCollection(d,a,i+l,this.tupColumnInfo,this.showColumnSubTotals,this.hideColumnTotalsObject,"column"),i++}if(this.olapVirtualization&&(a=a.slice(0,a.length-1).map((function(e){return 0===e?1:e})).concat(a.slice(a.length-1))),e.length>0){d=e[0].querySelectorAll("Member");for(var h=0;h<d.length;)n[h]="1"===d[h].querySelector("MEMBER_TYPE").textContent&&0===Number(d[h].querySelector("LNum").textContent)?0:Number(d[h].querySelector("LNum").textContent),"1"!==d[h].querySelector("MEMBER_TYPE").textContent||!this.isPaging&&0!==Number(d[h].querySelector("LNum").textContent)?r[h]=1:(r[h]=0,s=-1===s?h:s,o=h),h++}i=0;for(var p,u=1,c={},g=!0,m=!1,f=function(){var l=e[i].querySelectorAll("Member"),d=v.tupColumnInfo[i].allCount,h=v.tupColumnInfo[i].allStartPos,f=v.tupColumnInfo[i].measure,S=v.tupColumnInfo[i].typeCollection,y=v.tupColumnInfo[i].drillInfo,b=v.tupColumnInfo[i].drillStartPos,C=v.tupColumnInfo[i].startDrillUniquename,x=v.tupColumnInfo[i].endDrillUniquename,w=v.tupColumnInfo[i].drillEndPos,T=v.tupColumnInfo[i].levelCollection,M="2"!==S[0]&&("3"!==S[0]||"2"!==S[1]),D=0;a.map((function(e,i){D+=0===r[i]?e+(1-(n[i]>1?1:n[i])):0===e?t.isPaging&&"2"===S[i]?0:1:e})),v.colDepth=v.colDepth>D?v.colDepth:D,0===i&&l.length>d+(f?1:0)&&(m=!0,M=d>0&&M?h>s:M);var O=!1;if("Top"===v.dataSourceSettings.grandTotalsPosition&&v.dataSourceSettings.showGrandTotals&&v.dataSourceSettings.showColumnGrandTotals){for(var P=0,N=0;N<l.length;N++)0===l[N].querySelector("Caption").textContent.indexOf("All")&&P++;O=P===("column"===v.olapValueAxis?v.dataSourceSettings.columns.length-1:v.dataSourceSettings.columns.length)}if((M||O)&&(0===d||O)){var E=[-1,-1,-1];v.tupColumnInfo[i-1]&&0===v.tupColumnInfo[i-1].allCount?E=v.levelCompare(T,v.tupColumnInfo[i-1].levelCollection):m&&p&&(E=v.levelCompare(T,p.levelCollection)),v.tupColumnInfo[i].drillStartPos<0||v.showSubTotalsAtTop?(!g&&E[0]>-1&&E[2]>-1&&(u=v.mergeTotCollection(u,d,a,n,r,h,y,E)),v.setParentCollection(l),v.frameCommonColumnLoop(l,i,u,a,r,n),v.tupColumnInfo[i].showTotals||u--,!g&&E[0]>-1&&E[2]>-1&&(u=v.mergeTotCollection(u,d,a,n,r,h,y,E)),g=!1,v.isColDrill?v.isColDrill=!1:u++):c.drillStartPos===b&&c.startDrillUniquename===C&&c.allCount!==d||(!g&&E[0]>-1&&E[2]>-1&&(u=v.mergeTotCollection(u,d,a,n,r,h,y,E),g=!0),v.setParentCollection(l),(!m||o<=b)&&(O||(v.totalCollection[v.totalCollection.length]={allCount:d,ordinal:i,members:l,drillInfo:y}),c.allCount=d,c.allStartPos=h,c.drillStartPos=b,c.startDrillUniquename=C,c.endDrillUniquename=x)),p=v.tupColumnInfo[i]}var I=v.checkAttributeDrill(v.tupColumnInfo[i].drillInfo,"columns");if(d>0&&(!m||M&&(I||o<h))&&(d===c.allCount||h!==c.allStartPos)){var F=w===b||c.endDrillUniquename===x,L=h!==c.allStartPos?c.startDrillUniquename!==C:F;b>-1&&!L||(g||(u=v.mergeTotCollection(u,d,a,n,r,h,y),g=!0),v.setParentCollection(l),m&&b>-1&&!(o<=b)||(O||(v.totalCollection[v.totalCollection.length]={allCount:d,ordinal:i,members:l,allStartPos:h,drillInfo:y}),c.allCount=d,c.allStartPos=h,c.drillStartPos=b,c.startDrillUniquename=C,c.endDrillUniquename=x))}i++},v=this;i<e.length;)f();if(this.totalCollection.length>0)if(Object.keys(this.colMeasures).length>1)this.orderTotals(u,a,r,n);else{this.totalCollection=this.totalCollection.reverse();for(var S=0,y=this.totalCollection;S<y.length;S++){var b=y[S];if(!(0===this.tupColumnInfo[b.ordinal].measurePosition?1===this.tupColumnInfo[b.ordinal].allStartPos:0===this.tupColumnInfo[b.ordinal].allStartPos)||this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals){this.frameCommonColumnLoop(b.members,b.ordinal,u,a,n,r);var C=this.checkAttributeDrill(this.tupColumnInfo[b.ordinal].drillInfo,"columns");(this.tupColumnInfo[b.ordinal].showTotals||C)&&u++}}}},e.prototype.orderTotals=function(e,t,i,a){for(var r={},n=1,s=0,o=this.totalCollection;s<o.length;s++){var l=o[s];if(!(0===this.tupColumnInfo[l.ordinal].measurePosition?1===this.tupColumnInfo[l.ordinal].allStartPos:0===this.tupColumnInfo[l.ordinal].allStartPos)||this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals){var d=this.tupColumnInfo[l.ordinal].measure.querySelector("UName").textContent;r[d]?(r[d].coll.push(l),r[d].count++,n=n<r[d].count?r[d].count:n):r[d]={coll:[l],count:1}}}for(var h=Object.keys(r),p=n-1;p>-1;){for(var u=0,c=h;u<c.length;u++){(l=r[c[u]].coll[p])&&(this.frameCommonColumnLoop(l.members,l.ordinal,e,t,i,a),this.tupColumnInfo[l.ordinal].showTotals&&e++)}p--}},e.prototype.setParentCollection=function(e){for(var t=0;e.length>t;){var i=e[t],a=Number(i.querySelector("MEMBER_TYPE").textContent)>2?"3":i.querySelector("MEMBER_TYPE").textContent,r=Number(i.querySelector("LNum").textContent),n=i.querySelector("UName").textContent,s=i.querySelector("PARENT_UNIQUE_NAME")?i.querySelector("PARENT_UNIQUE_NAME").textContent:"",o=!0,l=!1;if(this.parentObjCollection[t]){var d=Object.keys(this.parentObjCollection[t]),h=this.parentObjCollection[t][r-1];o=h?s===h.querySelector("UName").textContent:0===d.length,l="1"===this.tupColumnInfo[0].typeCollection[t]}"2"===a?delete this.parentObjCollection[t]:(!this.isPaging&&!l||o||delete this.parentObjCollection[t],this.parentObjCollection[t]?this.parentObjCollection[t][r]&&this.parentObjCollection[t][r].querySelector("UName").textContent===n||(this.parentObjCollection[t][r]=i):(this.parentObjCollection[t]={},this.parentObjCollection[t][r]=i)),t++}},e.prototype.setDrillInfo=function(e,t,i,a,r){for(a--;r[a]&&r[a].drillInfo[i].uName===e;){if(r[a].uNameCollection.split(/~~|::\[/).map((function(e){return"["===e[0]?e:"["+e})).join("~~").indexOf(t)<0)break;r[a].drillInfo[i].isDrilled=!0,this.curDrillEndPos<=i&&(r[a].drillEndPos=this.curDrillEndPos=i,r[a].endDrillUniquename=e),(r[a].drillStartPos>i||-1===r[a].drillStartPos)&&(r[a].drillStartPos=i),r[a].startDrillUniquename=e,a--}},e.prototype.levelCompare=function(e,t){for(var i=[-1,0],a=0;a<t.length;a++)if(e[a]!==t[a]){i=[a,e[a],t[a]-e[a]];break}return i},e.prototype.mergeTotCollection=function(e,i,a,r,n,s,o,l){for(var d=(0,t.isNullOrUndefined)(s)?l[0]:s-(this.colMeasurePos===s-1?2:1),h=o[d]&&o[d].level,p=this.getLevelsAsString(d-1,o),u={},c=1,g=!1,m=0,f=this.totalCollection;m<f.length;m++){var v=f[m];if(g||v.allCount<=i&&(!(h>-1&&v.drillInfo[d])||v.drillInfo[d].level>=h&&this.getLevelsAsString(d-1,v.drillInfo)===p)){var S=this.tupColumnInfo[v.ordinal].measure?this.tupColumnInfo[v.ordinal].measure.querySelector("UName").textContent:"measure";u[S]?(u[S].coll.push(v),u[S].count++,c=c<u[S].count?u[S].count:c):u[S]={coll:[v],count:1},g=!1}}for(var y=Object.keys(u),b=c-1;b>-1;){for(var C=0,x=y;C<x.length;C++){var w=u[x[C]].coll[b];if(w)(!(0===this.tupColumnInfo[w.ordinal].measurePosition?1===this.tupColumnInfo[w.ordinal].allStartPos:0===this.tupColumnInfo[w.ordinal].allStartPos)||this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals)&&(this.frameCommonColumnLoop(w.members,w.ordinal,e,a,n,r),this.tupColumnInfo[w.ordinal].showTotals&&e++),this.totalCollection.pop()}b--}return e},e.prototype.getLevelsAsString=function(e,t){for(var i=[],a=0;a<e;a++)i[a]=t[a].level;return i.length>0?i.toString():""},e.prototype.frameCommonColumnLoop=function(e,t,i,a,r,n){var s,o=-1;if(this.tupColumnInfo[t].showTotals)for(var l=0,d=0;l<e.length;)d+=n[l]>0&&this.getMeasurePosition(this.tupColumnInfo[t].uNameCollection,this.tupColumnInfo[t].measurePosition)!==l?a[l]:a[l]+(1-r[l]),this.tupColumnInfo[t].drillInfo[l].isDrilled&&this.tupColumnInfo[t].showTotals&&(this.tupColumnInfo[t].showTotals=!!this.showColumnSubTotals&&void 0===this.hideColumnTotalsObject[this.tupColumnInfo[t].drillInfo[l].hierarchy],d-=a[l]-this.tupColumnInfo[t].levelCollection[l],o=this.tupColumnInfo[t].showTotals?-1:d-1),l++;var h=this.checkAttributeDrill(this.tupColumnInfo[t].drillInfo,"columns");if(this.tupColumnInfo[t].showTotals||h)for(var p=0,u=0,c={},g="0"===e[0].querySelector("LNum").textContent;p<e.length;){for(var m=e[p],f=Number(m.querySelector("MEMBER_TYPE").textContent)>2?"3":m.querySelector("MEMBER_TYPE").textContent,v=0,S=m.querySelector("LNum").textContent,y="2"!==f?n[p]?1:r[p]:1;y<=("3"===f?1:a[p]);y++){var b=!1;this.pivotValues[u]||(this.pivotValues[u]=[]),Number(e[p].querySelector("LNum").textContent)>y&&"2"!==f?(this.parentObjCollection[p][y]||this.getDrilledParent(e[p],y,this.parentObjCollection[p]),this.parentObjCollection[p][y]&&(m=this.parentObjCollection[p][y]),b=!0):(m=e[p],v++);var C=this.getUniqueName(m.querySelector("UName").textContent);"2"!==f?c[C]="3"===f&&this.dataFields[C]&&this.dataFields[C].caption?this.dataFields[C].caption:m.querySelector("Caption").textContent:"2"===f&&"0"===S&&g&&(c[C]="Grand Total",g=!1);for(var x=Object.keys(c),w=p>=this.measurePosition&&0===Number(m.getElementsByTagName("LNum")[0].textContent)&&1===x.length?"Grand Total"+this.valueSortSettings.headerDelimiter:"",T=0;T<x.length;T++){var M=x[T];0===T?w+=c[M]:w=w+this.valueSortSettings.headerDelimiter+c[M]}var D=!!this.namedSetsPosition.column[p],O=this.getDepth(this.tupColumnInfo[t],C,Number(f));if(this.isPaging&&this.pivotValues[u-1]&&this.pivotValues[u-1][i]&&this.fieldList[this.pivotValues[u-1][i].hierarchy]&&this.fieldList[this.pivotValues[u-1][i].hierarchy].isHierarchy&&this.pivotValues[u-1][i].hasChild&&!this.pivotValues[u-1][i].isDrilled&&!this.columns[p].isNamedSet&&this.fieldList[m.getAttribute("Hierarchy")]&&(this.fieldList[m.getAttribute("Hierarchy")].isHierarchy||this.fieldList[m.getAttribute("Hierarchy")].hasAllMember)&&this.pivotValues[u-1][i].depth<O){this.isColDrill=!0;break}this.pivotValues[u][i]={axis:"column",actualText:C,colIndex:i,formattedText:"3"===f&&this.dataFields[C]&&this.dataFields[C].caption?this.dataFields[C].caption:m.querySelector("Caption").textContent,hasChild:!!(this.fieldList[m.getAttribute("Hierarchy")]&&this.fieldList[m.getAttribute("Hierarchy")].isHierarchy&&p<this.columns.length-1&&!this.columns[p+1].isNamedSet&&this.columns[p+1].name.indexOf("[Measures]")<0&&this.fieldList[this.columns[p+1].name]&&this.fieldList[this.columns[p+1].name].hasAllMember)||Number(m.querySelector("CHILDREN_CARDINALITY").textContent)>0,level:v>1?-1:Number(m.querySelector("LNum").textContent)-(n[p]&&"3"!==f?1:0),rowIndex:u,ordinal:t,memberType:Number(f),depth:O,isDrilled:!(!this.fieldList[m.getAttribute("Hierarchy")]||!this.fieldList[m.getAttribute("Hierarchy")].isHierarchy||this.isAttributeDrill(m.getAttribute("Hierarchy"),this.tupColumnInfo[t].drillInfo,"columns"))||(b||this.tupColumnInfo[t].drillInfo[p].isDrilled),parentUniqueName:m.querySelector("PARENT_UNIQUE_NAME")?m.querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:m.querySelector("LName").textContent,hierarchy:m.getAttribute("Hierarchy"),isNamedSet:D,valueSort:(s={levelName:w},s[w]=1,s.axis=m.getAttribute("Hierarchy"),s)},this.headerContent[u]||(this.headerContent[u]={}),this.headerContent[u][i]=this.pivotValues[u][i],u++}p++}else if(o>-1)this.pivotValues[o][i-1].ordinal=t;else if(this.tupColumnInfo[t].allCount>0){for(l=0,d=0;l<this.tupColumnInfo[t].allStartPos;)d+=n[l]>0&&this.getMeasurePosition(this.tupColumnInfo[t].uNameCollection,this.tupColumnInfo[t].measurePosition)!==l?a[l]:a[l]+(1-r[l]),l++;this.tupColumnInfo[t].allStartPos===this.tupColumnInfo[t].measurePosition+1?d-=a[this.tupColumnInfo[t].allStartPos-2]-this.tupColumnInfo[t].levelCollection[this.tupColumnInfo[t].allStartPos-2]+1:d-=a[this.tupColumnInfo[t].allStartPos-1]-this.tupColumnInfo[t].levelCollection[this.tupColumnInfo[t].allStartPos-1],this.pivotValues[d-1]&&(this.pivotValues[d-1][i-1].ordinal=t)}},e.prototype.isAttributeDrill=function(e,t,i){var a=!1;if(!this.isAdjacentToMeasure(e,i))for(var r=0;r<this.drilledMembers.length;r++)if(this.drilledMembers[r].name===e)for(var n=0;n<this.drilledMembers[r].items.length;n++){for(var s=this.drilledMembers[r].delimiter,o=this.drilledMembers[r].items[n].split(s),l="",d=0;d<o.length;d++)t[d]&&t[d].uName&&(l=l+(""===l?"":this.drilledMembers[r].delimiter)+t[d].uName);if(l===this.drilledMembers[r].items[n]){a=!0;break}}return a},e.prototype.isAdjacentToMeasure=function(e,t){for(var i=!1,a="rows"===t?this.rows:this.columns,r=0;r<a.length;r++)if(a[r].name===e&&a[r+1]&&("[Measures]"===a[r+1].name||a[r+1].isNamedSet||this.fieldList[a[r+1].name]&&!this.fieldList[a[r+1].name].hasAllMember)){i=!0;break}return i},e.prototype.getDrilledParent=function(e,t,i){for(var a=Number(e.querySelector("LNum").textContent),r=e,n=a-1;n>=t;n--){var s=this.drilledSets[r.querySelector("PARENT_UNIQUE_NAME").textContent];if(!s)break;i[n]=s,r=s}},e.prototype.performRowSorting=function(e,t){var i;if((this.enableSort||this.enableValueSorting)&&this.tupRowInfo.length>0){for(var a=this.pivotValues.length,r={},n={},s=[],o=!1,l=this.tupRowInfo[0].typeCollection.lastIndexOf("1"),d=void 0,h=this.colDepth;h<a;h++){var p=this.pivotValues[h][0];if(!this.showSubTotalsAtBottom||!p.isSum||3===p.memberType){var u=this.tupRowInfo[p.ordinal],c=u?0===u.measurePosition&&3===p.memberType?u.measureName:u.uNameCollection:"";if(""!==c){l>-1&&(c=this.frameUniqueName(c,p,u));var g=c.split(/~~|::\[/).length;if(3===p.memberType&&this.tupRowInfo[0].measurePosition>0)n[U=this.getParentUname(c,p,!0,!0)]?n[U].push(p):n[U]=[p];else r[g]?r[g][c]=[p]:r[g]=((i={})[c]=[p],i)}o&&s.push(p),"grand sum"===p.type&&(o=!0)}}for(var m=Object.keys(n).length>0&&this.tupRowInfo[0].measurePosition>0,f=Object.keys(r).map((function(e){return Number(e)})).sort((function(e,t){return e>t?1:t>e?-1:0})),v={},S=f.length-1;S>=0;S--){for(var y={},b=r[f[S]],C=Object.keys(b),x=0;x<C.length;x++){y[U=0===S?"parent":this.getParentUname(C[x],b[C[x]][0],m,!1)]?y[U].push(b[C[x]][0]):y[U]=b[C[x]]}for(var w=Object.keys(y),T=0;T<w.length;T++)y[w[T]]=this.sortRowHeaders(y[w[T]],e,t);if(v[f[S+1]])for(T=0;T<w.length;T++){for(var M=[],D=y[w[T]],O=0;O<D.length;O++){var P=this.tupRowInfo[D[O].ordinal],N=0===P.measurePosition&&3===D[O].memberType?P.measureName:P.uNameCollection;M.push(D[O]),l>-1&&(N=this.frameUniqueName(N,D[O],P));var E=!1;if(m)if(n[U=this.getParentUname(N,D[O],m,!0)]){n[U]=this.sortRowHeaders(n[U],e,t);var I=N.lastIndexOf("::[")===N.indexOf("::[Measures]"),F=N.split("::[").length-1===P.measurePosition,L=!P.drillInfo[P.measurePosition-1].isDrilled,A=P.members.length>P.measurePosition+1;if(I&&F&&L&&A){E=!0;for(var R=0;R<n[U].length;R++){M.push(n[U][R]);var k=N.substring(0,N.indexOf("::[Measures]"))+"::"+n[U][R].actualText;v[f[S+1]][k]&&(M=M.concat(v[f[S+1]][k]))}}else d=this.showSubTotalsAtBottom&&M[M.length-1].isDrilled,M=M.concat(n[U])}if(!E&&v[f[S+1]][N])if(this.showSubTotalsAtBottom&&3===M[M.length-1].memberType&&M[M.length-1].level>-1&&d){for(var j=[],q=0,V=M.length-1;V>=0;V--){if(3!==M[V].memberType){j=j.reverse(),q=V+1;break}j[j.length]=M[V]}M=M.slice(0,q).concat(v[f[S+1]][N]).concat(j)}else{p=M[M.length-1];var H=void 0;this.showSubTotalsAtBottom&&p.isDrilled&&((H=Di.frameHeaderWithKeys(p)).hasChild=!1,H.isDrilled=!1,H.isSum=!0,H.formattedText=H.formattedText+" Total"),M=M.concat(v[f[S+1]][N]),H&&(M[M.length]=H)}}y[w[T]]=M}else if(m)for(T=0;T<w.length;T++){for(D=y[w[T]],M=[],O=0;O<D.length;O++){M.push(D[O]);var U;N=this.tupRowInfo[D[O].ordinal].uNameCollection;l>-1&&(N=this.frameUniqueName(N,D[O],this.tupRowInfo[D[O].ordinal])),n[U=this.getParentUname(N,D[O],!0,!0)]&&(n[U]=this.sortRowHeaders(n[U],e,t),M=M.concat(n[U]))}y[w[T]]=M}v[f[S]]=y}var _=0,B=0,G=0;o=!1,s=this.sortRowHeaders(s,e,t);for(h=this.colDepth;h<a;h++){"Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals&&("column"===this.olapValueAxis&&this.colDepth+1===h||"row"===this.olapValueAxis&&this.colDepth+this.dataSourceSettings.values.length+1===h)&&(_=0,o=!1);var z=o?s:v[f[0]].parent,W="Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals&&this.colDepth===h?z.length:o?_-B:_;z[W]&&(this.pivotValues[h]=[z[W]],this.pivotValues[h][0].rowIndex=h,this.valueContent[G][0]=this.pivotValues[h][0]),_++,G++,"grand sum"===this.pivotValues[h][0].type&&(o=!0,B=_)}}},e.prototype.performColumnSorting=function(e,i){if(this.enableSort||this.enableValueSorting)for(var a=0;a<this.dataSourceSettings.columns.length;a++){for(var r=[],n=0,s=[],o=0;o<this.pivotValues.length;o++){var l=this.pivotValues[o],d=void 0,h={},p=[],u=1;s[n]=[],r[n]=[];for(var c=1,g=l[c].hierarchy,m=l[c].levelUniqueName;c<l.length;c++)if(!l[c].isNamedSet){if(2!==l[c].memberType&&"[Measures]"!==l[c].hierarchy&&-1!==l[c].level){if((0,t.isNullOrUndefined)(h[l[c].formattedText])||(0,t.isNullOrUndefined)(this.pivotValues[o-1]))h[l[c].formattedText]||(h[l[c].formattedText]=[]),l[c+1]&&l[c].formattedText===l[c+1].formattedText||(p[p.length]=l[c]),h[l[c].formattedText][l[c].colIndex]=l[c];else if(h[l[c].formattedText]&&this.pivotValues[o-1]){var f=this.pivotValues[o-1][l[c].colIndex],v=Number(Object.keys(h[l[c].formattedText])[0]),S=h[l[c].formattedText][v].colIndex,y=this.pivotValues[o-1][S];if(f.formattedText!==y.formattedText){d=this.sortColumnHeaders(h,p,this.sortObject[l[c-1].levelUniqueName]||this.sortObject[l[c].hierarchy],e,i,g,m),r[n]=(0,t.isNullOrUndefined)(r[n])?[]:r[n];for(var b=0;b<d.length;b++)for(var C=Object.keys(h[d[b]]).length,x=0;x<C;x++)u=0===r[n].length?1:0,r[n][r[n].length+u]=h[d[b]][Number(Object.keys(h[d[b]])[x])];p=[],(h={})[l[c].formattedText]=[],p[p.length]=l[c],h[l[c].formattedText][l[c].colIndex]=l[c]}else h[l[c].formattedText][l[c].colIndex]=l[c]}}else if(Object.keys(h).length>0){s[n][s[n].length+u]=l[c],d=this.sortColumnHeaders(h,p,this.sortObject[l[c-1].levelUniqueName]||this.sortObject[l[c].hierarchy],e,i,g,m),r[n]=(0,t.isNullOrUndefined)(r[n])?[]:r[n];for(var w=0;w<d.length;w++)for(var T=Object.keys(h[d[w]]).length,M=0;M<T;M++)u=0===r[n].length?1:0,r[n][r[n].length+u]=h[d[w]][Number(Object.keys(h[d[w]])[M])]}else(-1===l[c].level||0===l[c].level)&&Object.keys(h).length>=0&&"[Measures]"!==l[c].hierarchy&&(s[n][s[n].length+u]=l[c]);if(-1!==l[c].level&&1===Object.keys(h).length&&"[Measures]"!==l[c].hierarchy&&!(0,t.isNullOrUndefined)(l[c+1])&&-1===l[c+1].level){var D=Object.keys(h[l[c].formattedText]).length,O=Object.keys(h[l[c].formattedText]);if(D>1)for(var P=0;P<D;P++)u=0===s[n].length?1:0,s[n][s[n].length+u]=h[l[c].formattedText][Number(O[P])];else s[n][s[n].length+u]=l[c]}if(Object.keys(s[n]).length>0){u=0===r[n].length?1:0;var N=s[n].length;if(N>2)for(var E=1;E<N;E++)u=0===r[n].length?1:0,r[n][r[n].length+u]=s[n][E];else r[n][r[n].length+u]=s[n][1]||s[n][0];h={},p=[],s[n]=[]}}if(Object.keys(h).length>0){s[n][s[n].length+u]=l[c];var I=this.sortObject[l[c-1].levelUniqueName]||this.sortObject[l[c-1].hierarchy];d=this.sortColumnHeaders(h,p,I,e,i,g,m),r[n]=(0,t.isNullOrUndefined)(r[n])?[]:r[n];for(var F=0;F<d.length;F++){var L=Object.keys(h[d[F]]).length;for(M=0;M<L;M++)u=0===r[n].length?1:0,r[n][r[n].length+u]=h[d[F]][Number(Object.keys(h[d[F]])[M])]}}for(var A=1;A<r[n].length;A++)this.pivotValues[n][A]=r[n][A];for(var R=o;R<this.pivotValues.length;R++){var k=(0,t.extend)({},this.pivotValues[R+1],null,!0),j=(0,t.extend)({},this.pivotValues[R],null,!0);if(Object.keys(k).length===Object.keys(j).length&&Object.keys(k).length>2){for(var q=1;q<this.pivotValues[o].length;q++)Object.keys(k).length>0&&j[q].colIndex!==k[q].colIndex&&(this.pivotValues[R+1][q]=k[j[q].colIndex]);break}}n++,h={}}for(var V=0;V<this.pivotValues.length;V++)for(l=this.pivotValues[V],o=1;o<l.length;o++)l[o].colIndex=o}},e.prototype.frameUniqueName=function(e,t,i){var a=e.indexOf(t.actualText.toString()+"::[Measures]")>-1,r=(e=e.substring(0,e.indexOf(t.actualText.toString()))+t.actualText.toString()).split("::[").length<=this.getMeasurePosition(e,i.measurePosition);return e+=a||r?"::"+i.measureName:""},e.prototype.getMeasurePosition=function(e,t){for(var i=t,a=e.split("::["),r=0;r<a.length;r++)if(a[r]&&a[r].indexOf("Measures")>-1){i=r;break}return i},e.prototype.sortRowHeaders=function(e,i,a){if(this.enableValueSorting&&"column"===this.olapValueAxis&&a.isValueSorting&&!(0,t.isNullOrUndefined)(this.valueSortSettings)){for(var r=[],n=0;n<e.length;n++){var s=e[n],o=i[s.ordinal*a.columnLength+a.memberIndex],l=o?o.getElementsByTagName("Value"):void 0,d=o&&l.length>0?Number(l[0].textContent):0;r.push({header:s,value:d})}e=Di.getSortedValue(r,this.valueSortSettings.sortOrder)}else if(this.enableSort&&e.length>0&&3!==e[0].memberType&&!e[0].isNamedSet){var h=[];for(n=0;n<e.length;n++)h[n]=e[n].actualText;var p=!1,u="Grand Total"!==e[0].actualText?e[0].hierarchy:e[1].hierarchy,c=this.fieldList[u]&&this.fieldList[u].membersOrder?this.fieldList[u].membersOrder.slice():[],g={fieldName:u,levelName:e[0].levelUniqueName,sortOrder:this.sortObject[e[0].hierarchy]||this.sortObject[e[0].levelUniqueName],members:c&&c.length>0?c:h,IsOrderChanged:!1};if(c&&c.length>0?Di.applyCustomSort(g,e,"string",!1,!0):("Ascending"===g.sortOrder||void 0===g.sortOrder?e.sort((function(e,t){return e.formattedText>t.formattedText?1:t.formattedText>e.formattedText?-1:0})):"Descending"===g.sortOrder&&e.sort((function(e,t){return e.formattedText<t.formattedText?1:t.formattedText<e.formattedText?-1:0})),p=!0),p&&this.getHeaderSortInfo){for(var m=[],f=0,v=0;f<e.length;f++)"Grand Total"!==e[f].actualText&&(m[v++]=e[f].formattedText);g.members=m}this.getHeaderSortInfo&&this.getHeaderSortInfo(g),g.IsOrderChanged&&Di.applyCustomSort(g,e,"string",!0,!0)}return e},e.prototype.sortColumnHeaders=function(e,i,a,r,n,s,o){var l=Object.keys(e);if(this.enableValueSorting&&"row"===this.olapValueAxis&&n.isValueSorting&&!(0,t.isNullOrUndefined)(this.valueSortSettings)){for(var d=[],h=0;h<l.length;h++){var p=e[l[h]],u=this.showSubTotalsAtTop?p[0]:p[p.length-1],c=r[n.memberIndex*n.columnLength+u.ordinal],g=c?c.getElementsByTagName("Value"):void 0,m=c&&g.length>0?Number(g[0].textContent):0;d.push({header:u,value:m})}l=Di.getSortedValue(d,this.valueSortSettings.sortOrder).map((function(e){return e.formattedText}))}else if(this.enableSort){var f=!1,v=this.fieldList[s]&&this.fieldList[s].membersOrder?this.fieldList[s].membersOrder.slice():[],S={fieldName:s,levelName:o,sortOrder:a,members:v&&v.length>0?v:l,IsOrderChanged:!1};if(v&&v.length>0?this.applyCustomSort(l,S):("Ascending"===S.sortOrder||void 0===S.sortOrder?l.sort((function(e,t){return e>t?1:t>e?-1:0})):"Descending"===S.sortOrder&&l.sort((function(e,t){return e<t?1:t<e?-1:0})),f=!0),f&&this.getHeaderSortInfo){for(var y=[],b=0,C=0;b<l.length;b++)"Grand Total"!==l[b]&&(y[C++]=l[b]);S.members=y}this.getHeaderSortInfo&&this.getHeaderSortInfo(S),S.IsOrderChanged&&this.applyCustomSort(l,S,!0)}return l},e.prototype.applyCustomSort=function(e,t,i){var a,r=[],n=[];r=t.IsOrderChanged?t.members:"Ascending"===t.sortOrder||"None"===t.sortOrder||void 0===t.sortOrder?[].concat(t.members):[].concat(t.members).reverse(),"Grand Total"===e[0]&&(a=e[0],e.shift());for(var s=0,o=0;s<e.length;s++){var l=e[s];if(r[o]===l){if(e.splice(o++,0,l),e.splice(++s,1),!(o<r.length)){i||n.splice(--o,0,l);break}s=-1}s>=0&&!i&&(n[s]=e[s])}if(!i){for(s=n.length;s<e.length;s++)n[s]=e[s];"Grand Total"===n[n.length-1]&&n.pop(),t.members=n}return a&&e.splice(0,0,a),e},e.prototype.frameSortObject=function(){if(this.enableSort)for(var e=0;e<this.sortSettings.length;e++)this.sortObject[this.sortSettings[e].name]=this.sortSettings[e].order},e.prototype.getParentUname=function(e,t,i,a){var r="";if(i&&!a){for(var n=this.tupRowInfo[t.ordinal],s=[],o={},l=0;l<e.length;l++)"~"!==e[l]&&":"!==e[l]||(s.push(l),o[l]=e[l]+e[l],l++);if(this.getMeasurePosition(e,n.measurePosition)>=e.split("::[").length-1)r=s[s.length-2]>-1?e.substring(0,s[s.length-2])+o[s[s.length-1]]+n.measureName:"parent";else r=(d=e.lastIndexOf("~~")>e.lastIndexOf("::[")?e.lastIndexOf("~~"):e.lastIndexOf("::["))>-1?e.substring(0,d):"parent"}else{var d;r=(d=e.lastIndexOf("~~")>e.lastIndexOf("::[")?e.lastIndexOf("~~"):e.lastIndexOf("::["))>-1?e.substring(0,d):"parent"}return r},e.prototype.performColumnSpanning=function(){for(var e={},t=this.rowStartPos-1,i=Object.keys(this.colMeasures).length,a=this.tupColumnInfo[0]?this.tupColumnInfo[0].measurePosition:this.measureIndex,r=t;r>-1;r--)if(3===this.pivotValues[r][1].memberType){a=r;break}for(;t>-1;){e[t]={};for(var n=this.pivotValues[t].length-1;n>0;){e[t][n]=1;var s=this.pivotValues[t][n+1],o=this.pivotValues[t+1]&&this.rowStartPos-t>1?this.pivotValues[t+1][n]:void 0,l=this.pivotValues[t][n],d=!1,h=!1,p=this.tupColumnInfo[l.ordinal],u=p.allStartPos>("3"===p.typeCollection[0]?1:0),c=this.checkAttributeDrill(p.drillInfo,"columns");if(this.showSubTotalsAtTop&&l.isDrilled&&s&&s.actualText!==l.actualText&&l.level>-1&&(l.ordinal=this.getOrdinal(l,this.pivotValues[t+1])),o&&s&&(2===l.memberType||-1===l.level?s.actualText===l.actualText:3===l.memberType&&l.actualText===s.actualText||s.valueSort.levelName===l.valueSort.levelName)&&(2===l.memberType?u&&"sum"!==s.type?l.colSpan=1:l.colSpan=s.colSpan+1>(a>t?i:0)?1:s.colSpan+1:(l.colSpan=s.colSpan+1,l.ordinal=s.ordinal),d=!0),2===l.memberType){if(u)c||(l.type="sum"),l.formattedText="Total",l.valueSort[l.valueSort.levelName.toString()]=1;else if(l.type="grand sum",l.formattedText="Grand Total",t<this.measureIndex){var g="Grand Total";l.valueSort.levelName=g,l.valueSort[g.toString()]=1}l.hasChild=!1}else-1===l.level&&(l.type="sum",l.formattedText="Total",l.hasChild=!1,l.valueSort[l.valueSort.levelName.toString()]=1);o?2===l.memberType&&2===o.memberType||o.actualText===l.actualText?(e[t][n]=e[t+1]?e[t+1][n]+1:1,0===t||1===l.memberType&&l.level>-1&&1===o.memberType&&-1===o.level?(l.rowSpan=!l.isDrilled||this.fieldList[l.hierarchy]&&this.fieldList[l.hierarchy].isHierarchy&&!l.hasChild?e[t+1][n]+1:1,o.rowSpan=!o.isDrilled||this.fieldList[o.hierarchy]&&this.fieldList[o.hierarchy].isHierarchy&&!o.hasChild||-1!==o.level?o.rowSpan:e[t+1][n]):3===l.memberType?l.rowSpan=1:l.rowSpan=-1,h=!0):!l.isDrilled||this.fieldList[l.hierarchy]&&this.fieldList[l.hierarchy].isHierarchy&&!l.hasChild||-1!==l.level||2!==o.memberType?(l.rowSpan=0===t?e[t][n]:-1,o.rowSpan=o.level>-1&&(!o.isDrilled||this.fieldList[o.hierarchy]&&this.fieldList[o.hierarchy].isHierarchy&&!o.hasChild)||2!==l.memberType&&2===o.memberType?e[t+1][n]:1):(e[t][n]=e[t+1]?e[t+1][n]+1:1,l.rowSpan=-1,h=!0):l.rowSpan=l.level>-1||1===this.rowStartPos?e[t][n]:-1,d||(l.colSpan=1),h||(e[t][n]=1),n--}t--}},e.prototype.getOrdinal=function(e,t){for(var i=0,a=e.colIndex;a>0;a--)if(-1===t[a].level){i=t[a].ordinal;break}return i},e.prototype.frameValues=function(e,i){var a=this.colDepth,r=this.pivotValues.length,n=0;if("down"===this.customArgs.action){var s=Object.keys(this.onDemandDrillEngine);a=Number(s[0]),r=Number(s[s.length-1])+1,n=this.onDemandDrillEngine[a][0].ordinal}for(var o=a;o<r;o++)for(var l=this.pivotValues[o],d=l[0].ordinal,h=1;h<this.pivotValues[0].length;h++)if(this.pivotValues[this.colDepth-1][h]){var p=this.pivotValues[this.colDepth-1][h].ordinal,u=this.pivotValues[this.colDepth-1][h],c=3===l[0].memberType?l[0].actualText.toString():this.tupColumnInfo[u.ordinal]&&this.tupColumnInfo[u.ordinal].measure?this.tupColumnInfo[u.ordinal].measure.querySelector("UName").textContent:l[0].actualText;if("header"===l[0].type)l[h]={axis:"value",actualText:this.getUniqueName(c),formattedText:"",value:0,colIndex:h,rowIndex:o};else{var g,m=void 0,f=this.getUniqueName(c),v=!0,S=!this.fieldList[l[0].hierarchy]||!this.fieldList[l[0].hierarchy].isHierarchy||l[0].isDrilled;if(this.tupRowInfo[d])v=this.tupRowInfo[d].showTotals;else{var y=0===this.dataSourceSettings.rows.length||1===this.dataSourceSettings.rows.length&&"[Measures]"===this.dataSourceSettings.rows[0].name;v=this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals||y}var b=e[(d-n)*i+p];m=this.showSubTotalsAtBottom&&l[0].isDrilled||!v&&S?"":(0,t.isNullOrUndefined)(b)||(0,t.isNullOrUndefined)(b.querySelector("FmtValue"))?this.emptyCellTextContent:b.querySelector("FmtValue").textContent,g=!v&&S?"0":(0,t.isNullOrUndefined)(b)||(0,t.isNullOrUndefined)(b.querySelector("Value"))?null:b.querySelector("Value").textContent,m=this.showSubTotalsAtBottom&&l[0].isDrilled?"":v&&!(0,t.isNullOrUndefined)(g)?this.getFormattedValue(Number(g),f,""!==m?m:g):m;var C=!this.tupColumnInfo[p]||(this.tupColumnInfo[p].allCount>0||this.tupColumnInfo[p].drillStartPos>-1)||!this.tupRowInfo[d]||this.tupRowInfo[d].allCount>0||this.tupRowInfo[d].drillStartPos>-1,x=!!this.tupRowInfo[d]&&(0===this.tupRowInfo[d].measurePosition?1===this.tupRowInfo[d].allStartPos:0===this.tupRowInfo[d].allStartPos)||!!this.tupColumnInfo[p]&&(0===this.tupColumnInfo[p].measurePosition?1===this.tupColumnInfo[p].allStartPos:0===this.tupColumnInfo[p].allStartPos);l[h]={axis:"value",actualText:f,formattedText:m,colOrdinal:p,rowOrdinal:d,columnHeaders:this.tupColumnInfo[p]?this.tupColumnInfo[p].captionCollection:"",rowHeaders:this.tupRowInfo[d]?this.tupRowInfo[d].captionCollection:"",value:(0,t.isNullOrUndefined)(g)?null:Number(g),colIndex:h,rowIndex:o,isSum:C,isGrandSum:x}}this.valueContent[o-this.rowStartPos][h]=l[h]}},e.prototype.getFormattedValue=function(e,i,a){var r=a;if(this.formatFields[i]&&!(0,t.isNullOrUndefined)(e)){var n=this.formatFields[i].properties?this.formatFields[i].properties:this.formatFields[i],s=(0,t.extend)({},n,null,!0);delete s.name,!s.minimumSignificantDigits&&s.minimumSignificantDigits<1&&delete s.minimumSignificantDigits,!s.maximumSignificantDigits&&s.maximumSignificantDigits<1&&delete s.maximumSignificantDigits,s.type?r=this.globalize.formatDate(new Date(e.toString()),s):(delete s.type,r=this.globalize.formatNumber(e,s))}return r},e.prototype.getMeasureInfo=function(){this.olapValueAxis=void 0,this.olapRowValueIndex=void 0;for(var e,t="column",i=[],a=0,r=this.values;a<r.length;a++){var n=r[a];i[i.length]=n.isCalculatedField?this.fieldList[n.name].tag:n.name}if(i.length>0){if(this.isMeasureAvail){for(var s=!1,o=0,l=0,d=this.rows.length;l<d;l++)if("[measures]"===this.rows[l].name.toLowerCase()){t="row",e=l,s=!0,o=this.dataSourceSettings.rows.length,this.olapRowValueIndex=e;break}if(!s)for(l=0,d=this.columns.length;l<d;l++)if("[measures]"===this.columns[l].name.toLowerCase()){t="column",e=l,s=!0,o=this.dataSourceSettings.columns.length;break}this.olapValueAxis=t,this.measurePosition=e,this.measureIndex=e===o-1?-1:e}else e="row"===(t=this.valueAxis)?this.rows.length-1:this.columns.length-1;return{measureAxis:t,measureIndex:e,valueInfo:i}}return{measureAxis:t,measureIndex:-1,valueInfo:[]}},e.prototype.frameMeasureOrder=function(e,i,a,r,n,s){var o=[],l=[],d=[],h={},p=[],u=e.measureAxis,c=e.measureIndex,g=e.valueInfo;if(u===i&&g.length>0){for(var m={},f=[],v=0,S=a.length;v<S;v++){for(var y=a[v],b=[].slice.call(y.querySelectorAll("Member")),C="",x="",w=0;w<b.length;)C=C+(""!==C?"~~":"")+b[w].querySelector("UName").textContent,(w===c&&0===c||w===c-1)&&(x=C),w++;m[x]?m[x][m[x].length]=C:(m[x]=[C],f[f.length]=x),h[C]={index:v,node:y},p[p.length]=C}if(p.length>0&&f.length>0)if(0===c)for(var T=0,M=g;T<M.length;T++)for(var D=M[T],O=0,P=f;O<P.length;O++){if((L=P[O])===D)for(var N=0,E=m[L];N<E.length;N++){C=E[N];d[d.length]=h[C].index,o[o.length]=h[C].node}}else for(var I=0,F=f;I<F.length;I++)for(var L=F[I],A=0,R=g;A<R.length;A++)for(var k=R[A],j=0,q=m[L];j<q.length;j++){(C=q[j]).split("~~")[c]===k&&(d[d.length]=h[C].index,o[o.length]=h[C].node)}var V=[];if(r.length>0){for(var H=[],U=[],_=0,B=0,G=0,z=(v=0,s);v<z;v++){B>n-1?(B=0,H[++G]||(H[G]=[]),H[G][B]=v,B++):(H[G]||(H[G]=[]),H[G][B]=v,B++);var W=void 0;r[_]?W=this.olapVirtualization?v:Number(r[_].getAttribute("CellOrdinal")):_++,W===v&&(U[v]=W,V[W]=r[_],_++)}if(r=V,"column"===u){if(H.length>0&&H[0].length===d.length)for(w=0,z=d.length;w<z;w++)for(v=0;v<H.length;){var Q=v*n+w;if(!(0,t.isNullOrUndefined)(H[v])&&!(0,t.isNullOrUndefined)(d[w])){var Y=U[Q]?U[Q].toString():Q.toString();(K=r[Number(H[v][d[w]])])&&(K.setAttribute("CellOrdinal",Y.toString()),l[Q]=K)}v++}}else if(H.length===d.length)for(w=0,z=d.length;w<z;w++)for(v=0;v<H[d[w]].length;){var K;Y=U[Q=w*n+v]?U[Q].toString():Q.toString();(K=r[Number(H[d[w]][v])])&&(K.setAttribute("CellOrdinal",Y.toString()),l[l.length]=K),v++}}return{orderedHeaderTuples:o,orderedValueTuples:l}}return{orderedHeaderTuples:a,orderedValueTuples:r}},e.prototype.getDrilledSets=function(e,i,a,r){for(var n=[],s=i.actualText.toString(),o="row"===r?this.tupRowInfo:this.tupColumnInfo,l=o[i.ordinal],d=0===o[0].typeCollection.indexOf("3")?1:0,h=0,p="1"===o[0].typeCollection[a];h<o.length;)((0,t.isNullOrUndefined)(o[h].allStartPos)||o[h].allStartPos>d)&&(n[n.length]=o[h].uNameCollection),h++;for(var u=e.split("::[").map((function(e){return"["===e[0]?e:"["+e})),c=[],g=0;g<=a;g++)if(u[g])if((p||this.isPaging)&&g===a){for(var m=u[g].split("~~"),f=m.indexOf(s),v=[],S=0;S<=f;S++)v.push(m[S]);c[c.length]=v.length>0?v.join("~~"):u[g]}else c[c.length]=u[g];e=c.join("::");for(var y=[],b={},C=0,x=n;C<x.length;C++){var w=x[C];if(0===w.indexOf(e)&&(y.push(w),this.isPaging))for(var T=w.split("::[")[a],M=(P=(T="["===T[0]?T:"["+T).split("~~")).indexOf(s);M<P.length;M++)b[P[M]]=P[M]}if(this.isPaging){var D=l.uNameCollection.split("::[").map((function(e){return"["===e[0]?e:"["+e})),O=[];for(M=0;M<D.length;M++)M!==a&&(O[M]=D[M]);var P=Object.keys(b);for(M=0;M<P.length;M++)O[a]=P[M],y.push(O.join("::"))}for(var N={},E=0,I=y;E<I.length;E++){for(var F=I[E].split("::[").map((function(e){return"["===e[0]?e:"["+e})),L="",A=0;A<=a;A++){var R=F[A];if(R){var k=R.split("~~");L=L+(""!==L?"~~":"")+k[k.length-1]}}N[L]=L}return N},e.prototype.updateDrilledInfo=function(e){this.dataSourceSettings=e,this.drilledMembers=e.drilledMembers?this.updateDrilledItems(e.drilledMembers):[],this.generateGridData(e)},e.prototype.updateCalcFields=function(e,t){this.dataSourceSettings=e,this.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.getAxisFields(),this.updateFieldlist(),this.loadCalculatedMemberElements(this.calculatedFieldSettings),this.dataFields[t.name]?this.generateGridData(e):Yo.getCellSets(e,this,!0,void 0,!0)},e.prototype.onSort=function(e,t){this.dataSourceSettings=e,t||(this.sortSettings=e.sortSettings?e.sortSettings:[],this.getAxisFields(),this.frameSortObject(),this.updateFieldlist()),this.xmlaCellSet.length>0&&this.xmlDoc?this.generateEngine(this.xmlDoc,this.request,this.customArgs):this.generateGridData(e)},e.prototype.updateFieldlist=function(e){for(var t=0;t<this.savedFieldListData.length;){var i=this.savedFieldListData[t].id,a=this.savedFieldListData[t].pid;if(this.savedFieldList[i]){var r=this.enableSort?this.sortObject[i]?this.sortObject[i]:"Ascending":"None";this.savedFieldList[i].isSelected=!1,this.savedFieldList[i].isExcelFilter=!1,this.savedFieldList[i].sort=r,this.savedFieldList[i].allowDragAndDrop=!0,this.savedFieldList[i].showFilterIcon=!0,this.savedFieldList[i].showSortIcon=!0,this.savedFieldList[i].showEditIcon=!0,this.savedFieldList[i].showRemoveIcon=!0,this.savedFieldList[i].showValueTypeIcon=!0,this.savedFieldList[i].showSubTotals=!0,this.savedFieldListData[t].sort=r,this.savedFieldListData[t].allowDragAndDrop=!0,this.savedFieldListData[t].showFilterIcon=!0,this.savedFieldListData[t].showSortIcon=!0,this.savedFieldListData[t].showEditIcon=!0,this.savedFieldListData[t].showRemoveIcon=!0,this.savedFieldListData[t].showValueTypeIcon=!0,this.savedFieldListData[t].showSubTotals=!0,e&&(this.savedFieldList[i].filter=[],this.savedFieldList[i].actualFilter=[])}if(this.dataFields[i]&&this.savedFieldList[i]&&this.selectedItems.indexOf(i)>-1?(this.savedFieldList[i].isSelected=!0,this.savedFieldList[i].allowDragAndDrop=!this.dataFields[i]||this.dataFields[i].allowDragAndDrop,this.savedFieldList[i].showFilterIcon=!this.dataFields[i]||this.dataFields[i].showFilterIcon,this.savedFieldList[i].showSortIcon=!this.dataFields[i]||this.dataFields[i].showSortIcon,this.savedFieldList[i].showEditIcon=!this.dataFields[i]||this.dataFields[i].showEditIcon,this.savedFieldList[i].showRemoveIcon=!this.dataFields[i]||this.dataFields[i].showRemoveIcon,this.savedFieldList[i].showValueTypeIcon=!this.dataFields[i]||this.dataFields[i].showValueTypeIcon,this.savedFieldList[i].showSubTotals=!this.dataFields[i]||this.dataFields[i].showSubTotals,this.savedFieldListData[t].isSelected=!0,this.savedFieldListData[t].allowDragAndDrop=!this.dataFields[i]||this.dataFields[i].allowDragAndDrop,this.savedFieldListData[t].showFilterIcon=!this.dataFields[i]||this.dataFields[i].showFilterIcon,this.savedFieldListData[t].showSortIcon=!this.dataFields[i]||this.dataFields[i].showSortIcon,this.savedFieldListData[t].showEditIcon=!this.dataFields[i]||this.dataFields[i].showEditIcon,this.savedFieldListData[t].showRemoveIcon=!this.dataFields[i]||this.dataFields[i].showRemoveIcon,this.savedFieldListData[t].showValueTypeIcon=!this.dataFields[i]||this.dataFields[i].showValueTypeIcon,this.savedFieldListData[t].showSubTotals=!this.dataFields[i]||this.dataFields[i].showSubTotals):this.dataFields[a]&&this.savedFieldList[a]&&this.selectedItems.indexOf(a)>-1?this.savedFieldListData[t].isSelected=!0:this.savedFieldListData[t].isSelected=!1,this.savedFieldList[i]&&this.savedFieldList[i].isCalculatedField||"[calculated members].[_0]"===i.toLowerCase()){for(var n=!1,s=0,o=this.calculatedFieldSettings;s<o.length;s++){var l=o[s];if(i===l.name){var d=l.formula,h=l.formatString;this.savedFieldListData[t].formula=d,this.savedFieldListData[t].formatString=h,this.savedFieldListData[t].parentHierarchy=d.toLowerCase().indexOf("measure")>-1?void 0:l.hierarchyUniqueName,this.savedFieldList[i].formula=d,this.savedFieldList[i].formatString=h,this.savedFieldList[i].parentHierarchy=this.savedFieldListData[t].parentHierarchy,n=!0}}(!n&&"[calculated members].[_0]"!==i.toLowerCase()||"[calculated members].[_0]"===i.toLowerCase()&&0===this.calculatedFieldSettings.length)&&(this.savedFieldListData.splice(t,1),t--,this.savedFieldList[i]&&delete this.savedFieldList[i])}t++}this.fieldList=this.savedFieldList,this.fieldListData=this.savedFieldListData},e.prototype.updateFieldlistData=function(e,t){for(var i=0,a=this.fieldListData;i<a.length;i++){var r=a[i];if(r.id===e){r.isSelected=!!t;break}}},e.prototype.getFormattedFields=function(e){this.formatFields={};for(var t=e.length;t--;)this.formatFields[e[t].name]=e[t]},e.prototype.getCubes=function(e){var t=this.getConnectionInfo(e.url,e.localeIdentifier.toString()),i='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_CUBES</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+e.catalog+"</CATALOG_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.catalog+"</Catalog> <LocaleIdentifier>"+t.LCID+"</LocaleIdentifier>"+(e.roles?"<Roles>"+e.roles+"</Roles>":"")+"</PropertyList></Properties></Discover></Body></Envelope>";if(this.doAjaxPost("POST",t.url,i,this.validateCube.bind(this),{dataSourceSettings:e,action:"getCubes"}),this.errorInfo)throw this.errorInfo},e.prototype.validateCube=function(e,t,i){for(var a=[].slice.call(e.querySelectorAll("row")),r=!1,n=0,s=a;n<s.length;n++){if(s[n].querySelector("CUBE_NAME").textContent===i.dataSourceSettings.cube){r=!0;break}}!r&&a.length>0&&(this.errorInfo="Invalid cube name "+this.dataSourceSettings.cube)},e.prototype.getFieldList=function(e){var t={catalog:e.catalog,cube:e.cube,url:e.url,LCID:e.localeIdentifier.toString(),request:"MDSCHEMA_HIERARCHIES",roles:e.roles};this.getTreeData(t,this.getFieldListItems.bind(this),{dataSourceSettings:e,action:"loadFieldElements"})},e.prototype.getTreeData=function(e,t,i){var a=this.getConnectionInfo(e.url,e.LCID),r='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>'+e.request+"</RequestType><Restrictions><RestrictionList><CATALOG_NAME>"+e.catalog+"</CATALOG_NAME><CUBE_NAME>"+e.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.catalog+"</Catalog> <LocaleIdentifier>"+a.LCID+"</LocaleIdentifier>"+(e.roles?"<Roles>"+e.roles+"</Roles>":"")+"</PropertyList></Properties></Discover></Body></Envelope>";if(this.doAjaxPost("POST",a.url,r,t,i),this.errorInfo)throw this.errorInfo},e.prototype.getAxisFields=function(){this.rows=this.dataSourceSettings.rows?this.dataSourceSettings.rows:[],this.columns=this.dataSourceSettings.columns?this.dataSourceSettings.columns:[],this.filters=this.dataSourceSettings.filters?this.dataSourceSettings.filters:[],this.values=this.dataSourceSettings.values?this.dataSourceSettings.values:[];for(var e=(0,t.extend)([],this.rows,null,!0),i=(e=e.concat(this.columns,this.values,this.filters)).length;i--;)this.dataFields[e[i].name]=e[i],"[measures]"===e[i].name.toLowerCase()?this.isMeasureAvail=!0:this.selectedItems.push(e[i].name);if(this.mappingFields={},this.dataSourceSettings.fieldMapping)for(var a=0,r=this.dataSourceSettings.fieldMapping;a<r.length;a++){var n=r[a];this.mappingFields[n.name]=n}if(!this.isMeasureAvail&&this.values.length>0){var s={name:"[Measures]",caption:"Measures",showRemoveIcon:!0,allowDragAndDrop:!0};"row"===this.valueAxis?this.rows.push(s):this.columns.push(s),this.isMeasureAvail=!0}},e.prototype.getAggregateType=function(e,t){var i;switch(t){case"1":i="Sum";break;case"2":i="Count";break;case"3":i="Min";break;case"4":i="Max";break;case"5":i="Avg";break;case"8":i="DistinctCount";break;case"127":i="CalculatedField";break;default:i=void 0}return i||void 0},e.prototype.getUniqueName=function(e){for(var t=e,i=0,a=this.calculatedFieldSettings;i<a.length;i++){var r=a[i];if(e===(r.formula.toLowerCase().indexOf("measure")>-1?"[Measures].":r.hierarchyUniqueName+".")+"["+r.name+"]"){t=r.name;break}}return t},e.prototype.updateFilterItems=function(e){var i=(0,t.extend)([],this.rows,null,!0);i=i.concat(this.columns);for(var a=0,r=e;a<r.length;a++){var n=r[a];if("Include"===n.type&&this.allowMemberFilter&&this.fieldList[n.name]){var s=this.fieldList[n.name].members,o=s&&Object.keys(s).length>0;this.fieldList[n.name].actualFilter=n.items.slice();var l=(0,t.extend)([],n.items,null,!0);if(o)for(var d=0;d<l.length;){for(var h=[],p=0,u=h=this.getParentNode(l[d],s,h);p<u.length;p++){var c=u[p],g=Di.inArray(c,n.items);-1!==g&&n.items.splice(g,1)}d++}for(var m=[],f=0,v=n.items;f<v.length;f++){var S=v[f],y=void 0;o||1!==n.items.length||(this.getMembers(this.dataSourceSettings,n.name,void 0,void 0,void 0,n.items[0]),y=this.fieldList[n.name].actualFilter[0]),m.push(S),o?this.fieldList[n.name].filter.push(s[S].caption):this.fieldList[n.name].filter.push(y||S)}this.filterMembers[n.name]=m,this.fieldList[n.name].isExcelFilter=!1}else if((this.allowValueFilter||this.allowLabelFilter)&&-1!==["Date","Label","Number","Value"].indexOf(n.type))for(var b=0,C=i;b<C.length;b++){if(C[b].name===n.name){var x=this.filterMembers[n.name];x&&"object"==typeof x[0]&&x[0].type===n.type?x[x.length]=n:this.filterMembers[n.name]=[n],this.fieldList[n.name].isExcelFilter=!0;break}}}},e.prototype.getParentNode=function(e,t,i){if(t[e].parent&&e!==t[e].parent){var a=t[e].parent;i.push(a),this.getParentNode(a,t,i)}return i},e.prototype.updateDrilledItems=function(e){var i=[],a=(0,t.extend)([],this.rows,null,!0);a=a.concat(this.columns);for(var r=0,n=e;r<n.length;r++)for(var s=n[r],o=0,l=a;o<l.length;o++){var d=l[o];if(s.name===d.name){i.push(s);break}}return i},e.prototype.getDrillThroughData=function(e,t){for(var i,a=this.tupColumnInfo[e.colOrdinal]&&this.tupColumnInfo[e.colOrdinal].uNameCollection&&""!==this.tupColumnInfo[e.colOrdinal].uNameCollection?this.tupColumnInfo[e.colOrdinal].uNameCollection.split("::[").map((function(e){return"["===e[0]?e:"["+e})):[],r=this.tupRowInfo[e.rowOrdinal]&&this.tupRowInfo[e.rowOrdinal].uNameCollection&&""!==this.tupRowInfo[e.rowOrdinal].uNameCollection?this.tupRowInfo[e.rowOrdinal].uNameCollection.split("::[").map((function(e){return"["===e[0]?e:"["+e})):[],n=[],s="",o=0;o<this.filters.length;o++)if(i=this.filterMembers[this.filters[o].name]){for(var l=0;l<i.length;l++)s+=i[l],s=l<i.length-1?s+",":s+"";n[o]=s,s=""}for(o=0;o<n.length;o++)s=""===s?"{"+n[o]+"}":s+",{"+n[o]+"}";var d="",h="";for(o=0;o<a.length;o++)d=(d.length>0?d+",":"")+(a[o].split("~~").length>1?a[o].split("~~")[a[o].split("~~").length-1]:a[o]);for(o=0;o<r.length;o++)h=(h.length>0?h+",":"")+(r[o].split("~~").length>1?r[o].split("~~")[r[o].split("~~").length-1]:r[o]);var p="DRILLTHROUGH MAXROWS "+t+" Select("+(d.length>0?d:"")+(d.length>0&&h.length>0?",":"")+(h.length>0?h:"")+") on 0 from "+(""===s?"["+this.dataSourceSettings.cube+"]":"(SELECT ("+s+") ON COLUMNS FROM ["+this.dataSourceSettings.cube+"])");p=p.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;");var u=this.getSoapMsg(this.dataSourceSettings,p),c=this.getConnectionInfo(this.dataSourceSettings.url,this.dataSourceSettings.localeIdentifier);if(this.doAjaxPost("POST",c.url,u,this.drillThroughSuccess.bind(this),{dataSourceSettings:this.dataSourceSettings,action:"drillThrough"}),this.errorInfo)throw this.errorInfo},e.prototype.drillThroughSuccess=function(e){var t=[].slice.call(e.querySelectorAll("row")),i="";if(t.length>0){for(var a=[],r=0;r<t.length;){for(var n=[].slice.call(t[r].children),s=0;s<n.length;)a.push('"'+n[s].tagName+'":"'+n[s].textContent+'"'),s++;r++}for(var o=a[0],l=0;l<a.length;)Object.keys(JSON.parse("[{"+a[l]+"}]")[0])[0]!==Object.keys(JSON.parse("[{"+o+"}]")[0])[0]?(i+=","+a[l],l++):(i+=""===i?"[{"+a[l]:"}, {"+a[l],l++);i+="}]"}else{var d=[].slice.call(e.querySelectorAll("faultstring"));for(r=0;r<d.length;)i+=d[r].textContent,r++}this.gridJSON=i},e.prototype.getFilterMembers=function(e,t,i,a,r){var n,s=this.fieldList[t].levels,o=this.fieldList[t].levelCount;return n=r?"Descendants({"+s[o].id+"}, "+s[i-1].id+", "+(i-o==1?"SELF)":"SELF_AND_BEFORE)"):t+", Descendants({"+s[0].id+"}, "+s[i-1].id+", SELF_AND_BEFORE)",this.fieldList[t].levelCount=i,a||this.getMembers(e,t,!1,n,r),n},e.prototype.getMembers=function(e,t,i,a,r,n){var s,o="DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE",l=this.fieldList[t].hasAllMember,d=(l?t:t+".LEVELS(0)").replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;");s=i||n?n?"SELECT {"+(n=n.replace(/&/g,"&amp;"))+"} ON 0 FROM ["+e.cube+"] WHERE {}":"SELECT ({"+d+".ALLMEMBERS})"+o+" ON 0 FROM ["+e.cube+"]":"SELECT ({"+(a||(l?d+", "+d+".CHILDREN":d+".ALLMEMBERS"))+"})"+o+" ON 0 FROM ["+e.cube+"]";var h=this.getSoapMsg(e,s),p=this.getConnectionInfo(e.url,e.localeIdentifier);if(r||(this.fieldList[t].filterMembers=[],this.fieldList[t].childMembers=[],this.fieldList[t].searchMembers=[],this.fieldList[t].members={},this.fieldList[t].currrentMembers={}),this.doAjaxPost("POST",p.url,h,n?this.getOlapFilterText.bind(this):this.generateMembers.bind(this),{dataSourceSettings:e,fieldName:t,loadLevelMembers:r,action:"fetchMembers"}),this.errorInfo)throw this.errorInfo},e.prototype.getOlapFilterText=function(e,t,i){var a=[].slice.call(e.querySelectorAll('Axis[name="Axis0"] Tuple'));a.length>0&&this.fieldList[i.fieldName]&&a[a.length-1].getElementsByTagName("Caption")&&a[a.length-1].getElementsByTagName("Caption")[0]&&(this.fieldList[i.fieldName].actualFilter[0]=a[a.length-1].getElementsByTagName("Caption")[0].textContent)},e.prototype.getChildMembers=function(e,t,i){var a="SELECT ({"+t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")+".CHILDREN})DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE ON 0 FROM ["+e.cube+"]",r=this.getSoapMsg(e,a),n=this.getConnectionInfo(e.url,e.localeIdentifier);if(this.doAjaxPost("POST",n.url,r,this.generateMembers.bind(this),{dataSourceSettings:e,fieldName:i,action:"fetchChildMembers"}),this.errorInfo)throw this.errorInfo},e.prototype.getCalcChildMembers=function(e,t){this.calcChildMembers=[];var i="SELECT ({"+t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")+".MEMBERS})DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE ON 0 FROM ["+e.cube+"]",a=this.getConnectionInfo(e.url,e.localeIdentifier),r=this.getSoapMsg(e,i);if(this.doAjaxPost("POST",a.url,r,this.generateMembers.bind(this),{dataSourceSettings:e,action:"fetchCalcChildMembers"}),this.errorInfo)throw this.errorInfo},e.prototype.getSearchMembers=function(e,t,i,a,r,n){if(this.fieldList[t].searchMembers=[],this.fieldList[t].currrentMembers={},""!==i){var s=t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;"),o="WITH SET [SearchMembersSet] AS &#39;FILTER("+(r?s+".ALLMEMBERS, ":"{"+(n>1?this.getFilterMembers(e,t,n,!0):s+", "+s+".CHILDREN")+"},")+"(INSTR(1, "+s+'.CurrentMember.member_caption, "'+i+'") > 0))&#39;SET [SearchParentsSet] AS &#39;GENERATE([SearchMembersSet], ASCENDANTS([SearchMembersSet].Current))&#39;SET [SearchSet] AS &#39;HIERARCHIZE(DISTINCT({[SearchMembersSet], [SearchParentsSet]}))&#39;SELECT SUBSET([SearchSet], 0, '+a+")DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE ON 0 FROM ["+e.cube+"]",l=this.getSoapMsg(e,o),d=this.getConnectionInfo(e.url,e.localeIdentifier);if(this.doAjaxPost("POST",d.url,l,this.generateMembers.bind(this),{dataSourceSettings:e,fieldName:t,action:"fetchSearchMembers"}),this.errorInfo)throw this.errorInfo}},e.prototype.generateMembers=function(e,t,i){for(var a,r=[].slice.call(e.querySelectorAll('Axis[name="Axis0"] Tuple')),n=i.fieldName,s={},o=0,l=r;o<l.length;o++){var d=l[o],h=d.querySelector("Member"),p=h.querySelector("MEMBER_TYPE").textContent,u=h.querySelector("UName").textContent,c=h.querySelector("Caption").textContent,g=h.querySelector("PARENT_UNIQUE_NAME")?h.querySelector("PARENT_UNIQUE_NAME").textContent:"",m={"data-fieldName":n,"data-memberId":u};if(""===g&&"1"===p)s={hasChildren:!!d.querySelector("CHILDREN_CARDINALITY")&&"0"!==d.querySelector("CHILDREN_CARDINALITY").textContent,isSelected:!1,id:u,tag:u,name:c,caption:c,htmlAttributes:m},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[n].members[u]={name:u,caption:c,parent:void 0,isNodeExpand:!1,isSelected:!1},this.fieldList[n].filterMembers.push(s),this.fieldList[n].childMembers.push(s)):"fetchSearchMembers"===i.action?(this.fieldList[n].currrentMembers[u]={name:u,caption:c,parent:void 0,isNodeExpand:!1,isSelected:!1},this.fieldList[n].searchMembers.push(s),s.expanded=!0):this.calcChildMembers.push(s);else if(""!==g&&"1"===p)if(g===a&&"1"===p)s={hasChildren:!!d.querySelector("CHILDREN_CARDINALITY")&&"0"!==d.querySelector("CHILDREN_CARDINALITY").textContent,id:u,name:c,isSelected:!1,caption:c,htmlAttributes:m,tag:u},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[n].filterMembers.push(s),this.fieldList[n].childMembers.push(s),this.fieldList[n].members[u]={name:u,caption:c,parent:void 0,isNodeExpand:!1,isSelected:!1}):"fetchSearchMembers"===i.action?(s.expanded=!0,this.fieldList[n].searchMembers.push(s),this.fieldList[n].currrentMembers[u]={name:u,caption:c,parent:void 0,isNodeExpand:!1,isSelected:!1}):this.calcChildMembers.push(s);else{if("fetchMembers"===i.action&&this.fieldList[n].members[u])continue;var f=!!i.loadLevelMembers&&this.fieldList[n].members[g].isSelected;s={hasChildren:!!d.querySelector("CHILDREN_CARDINALITY")&&"0"!==d.querySelector("CHILDREN_CARDINALITY").textContent,htmlAttributes:m,isSelected:!1,id:u,pid:g,name:c,caption:c,tag:u},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[n].isHierarchy=!1,this.fieldList[n].filterMembers.push(s),this.fieldList[n].childMembers.push(s),this.fieldList[n].members[u]={name:u,caption:c,parent:g,isNodeExpand:!1,isSelected:f}):"fetchSearchMembers"===i.action?(this.fieldList[n].searchMembers.push(s),s.expanded=!0,this.fieldList[n].currrentMembers[u]={name:u,caption:c,parent:g,isNodeExpand:!1,isSelected:!1}):this.calcChildMembers.push(s)}else"2"===p&&(a=u)}},e.prototype.getFieldListItems=function(e,t,i){for(var a,r=[],n=0,s=[].slice.call(e.querySelectorAll("row"));n<s.length;n++){var o=s[n],l=[].slice.call(o.querySelectorAll("ALL_MEMBER")).length>0,d=o.querySelector("DIMENSION_UNIQUE_NAME").textContent,h=o.querySelector("HIERARCHY_UNIQUE_NAME").textContent,p=d===h&&"[measures]"!==d.toLowerCase()&&"[measures]"!==h.toLowerCase();r.push({pid:this.isMondrian||p?d+"~#^Dim":d,id:h,name:o.querySelector("HIERARCHY_CAPTION").textContent,caption:o.querySelector("HIERARCHY_CAPTION").textContent,tag:h,hasAllMember:l,allMember:l?o.querySelectorAll("ALL_MEMBER")[0].textContent:void 0,type:"string"})}a={hierarchy:r,hierarchySuccess:e,measures:[]},this.fieldListObj=a;var u={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_DIMENSIONS",roles:i.dataSourceSettings.roles};this.getTreeData(u,this.loadDimensionElements.bind(this),i)},e.prototype.loadCalculatedMemberElements=function(e){if(e.length>0){var t=this.fieldListData,i={hasChildren:!0,isSelected:!1,id:"[Calculated Members].[_0]",name:"[Calculated Members].[_0]",caption:"Calculated Members",spriteCssClass:"e-calcMemberGroupCDB "+o,tag:"[Calculated Members].[_0]",type:"string"};t.length>0&&"[measures]"===t[0].id.toLowerCase()&&t.splice(0,0,i);for(var a=0,r=e;a<r.length;a++){var n=r[a];if(!this.fieldList[n.name]){var s=n.formula,l=(s.toLowerCase().indexOf("measure")>-1?"[Measures].":n.hierarchyUniqueName+".")+"["+n.name+"]",d=this.dataFields[n.name]&&this.dataFields[n.name].caption?this.dataFields[n.name].caption:this.mappingFields[n.name]&&this.mappingFields[n.name].caption?this.mappingFields[n.name].caption:n.name,h=n.formatString,p={hasChildren:!1,isSelected:!1,id:n.name,pid:"[Calculated Members].[_0]",name:n.name,caption:d,spriteCssClass:"e-calc-member "+(s.toLowerCase().indexOf("measure")>-1?"e-calc-measure-icon":"e-calc-dimension-icon")+" "+o,tag:l,formula:s,formatString:h,aggregateType:void 0,type:"CalculatedField",filter:[],dateMember:[],sort:"Ascending",actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},isHierarchy:!0,isExcelFilter:!1,isCalculatedField:!0,allowDragAndDrop:this.dataFields[n.name]?this.dataFields[n.name].allowDragAndDrop:!this.mappingFields[n.name]||this.mappingFields[n.name].allowDragAndDrop,showFilterIcon:this.dataFields[n.name]?this.dataFields[n.name].showFilterIcon:!this.mappingFields[n.name]||this.mappingFields[n.name].showFilterIcon,showSortIcon:this.dataFields[n.name]?this.dataFields[n.name].showSortIcon:!this.mappingFields[n.name]||this.mappingFields[n.name].showSortIcon,showEditIcon:this.dataFields[n.name]?this.dataFields[n.name].showEditIcon:!this.mappingFields[n.name]||this.mappingFields[n.name].showEditIcon,showRemoveIcon:this.dataFields[n.name]?this.dataFields[n.name].showRemoveIcon:!this.mappingFields[n.name]||this.mappingFields[n.name].showRemoveIcon,showValueTypeIcon:this.dataFields[n.name]?this.dataFields[n.name].showValueTypeIcon:!this.mappingFields[n.name]||this.mappingFields[n.name].showValueTypeIcon,showSubTotals:this.dataFields[n.name]?this.dataFields[n.name].showSubTotals:!this.mappingFields[n.name]||this.mappingFields[n.name].showSubTotals,fieldType:s.toLowerCase().indexOf("measure")>-1?"Measure":"Dimension",parentHierarchy:s.toLowerCase().indexOf("measure")>-1?void 0:n.hierarchyUniqueName};t.push(p),this.fieldList[p.id]=p,this.updateMembersOrder(n.name)}}}},e.prototype.loadDimensionElements=function(e,i,a){for(var r=[],n=[].slice.call(e.querySelectorAll("row")),s={},l=0,d=n;l<d.length;l++){var h=d[l],p=h.querySelector("DIMENSION_UNIQUE_NAME").textContent,u=h.querySelector("DEFAULT_HIERARCHY").textContent,c=h.querySelector("DIMENSION_CAPTION").textContent,g=p===u;p.toLowerCase().indexOf("[measure")>=0?s={hasChildren:!0,isSelected:!1,id:p,name:p,caption:c,spriteCssClass:"[measures]"===p.toLowerCase()?"e-measureGroupCDB-icon "+o:"e-dimensionCDB-icon "+o,tag:p,type:"string"}:(0,t.isNullOrUndefined)(n[0].querySelector("HIERARCHY_CAPTION"))&&r.push({hasChildren:!0,isSelected:!1,id:this.isMondrian||g?p+"~#^Dim":p,name:p,caption:c,spriteCssClass:"e-dimensionCDB-icon "+o,tag:p,defaultHierarchy:h.querySelector("DEFAULT_HIERARCHY").textContent,type:"string"})}r.splice(0,0,s),this.fieldListData=r;var m={catalog:a.dataSourceSettings.catalog,cube:a.dataSourceSettings.cube,url:a.dataSourceSettings.url,LCID:a.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_SETS",roles:a.dataSourceSettings.roles};this.getTreeData(m,this.loadNamedSetElements.bind(this),a)},e.prototype.loadNamedSetElements=function(e,i,a){var r=(0,t.extend)([],this.rows,null,!0);r=r.concat(this.columns,this.filters);for(var n=this.fieldListData,s=[],l=0,d=r;l<d.length;l++){var h=d[l];s.push(h.name)}for(var p=[],u=0,c=[].slice.call(e.querySelectorAll("row"));u<c.length;u++){h=c[u];p.indexOf(h.querySelector("DIMENSIONS").textContent.split(".")[0])>=0||(n.push({hasChildren:!0,isSelected:!1,pid:h.querySelector("DIMENSIONS").textContent.split(".")[0],id:h.querySelector("SET_DISPLAY_FOLDER").textContent+"_"+h.querySelector("DIMENSIONS").textContent.split(".")[0],name:h.querySelector("SET_DISPLAY_FOLDER").textContent,spriteCssClass:"e-folderCDB-icon "+o+" namedSets",caption:h.querySelector("SET_DISPLAY_FOLDER").textContent,type:"string"}),p.push(h.querySelector("DIMENSIONS").textContent.split(".")[0]));var g="["+h.querySelector("SET_NAME").textContent.trim()+"]",m={hasChildren:!0,isNamedSets:!0,isSelected:s.indexOf("["+h.querySelector("SET_NAME").textContent+"]")>=0,pid:h.querySelector("SET_DISPLAY_FOLDER").textContent+"_"+h.querySelector("DIMENSIONS").textContent.split(".")[0],id:g,name:h.querySelector("SET_CAPTION").textContent,caption:this.dataFields[g]&&this.dataFields[g].caption?this.dataFields[g].caption:this.mappingFields[g]&&this.mappingFields[g].caption?this.mappingFields[g].caption:h.querySelector("SET_CAPTION").textContent,spriteCssClass:"e-namedSetCDB-icon "+o,tag:h.querySelector("EXPRESSION").textContent,type:"string",filter:[],dateMember:[],actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},isHierarchy:!0,isExcelFilter:!1,allowDragAndDrop:this.dataFields[g]?this.dataFields[g].allowDragAndDrop:!this.mappingFields[g]||this.mappingFields[g].allowDragAndDrop,showFilterIcon:this.dataFields[g]?this.dataFields[g].showFilterIcon:!this.mappingFields[g]||this.mappingFields[g].showFilterIcon,showSortIcon:this.dataFields[g]?this.dataFields[g].showSortIcon:!this.mappingFields[g]||this.mappingFields[g].showSortIcon,showEditIcon:this.dataFields[g]?this.dataFields[g].showEditIcon:!this.mappingFields[g]||this.mappingFields[g].showEditIcon,showRemoveIcon:this.dataFields[g]?this.dataFields[g].showRemoveIcon:!this.mappingFields[g]||this.mappingFields[g].showRemoveIcon,showValueTypeIcon:this.dataFields[g]?this.dataFields[g].showValueTypeIcon:!this.mappingFields[g]||this.mappingFields[g].showValueTypeIcon,showSubTotals:this.dataFields[g]?this.dataFields[g].showSubTotals:!this.mappingFields[g]||this.mappingFields[g].showSubTotals};n.push(m),this.fieldList[g]=m,this.updateMembersOrder(g)}a.hierarchy=this.fieldListData,a.hierarchySuccess=this.fieldListObj.hierarchySuccess,this.loadHierarchyElements(a)},e.prototype.loadHierarchyElements=function(e){for(var i=e.hierarchySuccess,a=e.hierarchy,r=(0,t.extend)([],this.rows,null,!0),n=[],s=0,l=r=r.concat(this.columns,this.filters);s<l.length;s++){var d=l[s];n.push(d.name)}for(var h=0,p=[].slice.call(i.querySelectorAll("row"));h<p.length;h++){var u=(d=p[h]).querySelector("DIMENSION_UNIQUE_NAME").textContent,c=d.querySelector("HIERARCHY_UNIQUE_NAME").textContent,g=[].slice.call(d.querySelectorAll("ALL_MEMBER")).length>0,m=void 0;if(g){var f=d.querySelectorAll("ALL_MEMBER")[0].textContent.replace(/[&[\]']+/g,"").split(".");m=f[f.length-1].trim()}else m=void 0;for(var v=d.querySelector("HIERARCHY_DISPLAY_FOLDER")?d.querySelector("HIERARCHY_DISPLAY_FOLDER").textContent:"",S=[],y=0,b=a;y<b.length;y++){(O=b[y]).tag===u&&S.push(O)}if(S.length>0){var C=u===c&&"[measures]"!==u.toLowerCase()&&"[measures]"!==c.toLowerCase();if("[measures]"!==u.toLowerCase()&&"[measures]"!==c.toLowerCase()){var x=u+(this.isMondrian||C?"~#^Dim":"");if(""!==v){for(var w=u+(this.isMondrian||C?"~#^Dim":"")+"_"+v,T=[],M=0,D=a;M<D.length;M++){var O;(O=D[M]).tag===w&&O.pid===x&&T.push(O)}if(0===T.length){var P={hasChildren:!0,isSelected:!1,pid:u+(this.isMondrian||C?"~#^Dim":""),id:w,name:v,spriteCssClass:"e-folderCDB-icon "+o,tag:w,caption:v,type:"string"};a.push(P)}x=w}var N={hasChildren:!d.querySelector("HIERARCHY_ORIGIN")||"2"!==d.querySelector("HIERARCHY_ORIGIN").textContent&&"6"!==d.querySelector("HIERARCHY_ORIGIN").textContent,isSelected:n.indexOf(c)>=0,pid:x,id:c,name:d.querySelector("HIERARCHY_CAPTION").textContent,spriteCssClass:(d.querySelector("HIERARCHY_ORIGIN")?"2"!==d.querySelector("HIERARCHY_ORIGIN").textContent&&"6"!==d.querySelector("HIERARCHY_ORIGIN").textContent?"e-hierarchyCDB-icon":"e-attributeCDB-icon":"e-hierarchyCDB-icon")+" "+o,hasAllMember:g,allMember:m,tag:c,caption:this.dataFields[c]&&this.dataFields[c].caption?this.dataFields[c].caption:this.mappingFields[c]&&this.mappingFields[c].caption?this.mappingFields[c].caption:d.querySelector("HIERARCHY_CAPTION").textContent,type:"string",filter:[],dateMember:[],sort:this.enableSort?this.sortObject[c]?this.sortObject[c]:"Ascending":"None",actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},levels:[],levelCount:1,isHierarchy:!!d.querySelector("HIERARCHY_ORIGIN")&&("2"===d.querySelector("HIERARCHY_ORIGIN").textContent||"6"===d.querySelector("HIERARCHY_ORIGIN").textContent),isExcelFilter:!1,allowDragAndDrop:this.dataFields[c]?this.dataFields[c].allowDragAndDrop:!this.mappingFields[c]||this.mappingFields[c].allowDragAndDrop,showFilterIcon:this.dataFields[c]?this.dataFields[c].showFilterIcon:!this.mappingFields[c]||this.mappingFields[c].showFilterIcon,showSortIcon:this.dataFields[c]?this.dataFields[c].showSortIcon:!this.mappingFields[c]||this.mappingFields[c].showSortIcon,showEditIcon:this.dataFields[c]?this.dataFields[c].showEditIcon:!this.mappingFields[c]||this.mappingFields[c].showEditIcon,showRemoveIcon:this.dataFields[c]?this.dataFields[c].showRemoveIcon:!this.mappingFields[c]||this.mappingFields[c].showRemoveIcon,showValueTypeIcon:this.dataFields[c]?this.dataFields[c].showValueTypeIcon:!this.mappingFields[c]||this.mappingFields[c].showValueTypeIcon,showSubTotals:this.dataFields[c]?this.dataFields[c].showSubTotals:!this.mappingFields[c]||this.mappingFields[c].showSubTotals};a.push(N),this.fieldList[c]=N,this.updateMembersOrder(c)}}}var E={catalog:e.dataSourceSettings.catalog,cube:e.dataSourceSettings.cube,url:e.dataSourceSettings.url,LCID:e.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_LEVELS",roles:e.dataSourceSettings.roles};this.getTreeData(E,this.loadLevelElements.bind(this),e)},e.prototype.updateMembersOrder=function(e){for(var t=0,i=this.sortSettings;t<i.length;t++){var a=i[t];if(e===a.name&&a.membersOrder){this.fieldList[e].membersOrder=a.membersOrder;break}}},e.prototype.loadLevelElements=function(e,t,i){var a=[],r=this.fieldListData;a=[];for(var n=0,s=[].slice.call(e.querySelectorAll("row"));n<s.length;n++){var l=s[n];if(1!==parseInt(l.querySelector("LEVEL_TYPE").textContent,10)&&"[measures]"!==l.querySelector("HIERARCHY_UNIQUE_NAME").textContent.toLowerCase()){var d=l.querySelector("HIERARCHY_UNIQUE_NAME").textContent,h=l.querySelector("LEVEL_UNIQUE_NAME").textContent,p=l.querySelector("LEVEL_CAPTION").textContent,u={hasChildren:!1,isChecked:!1,isSelected:this.fieldList[d].isSelected,pid:d,id:h,name:p,tag:h,spriteCssClass:"e-level-members e-hierarchy-level-"+parseInt(l.querySelector("LEVEL_NUMBER").textContent,10)+"-icon "+o,caption:p,type:"string"};a.push(u),this.fieldList[d]&&this.fieldList[d].spriteCssClass&&-1===this.fieldList[d].spriteCssClass.indexOf("e-attributeCDB-icon")?(this.fieldList[d].levels.push(u),this.fieldList[d].isHierarchy=!1):this.fieldList[d].isHierarchy=!0}}this.fieldListData=r=r.concat(a);var c={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_MEASURES",roles:i.dataSourceSettings.roles};this.getTreeData(c,this.loadMeasureElements.bind(this),i)},e.prototype.loadMeasureElements=function(e,i,a){for(var r,n=this.fieldListData,s=[],l=[],d=0,h=(0,t.extend)([],this.values,null,!0);d<h.length;d++){var p=h[d];l.push(p.name)}if("en-US"!==this.locale){var u={catalog:a.dataSourceSettings.catalog,cube:a.dataSourceSettings.cube,url:a.dataSourceSettings.url,LCID:a.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_MEASUREGROUPS",roles:a.dataSourceSettings.roles};this.getTreeData(u,this.loadMeasureGroups.bind(this),a)}for(var c=0,g=[].slice.call(e.querySelectorAll("row"));c<g.length;c++){p=g[c];var m=(0,t.isNullOrUndefined)(p.querySelector("MEASUREGROUP_NAME"))?"":p.querySelector("MEASUREGROUP_NAME").textContent,f=p.querySelector("MEASURE_UNIQUE_NAME").textContent,v=p.querySelector("DEFAULT_FORMAT_STRING")?p.querySelector("DEFAULT_FORMAT_STRING").textContent:"#,#",S=p.querySelector("MEASURE_AGGREGATOR")?p.querySelector("MEASURE_AGGREGATOR").textContent:"1";if(!(s.indexOf(m)>=0)){if("en-US"!==this.locale){for(var y=[],b=0,C=this.fieldListObj.measuresGroups;b<C.length;b++){var x=C[b];x.querySelector("MEASUREGROUP_NAME").textContent===m&&y.push(x)}r=y.length>0?y[0].querySelector("MEASUREGROUP_CAPTION").textContent:m}else r=m;""!==m&&(n.push({hasChildren:!0,isChecked:!1,isSelected:!1,pid:"[Measures]",id:m,name:r,spriteCssClass:"e-measureCDB e-folderCDB-icon "+o,tag:m,caption:r,aggregateType:this.getAggregateType(m,S),type:"string"}),s.push(m))}var w={hasChildren:!1,isSelected:l.indexOf(f)>=0,pid:""===m?"[Measures]":m,id:f,name:p.querySelector("MEASURE_CAPTION").textContent,spriteCssClass:"e-measure-icon "+o,tag:f,caption:this.dataFields[f]&&this.dataFields[f].caption?this.dataFields[f].caption:this.mappingFields[f]&&this.mappingFields[f].caption?this.mappingFields[f].caption:p.querySelector("MEASURE_CAPTION").textContent,aggregateType:this.getAggregateType(f,S),type:"number",filter:[],actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},formatString:v,allowDragAndDrop:this.dataFields[f]?this.dataFields[f].allowDragAndDrop:!this.mappingFields[f]||this.mappingFields[f].allowDragAndDrop,showFilterIcon:this.dataFields[f]?this.dataFields[f].showFilterIcon:!this.mappingFields[f]||this.mappingFields[f].showFilterIcon,showSortIcon:this.dataFields[f]?this.dataFields[f].showSortIcon:!this.mappingFields[f]||this.mappingFields[f].showSortIcon,showEditIcon:this.dataFields[f]?this.dataFields[f].showEditIcon:!this.mappingFields[f]||this.mappingFields[f].showEditIcon,showRemoveIcon:this.dataFields[f]?this.dataFields[f].showRemoveIcon:!this.mappingFields[f]||this.mappingFields[f].showRemoveIcon,showValueTypeIcon:this.dataFields[f]?this.dataFields[f].showValueTypeIcon:!this.mappingFields[f]||this.mappingFields[f].showValueTypeIcon,showSubTotals:this.dataFields[f]?this.dataFields[f].showSubTotals:!this.mappingFields[f]||this.mappingFields[f].showSubTotals};n.push(w),this.fieldList[f]=w,l.indexOf(f)>=0&&l.splice(l.indexOf(f),1)}this.measureReportItems=l},e.prototype.loadMeasureGroups=function(e){(0,t.isNullOrUndefined)(this.fieldListObj)&&(this.fieldListObj={}),this.fieldListObj.measuresGroups=[].slice.call(e.querySelectorAll("row"))},e.prototype.doAjaxPost=function(e,i,a,r,n){var s=this;new t.Ajax({mode:!1,contentType:"text/xml",url:i,data:a,dataType:"xml",type:e,beforeSend:this.beforeSend.bind(this),onSuccess:function(e,t){var i=(new DOMParser).parseFromString(e,"text/xml"),a=i.querySelector("Body");a.querySelector("OlapInfo")||a.querySelector("DiscoverResponse")||(a.querySelector("Fault")&&a.querySelector("Fault").querySelector("faultstring")?s.errorInfo=a.querySelector("Fault").querySelector("faultstring").innerHTML:a.querySelector("return")&&a.querySelector("return").querySelector("Error")&&(s.errorInfo=a.querySelector("return").querySelector("Error").getAttribute("Description"))),r(i,t,n)},onFailure:function(e){s.errorInfo=e}}).send()},e.prototype.beforeSend=function(e){this.dataSourceSettings.authentication.userName&&this.dataSourceSettings.authentication.password&&e.httpRequest.setRequestHeader("Authorization","Basic "+btoa(this.dataSourceSettings.authentication.userName+":"+this.dataSourceSettings.authentication.password))},e.prototype.getSoapMsg=function(e,t){var i=this.getConnectionInfo(e.url,e.localeIdentifier);return this.isMondrian?'<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement><![CDATA['+t+"]]></Statement></Command><Properties><PropertyList><DataSourceInfo>"+""+"</DataSourceInfo><Catalog>"+e.catalog+"</Catalog><AxisFormat>TupleFormat</AxisFormat><Content>Data</Content><Format>Multidimensional</Format></PropertyList></Properties></Execute></SOAP-ENV:Body></SOAP-ENV:Envelope>":'<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement> '+t+" </Statement> </Command> <Properties> <PropertyList> <Catalog>"+e.catalog+"</Catalog> <LocaleIdentifier>"+i.LCID+"</LocaleIdentifier>"+(e.roles?"<Roles>"+e.roles+"</Roles>":"")+"</PropertyList> </Properties> </Execute> </Body> </Envelope>"},e.prototype.getConnectionInfo=function(e,i){var a={url:"",LCID:(0,t.isNullOrUndefined)(i)?"1033":i.toString()};if(""!==e)for(var r=0,n=e.split(";");r<n.length;r++){var s=n[r];s.toLowerCase().indexOf("locale")<0&&0===a.url.length?a.url=s:s.toLowerCase().indexOf("locale")>=0&&(a.LCID=s.replace(/ /g,"").split("=")[1])}return a},e.prototype.getMDXQuery=function(e){return Yo.getCellSets(e,this,!0,void 0,!0),this.mdxQuery},e}(),Xo=v(727),Jo=function(){function e(){}return e.prototype.drawHeader=function(e,t){var i=t.pageSettings.size,r=e.header,n=new a.PointF(0,r&&r.fromTop?r.fromTop:0),s=new a.SizeF(i.width-80,r&&r.height?.75*r.height:50),o=new a.RectangleF(n,s);t.template.top=this.drawPageTemplate(new a.PdfPageTemplateElement(o),r)},e.prototype.drawFooter=function(e,t){var i=t.pageSettings.size,r=e.footer,n=new a.PointF(0,i.width-80-(r&&r.fromBottom?.75*r.fromBottom:0)),s=new a.SizeF(i.width-80,r&&r.height?.75*r.height:50),o=new a.RectangleF(n,s);t.template.bottom=this.drawPageTemplate(new a.PdfPageTemplateElement(o),r)},e.prototype.drawPageTemplate=function(e,i){for(var a=0,r=i.contents;a<r.length;a++){var n=r[a];switch(this.processContentValidation(n),n.type){case"Text":if(""===n.value||(0,t.isNullOrUndefined)(n.value)||"string"!=typeof n.value)throw new Error("please enter the valid input value in text content...");this.drawText(e,n);break;case"PageNumber":this.drawPageNumber(e,n);break;case"Image":if((0,t.isNullOrUndefined)(n.src)||""===n.src)throw new Error("please enter the valid base64 string in image content...");this.drawImage(e,n);break;case"Line":this.drawLine(e,n)}}return e},e.prototype.processContentValidation=function(e){if((0,t.isNullOrUndefined)(e.type))throw new Error("please set valid content type...");if("Line"===e.type){if((0,t.isNullOrUndefined)(e.points))throw new Error("please enter valid points in "+e.type+" content...");if((0,t.isNullOrUndefined)(e.points.x1)||"number"!=typeof e.points.x1)throw new Error("please enter valid x1 co-ordinate in "+e.type+" points...");if((0,t.isNullOrUndefined)(e.points.y1)||"number"!=typeof e.points.y1)throw new Error("please enter valid y1 co-ordinate in "+e.type+" points...");if((0,t.isNullOrUndefined)(e.points.x2)||"number"!=typeof e.points.x2)throw new Error("please enter valid x2 co-ordinate in "+e.type+" points...");if((0,t.isNullOrUndefined)(e.points.y2)||"number"!=typeof e.points.y2)throw new Error("please enter valid y2 co-ordinate in "+e.type+" points...")}else{if((0,t.isNullOrUndefined)(e.position))throw new Error("please enter valid position in "+e.type+" content...");if((0,t.isNullOrUndefined)(e.position.x)||"number"!=typeof e.position.x)throw new Error("please enter valid x co-ordinate in "+e.type+" position...");if((0,t.isNullOrUndefined)(e.position.y)||"number"!=typeof e.position.y)throw new Error("please enter valid y co-ordinate in "+e.type+" position...")}},e.prototype.drawText=function(e,i){var r=this.getFontFromContent(i),n=this.getBrushFromContent(i),s=null;if(!(0,t.isNullOrUndefined)(i.style)&&!(0,t.isNullOrUndefined)(i.style.textPenColor)){var o=this.hexDecToRgb(i.style.textPenColor);s=new a.PdfPen(new a.PdfColor(o.r,o.g,o.b))}null==n&&null==s&&(n=new a.PdfSolidBrush(new a.PdfColor(0,0,0)));var l=i.value.toString(),d=.75*i.position.x,h=.75*i.position.y,p=new a.PdfStringFormat;(0,t.isNullOrUndefined)(i.stringFormat)||(p=i.stringFormat);var u=this.setContentFormat(i,p);null===u||(0,t.isNullOrUndefined)(u.format)||(0,t.isNullOrUndefined)(u.size)?e.graphics.drawString(l,r,s,n,d,h,p):e.graphics.drawString(l,r,s,n,d,h,u.size.width,u.size.height,u.format)},e.prototype.drawPageNumber=function(e,i){var r=this.getFontFromContent(i),n=null;if((0,t.isNullOrUndefined)(i.style)||(0,t.isNullOrUndefined)(i.style.textBrushColor))n=new a.PdfSolidBrush(new a.PdfColor(0,0,0));else{var s=this.hexDecToRgb(i.style.textBrushColor);n=new a.PdfSolidBrush(new a.PdfColor(s.r,s.g,s.b))}var o,l,d=new a.PdfPageNumberField(r,n);if(d.numberStyle=this.getPageNumberStyle(i.pageNumberType),(0,t.isNullOrUndefined)(i.format))l="{0}",o=new a.PdfCompositeField(r,n,l,d);else{var h="$total",p="$current";if(-1!==i.format.indexOf(h)&&-1!==i.format.indexOf(p))(u=new a.PdfPageCountField(r)).numberStyle=this.getPageNumberStyle(i.pageNumberType),l=i.format.indexOf(h)>i.format.indexOf(p)?(l=i.format.replace(p,"0")).replace(h,"1"):(l=i.format.replace(p,"1")).replace(h,"0"),o=new a.PdfCompositeField(r,n,l,d,u);else if(-1!==i.format.indexOf(p)&&-1===i.format.indexOf(h))l=i.format.replace(p,"0"),o=new a.PdfCompositeField(r,n,l,d);else{var u=new a.PdfPageCountField(r);l=i.format.replace(h,"0"),o=new a.PdfCompositeField(r,n,l,u)}}var c=.75*i.position.x,g=.75*i.position.y,m=this.setContentFormat(i,o.stringFormat);null===m||(0,t.isNullOrUndefined)(m.format)||(0,t.isNullOrUndefined)(m.size)||(o.stringFormat=m.format,o.bounds=new a.RectangleF(c,g,m.size.width,m.size.height)),o.draw(e.graphics,c,g)},e.prototype.drawImage=function(e,i){var r=.75*i.position.x,n=.75*i.position.y,s=(0,t.isNullOrUndefined)(i.size)||(0,t.isNullOrUndefined)(i.size.width)?void 0:.75*i.size.width,o=(0,t.isNullOrUndefined)(i.size)||(0,t.isNullOrUndefined)(i.size.height)?void 0:.75*i.size.height,l=new a.PdfBitmap(i.src);(0,t.isNullOrUndefined)(s)?e.graphics.drawImage(l,r,n):e.graphics.drawImage(l,r,n,s,o)},e.prototype.drawLine=function(e,i){var a=.75*i.points.x1,r=.75*i.points.y1,n=.75*i.points.x2,s=.75*i.points.y2,o=this.getPenFromContent(i);(0,t.isNullOrUndefined)(i.style)||((0,t.isNullOrUndefined)(i.style.penSize)||"number"!=typeof i.style.penSize||(o.width=.75*i.style.penSize),o.dashStyle=this.getDashStyle(i.style.dashStyle)),e.graphics.drawLine(o,a,r,n,s)},e.prototype.getFontFromContent=function(e){var i=(0,t.isNullOrUndefined)(e.font)||(0,t.isNullOrUndefined)(e.font.fontSize)?(0,t.isNullOrUndefined)(e.style)||(0,t.isNullOrUndefined)(e.style.fontSize)?9.75:.75*e.style.fontSize:.75*e.font.fontSize,r=(0,t.isNullOrUndefined)(e.font)||(0,t.isNullOrUndefined)(e.font.pdfFontFamily)?a.PdfFontFamily.TimesRoman:e.font.pdfFontFamily,n=a.PdfFontStyle.Regular;return(0,t.isNullOrUndefined)(e.font)||(0,t.isNullOrUndefined)(e.font.bold)||(n|=a.PdfFontStyle.Bold),(0,t.isNullOrUndefined)(e.font)||(0,t.isNullOrUndefined)(e.font.italic)||(n|=a.PdfFontStyle.Italic),(0,t.isNullOrUndefined)(e.font)||(0,t.isNullOrUndefined)(e.font.underline)||(n|=a.PdfFontStyle.Underline),(0,t.isNullOrUndefined)(e.font)||(0,t.isNullOrUndefined)(e.font.strikeout)||(n|=a.PdfFontStyle.Strikeout),new a.PdfStandardFont(r,i,n)},e.prototype.getPenFromContent=function(e){var i=new a.PdfPen(new a.PdfColor(0,0,0));if(!(0,t.isNullOrUndefined)(e.style)&&null!==e.style&&!(0,t.isNullOrUndefined)(e.style.penColor)){var r=this.hexDecToRgb(e.style.penColor);i=new a.PdfPen(new a.PdfColor(r.r,r.g,r.b))}return i},e.prototype.getBrushFromContent=function(e){var i=null;if(!(0,t.isNullOrUndefined)(e.style)&&!(0,t.isNullOrUndefined)(e.style.textBrushColor)){var r=this.hexDecToRgb(e.style.textBrushColor);i=new a.PdfSolidBrush(new a.PdfColor(r.r,r.g,r.b))}return i},e.prototype.setContentFormat=function(e,i){if(!(0,t.isNullOrUndefined)(e.size)){var r=.75*e.size.width,n=.75*e.size.height;if(i=new a.PdfStringFormat(a.PdfTextAlignment.Left,a.PdfVerticalAlignment.Middle),!(0,t.isNullOrUndefined)(e.style)&&!(0,t.isNullOrUndefined)(e.style.hAlign))switch(e.style.hAlign){case"Right":i.alignment=a.PdfTextAlignment.Right;break;case"Center":i.alignment=a.PdfTextAlignment.Center;break;case"Justify":i.alignment=a.PdfTextAlignment.Justify}if(!(0,t.isNullOrUndefined)(e.style)&&!(0,t.isNullOrUndefined)(e.style.vAlign))switch(e.style.vAlign){case"Bottom":i.lineAlignment=a.PdfVerticalAlignment.Bottom;break;case"Top":i.lineAlignment=a.PdfVerticalAlignment.Top}return{format:i,size:new a.SizeF(r,n)}}return null},e.prototype.getPageNumberStyle=function(e){switch(e){case"LowerLatin":return 2;case"LowerRoman":return 3;case"UpperLatin":return 4;case"UpperRoman":return 5;default:return 1}},e.prototype.getDashStyle=function(e){switch(e){case"Dash":return 1;case"Dot":return 2;case"DashDot":return 3;case"DashDotDot":return 4;default:return 0}},e.prototype.hexDecToRgb=function(e){if(null===e||""===e||7!==e.length)throw new Error("please set valid hex value for color..");e=e.substring(1);var t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}},e}(),Zo=function(){function e(e){this.parent=e,this.pdfExportHelper=new Jo}return e.prototype.getModuleName=function(){return"chartExport"},e.prototype.pdfChartExport=function(e,i,r,n){var s=this,o=[this.parent.chart],l=this.getChartInfo(o),d=l.width,h=l.height,p=this.parent.chart.svgObject;this.parent.enableRtl&&l.svg&&l.svg.querySelector("#"+this.parent.element.id+"_chart_svg").setAttribute("direction","rtl"),this.parent.chart.enableCanvas||(p=(0,t.createElement)("canvas",{id:"ej2-canvas",attrs:{width:d.toString(),height:h.toString()}}));var u=window.URL.createObjectURL(new Blob([(new XMLSerializer).serializeToString(l.svg)],{type:"image/svg+xml"})),c=new Image,g=p.getContext("2d");return c.src=u,new Promise((function(o){c.onload=function(){var l;l=(0,t.isNullOrUndefined)(i)?new a.PdfDocument:i,g.drawImage(c,0,0),window.URL.revokeObjectURL(u),s.exportPdf(p,l,r,n,d,h,e),o(l)}}))},e.prototype.getChartInfo=function(e,i){var a,r=0,n=0,s=this.parent.chart.enableCanvas,o=new Xo.SvgRenderer("").createSvg({id:"Svg_Export_Element",width:200,height:200});return e.map((function(e){var l=e.svgObject.cloneNode(!0),d=e.renderer.createGroup({style:(0,t.isNullOrUndefined)(i)||i?"transform: translateY("+n+"px)":"transform: translateX("+r+"px)"});"transparent"===(a=l.childNodes[0]?l.childNodes[0].getAttribute("fill"):"transparent")&&(a=e.theme.indexOf("Dark")>-1||"HighContrast"===e.theme?"rgba(0, 0, 0, 1)":"rgba(255, 255, 255, 1)"),s||d.appendChild(l),r=e.availableSize.width,n=e.availableSize.height,s||o.appendChild(d)})),s||(o.setAttribute("width",r+""),o.setAttribute("height",n+""),o.setAttribute("style","background-color: "+a+";")),{width:r,height:n,svg:o}},e.prototype.exportPdf=function(e,i,r,n,s,o,l){var d=i.sections.add(),h=i.pageSettings.width,p=i.pageSettings.height,u=i.pageSettings.margins,c=s+u.left+u.right;i.pageSettings.size=new a.SizeF(c,p);var g=this.exportProperties.fileName?this.exportProperties.fileName:(0,t.isNullOrUndefined)(l)||(0,t.isNullOrUndefined)(l.fileName)?"default":l.fileName;if(this.exportProperties.width||this.exportProperties.height?(i.pageSettings.orientation=this.exportProperties.width>this.exportProperties.height||!this.exportProperties.height&&this.exportProperties.width>p||!this.exportProperties.width&&h>this.exportProperties.height?a.PdfPageOrientation.Landscape:a.PdfPageOrientation.Portrait,i.pageSettings.size=new a.SizeF(this.exportProperties.width?this.exportProperties.width:h,this.exportProperties.height?this.exportProperties.height:p)):(i.pageSettings.orientation=0===this.exportProperties.orientation||this.exportProperties.orientation?this.exportProperties.orientation:(0,t.isNullOrUndefined)(l)||(0,t.isNullOrUndefined)(l.pageOrientation)||"Landscape"===l.pageOrientation?a.PdfPageOrientation.Landscape:a.PdfPageOrientation.Portrait,(0,t.isNullOrUndefined)(l)||(0,t.isNullOrUndefined)(l.pageSize)||(i.pageSettings.size=Di.getPageSize(l.pageSize))),!(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins)){var m=i.pageSettings.margins;m.top=(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins.top)?m.top:this.exportProperties.pdfMargins.top,m.bottom=(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins.bottom)?m.bottom:this.exportProperties.pdfMargins.bottom,m.left=(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins.left)?m.left:this.exportProperties.pdfMargins.left,m.right=(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins.right)?m.right:this.exportProperties.pdfMargins.right}d.setPageSettings(i.pageSettings),p=i.pageSettings.height;var f=e.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream");f=f.slice(f.indexOf(",")+1);var v,S=new a.PdfBitmap(f),y=d.pages.add();(0,t.isNullOrUndefined)(l)||(0,t.isNullOrUndefined)(l.header)||this.pdfExportHelper.drawHeader(l,i),(0,t.isNullOrUndefined)(l)||(0,t.isNullOrUndefined)(l.footer)||this.pdfExportHelper.drawFooter(l,i),y.graphics.drawImage(S,0,0,p<o||this.exportProperties.width||i.pageSettings.size?y.getClientSize().width:c,p<o?y.getClientSize().height:o),n||r?n&&(v=i.save()):(i.save(g+".pdf"),i.destroy());var b={type:"PDF",promise:n?v:null};return this.parent.trigger(qi,b),new Promise((function(){}))},e.prototype.destroy=function(){this.exportProperties&&(this.exportProperties=null),this.pdfExportHelper&&(this.pdfExportHelper=null)},e}(),$o=v(115),el=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),tl=function(e,t,i,a){var r,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(n<3?r(s):n>3?r(t,i,s):r(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s},il=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return el(i,e),tl([(0,t.Property)(!0)],i.prototype,"showFilterIcon",void 0),tl([(0,t.Property)(!0)],i.prototype,"showSortIcon",void 0),tl([(0,t.Property)(!0)],i.prototype,"showRemoveIcon",void 0),tl([(0,t.Property)(!0)],i.prototype,"showValueTypeIcon",void 0),tl([(0,t.Property)("Both")],i.prototype,"displayMode",void 0),tl([(0,t.Property)(!0)],i.prototype,"allowDragAndDrop",void 0),tl([(0,t.Property)(!1)],i.prototype,"showFieldsPanel",void 0),i}(t.ChildProperty),al=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return el(i,e),tl([(0,t.Property)(!1)],i.prototype,"allowAdding",void 0),tl([(0,t.Property)(!1)],i.prototype,"allowEditing",void 0),tl([(0,t.Property)(!1)],i.prototype,"allowDeleting",void 0),tl([(0,t.Property)(!1)],i.prototype,"allowCommandColumns",void 0),tl([(0,t.Property)(!1)],i.prototype,"allowInlineEditing",void 0),tl([(0,t.Property)("Normal")],i.prototype,"mode",void 0),tl([(0,t.Property)(!0)],i.prototype,"allowEditOnDblClick",void 0),tl([(0,t.Property)(!0)],i.prototype,"showConfirmDialog",void 0),tl([(0,t.Property)(!1)],i.prototype,"showDeleteConfirmDialog",void 0),i}(t.ChildProperty),rl=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return el(i,e),tl([(0,t.Property)()],i.prototype,"measure",void 0),tl([(0,t.Property)()],i.prototype,"label",void 0),tl([(0,t.Property)("NotEquals")],i.prototype,"conditions",void 0),tl([(0,t.Property)()],i.prototype,"value1",void 0),tl([(0,t.Property)()],i.prototype,"value2",void 0),i}(t.ChildProperty),nl=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return el(i,e),tl([(0,t.Property)(!1)],i.prototype,"showHyperlink",void 0),tl([(0,t.Property)(!1)],i.prototype,"showRowHeaderHyperlink",void 0),tl([(0,t.Property)(!1)],i.prototype,"showColumnHeaderHyperlink",void 0),tl([(0,t.Property)(!1)],i.prototype,"showValueCellHyperlink",void 0),tl([(0,t.Property)(!1)],i.prototype,"showSummaryCellHyperlink",void 0),tl([(0,t.Collection)([],rl)],i.prototype,"conditionalSettings",void 0),tl([(0,t.Property)()],i.prototype,"headerText",void 0),tl([(0,t.Property)("")],i.prototype,"cssClass",void 0),i}(t.ChildProperty),sl=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return el(i,e),tl([(0,t.Property)(5)],i.prototype,"columnPageSize",void 0),tl([(0,t.Property)(5)],i.prototype,"rowPageSize",void 0),tl([(0,t.Property)(1)],i.prototype,"currentColumnPage",void 0),tl([(0,t.Property)(1)],i.prototype,"currentRowPage",void 0),i}(t.ChildProperty),ol=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return el(i,e),tl([(0,t.Property)("Bottom")],i.prototype,"position",void 0),tl([(0,t.Property)(!1)],i.prototype,"isInversed",void 0),tl([(0,t.Property)(!0)],i.prototype,"showRowPager",void 0),tl([(0,t.Property)(!0)],i.prototype,"showColumnPager",void 0),tl([(0,t.Property)(!0)],i.prototype,"showRowPageSize",void 0),tl([(0,t.Property)(!0)],i.prototype,"showColumnPageSize",void 0),tl([(0,t.Property)([10,50,100,200])],i.prototype,"rowPageSizes",void 0),tl([(0,t.Property)([5,10,20,50,100])],i.prototype,"columnPageSizes",void 0),tl([(0,t.Property)(!1)],i.prototype,"enableCompactView",void 0),tl([(0,t.Property)()],i.prototype,"template",void 0),i}(t.ChildProperty),ll=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return el(i,e),tl([(0,t.Property)("Table")],i.prototype,"view",void 0),tl([(0,t.Property)("Table")],i.prototype,"primary",void 0),i}(t.ChildProperty),dl=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return el(i,e),tl([(0,t.Property)(!1)],i.prototype,"allowSinglePage",void 0),i}(t.ChildProperty),hl=function(e){function l(i,a){var r=e.call(this,i,a)||this;return r.verticalScrollScale=1,r.horizontalScrollScale=1,r.scrollerBrowserLimit=8e6,r.lastSortInfo={},r.lastFilterInfo={},r.lastAggregationInfo={},r.lastCalcFieldInfo={},r.isScrolling=!1,r.allowEngineExport=!1,r.isInitial=!0,r.shiftLockedPos=[],r.savedSelectedCellsPos=[],r.cellSelectionPos=[],r.isPopupClicked=!1,r.isMouseDown=!1,r.isMouseUp=!1,r.fieldsType={},r.remoteData=[],r.defaultItems={},r.isCellBoxMultiSelection=!1,r.gridCellCollection={},r.rowRangeSelection={enable:!1,startIndex:0,endIndex:0},r.isStaticRefresh=!1,r.isStaticFieldList=!1,r.resizeInfo={},r.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}},r.pivotColumns=[],r.totColWidth=0,r.posCount=0,r.isModified=!1,r.isInitialRendering=!1,r.needsID=!0,r.pivotRefresh=t.Component.prototype.refresh,r.request="undefined"!=typeof window?new XMLHttpRequest:null,r.isServerWaitingPopup=!1,r.actionObj={},r.defaultFieldListOrder="None",r.destroyEngine=!1,r.pivotView=r,(0,t.setValue)("mergePersistData",r.mergePersistPivotData,r),r}return el(l,e),l.prototype.requiredModules=function(){var e=[];return this.showGroupingBar&&e.push({args:[this],member:"groupingBar"}),this.allowConditionalFormatting&&e.push({args:[this],member:"conditionalFormatting"}),this.allowNumberFormatting&&e.push({args:[this],member:"numberFormatting"}),this.allowCalculatedField&&e.push({args:[this],member:"calculatedField"}),this.showToolbar&&(this.toolbar.length>0||this.toolbarTemplate)&&e.push({args:[this],member:"toolbar"}),this.showFieldList&&e.push({args:[this],member:"fieldList"}),this.allowExcelExport&&e.push({args:[this],member:"excelExport"}),this.allowPdfExport&&e.push({args:[this],member:"pdfExport"}),this.enableVirtualization&&e.push({args:[this],member:"virtualscroll"}),this.allowGrouping&&e.push({args:[this],member:"grouping"}),(this.allowDrillThrough||this.editSettings&&this.editSettings.allowEditing)&&e.push({args:[this],member:"drillThrough"}),this.enablePaging&&e.push({args:[this],member:"pager"}),e},l.prototype.preRender=function(){this.dataSourceSettings&&"SSAS"===this.dataSourceSettings.providerType?(this.dataType="olap",this.olapEngineModule=new Ko):(this.dataType="pivot",this.engineModule=new Pi),this.isAdaptive=t.Browser.isDevice,t.Browser.isIE||"edge"===t.Browser.info.name?this.scrollerBrowserLimit=15e5:"chrome"===t.Browser.info.name&&(this.scrollerBrowserLimit=15e6),this.isTouchMode=!!(0,t.closest)(this.element,"e-bigger"),this.initProperties(),this.renderToolTip(),this.keyboardModule=new Xs(this),this.contextMenuModule=new Js(this),this.globalize=new t.Internationalization(this.locale),(this.showFieldList||this.showGroupingBar||this.allowNumberFormatting||this.allowCalculatedField||this.toolbar&&this.showToolbar||this.allowGrouping||this.gridSettings.contextMenuItems||this.allowDrillThrough)&&(this.commonModule=new Es(this)),!this.chartSettings.enableExport||"Both"!==this.displayOption.view&&"Chart"!==this.displayOption.view||(this.chartExportModule=new Zo(this)),this.defaultLocale={applyToGrandTotal:"Apply to Grand Total",grandTotal:"Grand Total",total:"Total",value:"Value",noValue:"No value",row:"Row",column:"Column",collapse:"Collapse",expand:"Expand",rowAxisPrompt:"Drop row here",columnAxisPrompt:"Drop column here",valueAxisPrompt:"Drop value here",filterAxisPrompt:"Drop filter here",filter:"Filter",filtered:"Filtered",sort:"Sort",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",close:"Close",cancel:"Cancel",delete:"Delete",CalculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",alert:"Alert",warning:"Warning",ok:"OK",search:"Search",drag:"Drag",remove:"Remove",allFields:"All Fields",formula:"Formula",addToRow:"Add to Row",addToColumn:"Add to Column",addToValue:"Add to Value",addToFilter:"Add to Filter",emptyData:"No records to display",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",sortAscending:"Sort ascending order",sortDescending:"Sort descending order",sortNone:"Sort data order",clearCalculatedField:"Clear edited field info",editCalculatedField:"Edit calculated field",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",all:"All",multipleItems:"Multiple items",member:"Member",label:"Label",date:"Date",enterValue:"Enter value",chooseDate:"Enter date",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Median:"Median",Min:"Min",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",MoreOption:"More...",NotEquals:"Not Equals",AllValues:"All Values",conditionalFormatting:"Conditional Formatting",apply:"Apply",condition:"Add Condition",formatLabel:"Format",valueFieldSettings:"Value field settings",baseField:"Base field",baseItem:"Base item",summarizeValuesBy:"Summarize values by",sourceName:"Field name :",sourceCaption:"Field caption",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",details:"Details",manageRecords:"Manage Records",Years:"Years",Quarters:"Quarters",Months:"Months",Days:"Days",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds",save:"Save a report",new:"Create a new report",load:"Load",saveAs:"Save as current report",rename:"Rename a current report",deleteReport:"Delete a current report",export:"Export",subTotals:"Sub totals",grandTotals:"Grand totals",reportName:"Report Name :",pdf:"PDF",excel:"Excel",csv:"CSV",png:"PNG",jpeg:"JPEG",svg:"SVG",mdxQuery:"MDX Query",showSubTotals:"Show subtotals",doNotShowSubTotals:"Do not show subtotals",showSubTotalsRowsOnly:"Show subtotals rows only",showSubTotalsColumnsOnly:"Show subtotals columns only",showGrandTotals:"Show grand totals",doNotShowGrandTotals:"Do not show grand totals",showGrandTotalsRowsOnly:"Show grand totals rows only",showGrandTotalsColumnsOnly:"Show grand totals columns only",fieldList:"Show fieldlist",grid:"Show table",toolbarFormatting:"Conditional formatting",chart:"Chart",reportMsg:"Please enter valid report name!!!",reportList:"Report list",removeConfirm:"Are you sure you want to delete this report?",emptyReport:"No reports found!!",bar:"Bar",pie:"Pie",funnel:"Funnel",doughnut:"Doughnut",pyramid:"Pyramid",stackingcolumn:"Stacked Column",stackingarea:"Stacked Area",stackingbar:"Stacked Bar",stackingline:"Stacked Line",stepline:"Step Line",steparea:"Step Area",splinearea:"Spline Area",spline:"Spline",stackingcolumn100:"100% Stacked Column",stackingbar100:"100% Stacked Bar",stackingarea100:"100% Stacked Area",stackingline100:"100% Stacked Line",bubble:"Bubble",pareto:"Pareto",radar:"Radar",line:"Line",area:"Area",scatter:"Scatter",polar:"Polar",of:"of",emptyFormat:"No format found!!!",emptyInput:"Enter a value",newReportConfirm:"Do you want to save the changes to this report?",emptyReportName:"Enter a report name",qtr:"Qtr",null:"null",undefined:"undefined",groupOutOfRange:"Out of Range",fieldDropErrorAction:"The field you are moving cannot be placed in that area of the report",aggregate:"Aggregate",drillThrough:"Drill Through",ascending:"Ascending",descending:"Descending",number:"Number",currency:"Currency",percentage:"Percentage",formatType:"Format Type",customText:"Currency Symbol",symbolPosition:"Symbol Position",left:"Left",right:"Right",grouping:"Grouping",true:"True",false:"False",decimalPlaces:"Decimal Places",numberFormat:"Number Formatting",memberType:"Field Type",formatString:"Format",expressionField:"Expression",customFormat:"Enter custom format string",numberFormatString:"Example: C, P, 0000 %, ###0.##0#, etc.",selectedHierarchy:"Parent Hierarchy",olapDropText:"Example: [Measures].[Order Quantity] + ([Measures].[Order Quantity] * 0.10)",Percent:"Percent",Currency:"Currency",Custom:"Custom",Measure:"Measure",Dimension:"Dimension",Standard:"Standard",blank:"(Blank)",fieldTooltip:'Drag and drop fields to create an expression. And, if you want to edit the existing calculated fields! You can achieve it by simply selecting the field under "Calculated Members".',fieldTitle:"Field Name",QuarterYear:"Quarter Year",drillError:"Cannot show the raw items of calculated fields.",caption:"Field Caption",copy:"Copy",defaultReport:"Sample Report",customFormatString:"Custom Format",invalidFormat:"Invalid Format.",group:"Group",unGroup:"Ungroup",invalidSelection:"Cannot group that selection.",groupName:"Enter the caption to display in header",captionName:"Enter the caption for group field",selectedItems:"Selected items",groupFieldCaption:"Field caption",groupTitle:"Group name",startAt:"Starting at",endAt:"Ending at",groupBy:"Interval by",selectGroup:"Select groups",multipleAxes:"Multiple Axis",showLegend:"Show Legend",exit:"Exit",chartTypeSettings:"Chart Type Settings",ChartType:"Chart Type",yes:"Yes",no:"No",numberFormatMenu:"Number Formatting...",conditionalFormattingMenu:"Conditional Formatting...",removeCalculatedField:"Are you sure you want to delete this calculated field?",replaceConfirmBefore:"A report named ",replaceConfirmAfter:" already exists. Do you want to replace it?",invalidJSON:"Invalid JSON data",invalidCSV:"Invalid CSV data",stacked:"Stacked",single:"Single",combined:"Combined",multipleAxisMode:"Multiple Axis Mode",grandTotalPosition:"Grand totals position",top:"Top",bottom:"Bottom",None:"None",rowPage:"Row pager",rowPerPage:"Rows per page",columnPage:"Column pager",columnPerPage:"Columns per page",goToFirstPage:"Go to first page",goToPreviousPage:"Go to previous page",goToNextPage:"Go to next page",goToLastPage:"Go to last page",subTotalPosition:"Subtotals position",auto:"Auto",loading:"Loading...",add:"Add"},this.localeObj=new t.L10n(this.getModuleName(),this.defaultLocale,this.locale),this.renderContextMenu(),this.isDragging=!1,this.pivotDeferLayoutUpdate=(0,t.isNullOrUndefined)(this.pivotDeferLayoutUpdate)?this.allowDeferLayoutUpdate:this.pivotDeferLayoutUpdate,this.addInternalEvents()},l.prototype.onBeforeTooltipOpen=function(e){e.element.classList.add("e-pivottooltipwrap")},l.prototype.renderToolTip=function(){this.showTooltip?(this.tooltipTemplate?this.tooltip=new Ni.Tooltip({target:"td.e-valuescontent",cssClass:"e-pivottooltiptemplate"+(this.cssClass?" "+this.cssClass:""),showTipPointer:!1,position:"BottomRight",mouseTrail:!0,enableRtl:this.enableRtl,locale:this.locale,enableHtmlSanitizer:this.enableHtmlSanitizer,beforeRender:this.setToolTip.bind(this),beforeOpen:this.onBeforeTooltipOpen}):this.tooltip=new Ni.Tooltip({target:"td.e-valuescontent",cssClass:this.cssClass,showTipPointer:!1,position:"BottomRight",mouseTrail:!0,enableRtl:this.enableRtl,locale:this.locale,enableHtmlSanitizer:this.enableHtmlSanitizer,beforeRender:this.setToolTip.bind(this),beforeOpen:this.onBeforeTooltipOpen}),this.tooltip.isStringTemplate=!0,this.tooltip.appendTo(this.element)):this.tooltip&&this.tooltip.destroy()},l.prototype.renderContextMenu=function(){if(this.gridSettings.contextMenuItems||this.allowGrouping&&"pivot"===this.dataType){var e=[],t=[],i=[],a=[],r=[],n=[],s=[];if(this.gridSettings.contextMenuItems)for(var o=0,l=this.gridSettings.contextMenuItems;o<l.length;o++){var d=l[o];if("string"==typeof d&&-1!==this.getDefaultItems().indexOf(d))if(-1!==d.toString().toLowerCase().indexOf("aggregate")&&"pivot"===this.dataType){s=[{text:this.localeObj.getConstant("Sum")}];var h=this.buildDefaultItems("Aggregate");h.items=s,r.push(h)}else-1!==d.toString().toLowerCase().indexOf("export")?a.push(this.buildDefaultItems(d)):e.push(this.buildDefaultItems(d));else"string"!=typeof d&&i.push(d)}if(this.allowGrouping&&"pivot"===this.dataType&&(this.getFieldByID(this.element.id+"_custom_group",this.gridSettings.contextMenuItems)||t.push(this.buildDefaultItems("Group")),this.getFieldByID(this.element.id+"_custom_ungroup",this.gridSettings.contextMenuItems)||t.push(this.buildDefaultItems("Ungroup"))),a.length>0){var p=this.buildDefaultItems("export");p.items=a,n.push(p)}var u=[];Array.prototype.push.apply(u,r),Array.prototype.push.apply(u,e),Array.prototype.push.apply(u,t),Array.prototype.push.apply(u,n),Array.prototype.push.apply(u,i),this.setProperties({gridSettings:{contextMenuItems:u}},!0)}},l.prototype.getFieldByID=function(e,t){return new i.DataManager({json:t}).executeLocal((new i.Query).where("id","equal",e))[0]},l.prototype.getAllSummaryType=function(){return["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"]},l.prototype.getDefaultItems=function(){return["Drillthrough","Expand","Collapse","Pdf Export","Excel Export","Csv Export","Sort Ascending","Sort Descending","Aggregate","CalculatedField"]},l.prototype.buildDefaultItems=function(e){var t;switch(e){case"Aggregate":t={text:this.localeObj.getConstant("aggregate"),target:"th.e-valuesheader,td.e-valuescontent,.e-stot.e-rowsheader",id:this.element.id+"_aggregate"};break;case"CalculatedField":t={text:this.localeObj.getConstant("CalculatedField"),target:"td.e-valuescontent",id:this.element.id+"_CalculatedField"};break;case"Drillthrough":t={text:this.localeObj.getConstant("drillThrough"),target:"td.e-valuescontent",id:this.element.id+"_drillthrough_menu",iconCss:"e-pivotview-grid "+o};break;case"export":t={text:this.localeObj.getConstant("export"),target:"td.e-valuescontent",id:this.element.id+"_exporting",iconCss:"e-pivotview-export "+o};break;case"Pdf Export":t={text:this.localeObj.getConstant("pdf"),id:this.element.id+"_pdf",iconCss:Wt+" "+o};break;case"Excel Export":t={text:this.localeObj.getConstant("excel"),id:this.element.id+"_excel",iconCss:Qt+" "+o};break;case"Csv Export":t={text:this.localeObj.getConstant("csv"),id:this.element.id+"_csv",iconCss:Yt+" "+o};break;case"Expand":t={text:this.localeObj.getConstant("expand"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_expand",iconCss:"e-pivotview-expand "+o};break;case"Collapse":t={text:this.localeObj.getConstant("collapse"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_collapse",iconCss:"e-pivotview-collapse "+o};break;case"Sort Ascending":t={text:this.localeObj.getConstant("ascending"),target:"th.e-valuesheader,.e-stot",id:this.element.id+"_sortasc",iconCss:"e-icon-ascending "+o};break;case"Sort Descending":t={text:this.localeObj.getConstant("descending"),target:"th.e-valuesheader,.e-stot",id:this.element.id+"_sortdesc",iconCss:"e-icon-descending "+o};break;case"Group":t={text:this.localeObj.getConstant("group"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_custom_group",iconCss:"e-pivotview-group "+o};break;case"Ungroup":t={text:this.localeObj.getConstant("unGroup"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_custom_ungroup",iconCss:"e-pivotview-ungroup "+o}}return this.defaultItems[e]={text:t.text,id:t.id,target:t.target,iconCss:t.iconCss},this.defaultItems[e]},l.prototype.initProperties=function(){this.isTabular="Tabular"===this.gridSettings.layout,this.pivotRefresh=t.Component.prototype.refresh,this.minHeight=(0,t.isNullOrUndefined)(this.minHeight)?300:this.minHeight<10?10:this.minHeight,this.isScrolling=!1,this.allowServerDataBinding=!1,this.isStaticRefresh=!1,this.setProperties({pivotValues:[]},!0),this.allowServerDataBinding=!0,this.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}},this.queryCellInfo=this.gridSettings.queryCellInfo?this.gridSettings.queryCellInfo:void 0,this.headerCellInfo=this.gridSettings.headerCellInfo?this.gridSettings.headerCellInfo:void 0,this.resizing=this.gridSettings.resizing?this.gridSettings.resizing:void 0,this.resizeStop=this.gridSettings.resizeStop?this.gridSettings.resizeStop:void 0,this.pdfHeaderQueryCellInfo=this.gridSettings.pdfHeaderQueryCellInfo?this.gridSettings.pdfHeaderQueryCellInfo:void 0,this.pdfQueryCellInfo=this.gridSettings.pdfQueryCellInfo?this.gridSettings.pdfQueryCellInfo:void 0,this.excelHeaderQueryCellInfo=this.gridSettings.excelHeaderQueryCellInfo?this.gridSettings.excelHeaderQueryCellInfo:void 0,this.excelQueryCellInfo=this.gridSettings.excelQueryCellInfo?this.gridSettings.excelQueryCellInfo:void 0,this.columnDragStart=this.gridSettings.columnDragStart?this.gridSettings.columnDragStart:void 0,this.columnDrag=this.gridSettings.columnDrag?this.gridSettings.columnDrag:void 0,this.columnDrop=this.gridSettings.columnDrop?this.gridSettings.columnDrop:void 0,this.beforeColumnsRender=this.gridSettings.columnRender?this.gridSettings.columnRender:void 0,this.selected=this.gridSettings.cellSelected?this.gridSettings.cellSelected:void 0,this.selecting=this.gridSettings.cellSelecting?this.gridSettings.cellSelecting:void 0,this.cellDeselected=this.gridSettings.cellDeselected?this.gridSettings.cellDeselected:void 0,this.rowSelected=this.gridSettings.rowSelected?this.gridSettings.rowSelected:void 0,this.rowDeselected=this.gridSettings.rowDeselected?this.gridSettings.rowDeselected:void 0,this.chartTooltipRender=this.chartSettings.tooltipRender?this.chartSettings.tooltipRender:void 0,this.chartLegendClick=this.chartSettings.legendClick?this.chartSettings.legendClick:void 0,this.chartLoaded=this.chartSettings.loaded?this.chartSettings.loaded:void 0,this.chartLoad=this.chartSettings.load?this.chartSettings.load:void 0,this.chartResized=this.chartSettings.resized?this.chartSettings.resized:void 0,this.chartAxisLabelRender=this.chartSettings.axisLabelRender?this.chartSettings.axisLabelRender:void 0,this.multiLevelLabelClick=this.chartSettings.multiLevelLabelClick?this.chartSettings.multiLevelLabelClick:void 0,this.chartPointClick=this.chartSettings.pointClick?this.chartSettings.pointClick:void 0,this.contextMenuClick=this.gridSettings.contextMenuClick?this.gridSettings.contextMenuClick:void 0,this.contextMenuOpen=this.gridSettings.contextMenuOpen?this.gridSettings.contextMenuOpen:void 0,this.beforePdfExport=this.gridSettings.beforePdfExport?this.gridSettings.beforePdfExport:void 0,this.beforeExcelExport=this.gridSettings.beforeExcelExport?this.gridSettings.beforeExcelExport:void 0,this.beforePrint=this.chartSettings.beforePrint?this.chartSettings.beforePrint:void 0,this.animationComplete=this.chartSettings.animationComplete?this.chartSettings.animationComplete:void 0,this.legendRender=this.chartSettings.legendRender?this.chartSettings.legendRender:void 0,this.textRender=this.chartSettings.textRender?this.chartSettings.textRender:void 0,this.pointRender=this.chartSettings.pointRender?this.chartSettings.pointRender:void 0,this.seriesRender=this.chartSettings.seriesRender?this.chartSettings.seriesRender:void 0,this.chartMouseMove=this.chartSettings.chartMouseMove?this.chartSettings.chartMouseMove:void 0,this.chartMouseClick=this.chartSettings.chartMouseClick?this.chartSettings.chartMouseClick:void 0,this.pointMove=this.chartSettings.pointMove?this.chartSettings.pointMove:void 0,this.chartMouseLeave=this.chartSettings.chartMouseLeave?this.chartSettings.chartMouseLeave:void 0,this.chartMouseDown=this.chartSettings.chartMouseDown?this.chartSettings.chartMouseDown:void 0,this.chartMouseUp=this.chartSettings.chartMouseUp?this.chartSettings.chartMouseUp:void 0,this.dragComplete=this.chartSettings.dragComplete?this.chartSettings.dragComplete:void 0,this.zoomComplete=this.chartSettings.zoomComplete?this.chartSettings.zoomComplete:void 0,this.scrollStart=this.chartSettings.scrollStart?this.chartSettings.scrollStart:void 0,this.scrollEnd=this.chartSettings.scrollEnd?this.chartSettings.scrollEnd:void 0,this.scrollChanged=this.chartSettings.scrollChanged?this.chartSettings.scrollChanged:void 0,this.multiLevelLabelRender=this.chartSettings.multiLevelLabelRender?this.chartSettings.multiLevelLabelRender:void 0,null===this.gridSettings.rowHeight&&(this.isTouchMode?this.setProperties({gridSettings:{rowHeight:36}},!0):this.setProperties({gridSettings:{rowHeight:this.isAdaptive?36:30}},!0)),this.chartSettings&&this.chartSettings.showMemberSeries&&!this.chartSettings.showPointColorByMembers&&this.setProperties({chartSettings:{showPointColorByMembers:!0}},!0),this.element.style.height="100%",this.enableVirtualization&&this.updatePageSettings(!0),this.isCellBoxMultiSelection=this.gridSettings.allowSelection&&"Box"===this.gridSettings.selectionSettings.cellSelectionMode&&"Cell"===this.gridSettings.selectionSettings.mode&&"Multiple"===this.gridSettings.selectionSettings.type,this.allowGrouping&&!this.isCellBoxMultiSelection&&(this.isCellBoxMultiSelection=!0,this.setProperties({gridSettings:{allowSelection:!0,selectionSettings:{cellSelectionMode:"Box",mode:"Cell",type:"Multiple"}}},!0)),"Table"!==this.displayOption.view&&(this.pivotChartModule=new io(this)),this.currentView=this.currentView?this.currentView:"Both"===this.displayOption.view?this.displayOption.primary:this.displayOption.view},l.prototype.updatePageSettings=function(e){if(this.enableVirtualization){var t=1,i=1;this.dataSourceSettings.values.length>1&&"pivot"===this.dataType&&("row"===this.dataSourceSettings.valueAxis?i=this.dataSourceSettings.values.length:t=this.dataSourceSettings.values.length);var a=this.getHeightAsNumber();isNaN(a)&&(a=this.element.offsetHeight),this.pageSettings={currentColumnPage:e?1:this.pageSettings.currentColumnPage,currentRowPage:e?1:this.pageSettings.currentRowPage,columnPageSize:Math.ceil((Math.floor(this.getWidthAsNumber()/this.gridSettings.columnWidth)-1)/t),rowPageSize:Math.ceil(Math.floor(a/this.gridSettings.rowHeight)/i)}}},l.prototype.render=function(){this.loadData()},l.prototype.loadData=function(){if(this.dataSourceSettings.formatSettings.length>0)for(var e=this.dataSourceSettings.formatSettings,i=0;i<e.length;i++)(0,t.isNullOrUndefined)(e[i].maximumFractionDigits)&&(0,t.isNullOrUndefined)(e[i].minimumFractionDigits)||null!==e[i].format.match(/^(P|N|C|P[0-9]|C[0-9]|N[0-9])$/g)||(e[i].maximumFractionDigits=void 0,e[i].minimumIntegerDigits=void 0);"pivot"===this.dataType&&this.dataSourceSettings.url&&""!==this.dataSourceSettings.url?"Server"===this.dataSourceSettings.mode?(this.guid=Di.generateUUID(),this.initialLoad(),"Chart"!==this.displayOption.view?this.renderEmptyGrid():this.refreshData(),this.showWaitingPopup()):new t.Fetch(this.dataSourceSettings.url,"GET").send().then((function(e){return"string"==typeof e?e:e.text()})).then(this.onReadyStateChange.bind(this)):this.initialLoad()},l.prototype.onSuccess=function(e){if(this.request.readyState===XMLHttpRequest.DONE)if("onExcelExport"===this.currentAction||"onCsvExport"===this.currentAction){if(200===this.request.status){var i=this.request.response,a=(0,t.isNullOrUndefined)(e.fileName)?"onExcelExport"===this.currentAction?"default.xlsx":"default.csv":e.fileName;$o.Save.save(a,i)}}else{this.isServerWaitingPopup=!0;try{var r={action:this.currentAction,response:this.request.responseText};this.trigger(sr,r);var n=JSON.parse(this.request.responseText);if("fetchFieldMembers"===this.currentAction){for(var s=JSON.parse(n.members),o=[],l={},d=Di.isDateField(n.memberName,this.engineModule),h="number"===this.engineModule.fieldList[n.memberName].type,p=Object.keys(s),u=0,c=p.length;u<c;u++){var g=s[p[u]],m=d?this.engineModule.getFormattedValue(g.Name,n.memberName):{formattedText:g.Caption};l[p[u]]={index:g.Index,ordinal:g.Ordinal,isDrilled:g.IsDrilled,caption:m.formattedText},o.push({formattedText:m.formattedText,actualText:d?m.actualText:h?isNaN(Number(g.Name))?g.Name:Number(g.Name):g.Name})}this.engineModule.fieldList[n.memberName].members=l,this.engineModule.fieldList[n.memberName].dateMember=o,this.showGroupingBar?this.pivotButtonModule.updateFilterEvents():this.pivotFieldListModule.pivotButtonModule.updateFilterEvents()}else if("fetchRawData"===this.currentAction){for(var f=this.engineModule.fieldList[this.drillThroughValue.actualText.toString()]?this.engineModule.fieldList[this.drillThroughValue.actualText.toString()].caption:this.drillThroughValue.actualText.toString(),v=this.engineModule.fieldList[this.drillThroughValue.actualText]?this.engineModule.fieldList[this.drillThroughValue.actualText].aggregateType:"",S=JSON.parse(n.rawData),y=JSON.parse(n.indexObject),b={},C=0;C<y.length;C++)b[y[C].Key]=y[C].Value;this.drillThroughValue.indexObject=b,this.drillThroughModule.triggerDialog(f,v,S,this.drillThroughValue,this.drillThroughElement),this.hideWaitingPopup()}else{var x=JSON.parse(n.fieldList);if(this.engineModule.fieldList)for(p=Object.keys(this.engineModule.fieldList),u=0;u<p.length;u++)this.engineModule.fieldList[p[u]]&&x[p[u]]&&(x[p[u]].dateMember=this.engineModule.fieldList[p[u]].dateMember,x[p[u]].formattedMembers=this.engineModule.fieldList[p[u]].formattedMembers,x[p[u]].members=this.engineModule.fieldList[p[u]].members);this.engineModule.fieldList=x,this.engineModule.fields=JSON.parse(n.fields),this.engineModule.rowCount=JSON.parse(n.pivotCount).RowCount,this.engineModule.columnCount=JSON.parse(n.pivotCount).ColumnCount,this.engineModule.rowStartPos=JSON.parse(n.pivotCount).RowStartPosition,this.engineModule.colStartPos=JSON.parse(n.pivotCount).ColumnStartPosition,this.engineModule.rowFirstLvl=JSON.parse(n.pivotCount).RowFirstLevel,this.engineModule.colFirstLvl=JSON.parse(n.pivotCount).ColumnFirstLevel,this.engineModule.columnPageCount=JSON.parse(n.pivotCount).ColumnPageCount,this.engineModule.rowPageCount=JSON.parse(n.pivotCount).RowPageCount;for(var w=void 0,T=JSON.parse(n.pivotValue),M=0;M<T.length;M++)if(T[M]&&T[M][0]&&"row"===T[M][0].axis){w=M;break}this.engineModule.headerContent=Di.frameContent(T,"header",w,this),this.engineModule.pageSettings=this.pageSettings;var D=JSON.parse(n.dataSourceSettings);this.dataSourceSettings.groupSettings.length>0&&(this.setProperties({dataSourceSettings:{rows:D.rows}},!0),this.setProperties({dataSourceSettings:{columns:D.columns}},!0),this.setProperties({dataSourceSettings:{formatSettings:D.formatSettings}},!0));var O=D.valueSortSettings;this.engineModule.valueSortSettings={headerText:O.headerText,headerDelimiter:O.headerDelimiter,sortOrder:O.sortOrder,columnIndex:O.columnIndex},this.engineModule.pivotValues=T,this.engineModule.isEmptyData=n.isEmptyData,this.engineModule.isEngineUpdated=n.isEngineUpdated;for(var P=0,N=this.dataSourceSettings.values;P<N.length;P++){var E=N[P];this.engineModule.valueAxisFields[E.name]=E}this.engineModule.globalize=(0,t.isNullOrUndefined)(this.globalize)?new t.Internationalization:this.globalize,this.engineModule.formatFields=this.engineModule.setFormattedFields(this.dataSourceSettings.formatSettings)}}catch(e){this.engineModule.pivotValues=[]}if("onScroll"===this.currentAction)if("vertical"===this.scrollDirection){var I="row"===this.dataSourceSettings.valueAxis?this.dataSourceSettings.values.length:1,F=this.pageSettings.rowPageSize*I*this.gridSettings.rowHeight*Math.ceil(this.engineModule.rowStartPos/(this.pageSettings.rowPageSize*I))-this.engineModule.rowFirstLvl*I*this.gridSettings.rowHeight;this.scrollPosObject.verticalSection=F}else if("horizondal"===this.scrollDirection){var L="column"===this.dataSourceSettings.valueAxis?this.dataSourceSettings.values.length:1;F=this.pageSettings.columnPageSize*L*this.gridSettings.columnWidth*Math.ceil(this.engineModule.colStartPos/(this.pageSettings.columnPageSize*L))-this.engineModule.colFirstLvl*L*this.gridSettings.columnWidth;this.scrollPosObject.horizontalSection=F}"fetchFieldMembers"!==this.currentAction&&"fetchRawData"!==this.currentAction&&(this.initEngine(),this.calculatedFieldModule&&this.calculatedFieldModule.isRequireUpdate&&(this.calculatedFieldModule.endDialog(),this.calculatedFieldModule.isRequireUpdate=!1),this.pivotFieldListModule&&this.pivotFieldListModule.calculatedFieldModule&&this.pivotFieldListModule.calculatedFieldModule.isRequireUpdate&&(this.pivotFieldListModule.calculatedFieldModule.endDialog(),this.pivotFieldListModule.calculatedFieldModule.isRequireUpdate=!1))}},l.prototype.getEngine=function(e,t,i,a,r,n,s,o,l,d){var h=this;this.engineModule.isEmptyData=!1,this.element.querySelector(".e-spin-hide")&&"onExcelExport"!==e&&"onCsvExport"!==e&&this.showWaitingPopup(),this.currentAction=e,this.isServerWaitingPopup=!1;var p={pageSettings:JSON.parse(this.getPageSettings()).pageSettings,enableValueSorting:this.enableValueSorting,enablePaging:this.enablePaging,enableVirtualization:this.enableVirtualization,allowDataCompression:this.allowDataCompression,enableDrillThrough:this.allowDrillThrough||this.editSettings.allowEditing,locale:JSON.stringify(Di.getLocalizedObject(this)),savedFieldList:"onDrop"===e&&null!==this.engineModule.fieldList?Di.getClonedFieldList(this.engineModule.fieldList,!0):void 0,enableOptimizedRendering:this.enableVirtualization&&this.virtualScrollSettings&&this.virtualScrollSettings.allowSinglePage,requestType:"string",headers:{"Content-type":"application/json"}};this.request.readyState!==XMLHttpRequest.UNSENT&&this.request.readyState!==XMLHttpRequest.OPENED||(this.request.withCredentials=!1);var u={request:this.request,dataSourceSettings:JSON.parse(this.getPersistData()).dataSourceSettings,action:e,customProperties:{},internalProperties:p,drillItem:t,sortItem:i,aggregatedItem:a,calculatedItem:r,filterItem:n,memberName:s,fetchRawDataArgs:o,editArgs:l,hash:this.guid,excelExportProperties:d,exportAllPages:this.exportAllPages,isGroupingUpdated:"onRefresh"===this.currentAction&&this.dataSourceSettings.groupSettings.length>0||!!this.groupingModule&&this.groupingModule.isUpdate};this.trigger(nr,u,(function(e){h.request=e.request,u.internalProperties=e.internalProperties,u.customProperties=e.customProperties,u.dataSourceSettings=e.dataSourceSettings,u.calculatedItem=e.calculatedItem,u.drillItem=e.drillItem,u.editArgs=e.editArgs,u.fetchRawDataArgs=e.fetchRawDataArgs,u.filterItem=e.filterItem,u.hash=e.hash,u.memberName=e.memberName,u.sortItem=e.sortItem,u.excelExportProperties=e.excelExportProperties,u.exportAllPages=e.exportAllPages})),this.request.open("POST",this.dataSourceSettings.url,!0),this.request.onreadystatechange=this.onSuccess.bind(this,u.excelExportProperties),"onExcelExport"===u.action||"onCsvExport"===u.action?this.request.responseType="blob":this.request.responseType="";for(var c=Object.keys(u.internalProperties.headers),g=0;g<c.length;g++){var m=c[g],f=String(u.internalProperties.headers[m]);this.request.setRequestHeader(m,f)}"string"===u.internalProperties.requestType?this.request.send(JSON.stringify(u)):"base64"===u.internalProperties.requestType&&this.request.send(btoa(JSON.stringify(u)))},l.prototype.getChartSettings=function(){var e=this.chartSettings.load,t=this.chartSettings.loaded,i=this.chartSettings.textRender,a=this.chartSettings.pointRender,r=this.chartSettings.seriesRender,n=this.chartSettings.legendRender,s=this.chartSettings.pointClick,o=this.chartSettings.tooltipRender,l=this.chartSettings.legendClick,d=this.chartSettings.multiLevelLabelRender,h=this.chartSettings.beforePrint,p=this.chartSettings.animationComplete,u=this.chartSettings.chartMouseMove,c=this.chartSettings.chartMouseClick,g=this.chartSettings.pointMove,m=this.chartSettings.chartMouseLeave,f=this.chartSettings.chartMouseDown,v=this.chartSettings.chartMouseUp,S=this.chartSettings.dragComplete,y=this.chartSettings.zoomComplete,b=this.chartSettings.scrollStart,C=this.chartSettings.scrollEnd,x=this.chartSettings.scrollChanged;this.chartSettings.load=void 0,this.chartSettings.loaded=void 0,this.chartSettings.textRender=void 0,this.chartSettings.pointRender=void 0,this.chartSettings.seriesRender=void 0,this.chartSettings.legendRender=void 0,this.chartSettings.pointClick=void 0,this.chartSettings.tooltipRender=void 0,this.chartSettings.legendClick=void 0,this.chartSettings.multiLevelLabelRender=void 0,this.chartSettings.beforePrint=void 0,this.chartSettings.animationComplete=void 0,this.chartSettings.chartMouseMove=void 0,this.chartSettings.chartMouseClick=void 0,this.chartSettings.pointMove=void 0,this.chartSettings.chartMouseLeave=void 0,this.chartSettings.chartMouseDown=void 0,this.chartSettings.chartMouseUp=void 0,this.chartSettings.dragComplete=void 0,this.chartSettings.zoomComplete=void 0,this.chartSettings.scrollStart=void 0,this.chartSettings.scrollEnd=void 0,this.chartSettings.scrollChanged=void 0;var w=this.addOnPersist(["chartSettings"]);return this.chartSettings.load=e,this.chartSettings.loaded=t,this.chartSettings.textRender=i,this.chartSettings.pointRender=a,this.chartSettings.seriesRender=r,this.chartSettings.legendRender=n,this.chartSettings.pointClick=s,this.chartSettings.tooltipRender=o,this.chartSettings.legendClick=l,this.chartSettings.multiLevelLabelRender=d,this.chartSettings.beforePrint=h,this.chartSettings.animationComplete=p,this.chartSettings.chartMouseMove=u,this.chartSettings.chartMouseClick=c,this.chartSettings.pointMove=g,this.chartSettings.chartMouseLeave=m,this.chartSettings.chartMouseDown=f,this.chartSettings.chartMouseUp=v,this.chartSettings.dragComplete=S,this.chartSettings.zoomComplete=y,this.chartSettings.scrollStart=b,this.chartSettings.scrollEnd=C,this.chartSettings.scrollChanged=x,w},l.prototype.getPageSettings=function(){return this.addOnPersist(["pageSettings"])},l.prototype.onReadyStateChange=function(e){var i=[];if("CSV"===this.dataSourceSettings.type)for(var a=e.split(/\r?\n|\r/),r=0;r<a.length;r++)(0,t.isNullOrUndefined)(a[r])||""===a[r]||i.push(a[r].split(","));else try{i=JSON.parse(e)}catch(e){i=[]}i&&i.length>0&&this.setProperties({dataSourceSettings:{dataSource:i}},!0),this.initialLoad()},l.prototype.initialLoad=function(){var e=this;try{this.cellTemplateFn=this.templateParser(this.cellTemplate),this.tooltipTemplateFn=this.templateParser(this.tooltipTemplate),this.spinnerTemplate?(0,Ni.createSpinner)({target:this.element,template:this.spinnerTemplate,cssClass:this.cssClass?this.cssClass:void 0},this.createElement):(0,Ni.createSpinner)({target:this.element,cssClass:this.cssClass?this.cssClass:void 0},this.createElement);var t={dataSourceSettings:this.dataSourceSettings,pivotview:this,fieldsType:{},defaultFieldListOrder:this.defaultFieldListOrder};this.trigger(Ei,t,(function(i){e.dataSourceSettings=i.dataSourceSettings,e.fieldsType=i.fieldsType,e.defaultFieldListOrder=t.defaultFieldListOrder,e.updateClass(),e.notify(vr,{}),e.notify(hr,{}),e.isAdaptive&&e.contextMenuModule.render(),e.notify(xr,{}),e.notify(wr,{})}))}catch(e){this.actionFailureMethod(e)}},l.prototype.addInternalEvents=function(){this.on(hr,this.generateData,this),this.on(fr,this.renderPivotGrid,this),this.on(mr,this.onContentReady,this)},l.prototype.removeInternalEvents=function(){this.off(hr,this.generateData),this.off(fr,this.renderPivotGrid),this.off(mr,this.onContentReady)},l.prototype.getPersistData=function(e){var t=this.gridSettings.columnRender,a=this.gridSettings.excelQueryCellInfo,r=this.gridSettings.excelHeaderQueryCellInfo,n=this.gridSettings.pdfQueryCellInfo,s=this.gridSettings.pdfHeaderQueryCellInfo,o=this.chartSettings.load,l=this.chartSettings.loaded,d=this.chartSettings.textRender,h=this.chartSettings.pointRender,p=this.chartSettings.seriesRender,u=this.chartSettings.legendRender,c=this.chartSettings.pointClick,g=this.chartSettings.tooltipRender,m=this.chartSettings.legendClick,f=this.chartSettings.multiLevelLabelRender,v=this.chartSettings.beforePrint,S=this.chartSettings.animationComplete,y=this.chartSettings.chartMouseMove,b=this.chartSettings.chartMouseClick,C=this.chartSettings.pointMove,x=this.chartSettings.chartMouseLeave,w=this.chartSettings.chartMouseDown,T=this.chartSettings.chartMouseUp,M=this.chartSettings.dragComplete,D=this.chartSettings.zoomComplete,O=this.chartSettings.scrollStart,P=this.chartSettings.scrollEnd,N=this.chartSettings.scrollChanged;this.gridSettings.columnRender=void 0,this.gridSettings.excelQueryCellInfo=void 0,this.gridSettings.excelHeaderQueryCellInfo=void 0,this.gridSettings.pdfQueryCellInfo=void 0,this.gridSettings.pdfHeaderQueryCellInfo=void 0,this.chartSettings.tooltipRender=void 0,this.chartSettings.legendClick=void 0,this.chartSettings.multiLevelLabelRender=void 0,this.chartSettings.load=void 0,this.chartSettings.loaded=void 0,this.chartSettings.textRender=void 0,this.chartSettings.pointRender=void 0,this.chartSettings.seriesRender=void 0,this.chartSettings.legendRender=void 0,this.chartSettings.pointClick=void 0,this.chartSettings.beforePrint=void 0,this.chartSettings.animationComplete=void 0,this.chartSettings.chartMouseMove=void 0,this.chartSettings.chartMouseClick=void 0,this.chartSettings.pointMove=void 0,this.chartSettings.chartMouseLeave=void 0,this.chartSettings.chartMouseDown=void 0,this.chartSettings.chartMouseUp=void 0,this.chartSettings.dragComplete=void 0,this.chartSettings.zoomComplete=void 0,this.chartSettings.scrollStart=void 0,this.chartSettings.scrollEnd=void 0,this.chartSettings.scrollChanged=void 0;var E=[];e&&(E=!this.dataSourceSettings.dataSource||this.dataSourceSettings.dataSource instanceof i.DataManager?this.dataSourceSettings.dataSource:this.dataSourceSettings.dataSource.slice(),this.setProperties({dataSourceSettings:{dataSource:[]}},!0));var I=this.addOnPersist(["dataSourceSettings","pivotValues","gridSettings","chartSettings","displayOption","pageSettings"]);return this.gridSettings.columnRender=t,this.gridSettings.excelQueryCellInfo=a,this.gridSettings.excelHeaderQueryCellInfo=r,this.gridSettings.pdfQueryCellInfo=n,this.gridSettings.pdfHeaderQueryCellInfo=s,this.chartSettings.load=o,this.chartSettings.loaded=l,this.chartSettings.textRender=d,this.chartSettings.pointRender=h,this.chartSettings.seriesRender=p,this.chartSettings.legendRender=u,this.chartSettings.pointClick=c,this.chartSettings.tooltipRender=g,this.chartSettings.legendClick=m,this.chartSettings.multiLevelLabelRender=f,this.chartSettings.beforePrint=v,this.chartSettings.animationComplete=S,this.chartSettings.chartMouseMove=y,this.chartSettings.chartMouseClick=b,this.chartSettings.pointMove=C,this.chartSettings.chartMouseLeave=x,this.chartSettings.chartMouseDown=w,this.chartSettings.chartMouseUp=T,this.chartSettings.dragComplete=M,this.chartSettings.zoomComplete=D,this.chartSettings.scrollStart=O,this.chartSettings.scrollEnd=P,this.chartSettings.scrollChanged=N,e&&this.setProperties({dataSourceSettings:{dataSource:E}},!0),I},l.prototype.loadPersistData=function(e){var t=JSON.parse(e);this.allowServerDataBinding=!1,this.setProperties({gridSettings:t.gridSettings,pivotValues:t.pivotValues,chartSettings:t.chartSettings,displayOption:t.displayOption},!0),"Chart"===t.displayOption.primary?this.currentView="Chart":this.currentView="Table",this.allowServerDataBinding=!0,this.dataSourceSettings&&this.dataSourceSettings.dataSource&&this.dataSourceSettings.dataSource instanceof i.DataManager&&t.dataSourceSettings&&t.dataSourceSettings.dataSource&&t.dataSourceSettings.dataSource.dataSource&&this.dataSourceSettings.dataSource.dataSource&&t.dataSourceSettings.dataSource.dataSource.url===this.dataSourceSettings.dataSource.dataSource.url&&(t.dataSourceSettings.dataSource=this.dataSourceSettings.dataSource),this.dataSourceSettings=t.dataSourceSettings},l.prototype.mergePersistPivotData=function(){var e=window.localStorage.getItem(this.getModuleName()+this.element.id);if(!(0,t.isNullOrUndefined)(e)&&""!==e){var a=JSON.parse(e);this.dataSourceSettings&&this.dataSourceSettings.dataSource&&this.dataSourceSettings.dataSource instanceof i.DataManager&&a.dataSourceSettings&&a.dataSourceSettings.dataSource&&a.dataSourceSettings.dataSource.dataSource&&this.dataSourceSettings.dataSource.dataSource&&a.dataSourceSettings.dataSource.dataSource.url===this.dataSourceSettings.dataSource.dataSource.url&&(a.dataSourceSettings.dataSource=this.dataSourceSettings.dataSource),this.setProperties(a,!0)}},l.prototype.showConditionalFormattingDialog=function(){this.conditionalFormattingModule&&this.conditionalFormattingModule.showConditionalFormattingDialog()},l.prototype.createCalculatedFieldDialog=function(){this.calculatedFieldModule&&this.calculatedFieldModule.createCalculatedFieldDialog()},l.prototype.getModuleName=function(){return"pivotview"},l.prototype.copy=function(e){this.grid.copy(e)},l.prototype.onPropertyChanged=function(i,a){for(var r=!1,n=0,s=Object.keys(i);n<s.length;n++){var o=s[n];switch(o){case"dataSourceSettings":case"hyperlinkSettings":case"allowDrillThrough":case"editSettings":case"allowDataCompression":if(i.dataSourceSettings&&(!(0,t.isNullOrUndefined)(i.dataSourceSettings.dataSource)&&!(0,t.isNullOrUndefined)(this.clonedDataSet)&&this.clonedDataSet!==i.dataSourceSettings.dataSource&&!(0,t.isNullOrUndefined)(i.dataSourceSettings.groupSettings)&&i.dataSourceSettings.groupSettings.length>0||1===Object.keys(i.dataSourceSettings).length&&"dataSource"===Object.keys(i.dataSourceSettings)[0]&&this.dataSourceSettings.groupSettings.length>0)&&(this.clonedDataSet=i.dataSourceSettings.dataSource,this.engineModule.groupingFields={}),i.dataSourceSettings&&1===Object.keys(i.dataSourceSettings).length&&i.dataSourceSettings.groupSettings&&"pivot"===this.dataType&&this.updateGroupingReport(i.dataSourceSettings.groupSettings,"Date"),((0,t.isNullOrUndefined)(i.dataSourceSettings)?[]:Object.keys(i.dataSourceSettings)).indexOf("dataSource")>-1&&"CSV"!==i.dataSourceSettings.type)!(0,t.isNullOrUndefined)(this.savedDataSourceSettings)&&this.dataSourceSettings.dataSource.length>0&&(Di.updateDataSourceSettings(this,this.savedDataSourceSettings),this.savedDataSourceSettings=void 0),i.dataSourceSettings.dataSource&&0===i.dataSourceSettings.dataSource.length&&(this.savedDataSourceSettings=Di.getClonedDataSourceSettings(this.dataSourceSettings),this.setProperties({dataSourceSettings:{rows:[]}},!0),this.setProperties({dataSourceSettings:{columns:[]}},!0),this.setProperties({dataSourceSettings:{values:[]}},!0),this.setProperties({dataSourceSettings:{filters:[]}},!0)),this.isStaticRefresh||(this.pivotValues=[],"pivot"===this.dataType?(this.engineModule.fieldList=null,this.engineModule.isEmptyData=!0,this.engineModule.data=[],this.engineModule.groupingFieldsInfo={}):"olap"===this.dataType&&(this.olapEngineModule.fieldList={},this.olapEngineModule.fieldListData=void 0,this.olapEngineModule.isEmptyData=!0)),this.showWaitingPopup(),this.notify(hr,{});else if(Di.isButtonIconRefesh(o,a,i)){if(this.showGroupingBar&&this.groupingBarModule&&this.axisFieldModule.render(),this.showFieldList&&this.pivotFieldListModule){var l=Di.cloneFieldSettings(this.dataSourceSettings.rows),d=Di.cloneFieldSettings(this.dataSourceSettings.columns),h=Di.cloneFieldSettings(this.dataSourceSettings.values),p=Di.cloneFieldSettings(this.dataSourceSettings.filters);this.pivotFieldListModule.setProperties({dataSourceSettings:{rows:l,columns:d,values:h,filters:p}},!0),this.pivotFieldListModule.axisFieldModule.render(),this.pivotFieldListModule.treeViewModule.fieldTable&&!this.isAdaptive&&this.pivotFieldListModule.notify(Sr,{})}}else this.remoteData=[],"pivot"===this.dataType&&this.dataSourceSettings.url&&""!==this.dataSourceSettings.url&&!(0,t.isNullOrUndefined)(i.dataSourceSettings)&&("type"in i.dataSourceSettings||"url"in i.dataSourceSettings)?(this.engineModule.fieldList=null,this.loadData()):(i.dataSourceSettings&&("pivot"===this.dataType&&"dataSource"in i.dataSourceSettings||"olap"===this.dataType&&"url"in i.dataSourceSettings)&&(this.isStaticRefresh||("pivot"===this.dataType?(this.engineModule.fieldList=null,this.engineModule.isEmptyData=!0,this.engineModule.data=[],this.engineModule.groupingFieldsInfo={}):"olap"===this.dataType&&(this.olapEngineModule.fieldList={},this.olapEngineModule.fieldListData=void 0,this.olapEngineModule.isEmptyData=!0),this.pivotValues=[])),this.notify(hr,{}));break;case"height":case"width":this.layoutRefresh();break;case"pivotValues":case"displayOption":if(i.displayOption&&1===Object.keys(i.displayOption).length&&i.displayOption.view)switch(this.currentView="Both"===i.displayOption.view?this.displayOption.primary:i.displayOption.view,(this.showGroupingBar||this.showFieldList)&&(this.showFieldList&&this.pivotFieldListModule&&(this.pivotFieldListModule.destroyEngine=!0,this.pivotFieldListModule.destroy(),null!==(0,t.select)("#"+this.element.id+"_PivotFieldList",this.element)&&(0,t.remove)((0,t.select)("#"+this.element.id+"_PivotFieldList",this.element)),this.pivotFieldListModule.destroyEngine=!1),this.notify(vr,this)),i.displayOption.view){case"Both":this.pivotChartModule||(this.pivotChartModule=new io(this)),this.grid||this.renderEmptyGrid();break;case"Chart":this.grid&&(this.grid.destroy(),this.grid=void 0),this.pivotChartModule||(this.pivotChartModule=new io(this));break;case"Table":this.grid||this.renderEmptyGrid(),this.pivotChartModule&&(this.destroyEngine=!0,this.pivotChartModule.destroy(),this.destroyEngine=!1,this.chart=void 0,this.pivotChartModule=void 0)}else this.showToolbar&&!(0,t.isNullOrUndefined)(i.displayOption)&&i.displayOption.view&&(this.currentView="Both"===i.displayOption.view?this.displayOption.primary:i.displayOption.view);if(this.showToolbar&&!(0,t.isNullOrUndefined)(i.displayOption)&&i.displayOption.view)if("Chart"===i.displayOption.view)this.toolbarModule.createChartMenu(),this.toggleButtonState(Zt,"add"),this.toggleButtonState($t,"remove");else if("Table"===i.displayOption.view){(0,t.select)("#"+this.element.id+"_grid",this.element).style.display="block",this.toggleButtonState($t,"add"),this.toggleButtonState(Zt,"remove")}else this.toolbarModule.createChartMenu(),this.toggleButtonState(Zt,"remove"),this.toggleButtonState($t,"remove");var u="pivot"===this.dataType?this.engineModule:this.olapEngineModule;(0,t.isNullOrUndefined)(u.fieldList)&&(0,t.isNullOrUndefined)(u.pivotValues)||this.notify(fr,{});break;case"gridSettings":this.isTabular="Tabular"===this.gridSettings.layout,this.lastGridSettings=i.gridSettings,this.isCellBoxMultiSelection=this.gridSettings.allowSelection&&"Box"===this.gridSettings.selectionSettings.cellSelectionMode&&"Cell"===this.gridSettings.selectionSettings.mode&&"Multiple"===this.gridSettings.selectionSettings.type,this.allowGrouping&&this.groupingModule&&!this.isCellBoxMultiSelection&&(this.setProperties({gridSettings:{allowSelection:!0,selectionSettings:{cellSelectionMode:"Box",mode:"Cell",type:"Multiple"}}},!0),this.isCellBoxMultiSelection=!0),this.renderModule&&this.grid&&this.renderModule.updateGridSettings(),i.gridSettings.layout&&this.initialLoad();break;case"chartSettings":this.showGroupingBar&&this.groupingBarModule&&(-1!==Object.keys(i.chartSettings).indexOf("enableMultipleAxis")||i.chartSettings.chartSeries&&-1!==Object.keys(i.chartSettings.chartSeries).indexOf("type"))&&(this.groupingBarModule.renderLayout(),this.pivotChartModule&&this.groupingBarModule.appendToElement()),(0,t.isNullOrUndefined)(this.pivotChartModule)&&"Table"!==this.displayOption.view&&(this.pivotChartModule=new io(this));var c="pivot"===this.dataType?this.engineModule:this.olapEngineModule;(0,t.isNullOrUndefined)(this.pivotChartModule)||(0,t.isNullOrUndefined)(c.pivotValues)||this.pivotChartModule.loadChart(this,this.chartSettings),(0,t.isNullOrUndefined)(c.pivotValues)||(0,t.isNullOrUndefined)(c.fieldList)||this.notify(pr,this);break;case"locale":case"currencyCode":case"enableRtl":if(this.tooltip&&this.tooltip.destroy(),this.dataSourceSettings.groupSettings&&this.dataSourceSettings.groupSettings.length>0&&this.clonedDataSet){var g="CSV"===this.dataSourceSettings.type?Di.getClonedCSVData(this.clonedDataSet):Di.getClonedData(this.clonedDataSet);this.setProperties({dataSourceSettings:{dataSource:g}},!0)}e.prototype.refresh.call(this),this.updateClass();break;case"enableValueSorting":this.enableValueSorting=i.enableValueSorting,this.updateDataSource();break;case"showGroupingBar":this.element.querySelector(".e-grouping-bar")?this.element.querySelector(".e-grouping-bar").remove():this.groupingBarModule&&(this.groupingBarModule.renderLayout(),this.commonModule||(this.commonModule=new Es(this)),this.notify(hr,{})),(0,t.isNullOrUndefined)(i.showFieldList)&&this.renderPivotGrid();break;case"showFieldList":this.initialLoad();break;case"groupingBarSettings":this.showGroupingBar&&this.groupingBarModule&&(i.groupingBarSettings&&Object.keys(i.groupingBarSettings).indexOf("showFieldsPanel")>-1?(this.groupingBarModule.RefreshFieldsPanel(),this.layoutRefresh()):this.axisFieldModule.render());break;case"showValuesButton":this.showGroupingBar&&this.groupingBarModule&&this.axisFieldModule&&this.axisFieldModule.render(),this.showFieldList&&this.pivotFieldListModule&&this.pivotFieldListModule.axisFieldModule&&(this.pivotFieldListModule.setProperties({showValuesButton:i.showValuesButton},!0),this.pivotFieldListModule.axisFieldModule.render());break;case"showTooltip":this.renderToolTip();break;case"showToolbar":case"toolbar":this.toolbarModule&&this.showToolbar&&this.toolbarModule.refreshToolbar();break;case"chartTypes":this.toolbarModule&&this.toolbarModule.createChartMenu();break;case"aggregateTypes":this.showGroupingBar&&this.groupingBarModule&&this.axisFieldModule&&this.axisFieldModule.render(),this.showFieldList&&this.pivotFieldListModule&&this.pivotFieldListModule.axisFieldModule&&(this.pivotFieldListModule.setProperties({aggregateTypes:i.aggregateTypes},!0),this.pivotFieldListModule.axisFieldModule.render());break;case"enableFieldSearching":this.pivotFieldListModule&&(this.pivotFieldListModule.enableFieldSearching=this.enableFieldSearching);break;case"pageSettings":this.enableVirtualization||(this.engineModule.pageSettings=this.pageSettings,this.engineModule.fieldList?this.refreshPageData():this.initialLoad());break;case"pagerSettings":case"enablePaging":this.isStaticFieldList&&this.isStaticRefresh&&(this.isStaticRefresh=!1),this.initialLoad();break;case"cellTemplate":this.cellTemplateFn=this.templateParser(this.cellTemplate),r=!0;break;case"tooltipTemplate":this.tooltipTemplateFn=this.templateParser(this.tooltipTemplate),r=!0;break;case"allowCalculatedField":this.pivotFieldListModule&&(this.pivotFieldListModule.allowCalculatedField=this.allowCalculatedField);break;case"allowDeferLayoutUpdate":this.pivotDeferLayoutUpdate=this.allowDeferLayoutUpdate,this.pivotFieldListModule&&(this.pivotFieldListModule.allowDeferLayoutUpdate=this.allowDeferLayoutUpdate);break;case"allowGrouping":this.refresh()}}r&&this.grid&&this.grid.refreshColumns()},l.prototype.toggleButtonState=function(e,t){var i=this.element.querySelector("."+e);if(i){var a=i.closest(".e-toolbar-item");a&&("add"===t?a.classList.add(vt):"remove"===t&&a.classList.remove(vt))}},l.prototype.templateParser=function(e){if(e)try{return"function"!=typeof e&&document.querySelectorAll(e).length?(0,t.compile)(document.querySelector(e).innerHTML.trim()):(0,t.compile)(e)}catch(i){return(0,t.compile)(e)}},l.prototype.getCellTemplate=function(){return this.cellTemplateFn},l.prototype.appendHtml=function(e,i){var a=document.createElement("div");return a.innerHTML=i,(0,t.isNullOrUndefined)(a.firstChild)||e.appendChild(a.firstChild),e},l.prototype.renderPivotGrid=function(){this.isEmptyGrid=!1,this.notEmpty=!0,this.clearTemplate(),this.showGroupingBar&&(this.pivotChartModule&&this.appendChartElement(),this.groupingBarModule.appendToElement()),this.pivotChartModule&&(this.pivotChartModule.engineModule=this.engineModule,this.pivotChartModule.loadChart(this,this.chartSettings),this.enableRtl&&this.chart&&"rtl"!==document.body.getAttribute("dir")&&(0,t.addClass)([this.chart.element],"e-ltr")),this.enableVirtualization&&(this.virtualscrollModule=new Zs(this)),(this.allowDrillThrough||this.editSettings.allowEditing)&&(this.drillThroughModule=new eo(this)),this.enablePaging&&this.notify(wr,this),"Chart"!==this.displayOption.view?(this.hyperlinkSettings&&(this.isRowCellHyperlink=!!this.hyperlinkSettings.showRowHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isColumnCellHyperlink=!!this.hyperlinkSettings.showColumnHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isValueCellHyperlink=!!this.hyperlinkSettings.showValueCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isSummaryCellHyperlink=!!this.hyperlinkSettings.showSummaryCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.applyHyperlinkSettings()),this.renderModule=this.renderModule?this.renderModule:new ys(this),this.renderModule.render(!0)):this.grid&&(0,t.remove)(this.grid.element);var e=this.actionObj.actionName===kr||this.actionObj.actionName===rn,i=this.actionObj.actionName===nn||this.actionObj.actionName===Rr;!(this.showFieldList||this.allowNumberFormatting||this.allowCalculatedField||this.toolbar||this.allowGrouping||this.gridSettings.contextMenuItems)||e||i||(this.notify(pr,this),this.pivotFieldListModule&&this.allowDeferLayoutUpdate&&(this.pivotFieldListModule.clonedDataSource=Di.getClonedDataSourceSettings(this.dataSourceSettings))),this.allowConditionalFormatting&&this.applyFormatting(this.pivotValues),this.showToolbar&&"Both"===this.displayOption.view&&this.chart&&this.grid&&(this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector("."+he)&&this.groupingBarModule.refreshUI(),this.toolbarModule&&this.toolbarModule.toolbar&&(this.toolbarModule.toolbar.width=this.getGridWidthAsNumber()),this.chartSettings.enableScrollOnMultiAxis&&this.chartSettings.enableMultipleAxis&&(this.element.querySelector("."+ei).style.width=(0,t.formatUnit)(this.getGridWidthAsNumber())),this.chart.width=(0,t.formatUnit)(this.getGridWidthAsNumber()),"Table"===this.currentView?(this.grid.element.style.display="",this.chart.element.style.display="none",this.chartSettings.enableMultipleAxis&&this.chartSettings.enableScrollOnMultiAxis&&(this.element.querySelector(".e-pivotchart").style.display="none")):(this.grid.element.style.display="none",this.chart.element.style.display="",this.chartSettings.enableMultipleAxis&&this.chartSettings.enableScrollOnMultiAxis&&(this.element.querySelector(".e-pivotchart").style.display=""))),this.toolbarModule&&(Di.toggleFieldListIconVisibility(this),this.toolbarModule&&"New"!==this.toolbarModule.action&&"Load"!==this.toolbarModule.action&&"Remove"!==this.toolbarModule.action&&(this.isModified=!0),this.isInitialRendering||(this.isModified=!1,this.isInitialRendering=!this.isInitialRendering),this.toolbarModule.action="")},l.prototype.appendChartElement=function(){if(!(0,t.select)("#"+this.element.id+"_chart",this.element)){"Both"===this.displayOption.view&&"Chart"===this.displayOption.primary?this.element.insertBefore((0,t.createElement)("div",{className:ei,id:this.element.id+"_chart"}),this.element.querySelector("."+gt)):this.element.appendChild((0,t.createElement)("div",{className:ei,id:this.element.id+"_chart"}));var e=this.width.toString();this.showToolbar&&this.grid&&(e=this.getGridWidthAsNumber().toString());var i=this.pivotChartModule.getChartHeight();(this.chartSettings&&this.chartSettings.chartSeries&&this.pivotChartModule.accumulationType.indexOf(this.chartSettings.chartSeries.type)>-1?new to.AccumulationChart({width:e,height:i}):new to.Chart({width:e,height:i})).appendTo((0,t.select)("#"+this.element.id+"_chart",this.element)),this.showToolbar&&("Both"===this.displayOption.view&&"Chart"===this.currentView&&(this.grid.element.style.display="none"),"Chart"!==this.currentView&&((0,t.select)("#"+this.element.id+"_chart",this.element).style.display="none"))}},l.prototype.showWaitingPopup=function(){this.grid&&this.grid.element&&!this.spinnerTemplate&&"Table"===this.currentView?(0,Ni.showSpinner)(this.grid.element):(0,Ni.showSpinner)(this.element)},l.prototype.hideWaitingPopup=function(){this.grid&&this.grid.element&&!this.spinnerTemplate&&"Table"===this.currentView?(0,Ni.hideSpinner)(this.grid.element):(0,Ni.hideSpinner)(this.element)},l.prototype.updateDataSource=function(){var e=this;this.showWaitingPopup();var i=this,a=!(0,t.isNullOrUndefined)(i.lastSortInfo)&&Object.keys(i.lastSortInfo).length>0,r=!(0,t.isNullOrUndefined)(i.lastFilterInfo)&&Object.keys(i.lastFilterInfo).length>0,n=!(0,t.isNullOrUndefined)(i.lastAggregationInfo)&&Object.keys(i.lastAggregationInfo).length>0,s=!(0,t.isNullOrUndefined)(i.lastCalcFieldInfo)&&Object.keys(i.lastCalcFieldInfo).length>0,o={dataSourceSettings:Di.getClonedDataSourceSettings(i.dataSourceSettings)};i.trigger(Ii,o,(function(t){if((i.enableVirtualization||i.enablePaging)&&(a||r||n||s)||Di.updateDataSourceSettings(i,t.dataSourceSettings),i.updatePageSettings(!1),a&&""!==i.dataSourceSettings.valueSortSettings.headerText&&i.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),"pivot"===i.dataType&&(i.enableVirtualization||i.enablePaging)&&(a||r||n||s))a&&("Server"===e.dataSourceSettings.mode?i.getEngine("onSort",null,i.lastSortInfo,null,null,null,null):i.engineModule.onSort(i.lastSortInfo,i.dataSourceSettings),i.lastSortInfo={}),n&&("Server"===e.dataSourceSettings.mode?i.getEngine("onAggregation",null,null,i.lastAggregationInfo,null,null,null):i.engineModule.onAggregation(i.lastAggregationInfo,i.dataSourceSettings),i.lastAggregationInfo={}),s&&("Server"===e.dataSourceSettings.mode?i.getEngine("onCalcOperation",null,null,null,i.lastCalcFieldInfo,null,null):i.engineModule.onCalcOperation(i.lastCalcFieldInfo,i.dataSourceSettings),i.lastCalcFieldInfo={}),r&&("Server"===e.dataSourceSettings.mode?i.getEngine("onFilter",null,null,null,null,i.lastFilterInfo,null):i.engineModule.onFilter(i.lastFilterInfo,i.dataSourceSettings),i.lastFilterInfo={}),i.allowServerDataBinding=!1,i.setProperties({pivotValues:i.engineModule.pivotValues},!0),i.allowServerDataBinding=!0,"Server"!==i.dataSourceSettings.mode&&i.enginePopulatedEventMethod("updateDataSource");else if("olap"===i.dataType){var o={mode:"",savedFieldList:i.olapEngineModule.fieldList,savedFieldListData:i.olapEngineModule.fieldListData,pageSettings:i.pageSettings,enableValueSorting:i.enableValueSorting,isDrillThrough:i.allowDrillThrough||i.editSettings.allowEditing,localeObj:i.localeObj,enableVirtualization:e.enableVirtualization};s||a?(i.olapEngineModule.savedFieldList=i.olapEngineModule.fieldList,i.olapEngineModule.savedFieldListData=i.olapEngineModule.fieldListData,s?(i.olapEngineModule.updateCalcFields(i.dataSourceSettings,i.lastCalcFieldInfo),i.lastCalcFieldInfo={}):(i.olapEngineModule.onSort(i.dataSourceSettings),i.lastSortInfo={})):Di.renderOlapEngine(i,o),i.allowServerDataBinding=!1,i.setProperties({pivotValues:i.olapEngineModule.pivotValues},!0),i.allowServerDataBinding=!0,i.enginePopulatedEventMethod("updateDataSource")}else{o={mode:"",savedFieldList:i.engineModule.fieldList,pageSettings:i.pageSettings,enableValueSorting:i.enableValueSorting,isDrillThrough:i.allowDrillThrough||i.editSettings.allowEditing,localeObj:i.localeObj,fieldsType:i.fieldsType,clonedReport:i.clonedReport,globalize:i.globalize,currenyCode:i.currencyCode,enablePaging:e.enablePaging,enableVirtualization:e.enableVirtualization,allowDataCompression:e.allowDataCompression,enableHtmlSanitizer:e.enableHtmlSanitizer,enableOptimizedRendering:e.enableVirtualization&&e.virtualscrollModule&&e.virtualScrollSettings.allowSinglePage,isTabularLayout:e.isTabular};"Server"===i.dataSourceSettings.mode?a?i.getEngine("onSort",null,i.lastSortInfo,null,null,null,null):n?i.getEngine("onAggregation",null,null,i.lastAggregationInfo,null,null,null):s?i.getEngine("onCalcOperation",null,null,null,i.lastCalcFieldInfo,null,null):r?i.getEngine("onFilter",null,null,null,null,i.lastFilterInfo,null):i.getEngine("onDrop",null,null,null,null,null,null):(i.engineModule.renderEngine(i.dataSourceSettings,o,i.aggregateCellInfo?i.getValueCellInfo.bind(i):void 0,i.onHeadersSort?i.getHeaderSortInfo.bind(i):void 0),i.allowServerDataBinding=!1,i.setProperties({pivotValues:i.engineModule.pivotValues},!0),i.allowServerDataBinding=!0,i.enginePopulatedEventMethod("updateDataSource")),i.lastSortInfo={},i.lastAggregationInfo={},i.lastCalcFieldInfo={},i.lastFilterInfo={}}}))},l.prototype.refreshPageData=function(){var e={dataSourceSettings:Di.getClonedDataSourceSettings(this.dataSourceSettings)};this.actionBeginMethod(),this.showWaitingPopup(),this.trigger(Ii,e),"pivot"===this.dataType&&("Server"===this.dataSourceSettings.mode?this.getEngine("onPageChange",null,null,null,null,null,null):this.engineModule.generateGridData(this.dataSourceSettings,!0,!1,this.engineModule.headerCollection,!0),this.setProperties({pivotValues:this.engineModule.pivotValues},!0),this.enginePopulatedEventMethod("updateDataSource")),this.actionObj.actionName=this.getActionCompleteName(),this.actionObj.actionName&&this.actionCompleteMethod()},l.prototype.excelExport=function(e,t,i,a){if("Server"===this.dataSourceSettings.mode)this.getEngine("onExcelExport",null,null,null,null,null,null,null,null,e);else{this.enableVirtualization||this.enablePaging||this.allowEngineExport||this.allowConditionalFormatting&&this.dataSourceSettings.conditionalFormatSettings.length>0?this.excelExportModule.exportToExcel("Excel",e,a):(this.exportType="Excel",this.grid.excelExport(e,t,i,a)),this.actionObj.actionName=this.getActionCompleteName();var r={exportInfo:{type:this.exportType,info:e}};this.actionObj.actionInfo=r,this.actionObj.actionName&&this.actionCompleteMethod()}},l.prototype.csvExport=function(e,t,i,a){if("Server"===this.dataSourceSettings.mode)this.getEngine("onCsvExport",null,null,null,null,null,null,null,null,e);else{this.enableVirtualization||this.enablePaging||this.allowEngineExport||this.allowConditionalFormatting&&this.dataSourceSettings.conditionalFormatSettings.length>0?this.excelExportModule.exportToExcel("CSV",e,a):(this.exportType="CSV",this.grid.csvExport(e,t,i,a)),this.actionObj.actionName=this.getActionCompleteName();var r={exportInfo:{type:this.exportType,info:e}};this.actionObj.actionInfo=r,this.actionObj.actionName&&this.actionCompleteMethod()}},l.prototype.gridPdfExport=function(e,t,i,a){var r={pdfExportProperties:e,isMultipleExport:t,isBlob:a,pdfDoc:i,currentExportView:"Table",pdfMargins:{}},n=null;this.trigger(ji,r),this.pdfExportModule&&(this.pdfExportModule.exportProperties=r),n="Server"!==this.dataSourceSettings.mode&&(this.enableVirtualization||this.enablePaging||this.allowEngineExport||Object.keys(r.pdfMargins).length>0||r.height||r.width||this.allowConditionalFormatting&&this.dataSourceSettings.conditionalFormatSettings.length>0)?this.pdfExportModule.exportToPDF(r.pdfExportProperties,r.isMultipleExport,r.pdfDoc,r.isBlob):this.grid.pdfExport(r.pdfExportProperties,r.isMultipleExport,r.pdfDoc,r.isBlob),this.actionObj.actionName=this.getActionCompleteName();var s={exportInfo:{type:"PDF",info:e}};return this.actionObj.actionInfo=s,this.actionObj.actionName&&this.actionCompleteMethod(),n},l.prototype.chartExport=function(e,i,r,n,s){var o,l={pdfExportProperties:i,isMultipleExport:r,isBlob:s,pdfDoc:n,type:e,currentExportView:"Chart",pdfMargins:{}};this.trigger(ji,l),this.chartExportModule&&(this.chartExportModule.exportProperties=l);var d=l.fileName?l.fileName:(0,t.isNullOrUndefined)(i)||(0,t.isNullOrUndefined)(i.fileName)?"default":i.fileName;if("PDF"===e)o=this.chartExportModule.pdfChartExport(l.pdfExportProperties,l.pdfDoc,l.isMultipleExport,l.isBlob);else{var h=0===l.orientation||l.orientation?l.orientation:(0,t.isNullOrUndefined)(i)||(0,t.isNullOrUndefined)(i.pageOrientation)||"Landscape"===i.pageOrientation?a.PdfPageOrientation.Landscape:a.PdfPageOrientation.Portrait;o=this.chart.exportModule.export(l.type,d,h,null)}this.actionObj.actionName=this.getActionCompleteName();var p={exportInfo:{type:e,info:d}};return this.actionObj.actionInfo=p,this.actionObj.actionName&&this.actionCompleteMethod(),o},l.prototype.pdfExport=function(e,t,i,a,r){var n=this,s=null;return new Promise((function(o){if(r&&"Both"===n.displayOption.view){if("Chart"===n.displayOption.primary)n.chartExport("PDF",e,!0,i,!1).then((function(i){s=n.gridPdfExport(e,t,i,a),o(s)}));else n.gridPdfExport(e,!0,i,!1).then((function(i){s=n.chartExport("PDF",e,t,i,a),o(s)}))}else{var l=n.gridPdfExport(e,t,i,a);o(l)}}))},l.prototype.printChart=function(){this.chart&&this.chart.print()},l.prototype.onDrill=function(e,i){var a=this,r=this.dataSourceSettings.drilledMembers[0]&&this.dataSourceSettings.drilledMembers[0].delimiter?this.dataSourceSettings.drilledMembers[0].delimiter:"**",n="",s="",o="";i?(n=i.fieldName,s=i.cell.axis,o=i.isDrilled?"up":"down"):(n="row"===(s=e.closest("td.e-rowsheader")?"row":"column")?(0,t.closest)(e,"td").getAttribute("fieldname"):(0,t.closest)(e,"th").getAttribute("fieldname"),o=e.classList.contains(qe)?"up":"down");if("pivot"===this.dataType){var l=Di.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers),d="row"===s?parseInt((0,t.closest)(e,"td").getAttribute("aria-colindex"),10)-1:parseInt((0,t.closest)(e,"th").getAttribute("aria-colindex"),10)-1,h=Number("row"===s?(0,t.closest)(e,"td").getAttribute("index"):(0,t.closest)(e,"th").getAttribute("index")),p=i?i.cell:this.engineModule.pivotValues[h][d],u=p.valueSort.levelName.split(this.engineModule.valueSortSettings.headerDelimiter).join(r),c=!1;if(0===this.dataSourceSettings.drilledMembers.length)this.setProperties({dataSourceSettings:{drilledMembers:[{name:n,items:[u],delimiter:r}]}},!0);else{for(var g=Di.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers),m=0;m<g.length;m++){var f=g[m];if(u=u.split(r).join(f.delimiter?f.delimiter:r),r=f.delimiter=f.delimiter?f.delimiter:r,f.name===n){c=!0;var v=f.items.indexOf(u);v>-1?f.items.splice(v,1):f.items.push(u)}}this.setProperties({dataSourceSettings:{drilledMembers:g}},!0),c||this.dataSourceSettings.drilledMembers.push({name:n,items:[u],delimiter:r})}this.showWaitingPopup();var S=this,y={fieldName:n,memberName:u,delimiter:r,axis:s,action:o,currentCell:p},b={drillInfo:y,pivotview:S,cancel:!1};S.trigger(ia,b,(function(e){if(e.cancel)a.hideWaitingPopup(),a.setProperties({dataSourceSettings:{drilledMembers:l}},!0);else{var t={dataSourceSettings:Di.getClonedDataSourceSettings(a.dataSourceSettings)};S.trigger(Ii,t),S.setProperties({dataSourceSettings:t.dataSourceSettings},!0),S.enableVirtualization||S.enablePaging?"Server"===a.dataSourceSettings.mode?a.getEngine("onDrill",y,null,null,null,null,null):(S.engineModule.drilledMembers=S.dataSourceSettings.drilledMembers,S.engineModule.onDrill(y)):"Server"===a.dataSourceSettings.mode?a.getEngine("onDrill",y,null,null,null,null,null):S.engineModule.generateGridData(S.dataSourceSettings,!0),S.allowServerDataBinding=!1,S.setProperties({pivotValues:S.engineModule.pivotValues},!0),S.allowServerDataBinding=!0;var i={dataSourceSettings:Di.getClonedDataSourceSettings(t.dataSourceSettings),pivotValues:a.pivotValues};a.trigger(Fi,i),S.engineModule.pivotValues=i.pivotValues;var r={drillInfo:y};a.actionObj.actionInfo=r,S.renderPivotGrid()}}))}else this.onOlapDrill(n,s,o,r,e,i)},l.prototype.onOlapDrill=function(e,i,a,r,n,s){var o,l=this,d=this,h=Di.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers);if(s)o=s.cell;else{var p="row"===i?parseInt((0,t.closest)(n,"td").getAttribute("aria-colindex"),10)-1:parseInt((0,t.closest)(n,"th").getAttribute("aria-colindex"),10)-1,u=Number("row"===i?(0,t.closest)(n,"td").getAttribute("index"):(0,t.closest)(n,"th").getAttribute("index"));o=this.olapEngineModule.pivotValues[u][p]}var c="row"===i?this.olapEngineModule.tupRowInfo[o.ordinal]:this.olapEngineModule.tupColumnInfo[o.ordinal],g={axis:i,action:a,fieldName:e,delimiter:"~~",memberName:c.uNameCollection,currentCell:o};this.showWaitingPopup();var m={drillInfo:g,pivotview:d,cancel:!1},f=this.olapEngineModule.fieldList[g.fieldName]&&this.olapEngineModule.fieldList[g.fieldName].isHierarchy,v=c.drillInfo.map((function(e){return e.hierarchy})).indexOf(o.hierarchy.toString()),S=Di.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers);if(g&&"down"===g.action){for(var y=c.drillInfo.map((function(e){return e.uName})),b="",C=0;C<=v;C++){b=b+(""!==b?"~~":"")+(q=(j=y[C]).split("~~"))[q.length-1]}for(var x=this.olapEngineModule.getDrilledSets(g.memberName,o,this.olapEngineModule.fieldList[o.hierarchy]&&!this.olapEngineModule.fieldList[o.hierarchy].hasAllMember?o.valueSort.levelName.split(this.dataSourceSettings.valueSortSettings.headerDelimiter).length-1:v,i),w=0,T=k=Object.keys(x);w<T.length;w++)for(var M=x[T[w]],D=0,O=S.length;D<O;D++){var P=S[D],N=M;P.delimiter&&(N=N.replace(/~~/g,P.delimiter));for(var E=[],I=0;I<P.items.length;I++)0!==P.items[I].indexOf(N)&&(E[E.length]=P.items[I]);P.items=E}this.olapEngineModule.drilledSets[o.actualText]=c.members[v],g.memberName=b;for(var F=[],L=0,A=S;L<A.length;L++){(j=A[L]).name===g.fieldName&&F.push(j)}if(F.length>0){if(F[0].delimiter&&(b=b.replace(/~~/g,F[0].delimiter)),-1===Di.inArray(b,F[0].items)&&F[0].items.push(b),f)for(D=0;D<F[0].items.length;)F[0].items[D]===b?F[0].items.splice(D,1):++D}else if(!f){var R={name:g.fieldName,items:[b],delimiter:"~~"};S?S.push(R):S=[R]}m.drillInfo.memberName=b,this.setProperties({dataSourceSettings:{drilledMembers:S}},!0),d.trigger(ia,m,(function(e){if(e.cancel)l.hideWaitingPopup(),l.setProperties({dataSourceSettings:{drilledMembers:h}},!0);else{var t={dataSourceSettings:Di.getClonedDataSourceSettings(l.dataSourceSettings)};l.trigger(Ii,t),l.setProperties({dataSourceSettings:t.dataSourceSettings},!0),l.olapEngineModule.updateDrilledInfo(l.dataSourceSettings),l.allowServerDataBinding=!1,l.setProperties({pivotValues:l.olapEngineModule.pivotValues},!0),l.allowServerDataBinding=!0;var i={dataSourceSettings:Di.getClonedDataSourceSettings(t.dataSourceSettings),pivotValues:d.olapEngineModule.pivotValues};l.trigger(Fi,i),l.olapEngineModule.pivotValues=i.pivotValues,l.renderPivotGrid()}}))}else{delete this.olapEngineModule.drilledSets[o.actualText];x=this.olapEngineModule.getDrilledSets(g.memberName,o,v,i);var k=Object.keys(x);for(y=c.drillInfo.map((function(e){return e.uName})),b="",C=0;C<=v;C++){var j,q;b=b+(""!==b?"~~":"")+(q=(j=y[C]).split("~~"))[q.length-1]}for(var V=0,H=k;V<H.length;V++){M=x[H[V]];var U=[];for(D=0,O=S.length;D<O;D++){var _=M;if((F=S[D]).name===g.fieldName&&U.push(F),F.delimiter&&(_=M.replace(/~~/g,F.delimiter)),!f){for(E=[],I=0;I<F.items.length;I++)0!==F.items[I].indexOf(_)&&(E[E.length]=F.items[I]);F.items=E}}if(f)if(U.length>0){U[0].delimiter&&(b=b.replace(/~~/g,U[0].delimiter)),-1===Di.inArray(b,U[0].items)&&U[0].items.push(b)}else{R={name:g.fieldName,items:[b],delimiter:"~~"};S?S.push(R):S=[R]}}for(var B=[],G=0,z=S;G<z.length;G++){var W=z[G];W.items.length>0&&B.push(W)}this.setProperties({dataSourceSettings:{drilledMembers:S}},!0),d.trigger(ia,m,(function(e){if(e.cancel)l.hideWaitingPopup(),l.setProperties({dataSourceSettings:{drilledMembers:h}},!0);else{var t={dataSourceSettings:Di.getClonedDataSourceSettings(l.dataSourceSettings)};l.trigger(Ii,t),l.setProperties({dataSourceSettings:t.dataSourceSettings},!0),l.setProperties({dataSourceSettings:{drilledMembers:B}},!0),l.olapEngineModule.updateDrilledInfo(l.dataSourceSettings),l.allowServerDataBinding=!1,l.setProperties({pivotValues:l.olapEngineModule.pivotValues},!0),l.allowServerDataBinding=!0;var i={dataSourceSettings:Di.getClonedDataSourceSettings(t.dataSourceSettings),pivotValues:d.olapEngineModule.pivotValues};l.trigger(Fi,i),l.olapEngineModule.pivotValues=i.pivotValues,l.renderPivotGrid()}}))}},l.prototype.onContentReady=function(){var e,i,a=(0,gs.getScrollBarWidth)();this.isPopupClicked=!1,this.showFieldList&&this.pivotFieldListModule&&"Server"!==this.dataSourceSettings.mode?(this.pivotFieldListModule.element.style.display="block",(0,Ni.hideSpinner)(this.pivotFieldListModule.fieldListSpinnerElement)):this.fieldListSpinnerElement&&(0,Ni.hideSpinner)(this.fieldListSpinnerElement),this.isEmptyGrid?this.pivotValues.length>0&&(this.isEmptyGrid=!1,this.notEmpty=!0):("Server"===this.dataSourceSettings.mode&&this.isServerWaitingPopup||"Local"===this.dataSourceSettings.mode)&&this.hideWaitingPopup();var r=this.element.querySelector("."+Ft)?this.element.querySelector("."+Ft):this.element.querySelector("."+R),n=this.element.querySelector("."+At),s=this.virtualScrollSettings&&this.virtualScrollSettings.allowSinglePage&&"pivot"===this.dataType;if(this.grid){var o=this.element.querySelector("."+zt),l=r.parentElement.offsetWidth<r.querySelector("."+He).offsetWidth,d="pivot"===this.dataType?this.engineModule:this.olapEngineModule;if(this.enableVirtualization&&d&&this.virtualscrollModule){if(s&&this.element.querySelector("."+yi)&&((0,t.removeClass)([n,r],["e-virtual-pivot-content"]),(0,t.addClass)([this.element.querySelector("."+yi)],[bi]),this.grid&&this.grid.element.querySelector(".e-spinner-inner")&&(0,t.removeClass)([this.grid.element.querySelector(".e-spinner-inner")],[bi])),s){var h=this.element.querySelector("."+yi);if(h||(h=(0,t.createElement)("div",{className:yi+" "+bi,innerHTML:this.localeObj.getConstant("loading")}),this.grid.element&&!this.element.querySelector("."+yi)&&this.grid.element.insertBefore(h,this.grid.element.firstElementChild)),this.element.querySelector("."+qt)&&this.element.querySelector("."+zt)){var p=this.element.querySelector("."+zt).offsetHeight+this.element.querySelector("."+qt).offsetHeight;(0,t.setStyleAttribute)(h,{height:p+"px",width:this.element.querySelector("."+qt).offsetWidth+"px",padding:Math.floor(p/2)+"px"})}}this.element.querySelector("."+R)&&!this.element.querySelector("."+R).querySelector("."+Et)&&(this.virtualDiv=(0,t.createElement)("div",{className:Et}),this.element.querySelector("."+R).appendChild(this.virtualDiv)),this.element.querySelector("."+At)&&!this.element.querySelector("."+At).querySelector("."+Et)?(this.virtualHeaderDiv=(0,t.createElement)("div",{className:Et}),this.element.querySelector("."+At).appendChild(this.virtualHeaderDiv)):this.virtualHeaderDiv=this.element.querySelector("."+At).querySelector("."+Et);var u=o.querySelector("."+It);if(o&&!u){this.virtualTableDiv=(0,t.createElement)("div",{className:It}),o.appendChild(this.virtualTableDiv),u=o.querySelector("."+It),this.virtualScrollDiv=(0,t.createElement)("div",{className:Lt}),u.appendChild(this.virtualScrollDiv),(0,t.setStyleAttribute)(u,{minHeight:0!==a?a:"15px",maxHeight:0!==a?a:"15px",overflowX:"scroll"}),(0,t.setStyleAttribute)(this.virtualScrollDiv,{height:"0.1px"});var c=(0,t.createElement)("div",{className:Ft});c.append.apply(c,Array.prototype.slice.call(r.childNodes)),r.appendChild(c),c.scrollLeft=0}var g=this.element.querySelector("."+R).querySelector("."+He),m=this.gridSettings.rowHeight*d.rowCount+.1-g.clientHeight;m>this.scrollerBrowserLimit&&(this.verticalScrollScale=m/this.scrollerBrowserLimit,m=this.scrollerBrowserLimit),(i=this.gridSettings.columnWidth*d.columnCount)>this.scrollerBrowserLimit&&(this.horizontalScrollScale=i/this.scrollerBrowserLimit,i=this.scrollerBrowserLimit),(0,t.setStyleAttribute)(this.virtualDiv,{height:(m>.1?m:.1)+"px",width:(i>.1?i:.1)+"px"}),(0,t.setStyleAttribute)(this.virtualHeaderDiv,{height:0,width:(i>.1?i:.1)+"px"}),this.isAdaptive&&(r.style.minHeight="1px",r.style.minHeight="1px");var f=this.isAdaptive?r:o.querySelector("."+It)?o.querySelector("."+It):r;e=r.parentElement.scrollTop>this.scrollerBrowserLimit?r.querySelector("."+He).style.transform.split(",")[1].trim():(s?r.parentElement.scrollTop:-(r.parentElement.scrollTop*this.verticalScrollScale-this.scrollPosObject.verticalSection-r.parentElement.scrollTop))+"px)",Number(e.split("px")[0])>this.virtualDiv.clientHeight&&(e=this.virtualDiv.clientHeight+"px)");var v=Math.abs(f.scrollLeft),S=v>this.scrollerBrowserLimit?r.querySelector("."+He).style.transform.split(",")[0].trim()+",":"translate("+(this.enableRtl?1:-1)*(v*this.horizontalScrollScale-this.scrollPosObject.horizontalSection-v)+"px,";(0,t.setStyleAttribute)(r.querySelector("."+He),{transform:S+e}),(0,t.setStyleAttribute)(n.querySelector("."+He),{transform:S+0+"px)"}),!l&&o&&u||this.isAdaptive?u.style.display="none":u.style.display="block";var y=Number(-r.querySelector("."+He).style.transform.split("(")[1].split(",")[0].split("px")[0]);if(this.virtualscrollModule.alignFreezedCells(y,!0),l){var b=0;b=this.pivotColumns.length<25?i+r.querySelector("."+He).querySelector("."+Si).offsetWidth+(o.offsetWidth-o.clientWidth):i+(o.offsetWidth-o.clientWidth),"auto"!==this.grid.height?this.grid.element.querySelector("."+Lt).style.width=b+a+"px":this.grid.element.querySelector("."+Lt).style.width=b+"px"}this.grid.element.querySelector("."+Ft)&&r.parentElement.scrollHeight===r.scrollHeight&&(r.style.overflowY="");var C="pivot"===this.dataType&&"column"===this.dataSourceSettings.valueAxis?this.dataSourceSettings.values.length:1,x=this.pageSettings.columnPageSize*C*this.gridSettings.columnWidth,w=f.scrollWidth-(Math.abs(v)+f.offsetWidth);if(this.virtualscrollModule&&x>0&&w<=x&&v>0){var T=r.scrollWidth-(Math.abs(r.scrollLeft)+r.parentElement.offsetWidth),M=void 0;T<1&&"horizondal"===this.scrollDirection&&(r.parentElement.scrollTop>0&&(M=r.parentElement.scrollTop),this.virtualDiv.style.display="none",T=r.scrollWidth-(Math.abs(r.scrollLeft)+r.parentElement.offsetWidth)),this.virtualDiv.style.display="",M&&(r.parentElement.scrollTop=M);var D=r.scrollWidth-(Math.abs(r.scrollLeft)+r.parentElement.offsetWidth);T>1&&(this.scrollPosObject.horizontalSection-=w<=0?T>w?T:-D:D===T?T-w:T<D&&(w===D||w>T)?-(D-T):0,"auto"!==this.grid.height&&(this.scrollPosObject.horizontalSection-=a),this.scrollPosObject.horizontalSection=this.scrollPosObject.horizontalSection>=-this.element.querySelector("."+gt).querySelector("."+Be+"."+Si).offsetWidth?this.scrollPosObject.horizontalSection:-this.element.querySelector("."+gt).querySelector("."+Be+"."+Si).offsetWidth),S=v>this.scrollerBrowserLimit?r.querySelector("."+He).style.transform.split(",")[0].trim()+",":"translate("+(this.enableRtl?1:-1)*(v*this.horizontalScrollScale-this.scrollPosObject.horizontalSection-v)+"px,",(0,t.setStyleAttribute)(r.querySelector("."+He),{transform:S+e}),(0,t.setStyleAttribute)(n.querySelector("."+He),{transform:S+0+"px)"}),y=Number(-r.querySelector("."+He).style.transform.split("(")[1].split(",")[0].split("px")[0]),this.virtualscrollModule.alignFreezedCells(y,!0)}}if("Chart"!==this.currentView&&this.grid.hideScroll(),this.showGroupingBar){if(this.groupingBarModule&&this.element.querySelector("."+he)&&this.groupingBarModule.setGridRowWidth(),this.actionObj.fieldInfo&&this.actionObj.fieldInfo.fieldName){var O=this.pivotButtonModule.parentElement.querySelector('[data-uid="'+this.actionObj.fieldInfo.fieldName+'"]');(0,t.isNullOrUndefined)(O)||O.focus()}this.element.style.minWidth=this.isAdaptive?this.minWidth?this.minWidth+"px":"310px":this.minWidth?this.minWidth+"px":"400px",this.grid.element.style.minWidth=this.isAdaptive?this.minWidth?this.minWidth+"px":"310px":this.minWidth?this.minWidth+"px":"400px"}else this.element.style.minWidth=this.minWidth?this.minWidth+"px":"310px",this.grid.element.style.minWidth=this.minWidth?this.minWidth+"px":"310px"}if(this.unwireEvents(),this.wireEvents(),this.isChartLoaded=!1,this.isEmptyGrid||this.trigger(Gi),this.actionObj.actionName=this.getActionCompleteName(),this.actionObj.actionName&&(this.actionObj.actionName===es&&this.pivotCommon&&this.pivotCommon.filterDialog&&(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.pivotCommon.filterDialog.setFocus.bind(this.pivotCommon.filterDialog))),this.actionObj.actionName!==yn&&this.actionCompleteMethod()),this.groupingModule&&(this.groupingModule.isUpdate=!1),this.engineModule&&this.engineModule.clearProperties(),this.virtualscrollModule&&this.grid&&this.virtualscrollModule.onHorizondalScroll(n,r),!this.isAdaptive&&this.enableVirtualization&&r&&this.virtualscrollModule&&!s){var P=r.parentElement.parentElement.querySelector(".e-movablescrolldiv");if(i<3*r.parentElement.clientWidth)r.style.overflowX="visible",P.style.display="none",n.scrollLeft=r.parentElement.scrollLeft,(0,t.setStyleAttribute)(r.querySelector("."+He),{transform:"translate(0px,"+e}),(0,t.setStyleAttribute)(n.querySelector("."+He),{transform:"translate(0px, 0px)"}),this.virtualscrollModule.alignFreezedCells(0,!0);else{t.EventHandler.remove(this.element.querySelector("."+zt).querySelector("."+R),"scroll",this.headerScrollUpdate);var N=this.element.querySelector("."+zt).querySelector("."+R).scrollLeft;r.style.overflowX="auto",P.style.display="block",0!==N&&(P.scrollLeft=N),P.scrollLeft!==r.scrollLeft&&0!==r.scrollLeft&&(P.scrollLeft=r.scrollLeft)}}this.isStaticRefresh=!1},l.prototype.setToolTip=function(e){var i,a,r=this,n=parseInt(e.target.getAttribute("aria-colindex"),10)-1,s=Number(e.target.getAttribute("index")),o=this.dataSourceSettings.values.length>0&&this.pivotValues&&this.pivotValues[s]&&this.pivotValues[s][n]?this.pivotValues[s][n]:void 0;this.tooltip.content="";var l=!1;if(o&&"olap"===this.dataType){var d=o.actualText;if(!(0,t.isNullOrUndefined)(d)&&this.olapEngineModule.fieldList&&!this.olapEngineModule.fieldList[d]){var h=this.olapEngineModule.tupRowInfo;d=o.rowOrdinal>-1&&h.length>0&&h[o.rowOrdinal]&&!(0,t.isNullOrUndefined)(h[o.rowOrdinal].measureName)?h[o.rowOrdinal].measureName:d}if(this.olapEngineModule.fieldList&&this.olapEngineModule.fieldList[d])i=(p=this.olapEngineModule.fieldList[d]).isCalculatedField?p.type:p.aggregateType,a=this.olapEngineModule.dataFields[d]&&this.olapEngineModule.dataFields[d].caption?this.olapEngineModule.dataFields[d].caption:p.caption,l=!0}else{var p;if(o&&this.engineModule.fieldList&&this.engineModule.fieldList[o.actualText])i="DistinctCount"===(i=(p=this.engineModule.fieldList[o.actualText]).aggregateType)||"number"===p.type&&"include"!==p.type&&"exclude"!==p.type?void 0===i?"Sum":p.aggregateType:"Count",a=p.caption,l=!0}if(o&&l){var u=this.isTabular&&this.engineModule.rowMaxLevel>0?this.engineModule.rowMaxLevel:0,c=this.getRowText(s,u),g=this.getColText(0,n,s),m=""===o.formattedText?this.localeObj.getConstant("noValue"):o.formattedText;if(this.tooltipTemplate&&void 0!==this.getTooltipTemplate()){var f={rowHeaders:c,columnHeaders:g,aggregateType:i,valueField:a,value:m,rowFields:this.getHeaderField(s,n,"row"),columnFields:this.getHeaderField(s,n,"column")};if("function"==typeof this.tooltipTemplate&&this.isReact){var v=document.createElement("div");this.getTooltipTemplate()(f,this,"tooltipTemplate",this.element.id+"tooltipTemplate",null,null,v),this.renderReactTemplates((function(){r.enableHtmlSanitizer?r.tooltip.content=t.SanitizeHtmlHelper.sanitize(v.outerHTML):r.tooltip.content=v.outerHTML}))}else{var S=this.getTooltipTemplate()(f,this,"tooltipTemplate",this.element.id+"tooltipTemplate")[0].outerHTML;this.enableHtmlSanitizer?this.tooltip.content=t.SanitizeHtmlHelper.sanitize(S):this.tooltip.content=S}}else{var y="<div class=e-pivottooltip><p class="+ze+">"+this.localeObj.getConstant("row")+":</p><p class="+We+">"+c+"</p></br><p class="+ze+">"+this.localeObj.getConstant("column")+":</p><p class="+We+">"+g+"</p></br>"+(""!==o.actualText?"<p class="+ze+">"+("olap"===this.dataType?"":this.localeObj.getConstant(i)+" "+this.localeObj.getConstant("of")+" ")+a+":</p><p class="+We+">"+m+"</p></div>":"");this.tooltip.content=(0,t.initializeCSPTemplate)((function(){return y}))}}else e.cancel=!0},l.prototype.getTooltipTemplate=function(){return this.tooltipTemplateFn},l.prototype.getHeaderField=function(e,t,i){var a,r="",n="olap"===this.dataType?this.olapEngineModule:this.engineModule,s=n.valueSortSettings.headerDelimiter;if("row"===i){a=this.pivotValues[e][0].valueSort.levelName.toString().split(s).length;for(var o=0;o<a&&this.dataSourceSettings.rows.length>0&&this.dataSourceSettings.rows[o];o++)r+=(o?" - ":"")+(this.dataSourceSettings.rows[o].caption?this.dataSourceSettings.rows[o].caption:this.dataSourceSettings.rows[o].name)}else{if(this.dataSourceSettings.columns.length>0){var l=0===this.dataSourceSettings.values.length?0:Number(Object.keys(n.headerContent)[Object.keys(n.headerContent).length-1]);a=this.pivotValues[l][t].valueSort.levelName.toString().split(s).length,a=this.dataSourceSettings.values.length>1?a-1:a}for(var d=0;d<a&&this.dataSourceSettings.columns.length>0&&this.dataSourceSettings.columns[d];d++)r+=(d?" - ":"")+(this.dataSourceSettings.columns[d].caption?this.dataSourceSettings.columns[d].caption:this.dataSourceSettings.columns[d].name)}return r},l.prototype.getLevel=function(e){var t=e.valueSort?e.valueSort.levelName.toString():"",i=e.actualText?e.actualText.toString().split(this.dataSourceSettings.valueSortSettings.headerDelimiter).length:0,a=t.split(this.dataSourceSettings.valueSortSettings.headerDelimiter).length-(i?i-1:i);return a?a-1:0},l.prototype.getRowText=function(e,i){var a=this.pivotValues[e][i],r="";if(a){var n=this.getLevel(a);if(r="grand sum"===a.type?this.localeObj.getConstant("grandTotal"):a.formattedText,"row"===this.dataSourceSettings.valueAxis)r=(r=0===this.dataSourceSettings.rows.length&&this.dataSourceSettings.values.length>1?this.pivotValues[e][0].valueSort.levelName.toString().slice((this.localeObj.getConstant("grandTotal")+this.dataSourceSettings.valueSortSettings.headerDelimiter).length).toString():1===this.dataSourceSettings.values.length?(0,t.isNullOrUndefined)(this.dataSourceSettings.values[0].caption)?this.dataSourceSettings.values[0].name:this.dataSourceSettings.values[0].caption:this.pivotValues[e][0].valueSort.levelName.toString()).split(this.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - ");else if(this.isTabular)for(;n>0;)i--,a=this.pivotValues[e][i],r=r+this.dataSourceSettings.valueSortSettings.headerDelimiter+a.formattedText,n-=1;else for(;n>0||a&&void 0===a.index;)e--,(a=this.pivotValues[e][i])&&n>a.level&&(r=r+this.dataSourceSettings.valueSortSettings.headerDelimiter+a.formattedText,n-=1);r=r.split(this.dataSourceSettings.valueSortSettings.headerDelimiter).reverse().join(" - ")}return r},l.prototype.getColText=function(e,t,i){for(var a=this.pivotValues[0][t],r=a.axis,n="grand sum"===a.type?this.localeObj.getConstant("grandTotal"):a.formattedText;"value"!==r&&i>e;)e++,this.pivotValues[e]&&(r=(a=this.pivotValues[e][t]).axis,"sum"!==a.type&&"grand sum"!==a.type&&"value"!==r&&(n=n+" - "+a.formattedText));return n},l.prototype.updateClass=function(){this.enableRtl?(0,t.addClass)([this.element],n):(0,t.removeClass)([this.element],n),this.isAdaptive?(0,t.addClass)([this.element],s):(0,t.removeClass)([this.element],s),this.cssClass&&(0,t.addClass)([this.element],this.cssClass.split(" "))},l.prototype.mouseRclickHandler=function(e){(3===e.which||0===e.which)&&(this.lastCellClicked=e.target),this.lastCellClicked=e.target},l.prototype.mouseDownHandler=function(e){3===e.which&&(this.lastCellClicked=e.target),this.isCellBoxMultiSelection&&(this.isMouseDown=!e.target.closest("."+A),this.isMouseUp=!1,this.lastSelectedElement=void 0)},l.prototype.mouseMoveHandler=function(e){var i=this;if(this.isCellBoxMultiSelection){e.preventDefault();var a=e.target?e.target:void 0;if(this.isMouseDown&&a&&!a.classList.contains("e-expand")&&!a.classList.contains("e-collapse")){var r=a.parentElement.classList.contains(_e)||a.classList.contains(_e)?"row":"column";if(a="column"===r?(0,t.closest)(a,"th"):(0,t.closest)(a,"td")){var n=parseInt(a.getAttribute("aria-colindex"),10)-1,s=Number(a.getAttribute("index")),o={cancel:!1,isCellClick:!0,currentCell:a,data:this.pivotValues[s][n]};this.trigger(ta,o,(function(e){if(!e.cancel){i.grid.clearSelection();var t=i.parentAt(a,"TH");i.lastSelectedElement&&i.lastSelectedElement!==t&&t.classList.contains(kt)?(i.lastSelectedElement.classList.remove(Ut),i.lastSelectedElement.classList.remove(kt),i.lastSelectedElement=t):(i.lastSelectedElement=t,t.classList.contains(Be)&&t.classList.contains(Si)||(t.classList.add(Ut),t.classList.add(kt))),i.renderModule.selected()}}))}}}},l.prototype.mouseUpHandler=function(){this.isCellBoxMultiSelection&&(this.isMouseDown=!1,this.isMouseUp=!0)},l.prototype.parentAt=function(e,t){for(;e.tagName!==t&&e.parentElement;)e=e.parentElement;return e},l.prototype.mouseClickHandler=function(e){(3===e.which||0===e.which)&&(this.lastCellClicked=e.target);var i=e.target;if(!(0,t.closest)(i,"."+A)){var a=null,r=i.closest("td.e-rowsheader"),n=i.closest("td.e-valuescontent"),s=r||n?"row":"column";if(a="column"===s?(0,t.closest)(i,"th"):(0,t.closest)(i,"td"),"column"!==s||a||"Row"===this.gridSettings.selectionSettings.mode||(a=(0,t.closest)(i,"td")),i.classList.contains(qe)||i.classList.contains(Ve)||!this.enableValueSorting||i.classList.contains("e-resized")||i.classList.contains("e-rhandler")&&i.classList.contains("e-rcursor")||"olap"===this.dataType&&this.enableVirtualization){if(!i.classList.contains(qe)&&!i.classList.contains(Ve))return void this.cellClicked(i,a,e);var o=i.parentElement.getAttribute("fieldname"),l=(p=Di.getFieldInfo(o,this),i.classList.contains(qe)?this.actionObj.actionName=Or:i.classList.contains(Ve)?this.actionObj.actionName=Pr:"");if(this.actionObj.actionName=l,this.actionObj.fieldInfo=p.fieldItem,this.actionBeginMethod())return;try{this.onDrill(i)}catch(e){this.actionFailureMethod(e)}}else{var d="pivot"===this.dataType?this.engineModule:this.olapEngineModule;this.cellClicked(i,a,e);try{if(a&&(a.parentElement.parentElement.parentElement.parentElement.classList.contains(qt)&&"column"===this.dataSourceSettings.valueAxis&&!a.classList.contains(Si)||a.parentElement.classList.contains("e-row")&&"row"===this.dataSourceSettings.valueAxis&&(a.classList.contains("e-rowsheader")||a.classList.contains("e-stot")))){var h=a.getAttribute("fieldname"),p=Di.getFieldInfo(h,this);if(this.actionObj.actionName=Dr,this.actionObj.fieldInfo=p.fieldItem,this.actionBeginMethod())return;var u=this.isTabular?this.engineModule.rowMaxLevel:parseInt(a.getAttribute("aria-colindex"),10)-1,c=Number(a.getAttribute("index"));if("row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)){var g=this.pivotValues[c][u];if(-1!==this.dataSourceSettings.valueIndex||this.isTabular)c=this.getLevel(g)<=d.measureIndex&&g.members&&g.members.length>0?g.members[0].rowIndex:c;else c="value"===g.type||3===g.memberType?c:c+1}else"column"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&(u=parseInt(a.getAttribute("aria-colindex"),10)-1+Number(a.getAttribute("aria-colspan"))-1,c=d.headerContent.length-1);this.setProperties({dataSourceSettings:{valueSortSettings:{columnIndex:parseInt(a.getAttribute("aria-colindex"),10)-1+Number(a.getAttribute("aria-colspan"))-1,sortOrder:"Descending"===this.dataSourceSettings.valueSortSettings.sortOrder?"Ascending":"Descending",headerText:this.pivotValues[c][u].valueSort.levelName,headerDelimiter:this.dataSourceSettings.valueSortSettings.headerDelimiter?this.dataSourceSettings.valueSortSettings.headerDelimiter:"."}}},!0),this.showWaitingPopup();var m=this;if(d.enableValueSorting=!0,m.enableVirtualization||m.enablePaging){if(m.dataSourceSettings.enableSorting){for(var f=0,v=Object.keys(m.engineModule.fieldList);f<v.length;f++){var S=v[f];m.engineModule.fieldList[S].sort="Ascending"}m.setProperties({dataSourceSettings:{sortSettings:[]}},!0)}"Server"===m.dataSourceSettings.mode?m.getEngine("onValueSort",null,null,null,null,null,null):(m.engineModule.rMembers=m.engineModule.headerCollection.rowHeaders,m.engineModule.cMembers=m.engineModule.headerCollection.columnHeaders,m.engineModule.applyValueSorting(),m.engineModule.updateEngine())}else"Server"===m.dataSourceSettings.mode?m.getEngine("onValueSort",null,null,null,null,null,null):"olap"===this.dataType?m.olapEngineModule.onSort(m.dataSourceSettings,!0):m.engineModule.generateGridData(m.dataSourceSettings,!0);m.allowServerDataBinding=!1,m.setProperties({pivotValues:d.pivotValues},!0),m.allowServerDataBinding=!0;var y={valueSortInfo:d.valueSortSettings};this.actionObj.actionInfo=y,m.renderPivotGrid()}}catch(e){this.actionFailureMethod(e)}}}},l.prototype.updateTotColWidth=function(){this.totColWidth=0;for(var e=0,t=this.pivotColumns;e<t.length;e++){var i=t[e];this.totColWidth=this.totColWidth+i.width}},l.prototype.framePivotColumns=function(e){for(var t=0,i=e;t<i.length;t++){var a=i[t];if(a.columns&&a.columns.length>0)this.framePivotColumns(a.columns);else{var r="0.formattedText"===a.field?"":a.customAttributes&&a.customAttributes.cell&&a.customAttributes.cell.valueSort?a.customAttributes.cell.valueSort.levelName:"",n=this.renderModule.setSavedWidth("0.formattedText"===a.field?a.field:r,Number("auto"===a.width?a.minWidth:a.width));this.pivotColumns.push({allowReordering:a.allowReordering,allowResizing:a.allowResizing,headerText:r,width:n,autoFit:a.autoFit}),this.totColWidth=this.totColWidth+Number(n)}}},l.prototype.setGridColumns=function(e){if(!(0,t.isNullOrUndefined)(this.totColWidth)&&this.totColWidth>0||this.renderModule.isAutoFitEnabled){for(var i=0,a=e;i<a.length;i++){var r=a[i];if(r.columns&&r.columns.length>0)this.setGridColumns(r.columns);else if(this.renderModule.isAutoFitEnabled)r.autoFit=this.pivotColumns[this.posCount].autoFit,this.posCount++;else{var n="0.formattedText"===r.field?"":r.customAttributes?r.customAttributes.cell.valueSort.levelName:"";r.allowReordering=this.pivotColumns[this.posCount].allowReordering,r.allowResizing=this.pivotColumns[this.posCount].allowResizing,r.autoFit=this.pivotColumns[this.posCount].autoFit;var s=this.renderModule.setSavedWidth("0.formattedText"===r.field?r.field:n,Number(this.pivotColumns[this.posCount].width));r.autoFit?this.renderModule.isAutoFitEnabled=!0:"auto"!==r.width?r.width=s:r.minWidth=s,this.posCount++,r.allowReordering&&(this.gridSettings.allowReordering=!0),r.allowResizing&&(this.gridSettings.allowResizing=!0)}}this.gridSettings.allowReordering&&gs.Grid.Inject(gs.Reorder),this.gridSettings.allowResizing&&gs.Grid.Inject(gs.Resize)}},l.prototype.fillGridColumns=function(e){for(var t=0,i=e;t<i.length;t++){var a=i[t];a.allowReordering=this.gridSettings.allowReordering,a.allowResizing=this.gridSettings.allowResizing,a.clipMode=this.gridSettings.clipMode,this.posCount++,a.columns&&a.columns.length>0&&this.fillGridColumns(a.columns)}},l.prototype.triggerColumnRenderEvent=function(e){this.pivotColumns=[],this.totColWidth=0,this.framePivotColumns(e);var t=this.pivotColumns[0].width,i={columns:this.pivotColumns,dataSourceSettings:this.dataSourceSettings,stackedColumns:this.getStackedColumns(e,[])};this.trigger(Zi,i),this.updateTotColWidth(),t!==this.pivotColumns[0].width&&(this.firstColWidth=this.pivotColumns[0].width,this.renderModule.resColWidth=parseInt(this.firstColWidth.toString(),10)),this.posCount=0,this.setGridColumns(e)},l.prototype.setCommonColumnsWidth=function(e,t){for(var i=0,a=e;i<a.length;i++){var r=a[i];this.isTabular?r.index>this.engineModule.rowMaxLevel?r.columns?this.setCommonColumnsWidth(r.columns,t):this.setColumnWidth(r,t):r.width=this.firstColWidth?this.firstColWidth:r.width:"0.formattedText"!==r.field?r.columns?this.setCommonColumnsWidth(r.columns,t):this.setColumnWidth(r,t):r.width=this.firstColWidth?this.firstColWidth:r.width}},l.prototype.getHeightAsNumber=function(){var e,t;return isNaN(this.height)?this.height.toString().indexOf("%")>-1?(this.isAngular&&this.element&&this.element.style&&(t=window.getComputedStyle(this.element).display,this.element.style.display="block"),e=parseFloat(this.height.toString())/100*this.element.offsetHeight,this.isAngular&&this.element&&this.element.style&&(this.element.style.display=t)):this.height.toString().indexOf("px")>-1&&(e=Number(this.height.toString().split("px")[0])):e=Number(this.height),(e<this.minHeight||"auto"===this.height)&&(e=this.minHeight),e},l.prototype.getWidthAsNumber=function(){var e;return isNaN(this.width)?(this.width.toString().indexOf("%")>-1?e=parseFloat(this.width.toString())/100*this.element.offsetWidth:this.width.toString().indexOf("px")>-1&&(e=Number(this.width.toString().split("px")[0])),isNaN(e)&&(e=this.element.offsetWidth)):e=Number(this.width),e<400&&!this.isAdaptive?e=this.minWidth?this.minWidth:400:this.isAdaptive&&e<310&&(e=this.minWidth?this.minWidth:310),e},l.prototype.getGridWidthAsNumber=function(){var e,t=this.element.offsetWidth?this.element.offsetWidth:this.element.getBoundingClientRect().width;return isNaN(this.grid.width)?(this.grid.width.toString().indexOf("%")>-1?e=parseFloat(this.grid.width.toString())/100*t:this.grid.width.toString().indexOf("px")>-1&&(e=Number(this.grid.width.toString().split("px")[0])),isNaN(e)&&(e=t)):e=Number(this.grid.width),e},l.prototype.onWindowResize=function(){this.actionObj.actionName=yn,this.actionBeginMethod()||(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.layoutRefresh.bind(this),500),this.actionObj.actionName=this.getActionCompleteName(),this.actionObj.actionName&&this.actionCompleteMethod())},l.prototype.refresh=function(){this.pivotRefresh()},l.prototype.layoutRefresh=function(){if(this.element&&this.element.classList.contains("e-pivotview")&&("olap"===this.dataType?this.olapEngineModule&&this.olapEngineModule.pivotValues:this.engineModule&&this.engineModule.pivotValues)){if(this.grid){var e="olap"===this.dataType&&this.olapEngineModule.pivotValues.length>0?this.olapEngineModule.pivotValues[0].length:this.dataSourceSettings.values.length>0&&this.engineModule&&this.engineModule.pivotValues.length>0?this.engineModule.pivotValues[0].length:2,t=this.renderModule.calculateColWidth(e);this.grid.width=this.renderModule.calculateGridWidth(),this.renderModule.calculateGridHeight(!0),this.gridSettings.allowAutoResizing&&this.setCommonColumnsWidth(this.grid.columns,t),this.triggerColumnRenderEvent(this.grid.columns),this.grid.refreshColumns(),this.renderModule.isAutoFitEnabled?this.renderModule.addPivotAutoFitClass():this.renderModule.removePivotAutoFitClass(),this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector("."+he)&&this.groupingBarModule.setGridRowWidth(),this.chart&&this.pivotChartModule&&(this.chart.height=this.pivotChartModule.getResizedChartHeight())}this.showToolbar&&this.toolbarModule&&this.toolbarModule.toolbar&&(this.toolbarModule.toolbar.width=this.grid?this.getGridWidthAsNumber():this.getWidthAsNumber()),this.enablePaging&&this.notify(wr,this),this.chart&&(this.showToolbar&&"Chart"===this.currentView||!this.showToolbar)&&(this.chart.width=this.showToolbar&&this.grid||"Both"===this.displayOption.view&&this.grid?this.getGridWidthAsNumber().toString():this.getWidthAsNumber().toString(),this.chart.height=this.pivotChartModule.getResizedChartHeight(),"Chart"===this.displayOption.view&&this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector("."+si)&&this.groupingBarModule.refreshUI())}},l.prototype.cellClicked=function(e,i,a){var r=this;if(e.classList.contains(Bt)&&(e.classList.contains(_t)?this.isPopupClicked=!1:this.isPopupClicked=!0),i&&!(0,t.isNullOrUndefined)(this.pivotValues)&&this.pivotValues.length>0){var n=parseInt(i.getAttribute("aria-colindex"),10)-1,s=Number(i.getAttribute("index")),o=Number(i.getAttribute("aria-colspan")),l={cancel:!1,isCellClick:!0,currentCell:i,data:this.pivotValues[s][n]};this.trigger(ta,l,(function(e){r.gridSettings.allowSelection&&(("Both"===r.gridSettings.selectionSettings.mode?i.classList.contains(Ht):"Row"===r.gridSettings.selectionSettings.mode)?r.clearSelection(i,a):e.cancel||(r.clearSelection(i,a),r.applyColumnSelection(a,i,n,n+(o>0?o-1:0),s)),"Column"===r.gridSettings.selectionSettings.mode||i.classList.contains(Ue)||r.rowDeselect(i,a,s,r.gridSettings.selectionSettings.mode,e),"Column"===r.gridSettings.selectionSettings.mode||e.cancel||(("Multiple"===r.gridSettings.selectionSettings.type?a.ctrlKey||a.shiftKey:r.selectedRowIndex===s)?r.selectedRowIndex=void 0:(r.selectedRowIndex=s,r.grid.selectionModule.selectRow(s-r.renderModule.rowStartPos),i.classList.add("e-focused")))),r.cellClick&&e.isCellClick&&r.trigger(Xi,{currentCell:i,data:r.pivotValues[s][n],nativeEvent:a}),r.getSelectedCellsPos()}))}else this.clearSelection(null,a)},l.prototype.rowDeselect=function(e,i,a,r,n){if(!i.shiftKey&&!i.ctrlKey&&"Both"!==this.gridSettings.selectionSettings.mode||"Single"===this.gridSettings.selectionSettings.type)if(e.classList.contains(Rt)||e.classList.contains(kt)||e.classList.contains(Ut)){if((0,t.removeClass)(this.element.querySelectorAll("."+Rt),Rt),(0,t.removeClass)(this.element.querySelectorAll("."+kt),kt),(0,t.removeClass)(this.element.querySelectorAll("."+Ut),Ut),n.cancel)this.setSavedSelectedCells();else if("Cell"===r)(0,t.addClass)([e],[Rt]);else if("Row"===r||"Single"===this.gridSettings.selectionSettings.type){var s='[index="'+a+'"]';(0,t.addClass)(this.element.querySelectorAll(s),[kt,Ut]),"Row"!==r&&e.classList.add(Rt)}}else n.cancel?this.setSavedSelectedCells():((0,t.removeClass)(this.element.querySelectorAll("."+Rt),Rt),(0,t.removeClass)(this.element.querySelectorAll("."+kt),kt),(0,t.removeClass)(this.element.querySelectorAll("."+Ut),Ut));else(i.shiftKey||i.ctrlKey||"Both"===this.gridSettings.selectionSettings.mode)&&n.cancel&&((0,t.removeClass)(this.element.querySelectorAll("."+Rt),Rt),(0,t.removeClass)(this.element.querySelectorAll("."+kt),kt),(0,t.removeClass)(this.element.querySelectorAll("."+Ut),Ut),this.setSavedSelectedCells())},l.prototype.clearSelection=function(e,i){if(!i.shiftKey&&!i.ctrlKey||"Single"===this.gridSettings.selectionSettings.type)if("Cell"===this.gridSettings.selectionSettings.mode)e&&e.classList.contains(Ue)?(0,t.removeClass)(this.element.querySelectorAll("."+Ht+"."+Rt),Rt):(0,t.removeClass)(this.element.querySelectorAll("."+Ue+"."+Ut),[Ut,kt]);else if("Both"===this.gridSettings.selectionSettings.mode)if(e&&e.classList.contains(Ht))for(var a=0,r=[].slice.call(this.element.querySelectorAll("."+kt+", ."+Rt));a<r.length;a++){var n=r[a];(0,t.removeClass)([n],[Ut,kt,Rt])}else(0,t.removeClass)(this.element.querySelectorAll("."+Rt),Rt)},l.prototype.applyRowSelection=function(e,t,i){var a=this.engineModule.pivotValues[t][e];if(i.ctrlKey||i.shiftKey||!a||this.selectedRowIndex===t)this.selectedRowIndex=void 0;else{this.selectedRowIndex=t;var r=a.level,n=t;do{n++,a=this.engineModule.pivotValues[n][e]}while(a&&r<a.level);var s=this;this.isAdaptive?this.rowRangeSelection={enable:!0,startIndex:t-s.renderModule.rowStartPos,endIndex:n-(1+s.renderModule.rowStartPos)}:s.grid.selectionModule.selectRowsByRange(t-s.renderModule.rowStartPos,n-(1+s.renderModule.rowStartPos))}},l.prototype.applyColumnSelection=function(e,i,a,r,n){if(!i.classList.contains(_e)&&("Cell"!==this.gridSettings.selectionSettings.mode||i.classList.contains(Ue))){var s=e.ctrlKey;this.isAdaptive&&"Multiple"===this.gridSettings.selectionSettings.type&&(this.grid.selectionModule.showPopup(e),this.isPopupClicked?(this.element.querySelector("."+Bt).classList.add(_t),s=!0):(this.element.querySelector("."+Bt).classList.remove(_t),s=!1));for(var o=[],l=this.gridSettings.selectionSettings.type,d=i.classList.contains(Ut),h=[],p={},u=a;u<=r;u++)h.push(u.toString());if(s&&"Single"!==l)d=!1;else{for(var c=0,g=[].slice.call(this.element.querySelectorAll("."+Ut));c<g.length;c++){var m=g[c];(0,t.removeClass)([m],[Ut,kt]),-1===h.indexOf((parseInt(m.getAttribute("aria-colindex"),10)-1).toString())&&(d=!1);var f=parseInt(m.getAttribute("aria-colindex"),10)-1;p[f]=f}h=Object.keys(p).length>0?Object.keys(p).sort((function(e,t){return parseInt(e,10)-parseInt(t,10)})):h}"Multiple"===l&&e.shiftKey?(this.shiftLockedPos=0===this.shiftLockedPos.length?h:this.shiftLockedPos,Number(this.shiftLockedPos[0])<=a?a=Number(this.shiftLockedPos[0]):r=r<Number(this.shiftLockedPos[this.shiftLockedPos.length-1])?Number(this.shiftLockedPos[this.shiftLockedPos.length-1]):r):this.shiftLockedPos=[];var v=[];if(e.ctrlKey&&"Both"===this.gridSettings.selectionSettings.mode&&"Multiple"===l&&!i.classList.contains(_e))for(var S=0,y=[].slice.call(this.element.querySelectorAll("."+_e+"."+Rt));S<y.length;S++){m=y[S];v.push(m.getAttribute("index"))}for(var b=a;b<=r;)o.push('[aria-colindex="'+(b+1)+'"]'+("Cell"===this.gridSettings.selectionSettings.mode?'[index="'+n+'"]':"")),b++;if(!d){n=i.classList.contains(Be)?n:this.renderModule.rowStartPos-1;for(var C=i.classList.contains(Ut),x=0,w=[].slice.call(this.element.querySelectorAll(o.toString()));x<w.length;x++){m=w[x];Number(m.getAttribute("index"))>=n&&(C&&s&&-1===v.indexOf(m.getAttribute("index"))?(0,t.removeClass)([m],[Ut,kt]):(0,t.addClass)([m],[Ut,kt]))}}this.renderModule.selected()}},l.prototype.getSelectedCellsPos=function(){var e=this;e.savedSelectedCellsPos=[],e.cellSelectionPos=[];for(var t=0,i=[].slice.call(this.element.querySelectorAll("."+kt));t<i.length;t++){var a=i[t];e.savedSelectedCellsPos.push({rowIndex:a.getAttribute("index"),colIndex:(parseInt(a.getAttribute("aria-colindex"),10)-1).toString()})}for(var r=0,n=[].slice.call(this.element.querySelectorAll("."+Rt));r<n.length;r++){a=n[r];e.cellSelectionPos.push({rowIndex:a.getAttribute("index"),colIndex:(parseInt(a.getAttribute("aria-colindex"),10)-1).toString()})}},l.prototype.setSavedSelectedCells=function(){for(var e=0,i=[].slice.call(this.savedSelectedCellsPos);e<i.length;e++){var a=i[e],r='[aria-colindex="'+(parseInt(a.colIndex,10)+1)+'"][index="'+a.rowIndex+'"]';(0,t.addClass)([this.element.querySelector(r)],[Ut,kt])}for(var n=0,s=[].slice.call(this.cellSelectionPos);n<s.length;n++){a=s[n],r='[aria-colindex="'+(parseInt(a.colIndex,10)+1)+'"][index="'+a.rowIndex+'"]';(0,t.addClass)([this.element.querySelector(r)],[Rt])}},l.prototype.renderEmptyGrid=function(){var e=this;if(this.isEmptyGrid=!0,this.notEmpty=!1,this.isInitial=!0,this.renderModule=this.renderModule?this.renderModule:new ys(this),this.grid&&this.grid.element&&this.element.querySelector("."+gt))this.notEmpty=!0,this.grid.setProperties({columns:this.renderModule.frameEmptyColumns(),dataSource:this.renderModule.frameEmptyData()},!0),this.grid.notify("datasource-modified",{}),this.grid.refreshColumns();else{this.element.querySelector("."+gt)&&(0,t.remove)(this.element.querySelector("."+gt)),this.renderModule.bindGrid(this,!0),this.grid.showSpinner=function(){},this.grid.hideSpinner=function(){};var i=(0,t.createElement)("div",{id:this.element.id+"_grid"});this.element.appendChild(i),this.grid.isStringTemplate=!0,this.grid.appendTo(i),this.grid.off("data-ready",this.grid.dataReady),this.grid.on("data-ready",(function(){e.grid.scrollModule.setWidth(),e.grid.scrollModule.setHeight()}))}},l.prototype.initEngine=function(){var e=this;if(this.element.querySelector(".e-spin-hide")&&this.showWaitingPopup(),"pivot"===this.dataType){var i=!(0,t.isNullOrUndefined)(this.dataSourceSettings.dataSource)&&this.dataSourceSettings.dataSource.length>0?this.dataSourceSettings.dataSource[0]:(0,t.isNullOrUndefined)(this.engineModule.data)?void 0:this.engineModule.data[0];if(i&&this.pivotCommon){var a="[object Array]"===Object.prototype.toString.call(i);if(a&&"JSON"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidJSON"));if(!a&&"CSV"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidCSV"))}}var r={dataSourceSettings:Di.getClonedDataSourceSettings(this.dataSourceSettings)};this.trigger(Ii,r,(function(t){Di.updateDataSourceSettings(e,t.dataSourceSettings),e.updatePageSettings(!1);var i={mode:"",savedFieldList:void 0,pageSettings:e.pageSettings,enableValueSorting:e.enableValueSorting,isDrillThrough:e.allowDrillThrough||e.editSettings.allowEditing,localeObj:e.localeObj,fieldsType:e.fieldsType,clonedReport:e.clonedReport,globalize:e.globalize,currenyCode:e.currencyCode,enablePaging:e.enablePaging,enableVirtualization:e.enableVirtualization,allowDataCompression:e.allowDataCompression,enableHtmlSanitizer:e.enableHtmlSanitizer,enableOptimizedRendering:e.enableVirtualization&&e.virtualScrollSettings&&e.virtualScrollSettings.allowSinglePage,isTabularLayout:e.isTabular};if("pivot"===e.dataType){if(e.dataSourceSettings.groupSettings&&e.dataSourceSettings.groupSettings.length>0){var a=e.engineModule.data;e.clonedDataSet=e.clonedDataSet?e.clonedDataSet:"CSV"===e.dataSourceSettings.type?Di.getClonedCSVData(a):Di.getClonedData(a);var r=JSON.parse(e.getPersistData()).dataSourceSettings;r.dataSource=[],e.clonedReport=e.clonedReport?e.clonedReport:r}"Server"!==e.dataSourceSettings.mode&&e.engineModule.renderEngine(e.dataSourceSettings,i,e.aggregateCellInfo?e.getValueCellInfo.bind(e):void 0,e.onHeadersSort?e.getHeaderSortInfo.bind(e):void 0),e.allowServerDataBinding=!1,e.setProperties({pivotValues:e.engineModule.pivotValues},!0),e.allowServerDataBinding=!0,e.enginePopulatedEventMethod("initEngine")}else"SSAS"===e.dataSourceSettings.providerType&&"olap"===e.dataType&&(i.savedFieldList=e.olapEngineModule.fieldList,i.savedFieldListData=e.olapEngineModule.fieldListData,Di.renderOlapEngine(e,i),e.allowServerDataBinding=!1,e.setProperties({pivotValues:e.olapEngineModule.pivotValues},!0),e.allowServerDataBinding=!0,e.enginePopulatedEventMethod("initEngine"))}))},l.prototype.enginePopulatedEventMethod=function(e,t){if("initEngine"===e){var i=t||this;this.trigger(Fi,{pivotValues:this.pivotValues},(function(e){"olap"===i.dataType?(i.olapEngineModule.pivotValues=e.pivotValues,i.setProperties({pivotValues:i.olapEngineModule.pivotValues},!0)):(i.engineModule.pivotValues=e.pivotValues,i.setProperties({pivotValues:i.engineModule.pivotValues},!0)),i.notify(fr,{}),i.notEmpty=!0}))}else{var a=t||this,r={dataSourceSettings:a.dataSourceSettings,pivotValues:a.pivotValues};a.trigger(Fi,r,(function(e){a.dataSourceSettings=e.dataSourceSettings,"olap"===a.dataType?(a.olapEngineModule.pivotValues=e.pivotValues,a.allowServerDataBinding=!1,a.setProperties({pivotValues:a.olapEngineModule.pivotValues},!0),a.allowServerDataBinding=!0):(a.engineModule.pivotValues=e.pivotValues,a.allowServerDataBinding=!1,a.setProperties({pivotValues:a.engineModule.pivotValues},!0),a.allowServerDataBinding=!0),a.pivotCommon&&(a.pivotCommon.engineModule="olap"===a.dataType?a.olapEngineModule:a.engineModule,a.pivotCommon.dataSourceSettings=a.dataSourceSettings),a.renderPivotGrid()}))}},l.prototype.generateData=function(){this.isStaticRefresh||("Chart"!==this.displayOption.view&&(0,t.isNullOrUndefined)(this.grid)?(this.renderEmptyGrid(),this.showWaitingPopup()):(this.showWaitingPopup(),clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.refreshData.bind(this),100)))},l.prototype.refreshData=function(){var e=this;e.isStaticRefresh?(e.isStaticRefresh=!1,e.hideWaitingPopup()):e.dataSourceSettings&&(e.dataSourceSettings.dataSource||e.dataSourceSettings.url)?e.dataSourceSettings.dataSource instanceof i.DataManager?"pivot"===e.dataType&&e.remoteData.length>0?(this.element.querySelector(".e-spinner-pane")||this.showWaitingPopup(),this.engineModule.data=e.remoteData,this.initEngine()):(0,t.isNullOrUndefined)(e.engineModule.data)||0!==e.engineModule.data.length?e.initEngine():(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(e.getData.bind(e),100)):""!==this.dataSourceSettings.url&&"olap"===this.dataType||e.dataSourceSettings.dataSource&&e.dataSourceSettings.dataSource.length>0||this.engineModule.data&&this.engineModule.data.length>0?("pivot"===e.dataType&&(this.hideWaitingPopup(),e.engineModule.data=e.dataSourceSettings.dataSource),e.initEngine()):"Server"===this.dataSourceSettings.mode?this.getEngine("onRefresh"):(this.notify(fr,{}),this.hideWaitingPopup()):(this.notify(fr,{}),this.hideWaitingPopup())},l.prototype.getValueCellInfo=function(e){var t=e;return this.trigger(Ba,t),t},l.prototype.getHeaderSortInfo=function(e){var t=e;return this.trigger(Ga,t),t},l.prototype.bindTriggerEvents=function(e){this.trigger((0,gs.getObject)("name",e),e)},l.prototype.getData=function(){this.dataSourceSettings.dataSource.defaultQuery?this.dataSourceSettings.dataSource.executeQuery(this.dataSourceSettings.dataSource.defaultQuery).then(this.executeQuery.bind(this)):this.dataSourceSettings.dataSource.executeQuery(new i.Query).then(this.executeQuery.bind(this))},l.prototype.executeQuery=function(e){this.element.querySelector(".e-spinner-pane")||this.showWaitingPopup();var i=this;i.engineModule.data=e.result,this.isEmptyGrid&&!(0,t.isNullOrUndefined)(i.engineModule.data)&&0===i.engineModule.data.length?this.hideWaitingPopup():!(0,t.isNullOrUndefined)(i.engineModule.data)&&i.engineModule.data.length>0?(this.isEmptyGrid=!1,i.initEngine()):(this.isEmptyGrid=!0,this.hideWaitingPopup(),this.renderEmptyGrid(),this.engineModule.fieldList=null,this.engineModule.isEmptyData=!0,this.pivotValues=[],this.engineModule.data=[],this.notify(fr,{}))},l.prototype.applyFormatting=function(e){if(e){for(var i=[],a=e.length,r=0;r<a;r++)(0,t.isNullOrUndefined)(e[r])||void 0!==e[r][0]||i.push(r);for(r=0;r<e.length;r++)for(var n=this.isTabular?this.engineModule.rowMaxLevel+1:1;e[r]&&n<e[r].length;n++)if("value"===e[r][n].axis&&""!==e[r][n].formattedText){e[r][n].style=void 0,e[r][n].cssClass=void 0;for(var s=this.dataSourceSettings.conditionalFormatSettings,o=0;o<s.length;o++)!0!==s[o].applyGrandTotals&&!(0,t.isNullOrUndefined)(s[o].applyGrandTotals)&&e[r][n].isGrandSum||this.checkCondition(e[r][n].value,s[o].conditions,s[o].value1,s[o].value2)&&(s[o].measure&&e[r][n].actualText!==s[o].measure||void 0!==s[o].measure&&""===s[o].measure||void 0!==s[o].label&&""===s[o].label||!(!s[o].label||e[r][0].valueSort.levelName.indexOf(s[o].label)>-1||e[r][n].rowHeaders.indexOf(s[o].label)>-1||e[r][n].columnHeaders.indexOf(s[o].label)>-1)||(s[o].style&&s[o].style.backgroundColor&&(s[o].style.backgroundColor="#"===s[o].style.backgroundColor.charAt(0)&&this.conditionalFormattingModule.isHex(s[o].style.backgroundColor.substr(1))?s[o].style.backgroundColor:this.conditionalFormattingModule.colourNameToHex(s[o].style.backgroundColor)),s[o].style&&s[o].style.color&&(s[o].style.color="#"===s[o].style.color.charAt(0)&&this.conditionalFormattingModule.isHex(s[o].style.color.substr(1))?s[o].style.color:this.conditionalFormattingModule.colourNameToHex(s[o].style.color)),e[r][n].style=s[o].style,e[r][n].cssClass="format"+this.element.id+o))}var l=this.dataSourceSettings.conditionalFormatSettings;for(o=0;o<l.length;o++){var d=this.createStyleSheet.bind(this)(),h="color: "+l[o].style.color+"!important;background-color: "+l[o].style.backgroundColor+"!important;font-size: "+l[o].style.fontSize+"!important;font-family: "+l[o].style.fontFamily+" !important;",p=".format"+this.element.id+o;d.insertRule(p+", "+p+" .e-cellvalue{"+h+"}",0)}}},l.prototype.createStyleSheet=function(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet},l.prototype.applyHyperlinkSettings=function(){if(this.pivotValues){for(var e=this.pivotValues,i=[],a=e.length,r=0;r<a;r++)(0,t.isNullOrUndefined)(e[r])||void 0!==e[r][0]||i.push(r);if(this.hyperlinkSettings.conditionalSettings.length>0)for(r=0;r<e.length;r++)for(var n=this.isTabular?this.engineModule.rowMaxLevel+1:1;e[r]&&n<e[r].length;n++)if("value"===e[r][n].axis){e[r][n].enableHyperlink=!1;for(var s=this.hyperlinkSettings.conditionalSettings,o=0;o<s.length;o++)if(this.checkCondition(e[r][n].value,s[o].conditions,s[o].value1,s[o].value2)){var l="row"===this.dataSourceSettings.valueAxis?r:"pivot"===this.dataType?this.engineModule.headerContent.length-1:this.olapEngineModule.headerContent.length-1,d="row"===this.dataSourceSettings.valueAxis?0:n;(!s[o].measure||1===this.dataSourceSettings.values.length||e[l][d].valueSort&&e[l][d].actualText===s[o].measure)&&(!s[o].label||e[i[s[o].label.split(".").length-1]]&&e[i[s[o].label.split(".").length-1]][n]&&e[i[s[o].label.split(".").length-1]][n].valueSort&&e[i[s[o].label.split(".").length-1]][n].valueSort[s[o].label]||e[r][0].valueSort.levelName.indexOf(s[o].label)>-1)&&(e[r][n].enableHyperlink=!0)}}if((0,t.isNullOrUndefined)(this.hyperlinkSettings.headerText))return;var h=this.dataSourceSettings.valueSortSettings.headerDelimiter?this.dataSourceSettings.valueSortSettings.headerDelimiter:".";for(r=0;r<e.length;r++)for(n=this.isTabular?this.engineModule.rowMaxLevel+1:1;e[r]&&n<e[r].length;n++)if("value"===e[r][n].axis){var p=this.hyperlinkSettings.headerText;if(e[r][0].valueSort.levelName.indexOf(p)>-1)e[r][0].enableHyperlink=!0,e[r][n].enableHyperlink=!0;else{var u=!1;for(o=0;o<i.length;o++)p=h+this.hyperlinkSettings.headerText,(h+e[i[o]][n].valueSort.levelName).indexOf(p)>-1&&(e[i[o]][n].enableHyperlink=!0,u=!0);e[r][n].enableHyperlink=u}}}},l.prototype.checkCondition=function(e,t,i,a){switch(t){case"LessThan":return e<i;case"LessThanOrEqualTo":return e<=i;case"GreaterThan":return e>i;case"GreaterThanOrEqualTo":return e>=i;case"Equals":return e===i;case"NotEquals":return e!==i;case"Between":return i<a&&e>=i&&e<=a||i>a&&e<=i&&e>=a;case"NotBetween":return!(i<a&&e>=i&&e<=a||i>a&&e<=i&&e>=a);default:return!1}},l.prototype.updateGroupingReport=function(e,i){if(!this.clonedDataSet&&!this.clonedReport){var a=this.engineModule.data;this.clonedDataSet="CSV"===this.dataSourceSettings.type?Di.getClonedCSVData(a):Di.getClonedData(a);var r=JSON.parse(this.getPersistData()).dataSourceSettings;r.dataSource=[],this.clonedReport=this.clonedReport?this.clonedReport:r}var n=/_date_group_years|_date_group_quarters|_date_group_quarterYear|_date_group_months|_date_group_days|_date_group_hours|_date_group_minutes|_date_group_seconds/g,s="CSV"===this.dataSourceSettings.type?Di.getClonedCSVData(this.clonedDataSet):Di.getClonedData(this.clonedDataSet),o=this.dataSourceSettings,l=this.clonedReport.properties?this.clonedReport.properties:this.clonedReport,d=[o.rows,o.columns,o.values,o.filters],h=[o.filterSettings,o.sortSettings,o.formatSettings,o.drilledMembers],p=l.rows;if(p=p.concat(l.columns,l.values,l.filters),0===e.length||e.length>0){this.engineModule.groupingFields={},this.setProperties({dataSourceSettings:{dataSource:s,groupSettings:e.length>0?o.groupSettings:[]}},!0);for(var u,c="Date"===i,g=[],m=0,f=d.length;m<f;m++)for(var v,S,y=function(e,i){var a=d[m][e].name;-1===g.indexOf(a)&&g.push(a);var r=g.indexOf(a);if(!(0,t.isNullOrUndefined)(a.match(n))&&c||-1!==a.indexOf("_custom_group")&&!Di.getFieldByName(a.replace("_custom_group",""),o.groupSettings)){d[m].splice(e,1),g.splice(r,1),e--,i--,a=a.split("_")[0];for(var s=!1,l=0;l<d.length&&!(s=d[l].filter((function(e){return e.name===a})).length>0);l++);if(!s){u=a.split("_")[0];var h=Di.getFieldByName(u,p);p=p.filter((function(e){return e.name!==u})),g.push(u),h&&(s?d[m].splice(e,1,h):d[m].splice(++e,0,h))}}else{(h=Di.getFieldByName(a,p))?d[m].splice(e,1,h):u===a&&d[m].splice(e,1)}v=e,S=i},b=0,C=d[m].length;b<C;b++)y(b,C),b=v,C=S;for(var x=0,w=g;x<w.length;x++){var T=w[x],M=Di.getFilterItemByName(T,l.filterSettings),D=Di.getFieldByName(T,l.sortSettings),O=Di.getFieldByName(T,l.formatSettings),P=Di.getFieldByName(T,l.drilledMembers),N=[M,D,O,P];for(m=0,f=h.length;m<f;m++){var E=!1;for(b=0,C=h[m].length;b<C;b++){var I=h[m][b].name;if(!(0,t.isNullOrUndefined)(I.match(n))&&c||-1!==I.indexOf("_custom_group")&&!Di.getFieldByName(I.replace("_custom_group",""),o.groupSettings))h[m].splice(b,1),b--,C--;else if(T===h[m][b].name){E=!0,N[m]?h[m].splice(b,1,N[m]):(h[m].splice(b,1),b--,C--);break}}!E&&0===m&&M&&h[m].push(M),!E&&1===m&&D&&h[m].push(D),!E&&2===m&&O&&h[m].push(O),!E&&3===m&&P&&h[m].push(P)}}}},l.prototype.removeButtonFocus=function(){document.querySelectorAll(".e-btn-focused")&&(0,t.removeClass)(document.querySelectorAll(".e-btn-focused"),"e-btn-focused")},l.prototype.wireEvents=function(){var e=this.virtualScrollSettings&&this.virtualScrollSettings.allowSinglePage&&"pivot"===this.dataType;"Chart"!==this.displayOption.view&&(t.EventHandler.add(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler,this),t.EventHandler.add(this.element,"mousedown",this.mouseDownHandler,this),t.EventHandler.add(this.element.querySelector("."+Gt),"mousemove",this.mouseMoveHandler,this),t.EventHandler.add(this.element,"mouseup",this.mouseUpHandler,this),t.EventHandler.add(this.element,this.isAdaptive?"touchend":"contextmenu",this.mouseRclickHandler,this),this.virtualscrollModule&&this.enableVirtualization&&!e&&t.EventHandler.add(this.element.querySelector("."+zt).querySelector("."+R),"scroll",this.headerScrollUpdate,this)),t.EventHandler.add(document,this.isAdaptive?"touchend":"click",this.removeButtonFocus,this),window.addEventListener("resize",this.onWindowResize.bind(this),!0)},l.prototype.headerScrollUpdate=function(){this.element.querySelector("."+At).scrollLeft!==this.element.querySelector("."+zt).querySelector("."+R).scrollLeft&&(this.virtualscrollModule.direction="horizondal"),this.element.querySelector("."+At).scrollLeft=this.element.querySelector("."+zt).querySelector("."+R).scrollLeft},l.prototype.unwireEvents=function(){"Chart"!==this.displayOption.view&&(t.EventHandler.remove(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler),t.EventHandler.remove(this.element,"mousedown",this.mouseDownHandler),this.element.querySelector("."+Gt)&&t.EventHandler.remove(this.element.querySelector("."+Gt),"mousemove",this.mouseMoveHandler),t.EventHandler.remove(this.element,"mouseup",this.mouseUpHandler),t.EventHandler.remove(this.element,this.isAdaptive?"touchend":"contextmenu",this.mouseRclickHandler),this.virtualscrollModule&&this.enableVirtualization&&this.element.querySelector("."+zt)&&t.EventHandler.remove(this.element.querySelector("."+zt).querySelector("."+R),"scroll",this.headerScrollUpdate)),t.EventHandler.remove(document,this.isAdaptive?"touchend":"click",this.removeButtonFocus),window.removeEventListener("resize",this.onWindowResize.bind(this),!0)},l.prototype.actionBeginMethod=function(){var e={dataSourceSettings:Di.getClonedDataSourceSettings(this.dataSourceSettings),actionName:this.actionObj.actionName,fieldInfo:this.actionObj.fieldInfo,cancel:!1};return this.trigger(or,e),e.cancel},l.prototype.actionCompleteMethod=function(){var e={dataSourceSettings:Di.getClonedDataSourceSettings(this.dataSourceSettings),actionName:this.actionObj.actionName,fieldInfo:this.actionObj.fieldInfo,actionInfo:this.actionObj.actionInfo};this.trigger(lr,e),this.actionObj.actionName="",this.actionObj.actionInfo=void 0,this.actionObj.fieldInfo=void 0},l.prototype.actionFailureMethod=function(e){var t={actionName:this.actionObj.actionName,errorInfo:e};this.trigger(dr,t)},l.prototype.getActionCompleteName=function(){var e;switch(this.actionObj.actionName){case Rr:case nn:e=Vn;break;case kr:case rn:e=Hn;break;case Vr:e=Un;break;case Hr:e=_n;break;case Kr:e=Bn;break;case Xr:e=Gn;break;case Jr:e=zn;break;case Zr:e=Wn;break;case $r:e=Qn;break;case en:e=Yn;break;case tn:e=Kn;break;case an:e=Xn;break;case Dr:e=Jn;break;case un:e=xn;break;case ln:e=Zn;break;case dn:e=$n;break;case hn:e=es;break;case pn:e=ts;break;case vn:e=is;break;case cn:e=as;break;case sn:e=rs;break;case gn:e=wn;break;case mn:e=Tn;break;case fn:e=Mn;break;case Gr:e=kn;break;case Qr:e=jn;break;case Yr:e=qn;break;case Br:e=Rn;break;case Wr:e=An;break;case zr:e=Ln;break;case yn:e=ns;break;case Er:e=Pn;break;case Nr:e=Nn;break;case Ir:e=En;break;case Fr:e=In;break;case gr:e=ds;break;case cr:e=ls;break;case bn:e=hs;break;case Cn:e=ps;break;default:e=this.actionObj.actionName}return e},l.prototype.getStackedColumns=function(e,t){for(var i=0,a=e;i<a.length;i++){var r=a[i];t.push(r),r.columns&&r.columns.length>0&&this.getStackedColumns(r.columns,t)}return t},l.prototype.destroy=function(){this.removeInternalEvents(),this.engineModule&&(this.engineModule.fieldList={},this.engineModule.rMembers=null,this.engineModule.cMembers=null,this.engineModule.valueMatrix=[],this.engineModule={}),this.olapEngineModule&&(this.olapEngineModule.fieldList={},this.olapEngineModule={}),this.showGroupingBar&&this.groupingBarModule&&this.groupingBarModule.destroy(),this.allowGrouping&&this.groupingModule&&this.groupingModule.destroy(),this.showToolbar&&this.toolbarModule&&this.toolbarModule.destroy(),this.enablePaging&&this.pagerModule&&this.pagerModule.destroy(),this.enableVirtualization&&this.virtualscrollModule&&this.virtualscrollModule.destroy(),this.allowConditionalFormatting&&this.conditionalFormattingModule&&this.conditionalFormattingModule.destroy(),this.allowNumberFormatting&&this.numberFormattingModule&&this.numberFormattingModule.destroy(),this.contextMenuModule&&this.contextMenuModule.destroy(),this.keyboardModule&&this.keyboardModule.destroy(),this.tooltip&&!this.tooltip.isDestroyed&&this.tooltip.destroy(),this.calculatedFieldModule&&this.calculatedFieldModule.destroy(),this.chart&&!this.chart.isDestroyed&&(this.chart.destroy(),this.chart.isDestroyed&&(0,t.select)("#"+this.element.id+"_chart",this.element)&&(0,t.remove)((0,t.select)("#"+this.element.id+"_chart",this.element))),this.grid&&!this.grid.isDestroyed&&(this.grid.destroy(),this.grid.isDestroyed&&(0,t.select)("#"+this.element.id+"_grid",this.element)&&(0,t.remove)((0,t.select)("#"+this.element.id+"_grid",this.element))),this.commonModule&&this.commonModule.destroy(),this.pivotChartModule&&this.pivotChartModule.destroy(),this.pivotButtonModule&&!this.pivotButtonModule.isDestroyed&&this.pivotButtonModule.destroy(),this.pivotFieldListModule&&!this.pivotFieldListModule.isDestroyed&&(this.pivotFieldListModule.destroy(),this.pivotFieldListModule.isDestroyed&&null!==(0,t.select)("#"+this.element.id+"_PivotFieldList",this.element)&&(0,t.remove)((0,t.select)("#"+this.element.id+"_PivotFieldList",this.element))),(this.allowDrillThrough||this.editSettings&&this.editSettings.allowEditing)&&this.drillThroughModule&&this.drillThroughModule.destroy(),this.chartExportModule&&this.chartExportModule.destroy(),this.unwireEvents(),e.prototype.destroy.call(this),this.groupingBarModule&&(this.groupingBarModule=null),this.groupingModule&&(this.groupingModule=null),this.pivotFieldListModule&&(this.pivotFieldListModule=null),this.calculatedFieldModule&&(this.calculatedFieldModule=null),this.conditionalFormattingModule&&(this.conditionalFormattingModule=null),this.numberFormattingModule&&(this.numberFormattingModule=null),this.toolbarModule&&(this.toolbarModule=null),this.pagerModule&&(this.pagerModule=null),this.virtualscrollModule&&(this.virtualscrollModule=null),this.contextMenuModule&&(this.contextMenuModule=null),this.keyboardModule&&(this.keyboardModule=null),this.tooltip&&(this.tooltip=null),this.chart&&(this.chart=null),this.grid&&(this.grid=null),this.commonModule&&(this.commonModule=null),this.pivotChartModule&&(this.pivotChartModule=null),this.pivotButtonModule&&(this.pivotButtonModule=null),this.renderModule&&(this.renderModule=null),this.axisFieldModule&&(this.axisFieldModule=null),this.pdfExportModule&&(this.pdfExportModule=null),this.excelExportModule&&(this.excelExportModule=null),this.drillThroughModule&&(this.drillThroughModule=null),this.clonedDataSet&&(this.clonedDataSet=null),this.clonedReport&&(this.clonedReport=null),this.pagerModule&&(this.pagerModule=null),this.chartExportModule&&(this.chartExportModule=null),this.exportSpecifiedPages&&(this.exportSpecifiedPages=void 0),this.element.innerHTML="",(0,t.removeClass)([this.element],r),(0,t.removeClass)([this.element],n),(0,t.removeClass)([this.element],s),this.globalize=null,this.localeObj=null,this.currentView=null,this.fieldListSpinnerElement=null,this.lastSortInfo=null,this.lastFilterInfo=null,this.lastAggregationInfo=null,this.lastCalcFieldInfo=null,this.lastCellClicked=null,this.lastColumn=null,this.pivotCommon=null},l.prototype.showNumberFormattingDialog=function(){this.allowNumberFormatting&&this.numberFormattingModule.showNumberFormattingDialog()},l.prototype.getValuesHeader=function(e,i){var a=this.dataSourceSettings.values;return"value"===i&&!(0,t.isNullOrUndefined)(e.valueSort)&&this.localeObj.getConstant("grandTotal")+this.dataSourceSettings.valueSortSettings.headerDelimiter+e.formattedText===e.valueSort.levelName&&("column"===e.axis&&0===this.dataSourceSettings.columns.length&&"column"===this.dataSourceSettings.valueAxis||"row"===e.axis&&0===this.dataSourceSettings.rows.length&&"row"===this.dataSourceSettings.valueAxis)?this.localeObj.getConstant("total")+" "+this.localeObj.getConstant(this.engineModule.fieldList[e.actualText].aggregateType)+" "+this.localeObj.getConstant("of")+" "+e.formattedText:"grandTotal"===i&&1===a.length&&"row"===this.dataSourceSettings.valueAxis&&e.formattedText===this.localeObj.getConstant("grandTotal")?this.localeObj.getConstant("total")+" "+this.localeObj.getConstant(a[a.length-1].type)+" "+this.localeObj.getConstant("of")+" "+((0,t.isNullOrUndefined)(a[a.length-1].caption)?a[a.length-1].name:a[a.length-1].caption):e.formattedText},l.prototype.setColumnWidth=function(e,t){e.autoFit||("auto"!==e.width?e.width=this.renderModule.lastColumn&&e.field===this.renderModule.lastColumn.field?t-3:t:e.minWidth=t)},tl([(0,t.Property)("USD")],l.prototype,"currencyCode",void 0),tl([(0,t.Property)(!1)],l.prototype,"showFieldList",void 0),tl([(0,t.Complex)({},Ks)],l.prototype,"gridSettings",void 0),tl([(0,t.Complex)({},Qo)],l.prototype,"chartSettings",void 0),tl([(0,t.Complex)({},il)],l.prototype,"groupingBarSettings",void 0),tl([(0,t.Complex)({},nl)],l.prototype,"hyperlinkSettings",void 0),tl([(0,t.Complex)({},sl)],l.prototype,"pageSettings",void 0),tl([(0,t.Complex)({},ol)],l.prototype,"pagerSettings",void 0),tl([(0,t.Complex)({},Ws)],l.prototype,"dataSourceSettings",void 0),tl([(0,t.Complex)({},al)],l.prototype,"editSettings",void 0),tl([(0,t.Complex)({},ll)],l.prototype,"displayOption",void 0),tl([(0,t.Complex)({},dl)],l.prototype,"virtualScrollSettings",void 0),tl([(0,t.Property)()],l.prototype,"pivotValues",void 0),tl([(0,t.Property)(!1)],l.prototype,"showGroupingBar",void 0),tl([(0,t.Property)(!0)],l.prototype,"showTooltip",void 0),tl([(0,t.Property)(!1)],l.prototype,"showToolbar",void 0),tl([(0,t.Property)([])],l.prototype,"toolbar",void 0),tl([(0,t.Property)(!1)],l.prototype,"showValuesButton",void 0),tl([(0,t.Property)(!1)],l.prototype,"allowCalculatedField",void 0),tl([(0,t.Property)(!1)],l.prototype,"enableFieldSearching",void 0),tl([(0,t.Property)(!1)],l.prototype,"enableValueSorting",void 0),tl([(0,t.Property)(!1)],l.prototype,"allowConditionalFormatting",void 0),tl([(0,t.Property)(!1)],l.prototype,"allowNumberFormatting",void 0),tl([(0,t.Property)("auto")],l.prototype,"height",void 0),tl([(0,t.Property)("auto")],l.prototype,"width",void 0),tl([(0,t.Property)(!1)],l.prototype,"allowExcelExport",void 0),tl([(0,t.Property)(!1)],l.prototype,"enableVirtualization",void 0),tl([(0,t.Property)(!1)],l.prototype,"enablePaging",void 0),tl([(0,t.Property)(!1)],l.prototype,"allowDrillThrough",void 0),tl([(0,t.Property)(!1)],l.prototype,"allowPdfExport",void 0),tl([(0,t.Property)(!1)],l.prototype,"allowDeferLayoutUpdate",void 0),tl([(0,t.Property)(!1)],l.prototype,"allowDataCompression",void 0),tl([(0,t.Property)(1e3)],l.prototype,"maxNodeLimitInMemberEditor",void 0),tl([(0,t.Property)(1e4)],l.prototype,"maxRowsInDrillThrough",void 0),tl([(0,t.Property)(!0)],l.prototype,"loadOnDemandInMemberEditor",void 0),tl([(0,t.Property)(!1)],l.prototype,"enableHtmlSanitizer",void 0),tl([(0,t.Property)()],l.prototype,"cellTemplate",void 0),tl([(0,t.Property)()],l.prototype,"toolbarTemplate",void 0),tl([(0,t.Property)()],l.prototype,"tooltipTemplate",void 0),tl([(0,t.Property)()],l.prototype,"spinnerTemplate",void 0),tl([(0,t.Property)(!1)],l.prototype,"allowGrouping",void 0),tl([(0,t.Property)(!0)],l.prototype,"exportAllPages",void 0),tl([(0,t.Property)(["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"])],l.prototype,"aggregateTypes",void 0),tl([(0,t.Property)(["Column","Bar","Line","Area","Scatter","Polar","StackingColumn","StackingArea","StackingBar","StackingLine","StepLine","StepArea","SplineArea","Spline","StackingColumn100","StackingBar100","StackingArea100","StackingLine100","Bubble","Pareto","Radar","Pie","Doughnut","Funnel","Pyramid"])],l.prototype,"chartTypes",void 0),tl([(0,t.Property)("")],l.prototype,"cssClass",void 0),tl([(0,t.Event)()],l.prototype,"queryCellInfo",void 0),tl([(0,t.Event)()],l.prototype,"headerCellInfo",void 0),tl([(0,t.Event)()],l.prototype,"resizing",void 0),tl([(0,t.Event)()],l.prototype,"resizeStop",void 0),tl([(0,t.Event)()],l.prototype,"pdfHeaderQueryCellInfo",void 0),tl([(0,t.Event)()],l.prototype,"pdfQueryCellInfo",void 0),tl([(0,t.Event)()],l.prototype,"excelHeaderQueryCellInfo",void 0),tl([(0,t.Event)()],l.prototype,"excelQueryCellInfo",void 0),tl([(0,t.Event)()],l.prototype,"columnDragStart",void 0),tl([(0,t.Event)()],l.prototype,"columnDrag",void 0),tl([(0,t.Event)()],l.prototype,"columnDrop",void 0),tl([(0,t.Event)()],l.prototype,"beforePdfExport",void 0),tl([(0,t.Event)()],l.prototype,"beforeExcelExport",void 0),tl([(0,t.Event)()],l.prototype,"beforeColumnsRender",void 0),tl([(0,t.Event)()],l.prototype,"selected",void 0),tl([(0,t.Event)()],l.prototype,"selecting",void 0),tl([(0,t.Event)()],l.prototype,"cellDeselected",void 0),tl([(0,t.Event)()],l.prototype,"rowSelected",void 0),tl([(0,t.Event)()],l.prototype,"rowDeselected",void 0),tl([(0,t.Event)()],l.prototype,"chartTooltipRender",void 0),tl([(0,t.Event)()],l.prototype,"chartLegendClick",void 0),tl([(0,t.Event)()],l.prototype,"beforePrint",void 0),tl([(0,t.Event)()],l.prototype,"animationComplete",void 0),tl([(0,t.Event)()],l.prototype,"legendRender",void 0),tl([(0,t.Event)()],l.prototype,"textRender",void 0),tl([(0,t.Event)()],l.prototype,"pointRender",void 0),tl([(0,t.Event)()],l.prototype,"seriesRender",void 0),tl([(0,t.Event)()],l.prototype,"chartMouseMove",void 0),tl([(0,t.Event)()],l.prototype,"chartMouseClick",void 0),tl([(0,t.Event)()],l.prototype,"pointMove",void 0),tl([(0,t.Event)()],l.prototype,"chartMouseLeave",void 0),tl([(0,t.Event)()],l.prototype,"chartMouseDown",void 0),tl([(0,t.Event)()],l.prototype,"chartMouseUp",void 0),tl([(0,t.Event)()],l.prototype,"dragComplete",void 0),tl([(0,t.Event)()],l.prototype,"zoomComplete",void 0),tl([(0,t.Event)()],l.prototype,"scrollStart",void 0),tl([(0,t.Event)()],l.prototype,"scrollEnd",void 0),tl([(0,t.Event)()],l.prototype,"scrollChanged",void 0),tl([(0,t.Event)()],l.prototype,"multiLevelLabelRender",void 0),tl([(0,t.Event)()],l.prototype,"chartLoaded",void 0),tl([(0,t.Event)()],l.prototype,"chartLoad",void 0),tl([(0,t.Event)()],l.prototype,"chartResized",void 0),tl([(0,t.Event)()],l.prototype,"chartAxisLabelRender",void 0),tl([(0,t.Event)()],l.prototype,"multiLevelLabelClick",void 0),tl([(0,t.Event)()],l.prototype,"chartPointClick",void 0),tl([(0,t.Event)()],l.prototype,"contextMenuClick",void 0),tl([(0,t.Event)()],l.prototype,"contextMenuOpen",void 0),tl([(0,t.Event)()],l.prototype,"onPdfCellRender",void 0),tl([(0,t.Event)()],l.prototype,"saveReport",void 0),tl([(0,t.Event)()],l.prototype,"fetchReport",void 0),tl([(0,t.Event)()],l.prototype,"loadReport",void 0),tl([(0,t.Event)()],l.prototype,"renameReport",void 0),tl([(0,t.Event)()],l.prototype,"removeReport",void 0),tl([(0,t.Event)()],l.prototype,"newReport",void 0),tl([(0,t.Event)()],l.prototype,"toolbarRender",void 0),tl([(0,t.Event)()],l.prototype,"toolbarClick",void 0),tl([(0,t.Event)()],l.prototype,"load",void 0),tl([(0,t.Event)()],l.prototype,"enginePopulating",void 0),tl([(0,t.Event)()],l.prototype,"enginePopulated",void 0),tl([(0,t.Event)()],l.prototype,"onFieldDropped",void 0),tl([(0,t.Event)()],l.prototype,"fieldDrop",void 0),tl([(0,t.Event)()],l.prototype,"fieldDragStart",void 0),tl([(0,t.Event)()],l.prototype,"dataBound",void 0),tl([(0,t.Event)()],l.prototype,"created",void 0),tl([(0,t.Event)()],l.prototype,"destroyed",void 0),tl([(0,t.Event)()],l.prototype,"beforeExport",void 0),tl([(0,t.Event)()],l.prototype,"exportComplete",void 0),tl([(0,t.Event)()],l.prototype,"conditionalFormatting",void 0),tl([(0,t.Event)()],l.prototype,"memberFiltering",void 0),tl([(0,t.Event)()],l.prototype,"cellClick",void 0),tl([(0,t.Event)()],l.prototype,"drillThrough",void 0),tl([(0,t.Event)()],l.prototype,"editCompleted",void 0),tl([(0,t.Event)()],l.prototype,"beginDrillThrough",void 0),tl([(0,t.Event)()],l.prototype,"hyperlinkCellClick",void 0),tl([(0,t.Event)()],l.prototype,"cellSelecting",void 0),tl([(0,t.Event)()],l.prototype,"drill",void 0),tl([(0,t.Event)()],l.prototype,"cellSelected",void 0),tl([(0,t.Event)()],l.prototype,"chartSeriesCreated",void 0),tl([(0,t.Event)()],l.prototype,"aggregateCellInfo",void 0),tl([(0,t.Event)()],l.prototype,"fieldListRefreshed",void 0),tl([(0,t.Event)()],l.prototype,"memberEditorOpen",void 0),tl([(0,t.Event)()],l.prototype,"calculatedFieldCreate",void 0),tl([(0,t.Event)()],l.prototype,"numberFormatting",void 0),tl([(0,t.Event)()],l.prototype,"aggregateMenuOpen",void 0),tl([(0,t.Event)()],l.prototype,"fieldRemove",void 0),tl([(0,t.Event)()],l.prototype,"beforeServiceInvoke",void 0),tl([(0,t.Event)()],l.prototype,"afterServiceInvoke",void 0),tl([(0,t.Event)()],l.prototype,"actionBegin",void 0),tl([(0,t.Event)()],l.prototype,"actionComplete",void 0),tl([(0,t.Event)()],l.prototype,"actionFailure",void 0),tl([(0,t.Event)()],l.prototype,"onHeadersSort",void 0),l=tl([t.NotifyPropertyChanges],l)}(t.Component),pl=v(437),ul=function(){function e(){}return e.getClonedPivotValues=function(e){for(var t=[],i=0;i<e.length;i++)if(e[i]){t[i]=[];for(var a=0;a<e[i].length;a++)e[i][a]&&(t[i][a]=this.getClonedPivotValueObj(e[i][a]))}return t},e.getClonedPivotValueObj=function(e){var t=0,i={};if(null!=e)for(var a=Object.keys(e);t<a.length;)i[a[t]]=e[a[t]],t++;else i=e;return i},e.isContainCommonElements=function(e,t){for(var i=0,a=e.length;i<a;i++)for(var r=0,n=t.length;r<n;r++)if(t[r]===e[i])return!0;return!1},e}(),cl=function(){function e(e){this.actualrCnt=0,this.parent=e}return e.prototype.getModuleName=function(){return"excelExport"},e.prototype.addHeaderAndFooter=function(e,i,a,r){var n=[];if((0,t.isNullOrUndefined)(e.rows))""!==i&&("footer"===a&&this.actualrCnt++,n.push({index:1,value:i}),this.rows.push({index:this.actualrCnt+1,cells:n}),this.actualrCnt="header"===a?this.actualrCnt+2:this.actualrCnt);else{this.actualrCnt="footer"===a?this.actualrCnt+r-e.rows[0].cells.length:this.actualrCnt;for(var s=e.rows,o=0;o<s.length;o++){var l=0;n=[];for(var d=s[o],h=0;h<d.cells.length;h++)n.push({index:l+1,value:d.cells[h].value,colSpan:d.cells[h].colSpan,rowSpan:d.cells[h].rowSpan,style:d.cells[h].style}),l+=n[h].colSpan;this.actualrCnt++,this.rows.push({index:this.actualrCnt,cells:n})}this.actualrCnt="header"===a?r:this.actualrCnt}},e.prototype.exportToExcel=function(e,i,a){this.rows=[],this.actualrCnt=0;var r,n=!(0,t.isNullOrUndefined)(i)&&!(0,t.isNullOrUndefined)(i.header),s=!(0,t.isNullOrUndefined)(i)&&!(0,t.isNullOrUndefined)(i.footer),o=!(0,t.isNullOrUndefined)(i)&&!(0,t.isNullOrUndefined)(i.fileName);this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;var l=ul.getClonedPivotValues(this.engine.pivotValues),d=o?i.fileName:"CSV"===e?"default.csv":"default.xlsx";if(this.parent.exportAllPages&&(this.parent.enableVirtualization||this.parent.enablePaging)){var h=this.engine.pageSettings,p=void 0;this.engine.isPagingOrVirtualizationEnabled=!1,"olap"===this.parent.dataType?(this.updateOlapPageSettings(!0),p=this.parent.olapEngineModule.mdxQuery.slice(0)):this.engine.pageSettings=null,this.engine.generateGridData(this.parent.dataSourceSettings,!0,!0),this.parent.applyFormatting(this.engine.pivotValues),r=ul.getClonedPivotValues(this.engine.pivotValues),this.engine.pivotValues=l,this.engine.pageSettings=h,this.engine.isPagingOrVirtualizationEnabled=!0,"olap"===this.parent.dataType&&(this.updateOlapPageSettings(!1),this.parent.olapEngineModule.mdxQuery=p)}else r=l;var u,c,g,m,f={fileName:d,header:"",footer:"",dataCollections:[r],excelExportProperties:i};this.parent.trigger(ji,f,(function(e){u=e.fileName,c=e.header,g=e.footer,m=e.dataCollections})),!n&&(0,t.isNullOrUndefined)(f.excelExportProperties)&&""!==c?this.addHeaderAndFooter({},c,"header",void 0):(0,t.isNullOrUndefined)(f.excelExportProperties)||(0,t.isNullOrUndefined)(f.excelExportProperties.header)||this.addHeaderAndFooter(f.excelExportProperties.header,"","header",f.excelExportProperties.header.headerRows);for(var v=[],S=0;S<m.length;S++){for(var y=m[S],b=0,C=y.length,x=this.parent.renderModule.getFormatList(),w=0,T=0;T<C;T++)if(y[T]){this.actualrCnt++,b=y[T].length;for(var M=[],D=0;D<b;D++)if(y[T][D]){var O=y[T][D],P="row"===this.parent.dataSourceSettings.valueAxis&&"olap"===this.parent.dataType&&O.rowOrdinal&&this.engine.tupRowInfo[O.rowOrdinal]?this.engine.tupRowInfo[O.rowOrdinal].measureName:O.actualText,N="row"===O.axis?{hAlign:"Left",bold:!0,wrapText:!0}:{numberFormat:x[P],bold:!1,wrapText:!0},E={bold:!0,vAlign:"Center",wrapText:!0,indent:0===D?10*O.level:0};if(-1!==O.level||O.rowSpan){var I=this.engine.aggregatedValueMatrix,F="value"===O.axis?I[T]&&I[T][D]?I[T][D]:"#DIV/0!"===O.formattedText?O.formattedText:O.value:O.formattedText,L=0===this.parent.dataSourceSettings.rows.length&&"row"===this.parent.dataSourceSettings.valueAxis||0===this.parent.dataSourceSettings.columns.length&&"column"===this.parent.dataSourceSettings.valueAxis;if(F="grand sum"!==O.type||1===this.parent.dataSourceSettings.values.length&&"row"===this.parent.dataSourceSettings.valueAxis&&"column"===O.axis?"sum"===O.type?F.toString().replace("Total",this.parent.localeObj.getConstant("total")):!(0,t.isNullOrUndefined)(O.valueSort)&&this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+O.formattedText===O.valueSort.levelName&&L?this.parent.getValuesHeader(O,"value"):F:L?this.parent.getValuesHeader(O,"grandTotal"):this.parent.localeObj.getConstant("grandTotal"),(-1!==O.level||O.rowSpan)&&0!==O.rowSpan){M.push({index:D+1,value:F,colSpan:O.colSpan,rowSpan:-1===O.rowSpan?1:O.rowSpan});var A=M[M.length-1];if("value"===O.axis)(isNaN(O.value)||""===O.formattedText||void 0===O.formattedText||(0,t.isNullOrUndefined)(O.value))&&(A.value="Excel"===e?null:""),N.numberFormat="string"==typeof F?void 0:N.numberFormat,A.style=N;else if(A.style=E,"row"===O.axis&&0===D)if(A.style=N,"olap"===this.parent.dataType){var R=this.parent.renderModule.indentCollection[T];A.style.indent=2*R,w=w>R?w:R}else{var k=O.valueSort?O.valueSort.levelName.toString():"",j=O.actualText?O.actualText.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length:0,q=k.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length-(j?j-1:j),V=q?q-1:0;A.style.indent=2*V,w=V>w?V:w}(O.style||A.style.backColor||A.style.fontColor||A.style.fontName||A.style.fontSize)&&(A.style.backColor=A.style.backColor?A.style.backColor:O.style.backgroundColor,A.style.fontColor=A.style.fontColor?A.style.fontColor:O.style.color,A.style.fontName=A.style.fontName?A.style.fontName:O.style.fontFamily,(0,t.isNullOrUndefined)(A.style.fontSize)&&(0,t.isNullOrUndefined)(O.style.fontSize)||(A.style.fontSize=(0,t.isNullOrUndefined)(A.style.fontSize)?Number(O.style.fontSize.split("px")[0]):Number(A.style.fontSize))),A.style.borders={color:"#000000",lineStyle:"thin"};var H=void 0,U=void 0;"column"===O.axis?(H={style:E,cell:O},this.parent.trigger(Vi,H)):(U={style:N,cell:O,column:void 0,data:y,value:F},this.parent.trigger(Ui,U)),A.value="column"===O.axis?H.cell.formattedText:U.value,A.style="column"===O.axis?H.style:U.style}}D+=O.colSpan?O.colSpan-1:0}else{H=void 0;(O={formattedText:""})&&(H={style:void 0,cell:O},this.parent.trigger(Vi,H)),M.push({index:D+1,colSpan:1,rowSpan:1,value:O.formattedText,style:H.style})}this.rows.push({index:this.actualrCnt,cells:M})}s?this.addHeaderAndFooter(i.footer,"","footer",i.footer.footerRows):!s&&""!==g&&(0,t.isNullOrUndefined)(f.excelExportProperties)?this.addHeaderAndFooter({},g,"footer",void 0):(0,t.isNullOrUndefined)(f.excelExportProperties)||(0,t.isNullOrUndefined)(f.excelExportProperties.footer)||this.addHeaderAndFooter(f.excelExportProperties.footer,"","footer",f.excelExportProperties.footer.footerRows);var _=[];for(D=0;D<b;D++)_.push({index:D+1,width:100});w>0&&(_[0].width=100+20*w),v.push({columns:_,rows:this.rows})}var B,G=new pl.Workbook({worksheets:v},"Excel"===e?"xlsx":"csv",void 0,this.parent.currencyCode),z=u.split(".").pop();a?B=G.saveAsBlob("xlsx"===z||"Excel"===e?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"text/csv"):G.save("xlsx"===z||"csv"===z?u:u+("Excel"===e?".xlsx":".csv"));var W={type:e,promise:a?B:null};this.parent.trigger(qi,W)},e.prototype.updateOlapPageSettings=function(e){this.parent.olapEngineModule.isExporting=!!e,this.parent.exportSpecifiedPages?this.parent.olapEngineModule.exportSpeciedPages=this.parent.exportSpecifiedPages=e?this.parent.exportSpecifiedPages:void 0:(this.parent.olapEngineModule.pageSettings=e?null:this.parent.olapEngineModule.pageSettings,this.parent.olapEngineModule.isPaging=!e)},e.prototype.destroy=function(){this.engine&&(this.engine=null)},e}(),gl=function(){function e(e){this.parent=e,this.pdfExportHelper=new Jo}return e.prototype.getModuleName=function(){return"pdfExport"},e.prototype.addPage=function(e,i){i=i||this.exportProperties.pdfExportProperties;var r=e.document.sections.add(),n=e.document.pageSettings.height,s=e.document.pageSettings.width;if(this.exportProperties.width||this.exportProperties.height?(e.document.pageSettings.orientation=this.exportProperties.width>this.exportProperties.height||!this.exportProperties.height&&this.exportProperties.width>n||!this.exportProperties.width&&s>this.exportProperties.height?a.PdfPageOrientation.Landscape:a.PdfPageOrientation.Portrait,e.document.pageSettings.size=new a.SizeF(this.exportProperties.width?this.exportProperties.width:s,this.exportProperties.height?this.exportProperties.height:n)):(e.document.pageSettings.orientation=0===this.exportProperties.orientation||this.exportProperties.orientation?this.exportProperties.orientation:(0,t.isNullOrUndefined)(i)||(0,t.isNullOrUndefined)(i.pageOrientation)||"Landscape"===i.pageOrientation?a.PdfPageOrientation.Landscape:a.PdfPageOrientation.Portrait,(0,t.isNullOrUndefined)(i)||(0,t.isNullOrUndefined)(i.pageSize)||(e.document.pageSettings.size=Di.getPageSize(i.pageSize))),!(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins)){var o=e.document.pageSettings.margins;o.top=(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins.top)?o.top:this.exportProperties.pdfMargins.top,o.bottom=(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins.bottom)?o.bottom:this.exportProperties.pdfMargins.bottom,o.left=(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins.left)?o.left:this.exportProperties.pdfMargins.left,o.right=(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins.right)?o.right:this.exportProperties.pdfMargins.right}r.setPageSettings(e.document.pageSettings);var l=r.pages.add();return(0,t.isNullOrUndefined)(i)||(0,t.isNullOrUndefined)(i.header)||this.pdfExportHelper.drawHeader(i,e.document),(0,t.isNullOrUndefined)(i)||(0,t.isNullOrUndefined)(i.footer)||this.pdfExportHelper.drawFooter(i,e.document),l},e.prototype.getFontStyle=function(e){var i=a.PdfFontStyle.Regular;return!(0,t.isNullOrUndefined)(e)&&e.bold&&(i|=a.PdfFontStyle.Bold),!(0,t.isNullOrUndefined)(e)&&e.italic&&(i|=a.PdfFontStyle.Italic),!(0,t.isNullOrUndefined)(e)&&e.underline&&(i|=a.PdfFontStyle.Underline),!(0,t.isNullOrUndefined)(e)&&e.strikeout&&(i|=a.PdfFontStyle.Strikeout),i},e.prototype.getBorderStyle=function(e){var i=new a.PdfBorders;if((0,t.isNullOrUndefined)(e)){var r=new a.PdfColor(234,234,234);i.all=new a.PdfPen(r)}else{var n=e.width,s=(0,t.isNullOrUndefined)(n)||"number"!=typeof n?void 0:.75*n,o=new a.PdfColor(196,196,196);if(!(0,t.isNullOrUndefined)(e.color)){var l=this.pdfExportHelper.hexDecToRgb(e.color);o=new a.PdfColor(l.r,l.g,l.b)}var d=new a.PdfPen(o,s);(0,t.isNullOrUndefined)(e.dashStyle)||(d.dashStyle=this.pdfExportHelper.getDashStyle(e.dashStyle)),i.all=d}return i},e.prototype.getStyle=function(){var e=new a.PdfBorders;if((0,t.isNullOrUndefined)(this.gridStyle))return{brush:new a.PdfSolidBrush(new a.PdfColor),border:e,font:void 0};var i=(0,t.isNullOrUndefined)(this.gridStyle.header.fontName)?a.PdfFontFamily.Helvetica:this.getFontFamily(this.gridStyle.header.fontName),r=this.getFontStyle(this.gridStyle.header),n=(0,t.isNullOrUndefined)(this.gridStyle.header.fontSize)?10.5:this.gridStyle.header.fontSize,s=new a.PdfColor;if(!(0,t.isNullOrUndefined)(this.gridStyle.header.fontColor)){var o=this.pdfExportHelper.hexDecToRgb(this.gridStyle.header.fontColor);s=new a.PdfColor(o.r,o.g,o.b)}var l=new a.PdfStandardFont(i,n,r);return(0,t.isNullOrUndefined)(this.gridStyle.header.font)||(l=this.gridStyle.header.font),{border:this.getBorderStyle(this.gridStyle.header.border),font:l,brush:new a.PdfSolidBrush(s)}},e.prototype.setRecordThemeStyle=function(e,i){if(!(0,t.isNullOrUndefined)(this.gridStyle)&&!(0,t.isNullOrUndefined)(this.gridStyle.record)){var r=(0,t.isNullOrUndefined)(this.gridStyle.record.fontName)?a.PdfFontFamily.Helvetica:this.getFontFamily(this.gridStyle.record.fontName),n=(0,t.isNullOrUndefined)(this.gridStyle.record.fontSize)?9.75:this.gridStyle.record.fontSize,s=this.getFontStyle(this.gridStyle.record),o=new a.PdfStandardFont(r,n,s);(0,t.isNullOrUndefined)(this.gridStyle.record.font)||(o=this.gridStyle.record.font),e.style.setFont(o);var l=new a.PdfColor;if(!(0,t.isNullOrUndefined)(this.gridStyle.record.fontColor)){var d=this.pdfExportHelper.hexDecToRgb(this.gridStyle.record.fontColor);l=new a.PdfColor(d.r,d.g,d.b)}e.style.setTextBrush(new a.PdfSolidBrush(l))}var h=this.gridStyle&&this.gridStyle.record&&this.gridStyle.record.border?this.getBorderStyle(this.gridStyle.record.border):i;return e.style.setBorder(h),e},e.prototype.exportToPDF=function(e,i,r,n){var s,o=this;this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.gridStyle=(0,t.isNullOrUndefined)(this.exportProperties.pdfExportProperties)?void 0:this.exportProperties.pdfExportProperties.theme;var l=this.applyEvent();(0,t.isNullOrUndefined)(r)||(l.document=r);var d=this.getStyle(),h=(0,t.isNullOrUndefined)(this.exportProperties)||(0,t.isNullOrUndefined)(this.exportProperties.fileName)?(0,t.isNullOrUndefined)(e)||(0,t.isNullOrUndefined)(e.fileName)?"default":e.fileName:this.exportProperties.fileName,p=100+20*(this.parent.renderModule.maxIndent?this.parent.renderModule.maxIndent:5),u=Math.floor((540-p)/90)+1,c=0,g=l.args.pivotValues[c];(this.exportProperties.columnSize||this.exportProperties.width||this.exportProperties.height)&&(u=this.exportProperties.columnSize>0?this.exportProperties.columnSize:g[0].length),this.exportProperties.allowRepeatHeader=!0===this.exportProperties.allowRepeatHeader||(0,t.isNullOrUndefined)(this.exportProperties.allowRepeatHeader);var m,f=!!this.exportProperties.allowRepeatHeader&&this.exportProperties.allowRepeatHeader&&u>1;this.parent.isTabular&&(u=(m=this.parent.engineModule.rowMaxLevel)+1<u?u:m+2);for(var v=0;f&&v<g.length;v++)for(var S=u;g[v]&&S<g[v].length;S+=u){var y=this.parent.isTabular?g[v].slice(0,m+1):[g[v][0]];(s=g[v]).splice.apply(s,[S,0].concat(y))}var b=g&&g.length>0?g[0].length:0,C=0;do{(0,t.isNullOrUndefined)(e)||(this.exportProperties.header=(0,t.isNullOrUndefined)(e.header)||(0,t.isNullOrUndefined)(e.header.contents)||(0,t.isNullOrUndefined)(e.header.contents[0].value)?this.exportProperties.header:e.header.contents[0].value,this.exportProperties.footer=(0,t.isNullOrUndefined)(e.footer)||(0,t.isNullOrUndefined)(e.footer.contents)||(0,t.isNullOrUndefined)(e.footer.contents[0].value)?this.exportProperties.footer:e.footer.contents[0].value);var x=this.addPage(l,e),w=new a.PdfGrid,T=u>0?u:5;if(g&&g.length>0){w.columns.add(g[0].length-C>=T?T:g[0].length-C);for(var M=g.length,D=0,O=0,P=0,N=0;N<M;N++)if(g[N]){var E=!(g[N][0]&&"row"===g[N][0].axis),I=g[N].length>C+T?C+T:g[N].length,F=0;E&&w.headers.add(1);var L=E?w.headers.getHeader(D):w.rows.addRow();E?(L.style.setBorder(d.border),d.font&&L.style.setFont(d.font),L.style.setTextBrush(d.brush)):this.setRecordThemeStyle(L,d.border);for(var A=0,R=!0,k=C;k<I;k++){var j=!1;if(g[N][k]&&0!==g[N][k].rowSpan){var q=(H=g[N][k]).formattedText;q=0===this.parent.dataSourceSettings.rows.length||0===this.parent.dataSourceSettings.columns.length?this.parent.getValuesHeader(H,"value"):q,q="grand sum"===H.type?0===this.parent.dataSourceSettings.rows.length||0===this.parent.dataSourceSettings.columns.length?this.parent.getValuesHeader(H,"grandTotal"):this.parent.localeObj.getConstant("grandTotal"):"sum"===H.type?q.toString().replace("Total",this.parent.localeObj.getConstant("total")):q,(-1!==H.level||H.rowSpan)&&((-1!==H.level||H.rowSpan)&&(L.cells.getCell(A).columnSpan=H.colSpan?T-A<H.colSpan?T-A:H.colSpan:1,(E&&H.rowSpan&&H.rowSpan>1||!E&&H.rowSpan&&H.rowSpan>1&&this.parent.isTabular)&&(L.cells.getCell(A).rowSpan=H.rowSpan?H.rowSpan:1),L.cells.getCell(A).value=q?q.toString():""),""!==q&&(R=!1)),O=H.level>O?H.level:O,j="value"===H.axis,k+=L.cells.getCell(A).columnSpan?L.cells.getCell(A).columnSpan-1:0,A+=L.cells.getCell(A).columnSpan?L.cells.getCell(A).columnSpan-1:0,H.style&&(L=this.applyStyle(L,H,A));var V={style:void 0,pivotCell:H,cell:L.cells.getCell(A),column:w.columns.getColumn(A)};this.parent.trigger(Bi,V),"column"===H.axis?(V={style:V.style,cell:V.cell,gridCell:V.pivotCell},this.parent.trigger(Hi,V),L.cells.getCell(A).value=V.gridCell.formattedText?V.gridCell.formattedText:q):(V={style:V.style,cell:V.cell,column:void 0,data:V.pivotCell,value:q},this.parent.trigger(_i,V),L.cells.getCell(A).value=V.value?V.value:q),V.style&&this.processCellStyle(L.cells.getCell(A),V)}else{var H;V={style:void 0,pivotCell:void 0,cell:L.cells.getCell(A),column:w.columns.getColumn(A)};this.parent.trigger(Bi,V),P=V.column.width,"column"===(H={formattedText:""}).axis&&(V={style:V.style,cell:V.cell,gridCell:V.pivotCell},this.parent.trigger(Hi,V)),V.style&&this.processCellStyle(L.cells.getCell(A),V),L.cells.getCell(A).value="",this.parent.isTabular&&0===F?(0===k&&E&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0?(w.headers.getHeader(0).cells.getCell(0).rowSpan=Object.keys(this.engine.headerContent).length+1,w.headers.getHeader(0).cells.getCell(0).columnSpan=this.parent.engineModule.rowMaxLevel+1):0!==k&&E&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&w.headers.getHeader(0).cells.getCell(0).rowSpan<Object.keys(this.engine.headerContent).length&&(w.headers.getHeader(0).cells.getCell(0).rowSpan=Object.keys(this.engine.headerContent).length,w.headers.getHeader(0).cells.getCell(0).columnSpan=this.parent.engineModule.rowMaxLevel+1),F++):(0===k&&E&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0||0!==k&&E&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&w.headers.getHeader(0).cells.getCell(0).rowSpan<Object.keys(this.engine.headerContent).length)&&w.headers.getHeader(0).cells.getCell(0).rowSpan++}var U=new a.PdfStringFormat;if("olap"===this.parent.dataType){var _=!E&&0===A&&g[N][k]?this.parent.renderModule.indentCollection[g[N][k].rowIndex]:0;U.paragraphIndent=15*_,O=O>_?O:_}else if(U.paragraphIndent=0,!E&&0===A&&g[N][k]&&-1!==g[N][k].level){var B=g[N][k],G=B.valueSort?B.valueSort.levelName.toString():"",z=B.actualText?B.actualText.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length:0,W=G.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length-(z?z-1:z),Q=W?W-1:0;U.paragraphIndent=10*Q}U.alignment=j?a.PdfTextAlignment.Right:a.PdfTextAlignment.Left,U.lineAlignment=a.PdfVerticalAlignment.Middle,L.cells.getCell(A).style.stringFormat=U,A++}R&&(L.height=16),D++}w.columns.getColumn(0).width=P>0?P:100+20*O}0===C&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&w.headers.getHeader(0).cells.getCell(0).rowSpan--,w.draw(x,new a.PointF(10,20)),(C+=T)>=b&&l.args.pivotValues.length>c+1&&(c++,b=(g=l.args.pivotValues[c])&&g.length>0?g[0].length:0,C=0)}while(C<b);return new Promise((function(e){var t;n||i?n&&(t=l.document.save()):(l.document.save(h+".pdf"),l.document.destroy());var a={type:"PDF",promise:n?t:null};o.parent.trigger(qi,a),e(l.document)}))},e.prototype.applyStyle=function(e,t,i){var r=this.parent.conditionalFormattingModule.hexToRgb(t.style.backgroundColor),n=new a.PdfSolidBrush(new a.PdfColor(r.r,r.g,r.b));e.cells.getCell(i).style.backgroundBrush=n;var s=Number(t.style.fontSize.split("px")[0]),o=new a.PdfStandardFont(a.PdfFontFamily.TimesRoman,s,a.PdfFontStyle.Regular);return e.cells.getCell(i).style.font=o,r=this.parent.conditionalFormattingModule.hexToRgb(t.style.color),n=new a.PdfSolidBrush(new a.PdfColor(r.r,r.g,r.b)),e.cells.getCell(i).style.textBrush=n,e},e.prototype.getFontFamily=function(e){switch(e){case"TimesRoman":return 2;case"Courier":return 1;case"Symbol":return 3;case"ZapfDingbats":return 4;default:return 0}},e.prototype.getFont=function(e){if(e.style.font)return e.style.font;var i=e.cell.cellStyle.font&&e.cell.cellStyle.font.fontSize?e.cell.cellStyle.font.fontSize:(0,t.isNullOrUndefined)(e.style.fontSize)?9.75:.75*e.style.fontSize,r=(0,t.isNullOrUndefined)(e.style.fontFamily)?a.PdfFontFamily.TimesRoman:this.getFontFamily(e.style.fontFamily),n=a.PdfFontStyle.Regular;return!(0,t.isNullOrUndefined)(e.style.bold)&&e.style.bold&&(n|=a.PdfFontStyle.Bold),!(0,t.isNullOrUndefined)(e.style.italic)&&e.style.italic&&(n|=a.PdfFontStyle.Italic),!(0,t.isNullOrUndefined)(e.style.underline)&&e.style.underline&&(n|=a.PdfFontStyle.Underline),!(0,t.isNullOrUndefined)(e.style.strikeout)&&e.style.strikeout&&(n|=a.PdfFontStyle.Strikeout),new a.PdfStandardFont(r,i,n)},e.prototype.processCellStyle=function(e,i){if(!(0,t.isNullOrUndefined)(i.style.backgroundColor)){var r=this.pdfExportHelper.hexDecToRgb(i.style.backgroundColor);e.style.backgroundBrush=new a.PdfSolidBrush(new a.PdfColor(r.r,r.g,r.b))}if(!(0,t.isNullOrUndefined)(i.style.textBrushColor)){var n=this.pdfExportHelper.hexDecToRgb(i.style.textBrushColor);e.style.textBrush=new a.PdfSolidBrush(new a.PdfColor(n.r,n.g,n.b))}if(!(0,t.isNullOrUndefined)(i.style.textPenColor)){var s=this.pdfExportHelper.hexDecToRgb(i.style.textPenColor);e.style.textPen=new a.PdfPen(new a.PdfColor(s.r,s.g,s.b))}if((0,t.isNullOrUndefined)(i.style.fontFamily)&&(0,t.isNullOrUndefined)(i.style.fontSize)&&(0,t.isNullOrUndefined)(i.style.bold)&&(0,t.isNullOrUndefined)(i.style.italic)&&(0,t.isNullOrUndefined)(i.style.underline)&&(0,t.isNullOrUndefined)(i.style.strikeout)||(e.style.font=this.getFont(i)),!(0,t.isNullOrUndefined)(i.style.border)){var o=new a.PdfBorders,l=i.style.border.width,d=(0,t.isNullOrUndefined)(l)||"number"!=typeof l?void 0:.75*l,h=new a.PdfColor(196,196,196);if(!(0,t.isNullOrUndefined)(i.style.border.color)){var p=this.pdfExportHelper.hexDecToRgb(i.style.border.color);h=new a.PdfColor(p.r,p.g,p.b)}var u=new a.PdfPen(h,d);(0,t.isNullOrUndefined)(i.style.border.dashStyle)||(u.dashStyle=this.pdfExportHelper.getDashStyle(i.style.border.dashStyle)),o.all=u,e.style.borders=o}},e.prototype.applyEvent=function(){var e,t,i=ul.getClonedPivotValues(this.engine.pivotValues);if(this.parent.exportAllPages&&(this.parent.enableVirtualization||this.parent.enablePaging)&&"Server"!==this.parent.dataSourceSettings.mode){var r=this.engine.pageSettings;this.engine.isPagingOrVirtualizationEnabled=!1,"olap"===this.parent.dataType?(this.updateOlapPageSettings(!0),t=this.parent.olapEngineModule.mdxQuery.slice(0)):this.engine.pageSettings=null,this.engine.generateGridData(this.parent.dataSourceSettings,!0,!0),this.parent.applyFormatting(this.engine.pivotValues),e=ul.getClonedPivotValues(this.engine.pivotValues),this.engine.pivotValues=i,this.engine.pageSettings=r,this.engine.isPagingOrVirtualizationEnabled=!0,"olap"===this.parent.dataType&&(this.updateOlapPageSettings(!1),this.parent.olapEngineModule.mdxQuery=t)}else e=i;var n={pivotValues:[e]};return this.parent.trigger(Fi,n),this.document=new a.PdfDocument,{document:this.document,args:n}},e.prototype.updateOlapPageSettings=function(e){this.parent.olapEngineModule.isExporting=!!e,this.parent.exportSpecifiedPages?this.parent.olapEngineModule.exportSpeciedPages=this.parent.exportSpecifiedPages=e?this.parent.exportSpecifiedPages:void 0:(this.parent.olapEngineModule.pageSettings=e?null:this.parent.olapEngineModule.pageSettings,this.parent.olapEngineModule.isPaging=!e)},e.prototype.destroy=function(){this.engine&&(this.engine=null),this.exportProperties&&(this.exportProperties=null),this.document&&(this.document=null),this.pdfExportHelper&&(this.pdfExportHelper=null)},e}(),ml=function(){function e(e){this.parent=e,this.parent.pagerModule=this,this.addEventListener()}return e.prototype.getModuleName=function(){return"pager"},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on(wr,this.createPager,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||((0,t.isNullOrUndefined)(this.parent.pagerSettings.template)&&this.unWireEvent(),this.parent.off(wr,this.createPager))},e.prototype.createPager=function(){null!==(0,t.select)("#"+this.parent.element.id+"pivot-pager",this.parent.element)&&((0,t.remove)((0,t.select)("#"+this.parent.element.id+"pivot-pager",this.parent.element)),this.destroy(),this.addEventListener());var e=this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber(),i=this.parent.pagerSettings;if(this.parent.enablePaging){var a=(0,t.createElement)("div",{id:this.parent.element.id+"pivot-pager",className:gi+" "+(this.parent.isAdaptive||e<650?s:"")+" "+(this.parent.enableRtl?n:"")+" "+("Top"===this.parent.pagerSettings.position?" e-pivot-pager-top":" e-pivot-pager-bottom")+" "+(i.enableCompactView||e<400?"e-compact-view":""),styles:"width:"+(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())+"px"});this.parent.showFieldList&&(0,t.select)("#"+this.parent.element.id+"_PivotFieldList",this.parent.element)&&"Top"===i.position?this.parent.element.insertBefore(a,(0,t.select)("#"+this.parent.element.id+"_PivotFieldList",this.parent.element)):this.parent.showGroupingBar&&(0,t.select)("#"+this.parent.element.id+" ."+di,this.parent.element)&&"Top"===i.position?this.parent.element.insertBefore(a,(0,t.select)("#"+this.parent.element.id+" ."+di,this.parent.element)):"Top"===this.parent.pagerSettings.position?this.parent.element.insertBefore(a,(0,t.select)("#"+this.parent.element.id+"_grid",this.parent.element)):this.parent.element.append(a);var r=this;if(this.pager=new gs.Pager({enableRtl:this.parent.enableRtl,locale:this.parent.locale,template:""===i.template||i.template?i.template:(0,t.initializeCSPTemplate)((function(){return r.createPagerContainer()})),cssClass:this.parent.cssClass}),this.pager.isVue=this.parent.isVue,this.pager.appendTo(a),(0,t.isNullOrUndefined)(i.template)){if(i.showRowPager){if(!i.enableCompactView&&e>400)new fs.NumericTextBox({min:1,max:this.parent.engineModule.rowPageCount,showSpinButton:!1,format:"#",validateDecimalOnType:!0,decimals:0,strictMode:!0,value:this.parent.pageSettings.currentRowPage,enableRtl:this.parent.enableRtl,locale:this.parent.locale,width:e<669?"50px":"64px",change:this.rowPageChange.bind(this),cssClass:this.parent.cssClass}).appendTo((0,t.select)("#"+this.parent.element.id+"_row_textbox",this.parent.element));if(i.showRowPageSize){var o=this.parent.pagerSettings.rowPageSizes.slice(0);-1===this.parent.pagerSettings.rowPageSizes.indexOf(this.parent.pageSettings.rowPageSize)&&(o.push(this.parent.pageSettings.rowPageSize),o.sort((function(e,t){return e-t}))),new vs.DropDownList({dataSource:o,value:this.parent.pageSettings.rowPageSize,enableRtl:this.parent.enableRtl,locale:this.parent.locale,change:this.rowPageSizeChange.bind(this),popupHeight:"300px",popupWidth:"100%",width:"64px",cssClass:this.parent.cssClass}).appendTo((0,t.select)("#"+this.parent.element.id+"_row_size_list",this.parent.element))}}if(i.showColumnPager){if(!i.enableCompactView&&e>400)new fs.NumericTextBox({min:1,max:this.parent.engineModule.columnPageCount,showSpinButton:!1,format:"#",validateDecimalOnType:!0,decimals:0,strictMode:!0,value:this.parent.pageSettings.currentColumnPage,enableRtl:this.parent.enableRtl,locale:this.parent.locale,width:e<669?"50px":"64px",change:this.columnPageChange.bind(this),cssClass:this.parent.cssClass}).appendTo((0,t.select)("#"+this.parent.element.id+"_column_textbox",this.parent.element));if(i.showColumnPageSize){var l=this.parent.pagerSettings.columnPageSizes.slice(0);-1===this.parent.pagerSettings.columnPageSizes.indexOf(this.parent.pageSettings.columnPageSize)&&(l.push(this.parent.pageSettings.columnPageSize),l.sort((function(e,t){return e-t}))),new vs.DropDownList({dataSource:l,value:this.parent.pageSettings.columnPageSize,enableRtl:this.parent.enableRtl,locale:this.parent.locale,change:this.columnPageSizeChange.bind(this),popupHeight:"300px",popupWidth:"100%",width:"64px",cssClass:this.parent.cssClass}).appendTo((0,t.select)("#"+this.parent.element.id+"_column_size_list",this.parent.element))}}this.unWireEvent(),this.wireEvent()}}},e.prototype.wireEvent=function(){for(var e=[].slice.call(this.parent.element.querySelectorAll("."+h+", ."+u+", ."+c+", ."+p)),i=0;i<e.length;i++)t.EventHandler.add(e[i],"click",this.updatePageSettings,this)},e.prototype.unWireEvent=function(){for(var e=[].slice.call(this.parent.element.querySelectorAll("."+h+", ."+u+", ."+c+", ."+p)),i=0;i<e.length;i++)t.EventHandler.remove(e[i],"click",this.updatePageSettings)},e.prototype.columnPageChange=function(e){this.parent.pageSettings.currentColumnPage=e.value},e.prototype.rowPageChange=function(e){this.parent.pageSettings.currentRowPage=e.value},e.prototype.columnPageSizeChange=function(e){this.parent.pageSettings.columnPageSize=Number(e.value)},e.prototype.rowPageSizeChange=function(e){this.parent.pageSettings.rowPageSize=Number(e.value)},e.prototype.updatePageSettings=function(e){var t=e.target.id;switch(t){case this.parent.element.id+"_row_firstIcon":this.parent.pageSettings.currentRowPage=1;break;case this.parent.element.id+"_row_prevIcon":this.parent.pageSettings.currentRowPage=this.parent.pageSettings.currentRowPage>1?this.parent.pageSettings.currentRowPage-1:this.parent.pageSettings.currentRowPage;break;case this.parent.element.id+"_row_nextIcon":this.parent.pageSettings.currentRowPage=this.parent.pageSettings.currentRowPage<this.parent.engineModule.rowPageCount?this.parent.pageSettings.currentRowPage+1:this.parent.pageSettings.currentRowPage;break;case this.parent.element.id+"_row_lastIcon":this.parent.pageSettings.currentRowPage=this.parent.engineModule.rowPageCount;break;case this.parent.element.id+"_column_firstIcon":this.parent.pageSettings.currentColumnPage=1;break;case this.parent.element.id+"_column_prevIcon":this.parent.pageSettings.currentColumnPage=this.parent.pageSettings.currentColumnPage>1?this.parent.pageSettings.currentColumnPage-1:this.parent.pageSettings.currentColumnPage;break;case this.parent.element.id+"_column_nextIcon":this.parent.pageSettings.currentColumnPage=this.parent.pageSettings.currentColumnPage<this.parent.engineModule.columnPageCount?this.parent.pageSettings.currentColumnPage+1:this.parent.pageSettings.currentColumnPage;break;case this.parent.element.id+"_column_lastIcon":this.parent.pageSettings.currentColumnPage=this.parent.engineModule.columnPageCount}-1!==t.indexOf("_row")?this.parent.actionObj.actionName=bn:-1!==t.indexOf("_column")&&(this.parent.actionObj.actionName=Cn)},e.prototype.createPagerContainer=function(){var e,i,a=this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber(),r=this.parent.pagerSettings;r.showRowPager&&(e=this.createPagerItems("row",r,a)),r.showColumnPager&&(i=this.createPagerItems("column",r,a));var n=(0,t.createElement)("div",{id:this.parent.element.id+"_mainDiv",className:"e-pivot-pager-maindiv "+(r.showRowPager&&r.showColumnPager?"":"e-pivot-pager-single-maindiv")+" "+(r.isInversed?"e-inverse-view":"")}),s=(0,t.createElement)("div",{id:this.parent.element.id+"_vertical_separator",className:this.parent.isAdaptive||a<650?"e-pivotview-hseparator":"e-pivotview-vseparator"});return r.isInversed&&r.showColumnPager&&r.showRowPager?n.append(i,s,e):r.showColumnPager&&r.showRowPager?n.append(e,s,i):r.showRowPager&&!r.showColumnPager?n.append(e):!r.showRowPager&&r.showColumnPager&&n.append(i),n.outerHTML},e.prototype.createPagerItems=function(e,i,a){var r=!i.showRowPager||!i.showColumnPager,n=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_mainDiv",className:"row"===e?"e-pivot-pager-row-maindiv "+(i.showRowPageSize?"":fi):"e-pivot-pager-column-maindiv "+(i.showColumnPageSize?"":fi)}),s=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_pagerSettings",className:"row"===e?"e-pivot-row-pager-settings":"e-pivot-column-pager-settings"});this.parent.pagerSettings.showColumnPager&&this.parent.pagerSettings.showRowPager&&s.classList.add("e-pivot-both-pager-settings");var o="column"===e&&1===this.parent.pageSettings.currentColumnPage||"row"===e&&1===this.parent.pageSettings.currentRowPage,d="column"===e&&this.parent.pageSettings.currentColumnPage===this.parent.engineModule.columnPageCount||"row"===e&&this.parent.pageSettings.currentRowPage===this.parent.engineModule.rowPageCount,h=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_NavContainer",attrs:{class:"e-pivot-pager-nav-container "+mi}}),p=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_PageInfoContainer",attrs:{class:"e-pivot-pager-info-container "+mi}}),u=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_firstIcon",attrs:{class:"e-first e-icons e-icon-first"+(o?" e-firstpagedisabled "+l:" e-firstpage e-pager-default"),title:this.parent.localeObj.getConstant("goToFirstPage"),"aria-label":this.parent.localeObj.getConstant("goToFirstPage"),tabindex:"0",role:"button"}}),c=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_prevIcon",attrs:{class:"e-prev e-icons e-icon-prev"+(o?" e-prevpagedisabled "+l:" e-prevpage e-pager-default"),title:this.parent.localeObj.getConstant("goToPreviousPage"),"aria-label":this.parent.localeObj.getConstant("goToPreviousPage"),tabindex:"0",role:"button"}}),g=(0,t.createElement)("span",{id:this.parent.element.id+"_"+e+"_pagerString",className:"row"===e?"e-pivotview-row-pagerString":"e-pivotview-column-pagerString"});g.innerText="row"===e?this.parent.localeObj.getConstant("rowPage"):this.parent.localeObj.getConstant("columnPage");var m=(0,t.createElement)("input",{id:this.parent.element.id+"_"+e+"_textbox",className:"row"===e?"e-pivot-pager-row-dropdown":"e-pivot-pager-column-dropdown",attrs:{placeholder:"1"}}),f=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_of_string_mainDiv",className:"row"===e?"e-pivot-row-of-string-maindiv":"e-pivot-column-of-string-maindiv"}),v=(0,t.createElement)("span",{id:this.parent.element.id+"_"+e+"_ofString",className:"row"===e?"e-pivot-row-of-string":"e-pivot-column-of-string"});v.innerText=this.parent.localeObj.getConstant("of")+" ";var S=(0,t.createElement)("span",{id:this.parent.element.id+"_"+e+"_pagerNumber",className:"row"===e?"e-pivotview-row-pagerNumber":"e-pivotview-column-pagerNumber"});S.innerText=("row"===e?this.parent.engineModule.rowPageCount:this.parent.engineModule.columnPageCount).toString();var y=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_nextIcon",attrs:{class:"e-next e-icons e-icon-next"+(d?" e-nextpagedisabled "+l:" e-nextpage e-pager-default"),title:this.parent.localeObj.getConstant("goToNextPage"),"aria-label":this.parent.localeObj.getConstant("goToNextPage"),tabindex:"0",role:"button"}}),b=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_lastIcon",attrs:{class:"e-last e-icons e-icon-last"+(d?" e-lastpagedisabled "+l:" e-lastpage e-pager-default"),title:this.parent.localeObj.getConstant("goToLastPage"),"aria-label":this.parent.localeObj.getConstant("goToLastPage"),tabindex:"0",role:"button"}}),C=(0,t.createElement)("span",{id:this.parent.element.id+"_"+e+"_size",className:"row"===e?"e-pivotview-row-size":"e-pivotview-column-size"});C.innerText="row"===e?this.parent.localeObj.getConstant("rowPerPage"):this.parent.localeObj.getConstant("columnPerPage");var x=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_size_list_maindiv",className:"e-pager-dropdown "+mi}),w=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_size_list",className:"row"===e?"e-pivot-row-size-list":"e-pivot-column-size-list"}),T=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_text_div",className:"e-pivotview-text-div"}),M=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_text_div_1",className:"e-pivotview-text-div-1"});return x.append(w),i.enableCompactView||a<400?(h.append(c,y),s.append(h)):(f.append(v,S),h.append(u,c,y,b),p.append(m,f),s.append(h,p)),("row"===e&&i.showRowPager||"column"===e&&i.showColumnPager)&&(("column"===e&&!i.showRowPager||"row"===e&&!i.showColumnPager)&&r&&M.append(C,x),i.showColumnPager&&i.showRowPager||!r?("row"===e&&i.showRowPageSize||"column"===e&&i.showColumnPageSize?!i.enableCompactView&&a>400?(T.append(g,C),M.append(s,x)):(T.append(g,s),M.append(C,x)):("row"===e&&!i.showRowPageSize||"column"===e&&!i.showColumnPageSize)&&(T.append(g),M.append(s)),n.append(T,M)):("row"===e&&(i.showRowPageSize?n.append(s,g,M):n.append(s,g)),"column"===e&&(i.showColumnPageSize?n.append(s,g,M):n.append(s,g)))),n},e.prototype.destroy=function(){if(this.removeEventListener(),this.parent.pagerModule){var e=(0,t.select)("#"+this.parent.element.id+"_column_textbox",this.parent.element),i=e?(0,t.getInstance)(e,fs.NumericTextBox):null;i&&(i.destroy(),i=null);var a=(e=(0,t.select)("#"+this.parent.element.id+"_row_textbox",this.parent.element))?(0,t.getInstance)(e,fs.NumericTextBox):null;a&&(a.destroy(),a=null);var r=(e=(0,t.select)("#"+this.parent.element.id+"_column_size_list",this.parent.element))?(0,t.getInstance)(e,vs.DropDownList):null;r&&(r.destroy(),r=null);var n=(e=(0,t.select)("#"+this.parent.element.id+"_row_size_list",this.parent.element))?(0,t.getInstance)(e,vs.DropDownList):null;n&&(n.destroy(),n=null),this.pager&&this.pager.destroy(),this.pager=null}},e}(),fl=function(){function e(e){this.parent=e}return e.prototype.render=function(){var e=(0,t.createElement)("div",{id:this.parent.element.id+"_Container",className:m+" "+("olap"===this.parent.dataType?"e-olapfieldlist-container":""),styles:"width:"+this.parent.element.style.width});this.parent.isAdaptive?(0,t.addClass)([e],s):(0,t.removeClass)([e],s),this.parent.enableRtl?(0,t.addClass)([e],n):(0,t.removeClass)([e],n),this.parent.cssClass&&(0,t.addClass)([e],this.parent.cssClass.split(" ")),this.parent.enableFieldSearching?(0,t.addClass)([e],T):(0,t.removeClass)([e],T),this.parentElement=(0,t.createElement)("div",{className:"e-field-list-container"}),this.parent.element.appendChild(e),this.parent.isAdaptive&&(e.removeAttribute("style"),this.parentElement=(0,t.createElement)("div",{className:"e-adaptive-container"}),this.renderAdaptiveLayout(e)),"Popup"===this.parent.renderMode?(this.renderFieldListDialog(e),this.unWireDialogEvent(this.parent.element.querySelector("."+f)),this.wireDialogEvent(this.parent.element.querySelector("."+f))):this.renderStaticLayout(e)},e.prototype.renderStaticLayout=function(e){if(!this.parent.isAdaptive){var i=(0,t.createElement)("div",{className:"e-field-list-title"}),a=(0,t.createElement)("div",{className:"e-title-content"});a.innerText=this.parent.localeObj.getConstant("staticFieldList"),i.appendChild(a),i.appendChild(this.createCalculatedButton()),(0,t.addClass)([e],y),e.appendChild(i),e.appendChild(this.parentElement),(0,t.addClass)([e],y),this.parent.allowDeferLayoutUpdate&&(e.appendChild(this.createDeferUpdateButtons()),this.renderDeferUpdateButtons(e))}},e.prototype.renderDeferUpdateButtons=function(e){this.parent.allowDeferLayoutUpdate&&(this.deferUpdateCheckBox=new Os.CheckBox({label:this.parent.localeObj.getConstant("deferLayoutUpdate"),checked:this.parent.isPopupView&&this.parent.pivotGridModule?!!(0,t.isNullOrUndefined)(this.parent.pivotGridModule.pivotDeferLayoutUpdate)||this.parent.pivotGridModule.pivotDeferLayoutUpdate:!!(0,t.isNullOrUndefined)(this.parent.isDeferLayoutUpdate)||this.parent.isDeferLayoutUpdate,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,locale:this.parent.locale,change:this.onCheckChange.bind(this),cssClass:this.parent.cssClass}),this.deferUpdateCheckBox.isStringTemplate=!0,this.deferUpdateCheckBox.appendTo((0,t.select)("#"+this.parent.element.id+"DeferUpdateCheckBox",e)),this.deferUpdateApplyButton=new Os.Button({cssClass:"e-defer-apply-button e-defer-update-btn"+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("apply"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,isPrimary:!0,disabled:this.parent.isPopupView&&this.parent.pivotGridModule?!(0,t.isNullOrUndefined)(this.parent.pivotGridModule.pivotDeferLayoutUpdate)&&!this.parent.pivotGridModule.pivotDeferLayoutUpdate:!(0,t.isNullOrUndefined)(this.parent.isDeferLayoutUpdate)&&!this.parent.isDeferLayoutUpdate}),this.deferUpdateApplyButton.isStringTemplate=!0,this.deferUpdateApplyButton.appendTo((0,t.select)("#"+this.parent.element.id+"_DeferUpdateButton1",e)),this.deferUpdateApplyButton.element.onclick="Fixed"===this.parent.renderMode?this.applyButtonClick.bind(this):this.onDeferUpdateClick.bind(this)),this.deferUpdateCancelButton=new Os.Button({cssClass:"e-defer-cancel-button "+ae+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.allowDeferLayoutUpdate?this.parent.localeObj.getConstant("cancel"):this.parent.localeObj.getConstant("close"),enableRtl:this.parent.enableRtl,isPrimary:!this.parent.allowDeferLayoutUpdate,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,disabled:this.parent.isPopupView&&this.parent.pivotGridModule&&this.parent.pivotGridModule.refreshing?!(!this.parent.allowDeferLayoutUpdate||(0,t.isNullOrUndefined)(this.parent.pivotGridModule.pivotDeferLayoutUpdate))&&!this.parent.pivotGridModule.pivotDeferLayoutUpdate:!(!this.parent.refreshing||(0,t.isNullOrUndefined)(this.parent.isDeferLayoutUpdate)||!this.parent.allowDeferLayoutUpdate)&&!this.parent.isDeferLayoutUpdate}),this.deferUpdateCancelButton.isStringTemplate=!0,this.deferUpdateCancelButton.appendTo((0,t.select)("#"+this.parent.element.id+"_DeferUpdateButton2",e)),this.parent.allowDeferLayoutUpdate&&(!this.parent.isDeferLayoutUpdate&&"Popup"===this.parent.renderMode&&this.parent.refreshing||this.parent.isPopupView&&this.parent.pivotGridModule&&!this.parent.pivotGridModule.pivotDeferLayoutUpdate&&this.parent.pivotGridModule.refreshing)&&(this.deferUpdateApplyButton.element.style.display="none",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("close")}),this.deferUpdateCancelButton.isPrimary=!0,this.deferUpdateApplyButton.disabled=this.parent.isPopupView?this.parent.pivotGridModule.pivotDeferLayoutUpdate:this.parent.isDeferLayoutUpdate,this.deferUpdateCancelButton.disabled=this.parent.isPopupView?this.parent.pivotGridModule.pivotDeferLayoutUpdate:this.parent.isDeferLayoutUpdate),this.deferUpdateCancelButton.element.onclick=this.onCloseFieldList.bind(this)},e.prototype.createDeferUpdateButtons=function(){var e=(0,t.createElement)("div",{className:"e-layout-footer"});if(this.parent.allowDeferLayoutUpdate){var i=(0,t.createElement)("div",{className:"e-checkbox-layout",attrs:{title:this.parent.localeObj.getConstant("deferLayoutUpdate")}}),a=(0,t.createElement)("input",{id:this.parent.element.id+"DeferUpdateCheckBox"});i.appendChild(a),e.appendChild(i)}var r=(0,t.createElement)("div",{className:"e-button-layout"});if(this.parent.allowDeferLayoutUpdate){var n=(0,t.createElement)("button",{id:this.parent.element.id+"_DeferUpdateButton1",attrs:{type:"button",title:this.parent.localeObj.getConstant("apply")}});r.appendChild(n)}var s=(0,t.createElement)("button",{id:this.parent.element.id+"_DeferUpdateButton2",attrs:{type:"button",title:this.parent.localeObj.getConstant("cancel")}});return r.appendChild(s),e.appendChild(r),e},e.prototype.onCheckChange=function(e){e.checked&&(this.parent.clonedDataSource=Di.getClonedDataSourceSettings(this.parent.dataSourceSettings),"olap"===this.parent.dataType&&(this.parent.clonedFieldListData=Di.cloneOlapFieldSettings(this.parent.olapEngineModule.fieldListData)),this.parent.clonedFieldList=Di.getClonedFieldList(this.parent.pivotFieldList)),this.parent.isDeferLayoutUpdate=e.checked,this.parent.isPopupView&&this.parent.pivotGridModule&&(this.parent.pivotGridModule.pivotDeferLayoutUpdate=e.checked),"Fixed"===this.parent.renderMode?(this.deferUpdateApplyButton.setProperties({disabled:!e.checked}),this.deferUpdateCancelButton.setProperties({disabled:!e.checked})):this.parent.allowDeferLayoutUpdate&&e.checked?(this.deferUpdateApplyButton.element.style.display="",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("cancel")}),this.deferUpdateCancelButton.isPrimary=!1):(this.deferUpdateApplyButton.element.style.display="none",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("close")}),this.deferUpdateCancelButton.isPrimary=!0),Object.keys(this.parent.clonedFieldList).length!==Object.keys(this.parent.pivotFieldList).length&&this.parent.calculatedFieldModule&&this.parent.calculatedFieldModule.field&&"pivot"===this.parent.dataType&&(this.parent.engineModule.fields=Object.keys(this.parent.clonedFieldList)),this.onCloseFieldList(null,!0)},e.prototype.applyButtonClick=function(){"pivotfieldlist"===this.parent.getModuleName()&&this.parent.allowDeferLayoutUpdate&&(this.parent.pivotChange=!1),this.parent.isDeferUpdateApplied=!0,this.parent.isPopupView||"Server"!==this.parent.dataSourceSettings.mode||(this.parent.isRequiredUpdate=!0),this.parent.updateDataSource(!1);var e=this.parent;e.axisFieldModule.render(),e.clonedDataSource=Di.getClonedDataSourceSettings(e.dataSourceSettings),"olap"===this.parent.dataType&&(this.parent.clonedFieldListData=Di.cloneOlapFieldSettings(this.parent.olapEngineModule.fieldListData)),e.clonedFieldList=Di.getClonedFieldList(e.pivotFieldList)},e.prototype.onCloseFieldList=function(e,t){if((this.parent.allowDeferLayoutUpdate||t)&&(!this.parent.isPopupView||this.parent.pivotGridModule&&""!==this.parent.pivotGridModule.actionObj.actionName||""!==this.parent.actionObj.actionName)){if(this.parent.setProperties({dataSourceSettings:this.parent.clonedDataSource},!0),"olap"===this.parent.dataType)if(this.parent.olapEngineModule.fieldList=Di.getClonedFieldList(this.parent.clonedFieldList),this.parent.olapEngineModule.fieldListData=Di.cloneOlapFieldSettings(this.parent.clonedFieldListData),this.parent.isPopupView)this.parent.isPopupView&&this.parent.clonedFieldListData&&Object.keys(this.parent.clonedFieldListData).length>0&&(this.parent.olapEngineModule.fieldListData=this.parent.clonedFieldListData);else for(var i=0,a=Object.keys(this.parent.clonedFieldList);i<a.length;i++){var r=a[i],n=this.parent.clonedFieldList[r];this.parent.olapEngineModule.updateFieldlistData(n.id,n.isSelected)}else this.parent.engineModule.fieldList=Di.getClonedFieldList(this.parent.clonedFieldList);this.parent.updateDataSource(!1,!0)}if((!this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&!this.parent.pivotGridModule.pivotDeferLayoutUpdate)&&t&&(this.parent.pivotChange=!1),this.parent.allowDeferLayoutUpdate&&this.parent.isPopupView&&this.parent.pivotGridModule&&!this.parent.isAdaptive&&(this.parent.pivotGridModule.actionObj.actionName="",this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule,this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.clonedDataSource},!0)),this.parent.allowDeferLayoutUpdate&&this.parent.allowCalculatedField&&"pivot"===this.parent.dataType&&!this.parent.isAdaptive){this.parent.engineModule.fieldList=this.parent.pivotFieldList=Di.getClonedFieldList(this.parent.clonedFieldList);var s=Object.keys(this.parent.engineModule.fieldList);if(this.parent.allowCalculatedField&&s.length!==this.parent.engineModule.fields.length){var o=[];this.parent.engineModule.fields.forEach((function(e){-1!==s.indexOf(e)&&(o[o.length]=e)})),this.parent.engineModule.fields=o}}"Popup"!==this.parent.renderMode||t?this.parent.actionObj.actionName=us:(this.parent.dialogRenderer.fieldListDialog.hide(),this.parent.actionObj.actionName=Dn),this.parent.actionObj.actionName&&this.parent.actionCompleteMethod()},e.prototype.renderFieldListDialog=function(e){var i=(0,t.createElement)("div",{className:f+" "+o+" e-select-table",attrs:{tabindex:"0",title:this.parent.localeObj.getConstant("fieldList"),"aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("fieldList"),role:"button"}});if(this.parent.element.appendChild(i),this.parent.isAdaptive){var a='<div class=e-title-mobile-header><span class="'+o+" "+Vt+'"></span><div class=e-title-mobile-content>'+this.parent.localeObj.getConstant("fieldList")+"</div></div>",r=[{click:this.showFieldListDialog.bind(this),isFlat:!1,buttonModel:{cssClass:be+" "+xe+" "+we+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:o+" "+Te,isPrimary:!0}},{click:this.showCalculatedField.bind(this),isFlat:!1,buttonModel:{cssClass:Ce+" "+xe+" "+we+" "+l+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:o+" "+Te,enableRtl:this.parent.enableRtl,isPrimary:!0}}];this.fieldListDialog=new Ni.Dialog({animationSettings:{effect:this.parent.enableRtl?"SlideRight":"SlideLeft"},header:a,content:this.parentElement,isModal:!0,showCloseIcon:!1,visible:!1,allowDragging:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"100%",height:"100%",position:{X:"center",Y:"center"},buttons:r,target:document.body,cssClass:this.parent.cssClass,close:this.removeFieldListIcon.bind(this),open:this.dialogOpen.bind(this)}),this.fieldListDialog.isStringTemplate=!0,this.fieldListDialog.appendTo(e),(0,t.setStyleAttribute)((0,t.select)("#"+e.id+"_dialog-content",e),{padding:"0"});var n=e.querySelector(".e-footer-content");(0,t.addClass)([n],O),(0,t.removeClass)([n.querySelector("."+Ce)],Me),(0,t.removeClass)([n.querySelector("."+be)],Me),this.fieldListDialog.element.querySelector("."+Vt).onclick=this.parent.allowDeferLayoutUpdate?this.onDeferUpdateClick.bind(this):this.onCloseFieldList.bind(this)}else{var s=this.createDeferUpdateButtons().outerHTML;a="<div class="+Se+"><div class=e-title-content>"+this.parent.localeObj.getConstant("fieldList")+"</div></div>";this.fieldListDialog=new Ni.Dialog({animationSettings:{effect:"Zoom"},header:a,content:this.parentElement,isModal:!1,showCloseIcon:!1,visible:!1,allowDragging:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:this.parent.element.style.width,position:{X:"center",Y:this.parent.element.offsetTop},footerTemplate:s,closeOnEscape:!1,cssClass:this.parent.cssClass,target:(0,t.isNullOrUndefined)(this.parent.target)?document.body:"string"==typeof this.parent.target?document.querySelector(this.parent.target):this.parent.target,close:this.removeFieldListIcon.bind(this)}),this.fieldListDialog.isStringTemplate=!0,this.fieldListDialog.appendTo(e),this.renderDeferUpdateButtons(e),(0,t.setStyleAttribute)((0,t.select)("#"+e.id+"_title",e),{width:"100%"}),e.querySelector("."+Se).appendChild(this.createCalculatedButton())}},e.prototype.dialogOpen=function(){4===this.lastTabIndex?(this.adaptiveElement.items[this.lastTabIndex].content="",this.adaptiveElement.dataBind(),this.parent.notify(br,{})):this.adaptiveElement.refresh()},e.prototype.updateDataSource=function(e){for(var t=["filters","columns","rows","values"],i=0,a=e;i<a.length;i++){var r=a[i],n=t[this.adaptiveElement.selectedItem];this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.dataSourceUpdate.updateDataSource(r,n,-1)}this.parent.axisFieldModule.render(),this.parent.allowDeferLayoutUpdate?this.parent.triggerPopulateEvent():this.parent.updateDataSource(!0)},e.prototype.onDeferUpdateClick=function(){this.parent.isPopupView&&"Server"===this.parent.dataSourceSettings.mode&&(this.parent.isRequiredUpdate=!0),this.parent.updateDataSource(),this.parent.dialogRenderer.fieldListDialog.hide()},e.prototype.renderAdaptiveLayout=function(e){var i=(0,t.createElement)("div",{className:O});e.appendChild(this.parentElement);var a=[{header:{text:this.parent.localeObj.getConstant("filters")},content:this.createAxisTable("filters")},{header:{text:this.parent.localeObj.getConstant("columns")},content:this.createAxisTable("columns")},{header:{text:this.parent.localeObj.getConstant("rows")},content:this.createAxisTable("rows")},{header:{text:this.parent.localeObj.getConstant("values")},content:this.createAxisTable("values")},{header:{text:this.parent.localeObj.getConstant("createCalculatedField")},content:"Calculated Field Related UI"}];this.parent.allowCalculatedField||a.pop(),this.adaptiveElement=new ms.Tab({heightAdjustMode:"Auto",items:a,height:"100%",enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,locale:this.parent.locale,selected:this.tabSelect.bind(this),cssClass:this.parent.cssClass}),"Fixed"===this.parent.renderMode?(i.appendChild(this.createAddButton()),(0,t.addClass)([e],y),this.adaptiveElement.isStringTemplate=!0,this.adaptiveElement.appendTo(this.parentElement),this.parentElement.appendChild(i)):(this.adaptiveElement.isStringTemplate=!0,this.adaptiveElement.appendTo(this.parentElement))},e.prototype.tabSelect=function(e){var i=(0,t.closest)(this.parentElement,"."+m);this.lastTabIndex=e.selectedIndex,i&&i.querySelector("."+be)&&(4!==e.selectedIndex?((0,t.addClass)([i.querySelector("."+Ce)],l),(0,t.removeClass)([i.querySelector("."+be)],l)):((0,t.removeClass)([i.querySelector("."+Ce)],l),(0,t.addClass)([i.querySelector("."+be)],l))),4===e.selectedIndex?(this.adaptiveElement.items[4].content="",this.adaptiveElement.dataBind(),this.parent.notify(br,{})):this.parent.axisFieldModule.render()},e.prototype.createCalculatedButton=function(){var e=(0,t.createElement)("button",{id:this.parent.element.id+"_CalculatedField",attrs:{type:"button",tabindex:"0","aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("CalculatedField")}}),i=new Os.Button({cssClass:"e-calculated-field "+l+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("CalculatedField"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});return i.isStringTemplate=!0,i.appendTo(e),this.parent.calculatedFieldModule&&(0,t.removeClass)([e],l),i.element.onclick=this.showCalculatedField.bind(this),e},e.prototype.createAddButton=function(){var e=(0,t.createElement)("div",{className:O+"-content"}),i=(0,t.createElement)("div",{}),a=(0,t.createElement)("div",{}),r=new Os.Button({cssClass:Ce+" "+xe+" "+we+" "+l+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:o+" "+Te,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer}),n=new Os.Button({cssClass:be+" "+xe+" "+we+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:o+" "+Te,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});return n.isStringTemplate=!0,n.appendTo(i),r.isStringTemplate=!0,r.appendTo(a),e.appendChild(i),e.appendChild(a),r.element.onclick=this.showCalculatedField.bind(this),n.element.onclick=this.showFieldListDialog.bind(this),e},e.prototype.createAxisTable=function(e){var i=(0,t.createElement)("div",{className:C+"-"+e}),a=(0,t.createElement)("div",{className:I+" e-"+e}),r=(0,t.createElement)("span",{className:F});return r.innerText=this.parent.localeObj.getConstant("addPrompt"),i.appendChild(a),i.appendChild(r),i},e.prototype.showCalculatedField=function(){try{if(!this.parent.isAdaptive){if(this.parent.actionObj.actionName=un,this.parent.actionBeginMethod())return;this.parent.dialogRenderer.fieldListDialog&&(this.parent.dialogRenderer.fieldListDialog.hide(),(0,t.addClass)([this.parent.element.querySelector("."+f)],d))}this.parent.notify(br,{})}catch(e){this.parent.actionFailureMethod(e)}},e.prototype.showFieldListDialog=function(){var e=this.adaptiveElement.selectedItem;this.parent.treeViewModule.render(e)},e.prototype.onShowFieldList=function(){if(this.parent.actionObj.actionName=qr,!this.parent.actionBeginMethod()){this.parent.actionObj.actionName="";try{this.parent.allowDeferLayoutUpdate&&(this.parent.isAdaptive&&this.parent.axisFieldModule.render(),this.parent.clonedDataSource=Di.getClonedDataSourceSettings(this.parent.dataSourceSettings),"olap"===this.parent.dataType&&(this.parent.clonedFieldListData=Di.cloneOlapFieldSettings(this.parent.olapEngineModule.fieldListData)),this.parent.clonedFieldList=Di.getClonedFieldList(this.parent.pivotFieldList)),(0,t.addClass)([this.parent.element.querySelector("."+f)],d),this.parent.dialogRenderer.fieldListDialog.show(),this.parent.dialogRenderer.fieldListDialog.element.style.top=parseInt(this.parent.dialogRenderer.fieldListDialog.element.style.top,10)<0?"0px":this.parent.dialogRenderer.fieldListDialog.element.style.top}catch(e){this.parent.actionFailureMethod(e)}}},e.prototype.removeFieldListIcon=function(){this.parent.isAdaptive&&this.parent.allowCalculatedField&&this.parent.calculatedFieldModule&&this.adaptiveElement&&4===this.adaptiveElement.selectedItem&&((0,t.select)("#"+this.parent.element.id+"droppable",this.adaptiveElement.element)?this.parent.calculatedFieldModule.updateAdaptiveCalculatedField(!1):this.parent.notify(br,{edit:!1})),document.getElementById(this.parent.element.id+"calculateddialog")||(0,t.removeClass)([this.parent.element.querySelector("."+f)],d)},e.prototype.keyPress=function(e){if(13===e.keyCode&&e.target)return e.target.click(),void e.preventDefault()},e.prototype.wireDialogEvent=function(e){t.EventHandler.add(e,"keydown",this.keyPress,this),t.EventHandler.add(e,"click",this.onShowFieldList,this)},e.prototype.unWireDialogEvent=function(e){t.EventHandler.remove(e,"keydown",this.keyPress),t.EventHandler.remove(e,"click",this.onShowFieldList)},e.prototype.destroy=function(){"Popup"===this.parent.renderMode&&this.unWireDialogEvent(this.parent.element.querySelector("."+f)),this.deferUpdateCheckBox&&!this.deferUpdateCheckBox.isDestroyed&&(this.deferUpdateCheckBox.destroy(),this.deferUpdateCheckBox=null),this.deferUpdateApplyButton&&!this.deferUpdateApplyButton.isDestroyed&&(this.deferUpdateApplyButton.destroy(),this.deferUpdateApplyButton=null),this.deferUpdateCancelButton&&!this.deferUpdateCancelButton.isDestroyed&&(this.deferUpdateCancelButton.destroy(),this.deferUpdateCancelButton=null),this.adaptiveElement&&!this.adaptiveElement.isDestroyed&&(this.adaptiveElement.destroy(),this.adaptiveElement=null),"Popup"===this.parent.renderMode&&(this.fieldListDialog&&!this.fieldListDialog.isDestroyed&&(this.fieldListDialog.destroy(),this.fieldListDialog=null),document.getElementById(this.parent.element.id+"_Container")&&(0,t.remove)(document.getElementById(this.parent.element.id+"_Container")))},e}(),vl=function(){function e(e){this.selectedNodes=[],this.isSearching=!1,this.parentIDs=[],this.isSpaceKey=!1,this.parent=e,this.addEventListener()}return e.prototype.render=function(e){if(this.parentElement=this.parent.dialogRenderer.parentElement,this.fieldListSort=this.parent.pivotGridModule?this.parent.pivotGridModule.defaultFieldListOrder:this.parent.defaultFieldListOrder,this.fieldListSort="Ascending"===this.fieldListSort?"Ascend":"Descending"===this.fieldListSort?"Descend":"None",this.parent.isAdaptive)this.renderTreeDialog(e);else{var i=(0,t.createElement)("div",{className:"e-field-table "+("olap"===this.parent.dataType?"e-olap-field-table":"")}),a=(0,t.createElement)("div",{className:"e-field-header",attrs:{title:this.parent.localeObj.getConstant("allFields")}});a.innerText=this.parent.localeObj.getConstant("allFields");var r=(0,t.createElement)("div",{className:x+" "+dt});this.treeViewElement=(0,t.createElement)("div",{id:this.parent.element.id+"_TreeView",className:C+" "+("olap"===this.parent.dataType?"e-olap-field-list-tree":"")});var n=(0,t.createElement)("div",{className:"e-field-header-container"});if(n.appendChild(a),i.appendChild(n),this.updateSortElements(n),this.parent.enableFieldSearching){var s=(0,t.createElement)("div",{id:this.parent.element.id+"_SearchDiv",attrs:{tabindex:"-1"},className:"e-field-list-search"}),d=(0,t.createElement)("input",{attrs:{type:"text"}});s.appendChild(d),this.fieldSearch=new fs.TextBox({placeholder:this.parent.localeObj.getConstant("search"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:"e-field-list-search-input"+(this.parent.cssClass?" "+this.parent.cssClass:""),input:this.textChange.bind(this),showClearButton:!0}),this.fieldSearch.isStringTemplate=!0,this.fieldSearch.appendTo(d),this.fieldSearch.addIcon("append","e-field-list-search-icon "+o);var h=(0,t.createElement)("div",{className:yt+" "+l});h.innerText=this.parent.localeObj.getConstant("noMatches"),i.appendChild(s),i.appendChild(h)}if(r.appendChild(this.treeViewElement),i.appendChild(r),this.parentElement.appendChild(i),"Fixed"===this.parent.renderMode){var p=(0,t.createElement)("div",{className:"e-center-div"}),u=(0,t.createElement)("div",{className:"e-center-title"});u.innerText=this.parent.localeObj.getConstant("centerHeader"),this.parentElement.appendChild(p),this.parentElement.appendChild(u)}this.renderTreeView()}},e.prototype.updateSortElements=function(e){for(var i={None:"sortNone",Ascend:"sortAscending",Descend:"sortDescending"},a=0,r=Object.keys(i);a<r.length;a++){var n=r[a],s=(0,t.createElement)("span",{attrs:{tabindex:"0","aria-disabled":"false","aria-label":"Sort "+n,"data-sort":n,title:this.parent.localeObj.getConstant(i[n]),role:"button"},className:o+" e-sort-"+n.toLowerCase()+" "+(this.fieldListSort===n?"e-selected":"")});e.appendChild(s),this.unWireFieldListEvent(s),this.wireFieldListEvent(s)}},e.prototype.renderTreeView=function(){this.fieldTable=new ms.TreeView({fields:{dataSource:this.getTreeData(),id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},nodeChecked:this.nodeChecked.bind(this),nodeClicked:this.nodeStateChange.bind(this),keyPress:this.nodeStateChange.bind(this),cssClass:"e-field-list-tree"+(this.parent.cssClass?" "+this.parent.cssClass:""),showCheckBox:!0,allowDragAndDrop:!0,sortOrder:"None",loadOnDemand:"olap"!==this.parent.dataType&&!this.parent.enableFieldSearching,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,nodeDragStart:this.dragStart.bind(this),nodeDragStop:this.dragStop.bind(this),drawNode:this.updateTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:function(e){(0,t.removeClass)([e.node],"e-active"),e.cancel=!0}}),this.treeViewElement.innerHTML="",this.fieldTable.isStringTemplate=!0,this.fieldTable.appendTo(this.treeViewElement);var e="Fixed"===this.parent.renderMode?this.parent.element:this.parentElement;(0,t.isNullOrUndefined)(e.querySelector("."+C))||((0,t.getInstance)(e.querySelector("."+C),ms.TreeView).dragObj.enableAutoScroll=!1)},e.prototype.updateNodeIcon=function(e){if("olap"===this.parent.dataType)if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-icon")>-1){var i=e.node.querySelector(".e-list-icon");(0,t.removeClass)([i],"e-folderCDB-icon"),(0,t.addClass)([i],"e-folderCDB-open-icon")}else if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-open-icon")>-1){i=e.node.querySelector(".e-list-icon");(0,t.removeClass)([i],"e-folderCDB-open-icon"),(0,t.addClass)([i],"e-folderCDB-icon")}},e.prototype.updateTreeNode=function(e){var i=!1;"olap"===this.parent.dataType?i=this.updateOlapTreeNode(e):e.nodeData.hasChildren?(i=!1,e.node.querySelector("."+jt).style.display="none",(0,t.addClass)([e.node],M)):i=!0,(0,t.isNullOrUndefined)(e.nodeData.pid)||(0,t.addClass)([e.node],D);var a=e.node.querySelector("."+ye);if(e.node.querySelector(".e-list-icon")&&a){var r=e.node.querySelector(".e-list-icon");a.insertBefore(r,e.node.querySelector(".e-list-text"))}if(i&&!this.parent.isAdaptive){var n=Di.getFieldInfo(e.nodeData.id,this.parent);i=!1;var s=(0,t.createElement)("span",{attrs:{tabindex:"-1",title:n.fieldItem?n.fieldItem.allowDragAndDrop?this.parent.localeObj.getConstant("drag"):"":this.parent.localeObj.getConstant("drag"),"aria-disabled":"false"},className:o+" "+G+" "+(n.fieldItem?n.fieldItem.allowDragAndDrop?"":z:"")});e.node.querySelector("."+jt)&&!e.node.querySelector(".cls.DRAG_CLASS")&&a&&a.insertBefore(s,e.node.querySelector("."+jt))}if(e.node.querySelector("."+ee)&&(0,t.addClass)([e.node.querySelector("."+De)],Oe),this.parent.enableFieldSearching&&this.isSearching){var d=e.node;if("olap"===this.parent.dataType)for(var h=d.getAttribute("data-uid"),p=this.parent.pivotCommon.eventBase.searchListItem,u=0;u<this.parentIDs.length;u++){h===this.parentIDs[u]&&(0,t.addClass)([d],l);for(var c=0,g=p;c<g.length;c++){var m=g[c],f=this.parent.pivotCommon.eventBase.getParentIDs(this.fieldTable,m.getAttribute("data-uid"),[]);if(Di.inArray(h,f)>-1){(0,t.removeClass)([d],l);break}}}else for(u=0;u<this.nonSearchList.length;u++){if(d.textContent===this.nonSearchList[u].textContent){(0,t.addClass)([d],l);break}if(d.innerText===this.nonSearchList[u].textContent){(0,t.addClass)([d],l);break}}}},e.prototype.updateOlapTreeNode=function(e){var t=!1;return"olap"===this.parent.dataType?(e.node&&e.node.querySelector(".e-calcMemberGroupCDB,.e-measureGroupCDB-icon,.e-folderCDB-icon,.e-folderCDB-open-icon,.e-dimensionCDB-icon,.e-kpiCDB-icon")&&(e.node.querySelector("."+jt).style.display="none"),e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-list-icon").className.indexOf("e-level-members")>-1&&(this.parent.isAdaptive?e.node.querySelector("."+jt).style.display="none":e.node.querySelector("."+jt).style.visibility="hidden"),e.node&&(e.node.querySelector(".e-hierarchyCDB-icon,.e-attributeCDB-icon,.e-namedSetCDB-icon")||e.node.querySelector(".e-measure-icon,.e-kpiGoal-icon,.e-kpiStatus-icon,.e-kpiTrend-icon,.e-kpiValue-icon")||e.node.querySelector(".e-calc-measure-icon,.e-calc-dimension-icon"))&&(e.node.querySelector(".e-measure-icon")?(e.node.querySelector(".e-list-icon").style.display="none",t=!0):t=!0)):t=!0,t},e.prototype.renderTreeDialog=function(e){var i=(0,t.createElement)("div",{id:this.parent.element.id+"_FieldListTreeView",className:"e-adaptive-field-list-dialog "+("olap"===this.parent.dataType?"e-olap-editor-dialog":"")});this.parentElement.appendChild(i),this.fieldDialog=new Ni.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("adaptiveFieldHeader"),content:this.createTreeView(this.getTreeData(e)),isModal:!0,visible:!0,showCloseIcon:!1,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,locale:this.parent.locale,width:"320px",height:"350px",position:{X:"center",Y:"center"},buttons:[{click:this.closeTreeDialog.bind(this),isFlat:!1,buttonModel:{cssClass:ae+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}},{click:this.onFieldAdd.bind(this),isFlat:!1,buttonModel:{cssClass:ie+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("add"),isPrimary:!0}}],closeOnEscape:!1,cssClass:this.parent.cssClass,close:this.closeTreeDialog.bind(this),target:(0,t.closest)(this.parentElement,"."+m)}),this.fieldDialog.isStringTemplate=!0,this.fieldDialog.appendTo(i)},e.prototype.createTreeView=function(e){var i=(0,t.createElement)("div",{id:this.parent.element.id+"EditorDiv",className:Y}),a=(0,t.createElement)("div",{id:this.parent.element.id+"_SearchDiv",attrs:{tabindex:"-1"},className:Ke}),r=(0,t.createElement)("input",{attrs:{type:"text"}});a.appendChild(r);var n=(0,t.createElement)("div",{className:x}),s=(0,t.createElement)("div",{className:K+" "+("olap"===this.parent.dataType?"e-olap-field-list-tree":"")});i.appendChild(a),this.editorSearch=new fs.MaskedTextBox({showClearButton:!0,placeholder:this.parent.localeObj.getConstant("search"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:Xe+(this.parent.cssClass?" "+this.parent.cssClass:""),change:this.textChange.bind(this)}),this.editorSearch.isStringTemplate=!0,this.editorSearch.appendTo(r);var o=(0,t.createElement)("div",{className:yt+" "+l});return o.innerText=this.parent.localeObj.getConstant("noMatches"),i.appendChild(o),n.appendChild(s),i.appendChild(n),this.fieldTable=new ms.TreeView({fields:{dataSource:e,id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},showCheckBox:!0,loadOnDemand:"olap"!==this.parent.dataType,sortOrder:"olap"===this.parent.dataType?"None":"Ascending",enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass,nodeChecked:this.nodeChecked.bind(this),nodeClicked:this.addNode.bind(this),keyPress:this.addNode.bind(this),drawNode:this.updateTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:function(e){(0,t.removeClass)([e.node],"e-active"),e.cancel=!0}}),this.fieldTable.isStringTemplate=!0,this.fieldTable.appendTo(s),i},e.prototype.textChange=function(e){var i,a;this.parent.pivotCommon.eventBase.searchTreeNodes(e,this.fieldTable,!0),this.parent.isAdaptive?i=this.fieldDialog.element.querySelector("."+yt):(i=this.parentElement.querySelector("."+yt),a=this.parentElement.querySelector("."+dt));var r=[].slice.call(this.fieldTable.element.querySelectorAll("li")),n=[].slice.call(this.fieldTable.element.querySelectorAll("li."+l));if(r.length===n.length?((0,t.removeClass)([i],l),this.parent.isAdaptive||((0,t.addClass)([a],l),(0,t.removeClass)([a],w))):((0,t.addClass)([i],l),this.parent.isAdaptive||((0,t.removeClass)([a],l),(0,t.addClass)([a],w))),this.isSearching=n.length>0,this.nonSearchList=n,"olap"===this.parent.dataType){this.parentIDs=[];for(var s=0;s<r.length;s++)if(r[s].classList.contains("e-level-1")){var o=r[s].getAttribute("data-uid");this.parentIDs.push(o)}}},e.prototype.dragStart=function(e){var i=this;if(e.event.target.classList.contains(G)&&!e.event.target.classList.contains(z)){var a=Di.getFieldInfo(e.draggedNode.getAttribute("data-uid"),this.parent),r={fieldName:a.fieldName,fieldItem:a.fieldItem,axis:a.axis,dataSourceSettings:this.parent.dataSourceSettings,cancel:!1};(this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(ar,r,(function(a){if(a.cancel)i.parent.isDragging=!1,e.cancel=!0;else{i.parent.isDragging=!0,(0,t.addClass)([e.draggedNode.querySelector("."+De)],ve);var r=void 0;r="olap"===i.parent.dataType?i.parent.olapEngineModule.fieldList[e.draggedNode.getAttribute("data-uid")]:i.parent.engineModule.fieldList[e.draggedNode.getAttribute("data-uid")];var n=[se,oe,de];if(r&&"CalculatedField"===r.aggregateType)for(var s=0,o=n;s<o.length;s++){var l=o[s];(0,t.addClass)([i.parentElement.querySelector("."+l)],fe)}var d=e.clonedNode;d&&"Popup"===("pivotfieldlist"===i.parent.getModuleName()&&i.parent.renderMode)&&(d.style.zIndex=(i.parent.dialogRenderer.fieldListDialog.zIndex+1).toString())}}))}else this.parent.isDragging=!1,e.cancel=!0},e.prototype.dragStop=function(e){e.cancel=!0,this.parent.isDragging=!1;for(var i=0,a=[se,oe,de];i<a.length;i++){var r=a[i];(0,t.removeClass)([this.parentElement.querySelector("."+r)],fe)}(0,t.removeClass)([e.draggedNode.querySelector("."+De)],ve),this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();var n=e.draggedNodeData.id.toString();if(this.isNodeDropped(e,n)){var s=this.parent.pivotFieldList[n];if(this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.isPopupView&&this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(e,n))this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&this.parent.pivotGridModule.pivotDeferLayoutUpdate?(s.isSelected=!0,this.updateDataSource()):this.parent.updateDataSource(),this.parent.axisFieldModule.render()}},e.prototype.isNodeDropped=function(e,i){var a=!0;if("true"===e.draggedNodeData.isChecked){var r=this.getButton(i),n=(0,t.closest)(r,"."+ne),s=(0,t.closest)(e.target,"."+ne);if(r&&n===s){for(var o=[].slice.call(n.querySelectorAll("."+A)),l=(0,t.closest)(e.target,"."+L),d=void 0,h=-1,p=0,u=o.length;p<u;p++)if(o[p].id===r.id&&(d=p),l){var c=l.querySelector("."+A);o[p].id===c.id&&(h=p)}if(d===h||d===o.length-1&&-1===h){var g=document.getElementById(this.parent.element.id+"_Container");(0,t.removeClass)([].slice.call(g.querySelectorAll("."+W)),Q),a=!1}}}return a},e.prototype.getButton=function(e){for(var t,i=document.getElementById(this.parent.element.id+"_Container"),a=[].slice.call(i.querySelectorAll("."+A)),r=0,n=a.length;r<n;r++)if(a[r].getAttribute("data-uid")===e){t=a[r];break}return t},e.prototype.nodeChecked=function(e){if(this.isSpaceKey){var i=(0,t.closest)(e.node,"."+ye);if(!(0,t.isNullOrUndefined)(i)){var a=(0,t.closest)(i,"li").getAttribute("data-uid");this.parent.isAdaptive?this.addNode(void 0,a,"check"===e.action,i):this.nodeStateChange(void 0,a,"check"===e.action,i)}}this.isSpaceKey=!1},e.prototype.nodeStateChange=function(e,i,a,r){var n=this;r=(0,t.isNullOrUndefined)(r)?e.node:r,i=(0,t.isNullOrUndefined)(i)?r.getAttribute("data-uid"):i,this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();var s=this.parent.pivotFieldList[i];if(!(0,t.isNullOrUndefined)(e)){if(this.isSpaceKey=e.event.action&&"space"===e.event.action,(0,t.isNullOrUndefined)(s)||r.classList.contains(l)||e.event.target&&(e.event.target.classList.contains(Ci)||e.event.target.classList.contains(xi))||e.event.action&&"enter"!==e.event.action)return;a=!1;var o=this.fieldTable.getNode(r);e.event&&e.event.target&&!e.event.target.closest("."+jt)?"true"===o.isChecked?(this.fieldTable.uncheckAll([r]),a=!1):(this.fieldTable.checkAll([r]),a=!0):a="true"===o.isChecked}var d=this.parent.isPopupView?this.parent.pivotGridModule:this.parent,h=Di.getFieldInfo(i,this.parent),p=r.closest("."+M);if(a){var u={fieldName:i,dropField:h.fieldItem,dataSourceSettings:Di.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:"number"===s.type||"CalculatedField"===s.type&&s.formula&&s.formula.indexOf("Measure")>-1&&"olap"===this.parent.dataType?"values":"rows",dropPosition:h.position,draggedAxis:"fieldlist",cancel:!1};d.trigger(Ai,u,(function(e){if(e.cancel)n.updateCheckState(s,"check");else{(0,t.addClass)([r.querySelector("."+De)],Oe),p&&(0,t.addClass)([p.querySelector("."+De)],Oe),n.updateSelectedNodes(r,"check");var o=n.parent.pivotCommon.dataSourceUpdate.getNewField(i,h.fieldItem);n.updateReportSettings(o,e),n.updateNodeStateChange(i,s,a)}}))}else{var c={cancel:!1,fieldName:i,dataSourceSettings:Di.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:h.fieldItem,axis:h.axis};d.trigger(er,c,(function(e){e.cancel?n.updateCheckState(s,"uncheck"):((0,t.removeClass)([r.querySelector("."+De)],Oe),p&&(0,t.isNullOrUndefined)(p.querySelector("."+D+" ."+ee))&&(0,t.removeClass)([p.querySelector("."+De)],Oe),n.updateSelectedNodes(r,"uncheck"),n.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(i),"pivot"===n.parent.dataType&&n.parent.showValuesButton&&n.parent.dataSourceSettings.values.length>1&&h&&h.position<n.parent.dataSourceSettings.valueIndex&&("row"===n.parent.dataSourceSettings.valueAxis&&"rows"===h.axis||"column"===n.parent.dataSourceSettings.valueAxis&&"columns"===h.axis)&&d.setProperties({dataSourceSettings:{valueIndex:n.parent.dataSourceSettings.valueIndex-1}},!0),"olap"===n.parent.dataType&&0===n.parent.dataSourceSettings.values.length&&n.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[Measures]"),n.updateNodeStateChange(i,s,a))}))}},e.prototype.updateReportSettings=function(e,i){var a=i.dropPosition,r=i.dropAxis;if("pivot"===this.parent.dataType&&this.parent.showValuesButton&&this.parent.dataSourceSettings.values.length>1){var n="row"===this.parent.dataSourceSettings.valueAxis&&"rows"===r?this.parent.dataSourceSettings.rows:"column"===this.parent.dataSourceSettings.valueAxis&&"columns"===r?this.parent.dataSourceSettings.columns:void 0;(0,t.isNullOrUndefined)(n)||(-1===a&&-1===this.parent.dataSourceSettings.valueIndex?this.parent.setProperties({dataSourceSettings:{valueIndex:n.length}},!0):a>-1&&a<=this.parent.dataSourceSettings.valueIndex?this.parent.setProperties({dataSourceSettings:{valueIndex:this.parent.dataSourceSettings.valueIndex+1}},!0):this.parent.dataSourceSettings.valueIndex>-1&&a>this.parent.dataSourceSettings.valueIndex&&(a-=1))}switch(r){case"filters":-1!==a?this.parent.dataSourceSettings.filters.splice(a,0,e):this.parent.dataSourceSettings.filters.push(e);break;case"rows":-1!==a?this.parent.dataSourceSettings.rows.splice(a,0,e):this.parent.dataSourceSettings.rows.push(e);break;case"columns":-1!==a?this.parent.dataSourceSettings.columns.splice(a,0,e):this.parent.dataSourceSettings.columns.push(e);break;case"values":if(-1!==a?this.parent.dataSourceSettings.values.splice(a,0,e):this.parent.dataSourceSettings.values.push(e),"olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.isMeasureAvail&&!(this.parent.dataSourceSettings.values.length>1)){var s={name:"[Measures]",caption:"Measures",baseField:void 0,baseItem:void 0};("row"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.rows:this.parent.dataSourceSettings.columns).push(s)}}},e.prototype.updateCheckState=function(e,t){for(var i=this.fieldTable.element.querySelectorAll("."+jt),a=this.fieldTable.element.querySelectorAll(".e-list-text"),r=0;r<i.length;r++)e.caption===a[r].textContent&&("check"===t?this.fieldTable.uncheckAll([e.id]):this.fieldTable.checkAll([e.id]))},e.prototype.updateNodeStateChange=function(e,i,a){!1===this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&!1===this.parent.pivotGridModule.pivotDeferLayoutUpdate?this.parent.updateDataSource(!0):(i.isSelected=a,"olap"===this.parent.dataType&&this.parent.olapEngineModule.updateFieldlistData(e,a),this.updateDataSource());var r=this.treeViewElement.querySelector('[data-uid="'+e+'"]');r.focus(),(0,t.removeClass)([r],"e-hover");var n=this.parent;setTimeout((function(){n.axisFieldModule.render()}))},e.prototype.updateSelectedNodes=function(e,i){if(e&&e.querySelector("ul"))for(var a=0,r=[].slice.call(e.querySelectorAll("li"));a<r.length;a++){var n=r[a];"check"===i?(0,t.addClass)([n.querySelector("."+De)],Oe):(0,t.removeClass)([n.querySelector("."+De)],Oe)}},e.prototype.updateDataSource=function(){this.parent.isPopupView?("olap"===this.parent.dataType?this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule:this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0),this.parent.pivotGridModule.notify(pr,this)):this.parent.triggerPopulateEvent()},e.prototype.addNode=function(e,i,a,r){var n=this;r=(0,t.isNullOrUndefined)(r)?e.node:r,i=(0,t.isNullOrUndefined)(i)?r.getAttribute("data-uid"):i;var s=this.parent.pivotFieldList[i];if(!(0,t.isNullOrUndefined)(e)){if(this.isSpaceKey=e.event.key&&" "===e.event.key,(0,t.isNullOrUndefined)(s)||e.node.classList.contains(l)||e.event.target&&(e.event.target.classList.contains(Ci)||e.event.target.classList.contains(xi))||e.event.key&&"Enter"!==e.event.key)return;a=!1;var o=this.fieldTable.getNode(e.node);e.event&&e.event.target&&!e.event.target.classList.contains($)?"true"===o.isChecked?(this.fieldTable.uncheckAll([e.node]),a=!1):(this.fieldTable.checkAll([e.node]),a=!0):a="true"===o.isChecked}var d=Di.getFieldInfo(s.id.toString(),this.parent),h=this.parent.isPopupView?this.parent.pivotGridModule:this.parent;if(a){var p={fieldName:d.fieldName,dropField:d.fieldItem,dataSourceSettings:Di.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:["filters","columns","rows","values"][this.parent.dialogRenderer.adaptiveElement.selectedItem],draggedAxis:"fieldlist",cancel:!1};h.trigger(Ai,p,(function(e){e.cancel?n.updateCheckState(s,"check"):n.selectedNodes.push(s.id.toString())}))}else{var u={cancel:!1,fieldName:d.fieldName,dataSourceSettings:Di.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:d.fieldItem,axis:d.axis};h.trigger(er,u,(function(e){if(e.cancel)n.updateCheckState(s,"uncheck");else for(var t=n.selectedNodes.length;t--;)if(n.selectedNodes[t]===s.id.toString()){n.selectedNodes.splice(t,1);break}}))}},e.prototype.refreshTreeView=function(){if(this.fieldTable){var e=this.getUpdatedData();this.fieldTable.fields={dataSource:e,id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},this.fieldTable.dataBind()}},e.prototype.getUpdatedData=function(){var e=this.getTreeData(),t=this.fieldTable.expandedNodes;return this.updateExpandedNodes(e,t),this.applySorting(e,this.fieldListSort)},e.prototype.getTreeData=function(e){var i=[];if("olap"===this.parent.dataType)i=this.getOlapTreeData(e);else{for(var a=this.parent.pivotFieldList?Object.keys(this.parent.pivotFieldList):[],r={},n=0,s=a;n<s.length;n++){var o=s[n],l=this.parent.pivotFieldList[o];if(r[o]={id:l.id,pid:l.pid,caption:l.caption,isSelected:l.isSelected},!(0,t.isNullOrUndefined)(l.pid)&&!r[o].hasChildren){var d=l.pid+"_group_name";r[o].pid=d,r[d]={id:d,caption:l.pid,isSelected:r[d]&&r[d].isSelected?r[d].isSelected:l.isSelected,hasChildren:!0}}}if(this.parent.isAdaptive){for(var h=[this.parent.dataSourceSettings.filters,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.values][e],p=a.length;p--;)r[a[p]].isSelected=!1;for(var u=0,c=h;u<c.length;u++){r[c[u].name].isSelected=!0}}for(var g=0,m=Object.keys(r);g<m.length;g++){var f=r[l=m[g]];i.push(f)}}return i},e.prototype.getOlapTreeData=function(e){var i=[],a=this.parent.olapEngineModule.fieldListData?this.parent.olapEngineModule.fieldListData:[];if(this.parent.isAdaptive)for(var r=[this.parent.dataSourceSettings.filters,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.values][e],n=0;n<a.length;){var s=a[n],o=void 0;if(3===e){if("[measures]"!==s.id.toLowerCase()&&(0===s.id.toLowerCase().indexOf("[measures]")||s.spriteCssClass&&-1!==s.spriteCssClass.indexOf("e-measureCDB"))||"[calculated members].[_0]"===s.id.toLowerCase()||s.spriteCssClass&&-1!==s.spriteCssClass.indexOf("e-calc-measure-icon")){(o={id:s.id,caption:s.caption,hasChildren:s.hasChildren,type:s.type,aggregateType:s.aggregateType,isSelected:s.isSelected,pid:s.pid,spriteCssClass:s.spriteCssClass}).isSelected=!1,o.spriteCssClass&&-1!==o.spriteCssClass.indexOf("e-measureCDB")&&(o.spriteCssClass=o.spriteCssClass.replace("e-folderCDB-icon","e-measureGroupCDB-icon"),o.pid=void 0);for(var l=0,d=r;l<d.length;l++){var h=d[l];if(o.id===h.name){o.isSelected=!0;break}}i.push(o)}}else if(!(0===s.id.toLowerCase().indexOf("[measures]")||s.spriteCssClass&&-1!==s.spriteCssClass.indexOf("e-measureCDB")||s.spriteCssClass&&-1!==s.spriteCssClass.indexOf("e-calc-measure-icon"))){(o={id:s.id,caption:s.caption,hasChildren:s.hasChildren,type:s.type,aggregateType:s.aggregateType,isSelected:s.isSelected,pid:s.pid,spriteCssClass:s.spriteCssClass}).isSelected=!1;for(var p=0,u=r;p<u.length;p++){var c=u[p];if(o.id===c.name){o.isSelected=!0;break}}i.push(o)}n++}else i=(0,t.isNullOrUndefined)(this.parent.olapEngineModule.fieldListData)?[]:Di.getClonedData(this.parent.olapEngineModule.fieldListData);return i},e.prototype.updateExpandedNodes=function(e,t){if(t.length>0)for(var i=0,a=0,r=e;a<r.length;a++){var n=r[a];if(t.indexOf(n.id)>-1&&(i++,n.expanded=!0,n.spriteCssClass=n.spriteCssClass&&n.spriteCssClass.toString().indexOf("e-folderCDB-icon")>-1?n.spriteCssClass.toString().replace("e-folderCDB-icon","e-folderCDB-open-icon"):n.spriteCssClass,i===t.length))break}},e.prototype.updateSorting=function(e){var i=e.target,a=i.getAttribute("data-sort");if(this.parent.actionObj.actionName=on,!this.parent.actionBeginMethod()){try{if(-1===i.className.indexOf("e-selected")){switch(a){case"None":this.fieldListSort="None",(0,t.addClass)([i],"e-selected"),(0,t.removeClass)([this.parentElement.querySelector(".e-sort-ascend")],"e-selected"),(0,t.removeClass)([this.parentElement.querySelector(".e-sort-descend")],"e-selected");break;case"Ascend":this.fieldListSort="Ascend",(0,t.addClass)([i],"e-selected"),(0,t.removeClass)([this.parentElement.querySelector(".e-sort-none")],"e-selected"),(0,t.removeClass)([this.parentElement.querySelector(".e-sort-descend")],"e-selected");break;case"Descend":this.fieldListSort="Descend",(0,t.addClass)([i],"e-selected"),(0,t.removeClass)([this.parentElement.querySelector(".e-sort-ascend")],"e-selected"),(0,t.removeClass)([this.parentElement.querySelector(".e-sort-none")],"e-selected")}this.refreshTreeView()}}catch(e){this.parent.actionFailureMethod(e)}this.parent.actionObj.actionName=this.parent.getActionCompleteName(),this.parent.actionObj.actionName&&this.parent.actionCompleteMethod()}},e.prototype.applySorting=function(e,t){if(e.length>0)if("olap"===this.parent.dataType){var i=void 0,a=void 0;this.parent.dataSourceSettings.calculatedFieldSettings.length>0&&"[calculated members].[_0]"===e[0].id.toLowerCase()?(a=e[0],i=e[1],e.splice(0,2)):(i=e[0],e.splice(0,1)),e="Ascend"===t?e.sort((function(e,t){return e.caption>t.caption?1:t.caption>e.caption?-1:0})):"Descend"===t?e.sort((function(e,t){return e.caption<t.caption?1:t.caption<e.caption?-1:0})):e,a?e.splice(0,0,a,i):e.splice(0,0,i)}else this.fieldTable.sortOrder="Ascend"===t?"Ascending":"Descend"===t?"Descending":"None";return e},e.prototype.onFieldAdd=function(){this.parent.dialogRenderer.updateDataSource(this.selectedNodes),this.closeTreeDialog()},e.prototype.closeTreeDialog=function(){this.selectedNodes=[],this.fieldDialog.hide(),this.fieldDialog.destroy(),document.getElementById(this.parent.element.id+"_FieldListTreeView")&&(0,t.remove)(document.getElementById(this.parent.element.id+"_FieldListTreeView")),this.fieldDialog=null},e.prototype.keyPress=function(e){if(13===e.keyCode&&e.target)return e.target.click(),void e.preventDefault()},e.prototype.wireFieldListEvent=function(e){t.EventHandler.add(e,"keydown",this.keyPress,this),t.EventHandler.add(e,"click",this.updateSorting,this)},e.prototype.unWireFieldListEvent=function(e){t.EventHandler.remove(e,"keydown",this.keyPress),t.EventHandler.remove(e,"click",this.updateSorting)},e.prototype.addEventListener=function(){this.parent.on(Sr,this.refreshTreeView,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(Sr,this.refreshTreeView)},e.prototype.destroy=function(){this.removeEventListener(),this.editorSearch&&!this.editorSearch.isDestroyed&&(this.editorSearch.destroy(),this.editorSearch=null),this.fieldSearch&&!this.fieldSearch.isDestroyed&&(this.fieldSearch.destroy(),this.fieldSearch=null),this.fieldTable&&!this.fieldTable.isDestroyed&&(this.fieldTable.destroy(),this.fieldTable=null),this.fieldDialog&&!this.fieldDialog.isDestroyed&&(this.fieldDialog.destroy(),this.fieldDialog=null)},e}(),Sl=function(){function e(e){this.parent=e}return e.prototype.render=function(){if(!this.parent.isAdaptive){var e=(0,t.createElement)("div",{className:"e-axis-table "+("olap"===this.parent.dataType?"e-olap-axis-table":"")});this.leftAxisPanel=(0,t.createElement)("div",{className:P}),this.rightAxisPanel=(0,t.createElement)("div",{className:N}),this.parent.dialogRenderer.parentElement.appendChild(e),e.appendChild(this.leftAxisPanel),e.appendChild(this.rightAxisPanel),this.axisTable=e,this.renderAxisTable()}this.parent.axisFieldModule.render()},e.prototype.renderAxisTable=function(){for(var e=["filters","rows","columns","values"],i=0,a=e.length;i<a;i++){var r=(0,t.createElement)("div",{className:C+"-"+e[i]}),n=(0,t.createElement)("div",{className:ut+"-container"}),s=(0,t.createElement)("div",{className:"e-axis-header",attrs:{title:this.parent.localeObj.getConstant(e[i])}});s.innerText=this.parent.localeObj.getConstant(e[i]),n.appendChild(this.getIconupdate(e[i])),n.appendChild(s);var o=(0,t.createElement)("div",{className:I+" e-"+e[i]}),l=void 0;l="rows"===e[i]?this.parent.localeObj.getConstant("dropRowPrompt"):"columns"===e[i]?this.parent.localeObj.getConstant("dropColPrompt"):"values"===e[i]?this.parent.localeObj.getConstant("dropValPrompt"):this.parent.localeObj.getConstant("dropFilterPrompt");var d=(0,t.createElement)("span",{className:F});d.innerText=l,new t.Droppable(o,{}),r.appendChild(n),r.appendChild(o),r.appendChild(d),i<=1?this.leftAxisPanel.appendChild(r):this.rightAxisPanel.appendChild(r),this.unWireEvent(o),this.wireEvent(o)}},e.prototype.getIconupdate=function(e){var i=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:ut+"-icon-container"}),a=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:o+" "+ut+"-"+e});return i.appendChild(a),i},e.prototype.wireEvent=function(e){t.EventHandler.add(e,"mouseover",this.updateDropIndicator,this),t.EventHandler.add(e,"mouseleave",this.updateDropIndicator,this)},e.prototype.unWireEvent=function(e){t.EventHandler.remove(e,"mouseover",this.updateDropIndicator),t.EventHandler.remove(e,"mouseleave",this.updateDropIndicator)},e.prototype.updateDropIndicator=function(e){var i=this.parent.dialogRenderer.parentElement;if(this.parent.isDragging&&e.target.classList.contains(I)&&"mouseover"===e.type){(0,t.removeClass)([].slice.call(i.querySelectorAll("."+W)),Q),(0,t.removeClass)([].slice.call(i.querySelectorAll("."+W+"-last")),Q);var a=[].slice.call(e.target.querySelectorAll("."+L));a.length>0&&(0,t.addClass)([a[a.length-1].querySelector("."+W+"-last")],Q)}else this.parent.isDragging&&(e.target.classList.contains(ne)||"mouseleave"!==e.type)||((0,t.removeClass)([].slice.call(i.querySelectorAll("."+W)),Q),(0,t.removeClass)([].slice.call(i.querySelectorAll("."+W+"-last")),Q))},e}(),yl=function(){function e(e){this.parent=e,this.menuOption=new Ss(this.parent),this.parent.pivotButtonModule=this,this.addEventListener(),this.parent instanceof Tl&&(this.axisField=new bl(this.parent)),this.isDestroyed=!1}return e.prototype.renderPivotButton=function(e){var i,a=this;this.parentElement="pivotview"===this.parent.getModuleName()?this.parent.element:document.getElementById(this.parent.element.id+"_Container");var r,n=Array.prototype.slice.call(this.parentElement.querySelectorAll(".e-group-"+e.axis));"rows"===e.axis&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&(0,t.isNullOrUndefined)(this.parentElement.querySelector("."+ui))&&(n.push(this.parent.groupingBarModule.rowPanel),r=this.parent.groupingBarModule.rowPanel);var s=(0,t.extend)([],e.field,null,!0),d=e.axis,h=-1,p="pivot"===this.parent.dataType&&("pivotfieldlist"===this.parent.getModuleName()&&this.parent.pivotGridModule?this.parent.pivotGridModule.showValuesButton:this.parent.showValuesButton);if(("row"===this.parent.dataSourceSettings.valueAxis&&"rows"===e.axis||"column"===this.parent.dataSourceSettings.valueAxis&&"columns"===e.axis)&&p&&this.parent.dataSourceSettings.values.length>1&&(0,t.isNullOrUndefined)(Di.getFieldByName("[Measures]",s))){var u=Di.getFieldByName("[Measures]",this.parent.dataSourceSettings.fieldMapping),c={name:"[Measures]",caption:this.parent.localeObj.getConstant("values"),axis:e.axis,showRemoveIcon:!u||!("showRemoveIcon"in u)||u.showRemoveIcon,allowDragAndDrop:!u||!("allowDragAndDrop"in u)||u.allowDragAndDrop};-1===this.parent.dataSourceSettings.valueIndex||this.parent.dataSourceSettings.valueIndex>s.length?(h=s.length,s.push(c),this.parent.setProperties({dataSourceSettings:{valueIndex:-1}},!0)):(h=this.parent.dataSourceSettings.valueIndex,s.splice(h,0,c))}if("pivotfieldlist"===this.parent.getModuleName()){if(this.parentElement=document.getElementById(this.parent.element.id+"_Container"),!this.parentElement.querySelector("."+C+"-"+d))return;var g=this.parentElement.querySelector("."+C+"-"+d).querySelector("."+F);0===s.length?(0,t.removeClass)([g],l):(0,t.addClass)([g],l),r=this.parentElement.querySelector("."+C+"-"+d).querySelector("."+I)}else this.parentElement=this.parent.element,(0,t.isNullOrUndefined)(this.parentElement.querySelector(".e-group-"+d))||(r=this.parentElement.querySelector(".e-group-"+d));if(r)if("pivotview"===this.parent.getModuleName()&&0===s.length)for(var m=0;m<n.length;m++){if(!(y=n[m]).classList.contains(ai)&&!y.classList.contains(ii))(g=(0,t.createElement)("span",{className:F})).innerText=this.parent.groupingBarSettings.allowDragAndDrop?"rows"===d?this.parent.localeObj.getConstant("rowAxisPrompt"):"columns"===d?this.parent.localeObj.getConstant("columnAxisPrompt"):"values"===d?this.parent.localeObj.getConstant("valueAxisPrompt"):"filters"===d?this.parent.localeObj.getConstant("filterAxisPrompt"):this.parent.localeObj.getConstant("allFields"):"",y.appendChild(g)}else{m=0;for(var f=s.length;m<f;m++)for(var v="pivotfieldlist"===this.parent.getModuleName()?[r]:n,S=0;S<v.length;S++){var y=v[S];if(this.parent.olapEngineModule&&(this.parent.olapEngineModule.fieldList[s[m].name]||"[Measures]"===s[m].name)||this.parent.engineModule){var x="olap"===this.parent.dataType&&("[measures]"===s[m].name.toLowerCase()||"values"===d),w="olap"===this.parent.dataType&&"values"===d;if(!y.classList.contains(ai)&&!y.classList.contains(ii)){var T=(0,t.createElement)("div",{className:L+(0===m&&"all-fields"!==d?" e-first-btn":"")+(this.parent.isTabular?" e-tabular-pvt-btn":""),attrs:{"data-tag":d+":"+s[m].name}});this.parent.isTabular&&(T.style.width="auto");var M=s[m].caption?s[m].caption:s[m].name;M=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(M):M;var D=(0,t.createElement)("div",{id:this.parent.element.id+"_"+s[m].name,className:A+" "+s[m].name.replace(/[^A-Z0-9]/gi,"")+(this.parent.isTabular?" e-tabular-row-btn":""),attrs:{"data-uid":s[m].name,tabindex:"pivotview"===this.parent.getModuleName()&&this.parent.grid&&"rows"===d&&!y.classList.contains(ti)?"-1":"0",isvalue:m===h||x&&!w?"true":"false","aria-disabled":"false","aria-label":M,"data-type":"olap"===this.parent.dataType?w?"isMeasureFieldsAvail":x?"isMeasureAvail":s[m].type:s[m].type,"data-caption":M,"data-basefield":this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(s[m].baseField):s[m].baseField,"data-baseitem":this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(s[m].baseItem):s[m].baseItem,role:"button"}}),O=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:W}),P=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:W+"-last"}),N=this.createButtonDragIcon(s[m],D),E=this.createButtonText(s,m,d,h);if(D.appendChild(E),"all-fields"!==d){if(x||s[m].isNamedSet||s[m].isCalculatedField||(-1!==["filters","values"].indexOf(d)||h===m||"olap"===this.parent.dataType&&("pivotview"===this.parent.getModuleName()&&this.parent.enableVirtualization||"pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableVirtualization)||this.createSortOption(D,s[m].name,s[m]),"values"!==d&&h!==m&&this.createFilterOption(D,s[m].name,d,s[m]),"values"===d&&this.getTypeStatus(s,m,D)),s[m].isCalculatedField||"CalculatedField"===s[m].type){var R=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("editCalculatedField")},className:o+" "+bt});this.parent.allowCalculatedField&&this.parent.calculatedFieldModule&&(s[m].showEditIcon||void 0===s[m].showEditIcon)?(0,t.removeClass)([R],l):(0,t.addClass)([R],l),D.appendChild(R)}var k=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("remove")},className:o+" "+B});"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.showRemoveIcon&&(s[m].showRemoveIcon||void 0===s[m].showRemoveIcon)?(0,t.removeClass)([k],l):(0,t.addClass)([k],l):s[m].showRemoveIcon||void 0===s[m].showRemoveIcon?(0,t.removeClass)([k],l):(0,t.addClass)([k],l),D.appendChild(k),T.appendChild(O),T.appendChild(D),T.appendChild(P)}else T.appendChild(O),T.appendChild(D);y.appendChild(T);var j=new Os.Button({enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass});j.isStringTemplate=!0,j.appendTo(D),this.unWireEvent(T,m===h&&"all-fields"!==d?"values":d,x),this.wireEvent(T,m===h&&"all-fields"!==d?"values":d,x),("pivotview"===this.parent.getModuleName()&&!this.parent.isAdaptive||"pivotfieldlist"===this.parent.getModuleName())&&(this.createDraggable(s[m],"pivotview"===this.parent.getModuleName()?E:N),(0,t.getInstance)(D.querySelector("."+b),t.Draggable).enableAutoScroll=!1)}}}if("values"===d){var q=(0,t.select)("."+ri,this.parentElement)?(0,t.getInstance)((0,t.select)("."+ri,this.parentElement),vs.DropDownList):null,V=function(e){var i=n[e];if(i.classList.contains(ai)&&H.parent.pivotChartModule){var a=s.map((function(e){return{text:e.caption?e.caption:e.name,value:e.name}})),r=H.parent;if(q&&i.querySelector("."+ri))q.dataSource=a,q.value=r.chartSettings.enableMultipleAxis?a[0].value:r.pivotChartModule.currentMeasure;else{var o=(0,t.createElement)("div",{className:ri});i.appendChild(o),q=new vs.DropDownList({dataSource:a,enableRtl:H.parent.enableRtl,locale:H.parent.locale,value:r.chartSettings.enableMultipleAxis?a[0].value:r.pivotChartModule.currentMeasure,width:H.parent.isAdaptive?150:200,fields:{value:"value",text:"text"},cssClass:"e-group-chart-values-drodown"+(H.parent.cssClass?" "+H.parent.cssClass:""),change:function(e){e.e&&null!==e.e&&(r.chartSettings.value=e.value)}}),q.isStringTemplate=!0,q.appendTo(o)}}},H=this;for(m=0;m<n.length;m++)V(m)}else if("columns"===d){var U=void 0,_=(0,t.select)("."+ni,this.parentElement)?(0,t.getInstance)((0,t.select)("."+ni,this.parentElement),vs.DropDownList):null;for(m=0;m<n.length;m++){if((y=n[m]).classList.contains(ii)&&this.parent.pivotChartModule){for(var G=this.parent.pivotChartModule.currentMeasure,z=this.parent.chartSettings.columnDelimiter?this.parent.chartSettings.columnDelimiter:"-",Q=this.parent.chartSettings.columnHeader&&""!==this.parent.chartSettings.columnHeader?this.parent.chartSettings.columnHeader.split(z).join(" - "):"",Y="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,K=Y.pivotValues,X=this.parent.pivotChartModule.getColumnTotalIndex(K),J=[],Z=!1,$=0,ee=Object.keys(K);$<ee.length;$++){var te=ee[$];if(Z)break;var ie=Number(te);if(K[ie][0]&&"row"===K[ie][0].axis&&(0===this.parent.dataSourceSettings.rows.length||"grand sum"!==K[ie][0].type))for(var ae=K[ie][0],re="olap"===this.parent.dataType?Y.tupRowInfo[ae.ordinal]:void 0,ne=K[ie],se=0,oe=Object.keys(ne);se<oe.length;se++){var le=oe[se],de=Number(le),he=K[ie][de],pe="olap"===this.parent.dataType&&re&&re.measureName?re.measureName:he.actualText;if(!X[he.colIndex]&&"value"===he.axis&&"header"!==ae.type&&""!==pe&&pe===G){Z=!0;var ue="olap"===this.parent.dataType?he.columnHeaders.toString().split(/~~|::/).join(" - "):he.columnHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - ");J.push({value:ue,text:ue,title:(i={},i.title=ue,i)}),ue===Q&&(U=J.length)}}}if(_&&y.querySelector("."+ni))_.dataSource=J,_.value=void 0!==U?J[U-1].value:J[0].value;else{var ce=(0,t.createElement)("div",{className:ni});y.appendChild(ce),_=new vs.DropDownList({dataSource:J,enableRtl:this.parent.enableRtl,locale:this.parent.locale,value:U?J[U-1].value:J[0]?J[0].value:"",width:"200",fields:{value:"value",text:"text",htmlAttributes:"title"},cssClass:"e-group-chart-columns-dropdown"+(this.parent.cssClass?" "+this.parent.cssClass:""),change:function(e){if(e.e&&null!==e.e){var t=a.parent.chartSettings.columnDelimiter?a.parent.chartSettings.columnDelimiter:"-";a.parent.chartSettings.columnHeader=e.value.split(" - ").join(t)}}}),_.isStringTemplate=!0,_.appendTo(ce)}}}}}},e.prototype.createButtonText=function(e,i,a,r){var n,s,o;"filters"===a&&(s=this.updateButtontext(e[i].name)),(o="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList&&void 0!==o.fieldList[e[i].name]&&(n="DistinctCount"===(n=o.fieldList[e[i].name].aggregateType)||"number"===o.fieldList[e[i].name].type&&"include"!==o.fieldList[e[i].name].type&&"exclude"!==o.fieldList[e[i].name].type?void 0===n?"Sum":o.fieldList[e[i].name].aggregateType:"Count");var l=e[i].caption?e[i].caption:e[i].name;l=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(l):l;var d=(0,t.createElement)("span",{attrs:{title:"filters"===a?"olap"===this.parent.dataType&&"CalculatedField"===o.fieldList[e[i].name].type?l:l+" ("+s+")":"olap"===this.parent.dataType?l:this.parent.dataSourceSettings.showAggregationOnValueField&&"values"===a&&"CalculatedField"!==n?this.parent.localeObj.getConstant(n)+" "+this.parent.localeObj.getConstant("of")+" "+l:l,tabindex:"-1","aria-disabled":"false",oncontextmenu:"return false;","data-type":r===i?"":n},className:k+" "+("pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.allowDragAndDrop&&(e[i].allowDragAndDrop||void 0===e[i].allowDragAndDrop)?"":z:"")});return d.innerText="filters"===a?"olap"===this.parent.dataType&&"CalculatedField"===o.fieldList[e[i].name].type?l:l+" ("+s+")":"olap"===this.parent.dataType?l:this.parent.dataSourceSettings.showAggregationOnValueField&&"values"===a&&"CalculatedField"!==n?this.parent.localeObj.getConstant(n)+" "+this.parent.localeObj.getConstant("of")+" "+l:l,d},e.prototype.getTypeStatus=function(e,t,i){var a;if((a="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList){var r=a.fieldList[e[t].name];r&&"CalculatedField"!==r.aggregateType&&this.validateDropdown(r.type)&&this.createSummaryType(i,e[t].name,e[t])}},e.prototype.validateDropdown=function(e){var t=this.parent.aggregateTypes;if("number"!==e)return t.indexOf("Count")>-1||t.indexOf("DistinctCount")>-1;for(var i=0;i<t.length;i++)if(this.parent.getAllSummaryType().indexOf(t[i])>-1)return!0;return!1},e.prototype.createSummaryType=function(e,i,a){var r=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("format")},className:o+" "+g});return"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.showValueTypeIcon&&a.showValueTypeIcon?(0,t.removeClass)([r],l):(0,t.addClass)([r],l):a.showValueTypeIcon?(0,t.removeClass)([r],l):(0,t.addClass)([r],l),e.appendChild(r),r},e.prototype.createMenuOption=function(e){this.menuOption.render(e,this.parentElement),this.parent.pivotButtonModule=this},e.prototype.openCalculatedFieldDialog=function(e){var i=e.target.parentElement.getAttribute("data-uid"),a=Di.getFieldInfo(i,this.parent);if(this.parent.actionObj.actionName=ln,this.parent.actionObj.fieldInfo=a,!this.parent.actionBeginMethod())try{"pivotview"===this.parent.getModuleName()?this.parent.isAdaptive&&this.parent.showFieldList&&this.parent.pivotFieldListModule&&!this.parent.pivotFieldListModule.isDestroyed?(this.parent.pivotFieldListModule.element.querySelector("."+f).click(),this.parent.pivotFieldListModule.dialogRenderer.adaptiveElement.select(4),this.parent.pivotFieldListModule.calculatedFieldModule.updateAdaptiveCalculatedField(!0,i)):(this.parent.isAdaptive||(this.parent.calculatedFieldModule.buttonCall=!0),this.parent.notify(br,{edit:!0,fieldName:i})):"pivotfieldlist"===this.parent.getModuleName()&&(this.parent.isAdaptive?(this.parent.dialogRenderer.adaptiveElement.select(4),this.parent.calculatedFieldModule.updateAdaptiveCalculatedField(!0,i),this.parent.calculatedFieldModule.buttonCall=!0):(this.parent.dialogRenderer.fieldListDialog&&(this.parent.dialogRenderer.fieldListDialog.hide(),(0,t.addClass)([this.parent.element.querySelector("."+f)],d)),this.parent.notify(br,{edit:!0,fieldName:i}),this.parent.calculatedFieldModule&&(this.parent.calculatedFieldModule.buttonCall=!0)))}catch(e){this.parent.actionFailureMethod(e)}},e.prototype.createDraggable=function(e,i){this.draggable=new t.Draggable(i,{clone:!0,enableTailMode:!0,enableAutoScroll:!0,helper:this.createDragClone.bind(this),dragStart:this.onDragStart.bind(this),drag:this.onDragging.bind(this),dragStop:this.onDragStop.bind(this),abort:"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.allowDragAndDrop&&e.allowDragAndDrop?"":"."+A:e.allowDragAndDrop?"":"."+A})},e.prototype.createButtonDragIcon=function(e,i){var a=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false"}}),r=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("drag")},className:o+" "+G+" "+(e.allowDragAndDrop||void 0===e.allowDragAndDrop?"":z)});return a.appendChild(r),"pivotfieldlist"===this.parent.getModuleName()&&i.appendChild(a),a},e.prototype.createSortOption=function(e,i,a){var r,n,s;if(s="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,!1===this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&!1===this.parent.pivotGridModule.pivotDeferLayoutUpdate)r="Descending"===s.fieldList[i].sort?V:"";else{r="";for(var d=0;d<this.parent.dataSourceSettings.sortSettings.length;d++)this.parent.dataSourceSettings.sortSettings[d].name===i&&(r="Descending"===this.parent.dataSourceSettings.sortSettings[d].order?V:"")}return n=s.fieldList&&"None"===s.fieldList[i].sort?(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("sort")},className:o}):(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("sort")},className:o+" "+j+" "+r}),this.parent.dataSourceSettings.enableSorting?"pivotview"===this.parent.getModuleName()?a.showSortIcon&&this.parent.groupingBarSettings.showSortIcon?(0,t.removeClass)([n],l):(0,t.addClass)([n],l):a.showSortIcon?(0,t.removeClass)([n],l):(0,t.addClass)([n],l):(0,t.addClass)([n],l),e.appendChild(n),n},e.prototype.createFilterOption=function(e,i,a,r){var n,s;s="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;var d=Di.getFieldByName(i,this.parent.dataSourceSettings.filterSettings);if(!1===this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&!1===this.parent.pivotGridModule.pivotDeferLayoutUpdate)s.fieldList[i].filter=null===s.fieldList[i].filter?[]:s.fieldList[i].filter,n="Server"===this.parent.dataSourceSettings.mode&&!d||"Local"===this.parent.dataSourceSettings.mode&&0===s.fieldList[i].filter.length?s.fieldList[i].isExcelFilter?_:U:_;else{n=U;for(var h=0;h<this.parent.dataSourceSettings.filterSettings.length;h++)this.parent.dataSourceSettings.filterSettings[h].name===i&&(n=_)}var p=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("filter")},className:H+" "+o+" "+n});return(this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==a||this.parent.dataSourceSettings.allowMemberFilter?(0,t.removeClass)([p],l):(0,t.addClass)([p],l),"pivotview"===this.parent.getModuleName()?((this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==a||this.parent.dataSourceSettings.allowMemberFilter)&&this.parent.groupingBarSettings.showFilterIcon&&r.showFilterIcon?(0,t.removeClass)([p],l):(0,t.addClass)([p],l):r.showFilterIcon&&((this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==a||this.parent.dataSourceSettings.allowMemberFilter)?(0,t.removeClass)([p],l):(0,t.addClass)([p],l),e.appendChild(p),p},e.prototype.updateButtontext=function(e){var t,i,a=(t="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList[e].filter.length,r=t.fieldList[e].filterType,n=t.fieldList[e].dateMember.length,s=t.fieldList[e].filter[0];if("olap"===this.parent.dataType)i=this.updateOlapButtonText(t,e,s,a);else if("include"===r)1===a?i=s:a>1&&(i=a===n?this.parent.localeObj.getConstant("all"):this.parent.localeObj.getConstant("multipleItems"));else if("exclude"===r){if(1===a)i=2===n?s!==t.fieldList[e].dateMember[0].actualText?s:t.fieldList[e].dateMember[0].actualText:this.parent.localeObj.getConstant("multipleItems");else if(a>1){var o=void 0,l=Object.keys(t.fieldList[e].members),d=t.fieldList[e].filter;if(a===l.length-1)for(o=0;o<l.length;o++){var h=l[o];if(-1===d.indexOf(h)){i=l[o];break}}else i=this.parent.localeObj.getConstant("multipleItems")}}else i=this.parent.localeObj.getConstant("all");return i},e.prototype.updateOlapButtonText=function(e,t,i,a){var r,n=e.fieldList[t].actualFilter;if(n.length>0){var s=e.fieldList[t].members,o=[];if(e.fieldList[t].filterMembers.length>0){for(var l={},d=0,h=n;d<h.length;d++){l[c=h[d]]=c,s[c]&&(l=this.parent.pivotCommon.eventBase.getParentNode(t,c,l))}for(var p=0,u=l?Object.keys(l):[];p<u.length;p++){var c;s[c=u[p]].isSelected&&(s[c].parent&&s[s[c].parent].isSelected||o.push(c))}i=1===o.length?s[o[0]].caption:i}a=0===o.length?a:o.length}return 0===a?r=e.fieldList[t].allMember?e.fieldList[t].allMember:this.parent.localeObj.getConstant("all"):1===a?r=i:a>1&&(r=this.parent.localeObj.getConstant("multipleItems")),r},e.prototype.createDragClone=function(e){var i=(0,t.closest)(e.element,"."+A),a=(0,t.createElement)("div",{id:this.parent.element.id+"_DragClone",className:"e-button-drag-clone"+(this.parent.cssClass?" "+this.parent.cssClass:"")}),r=(0,t.createElement)("span",{className:ye});return r.innerText=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(i.textContent):i.textContent,a.appendChild(r),document.body.appendChild(a),a},e.prototype.onDragStart=function(e){var i=this,a=(0,t.closest)(e.element,"."+A),r=document.getElementById(this.parent.element.id+"_DragClone"),n=Di.getFieldInfo(a.getAttribute("data-uid"),this.parent),s={fieldName:n.fieldName,fieldItem:n.fieldItem,axis:n.axis,dataSourceSettings:Di.getClonedDataSourceSettings(this.parent.dataSourceSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(ar,s,(function(n){if(n.cancel)i.parent.isDragging=!1,i.draggable.intDestroy(e.event),(0,t.detach)(r);else{i.parent.isDragging=!0;var s=("olap"===i.parent.dataType?i.parent.olapEngineModule:i.parent.engineModule).fieldList[a.getAttribute("data-uid")],o=[se,oe,de];if((0,t.addClass)([a],ve),r&&"Popup"===("pivotfieldlist"===i.parent.getModuleName()&&i.parent.renderMode)){var l=i.parent;r.style.zIndex=(l.dialogRenderer.fieldListDialog.zIndex+1).toString()}if(s&&"CalculatedField"===s.aggregateType)for(var d=0,h=o;d<h.length;d++){var p=h[d];(0,t.addClass)([i.parentElement.querySelector("."+p)],fe),i.parentElement.querySelector("."+p).querySelectorAll(".e-pivot-button").forEach((function(e){e.style.cursor="no-drop"}))}}}))},e.prototype.onDragging=function(e){this.draggable.setProperties({cursorAt:{top:!(0,t.isNullOrUndefined)(e.event.targetTouches)||t.Browser.isDevice?60:-20}})},e.prototype.onDragStop=function(e){this.parent.isDragging=!1,e.target&&e.element&&(0,t.closest)(e.element,"."+pe)&&!(0,t.closest)(e.target,"."+ne)&&(e.cancel=!0);var i=(0,t.closest)(e.element,"."+A);(0,t.removeClass)([].slice.call(this.parentElement.querySelectorAll("."+A)),ve),(0,t.removeClass)([].slice.call(this.parentElement.querySelectorAll("."+W)),Q);for(var a=0,r=[se,oe,de];a<r.length;a++){var n=r[a];(0,t.removeClass)([this.parentElement.querySelector("."+n)],fe),this.parentElement.querySelector("."+n).querySelectorAll(".e-pivot-button").forEach((function(e){e.style.cursor="default"}))}if(this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close(),document.getElementById(this.parent.element.id+"_DragClone")&&(0,t.remove)(document.getElementById(this.parent.element.id+"_DragClone")),document.body.style.cursor="auto",this.isButtonDropped(e.target,i)&&!e.cancel&&(this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(e,i.getAttribute("data-uid")))){this.updateDataSource();this.parent.axisFieldModule.render()}},e.prototype.isButtonDropped=function(e,i){var a=(0,t.closest)(i,"."+ne),r=(0,t.closest)(e,"."+ne),n=!0;if(a&&a===r){for(var s=[].slice.call(a.querySelectorAll("."+A)),o=(0,t.closest)(e,"."+L),l=void 0,d=-1,h=0,p=s.length;h<p;h++)if(s[h].id===i.id&&(l=h),o){var u=o.querySelector("."+A);s[h].id===u.id&&(d=h)}(l===d||l===s.length-1&&-1===d)&&((0,t.removeClass)([].slice.call(this.parentElement.querySelectorAll("."+W)),Q),n=!1)}return n},e.prototype.updateSorting=function(e){var i=(0,t.closest)(e.target,"."+A),a=Di.getFieldInfo(i?i.getAttribute("data-uid"):"",this.parent);if(!e.target.classList.contains(H)&&!e.target.classList.contains(B)&&!e.target.classList.contains(G)&&i&&a.fieldItem&&(a.fieldItem.showSortIcon||(0,t.isNullOrUndefined)(a.fieldItem.showSortIcon))&&!a.fieldItem.isCalculatedField){if(this.parent.actionObj.actionName=dn,this.parent.actionObj.fieldInfo=a,this.parent.actionBeginMethod())return;try{if((this.parent instanceof Tl||this.parent.groupingBarSettings.showSortIcon)&&this.parent.dataSourceSettings.enableSorting&&("olap"!==this.parent.dataType||!("pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableVirtualization||"pivotview"===this.parent.getModuleName()&&this.parent.enableVirtualization))){if(this.parent.pivotCommon.eventBase.updateSorting(e),this.parent.staticPivotGridModule&&(this.parent.staticPivotGridModule.actionObj=this.parent.actionObj),!1===this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&!1===this.parent.pivotGridModule.pivotDeferLayoutUpdate||"pivotfieldlist"!==this.parent.getModuleName()){var r={sortInfo:this.parent.lastSortInfo};this.parent.actionObj.actionInfo=r,this.updateDataSource(!0)}this.parent instanceof Tl&&(this.axisField.render(),this.parent.isPopupView&&this.parent.pivotGridModule?this.parent.pivotGridModule.notify(pr,this):this.parent.staticPivotGridModule&&this.parent.staticPivotGridModule.notify(pr,this))}}catch(e){this.parent.actionFailureMethod(e)}}},e.prototype.updateDataSource=function(e){!1===this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&!1===this.parent.pivotGridModule.pivotDeferLayoutUpdate||"pivotview"===this.parent.getModuleName()?this.parent.updateDataSource(e):"pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView&&this.parent.pivotGridModule?("olap"===this.parent.dataType?this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule:this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.notify(pr,this),this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0)):this.parent.triggerPopulateEvent()},e.prototype.updateFiltering=function(e){var t=this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,i=e.target.parentElement.getAttribute("data-uid"),a=Di.getFieldInfo(i,this.parent);if(this.parent.actionObj.actionName=hn,this.parent.actionObj.fieldInfo=a,!this.parent.actionBeginMethod())try{"pivotfieldlist"===t.getModuleName()?(0,Ni.showSpinner)(t.fieldListSpinnerElement):t.showWaitingPopup(),t.mouseEventArgs=e,t.filterTargetID="pivotfieldlist"!==this.parent.pivotCommon.moduleName?this.parent.element:document.getElementById(this.parent.pivotCommon.parentID+"_Container"),"Server"===t.dataSourceSettings.mode?this.parent.engineModule.fieldList[i].members&&Object.keys(this.parent.engineModule.fieldList[i].members).length>0?this.updateFilterEvents():this.parent.getEngine("fetchFieldMembers",null,null,null,null,null,i):("pivot"!==t.dataType||this.parent.engineModule.fieldList[i].isMembersFilled||this.parent.engineModule.fetchFieldMembers(i),this.updateFilterEvents())}catch(e){this.parent.actionFailureMethod(e)}},e.prototype.updateFilterEvents=function(){var e=this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent;this.parent.pivotCommon.eventBase.updateFiltering(e.mouseEventArgs);var t=e.mouseEventArgs.target;this.fieldName=t.parentElement.getAttribute("data-uid"),this.parent.pivotCommon.filterDialog.dialogPopUp&&this.bindDialogEvents(),"pivotfieldlist"===e.getModuleName()?(0,Ni.hideSpinner)(e.fieldListSpinnerElement):e.hideWaitingPopup()},e.prototype.bindDialogEvents=function(){this.parent.pivotCommon.filterDialog.allowExcelLikeFilter&&this.parent.pivotCommon.filterDialog.tabObj?(this.index=this.parent.pivotCommon.filterDialog.tabObj.selectedItem,this.updateDialogButtonEvents(),this.parent.pivotCommon.filterDialog.dialogPopUp.buttons=this.buttonModel(),this.parent.pivotCommon.filterDialog.dialogPopUp.dataBind(),this.parent.pivotCommon.filterDialog.tabObj.selected=this.tabSelect.bind(this)):this.parent.dataSourceSettings.allowMemberFilter&&(this.index=0,this.updateDialogButtonEvents())},e.prototype.buttonModel=function(){return[{isFlat:!1,buttonModel:{cssClass:"e-clear-filter-button"+(this.parent.pivotCommon.filterDialog.allowExcelLikeFilter?"":" "+l)+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.parent.pivotCommon.filterDialog.filterObject},click:this.ClearFilter.bind(this)},{isFlat:!1,buttonModel:{cssClass:ie+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("ok"),isPrimary:!0},click:0===this.index?this.updateFilterState.bind(this,this.fieldName):this.updateCustomFilter.bind(this)},{isFlat:!1,click:this.parent.pivotCommon.filterDialog.closeFilterDialog.bind(this.parent.pivotCommon.filterDialog),buttonModel:{cssClass:ae+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}]},e.prototype.tabSelect=function(e){this.index=e.selectedIndex,this.updateDialogButtonEvents(),(0,t.removeClass)([].slice.call(this.parent.pivotCommon.filterDialog.dialogPopUp.element.querySelectorAll(".e-selected-tab")),"e-selected-tab"),e.selectedIndex>0&&(0,t.addClass)([this.parent.pivotCommon.filterDialog.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===e.selectedIndex&&this.parent.dataSourceSettings.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab"),0===e.selectedIndex?this.parent.pivotCommon.filterDialog.updateCheckedState():(this.parent.pivotCommon.filterDialog.dialogPopUp.buttons[0].buttonModel.disabled=!1,this.parent.pivotCommon.filterDialog.dialogPopUp.element.querySelector("."+ie).removeAttribute("disabled"))},e.prototype.updateDialogButtonEvents=function(){this.parent.pivotCommon.filterDialog.dialogPopUp.buttons=this.buttonModel(),this.parent.pivotCommon.filterDialog.dialogPopUp.dataBind()},e.prototype.updateCustomFilter=function(){var e,i=this,a=this.parent.pivotCommon.filterDialog.dialogPopUp.element.querySelector(".e-selected-tab"),r=a.getAttribute("data-fieldname"),n=a.getAttribute("data-selectedField"),s=a.getAttribute("data-type"),o=a.getAttribute("data-measure"),l=a.getAttribute("data-operator"),d=a.getAttribute("data-value1"),h=a.getAttribute("data-value2"),p="value"===s?"Value":"date"===s?"Date":"number"===s?"Number":"Label",u={name:r,type:p,measure:o,condition:l,value1:"date"===s?new Date(d):d,value2:"date"===s?new Date(h):h};if("olap"===this.parent.dataType){u.selectedField=n,this.removeDataSourceSettings(r,n,p);for(var c=0,g=this.parent.dataSourceSettings.filterSettings;c<g.length;c++){var m=g[c];m.name===r&&m.selectedField===n&&(e=m)}}else e=Di.getFilterItemByName(r,this.parent.dataSourceSettings.filterSettings);if((0,t.isNullOrUndefined)(d)||""===d||["Between","NotBetween"].indexOf(l)>-1&&((0,t.isNullOrUndefined)(h)||""===h)){var f=p.toLowerCase()+((0,t.isNullOrUndefined)(d)||""===d?"_input_option_1":"_input_option_2"),v=(0,t.select)("#"+this.parent.element.id+"_"+f,a);return(0,t.addClass)([v],wt),void v.focus()}var S={cancel:!1,filterSettings:u,dataSourceSettings:Di.getClonedDataSourceSettings(this.parent.dataSourceSettings)};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(Ja,S,(function(t){t.cancel||(u=t.filterSettings,e?((e=e.properties?e.properties:e).type=u.type,e.measure=u.measure,e.condition=u.condition,e.value1=u.value1,e.value2=u.value2,"olap"===i.parent.dataType&&(e.selectedField=u.selectedField)):i.parent.dataSourceSettings.filterSettings.push(u)),"Value"!==p&&(i.parent.lastFilterInfo=Di.getFilterItemByName(r,i.parent.dataSourceSettings.filterSettings),i.parent.lastFilterInfo=i.parent.lastFilterInfo.properties?i.parent.lastFilterInfo.properties:i.parent.lastFilterInfo),i.parent.pivotCommon.filterDialog.dialogPopUp.close(),t.cancel||(i.refreshPivotButtonState(r,!0),i.updateDataSource(!0))}))},e.prototype.ClearFilter=function(){var e=this.parent.pivotCommon.filterDialog.dialogPopUp.element,t=e.getAttribute("data-fieldname"),i=e.querySelector(".e-selected-tab");if(this.parent.pivotCommon.filterDialog.dialogPopUp.close(),"olap"===this.parent.dataType&&i){var a=i.getAttribute("data-selectedField");this.removeDataSourceSettings(t,a)}else this.removeDataSourceSettings(t);var r=Di.getFilterItemByName(t,this.parent.dataSourceSettings.filterSettings);this.refreshPivotButtonState(t,!!r),this.updateDataSource(!0)},e.prototype.removeButton=function(e){var t=this,i=e.target,a=i.parentElement.getAttribute("data-uid"),r=Di.getFieldInfo(a,this.parent);if(this.parent.actionObj.actionName=pn,this.parent.actionObj.fieldInfo=r,!this.parent.actionBeginMethod()){var n={cancel:!1,fieldName:a,dataSourceSettings:Di.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:r.fieldItem,axis:r.axis};try{("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(er,n,(function(e){e.cancel||("true"===i.parentElement.getAttribute("isvalue")?(t.parent.setProperties({dataSourceSettings:{values:[]}},!0),"olap"===t.parent.dataType&&t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[Measures]")):(t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(a),"pivot"===t.parent.dataType&&t.parent.showValuesButton&&t.parent.dataSourceSettings.values.length>1&&r.position<t.parent.dataSourceSettings.valueIndex&&("row"===t.parent.dataSourceSettings.valueAxis&&"rows"===e.axis||"column"===t.parent.dataSourceSettings.valueAxis&&"columns"===e.axis)&&t.parent.setProperties({dataSourceSettings:{valueIndex:t.parent.dataSourceSettings.valueIndex-1}},!0),"olap"===t.parent.dataType&&0===t.parent.dataSourceSettings.values.length&&t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[Measures]")),"pivotfieldlist"===t.parent.getModuleName()&&t.parent.axisFieldModule.render(),t.updateDataSource())}))}catch(e){this.parent.actionFailureMethod(e)}}},e.prototype.nodeStateModified=function(e){var i=(0,t.closest)(e.node,"li"),a=i.getAttribute("data-fieldname");if("all"===i.getAttribute("data-memberId"))this.parent.pivotCommon.filterDialog.memberTreeView.nodeChecked=null,"check"===e.action?this.parent.pivotCommon.filterDialog.memberTreeView.checkAll():this.parent.pivotCommon.filterDialog.memberTreeView.uncheckAll(),"olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.fieldList[a].isHierarchy&&this.updateNodeStates(this.parent.pivotCommon.filterDialog.memberTreeView.getAllCheckedNodes(),a),this.checkedStateAll(e.action),this.parent.pivotCommon.filterDialog.memberTreeView.nodeChecked=this.nodeStateModified.bind(this);else{if("olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.fieldList[a].isHierarchy){var r=this.parent.pivotCommon.filterDialog.memberTreeView.getAllCheckedNodes();this.updateNodeStates(r,a)}var n=this.parent.pivotCommon.currentTreeItemsPos[i.getAttribute("data-memberId")].index;this.parent.pivotCommon.currentTreeItems[n]&&(this.parent.pivotCommon.currentTreeItems[n].isSelected="check"===e.action,this.parent.pivotCommon.currentTreeItemsPos[i.getAttribute("data-memberId")].isSelected="check"===e.action)}this.parent.pivotCommon.filterDialog.updateCheckedState()},e.prototype.checkedStateAll=function(e){for(var t={},i=0,a=this.parent.pivotCommon.searchTreeItems;i<a.length;i++){(s=a[i]).isSelected="check"===e,t[s.htmlAttributes["data-memberId"]]=s.htmlAttributes["data-memberId"]}for(var r=0,n=this.parent.pivotCommon.currentTreeItems;r<n.length;r++){var s;void 0!==t[(s=n[r]).htmlAttributes["data-memberId"]]&&(s.isSelected="check"===e,this.parent.pivotCommon.currentTreeItemsPos[s.htmlAttributes["data-memberId"]].isSelected="check"===e)}},e.prototype.updateNodeStates=function(e,t){var i=this.parent.pivotCommon.engineModule.fieldList[t],a=i.members,r=i.currrentMembers;if(i.searchMembers.length>0){for(var n=0,s=Object.keys(r);n<s.length;n++){if(r[u=s[n]]&&(r[u].isSelected=!1),a[u])if(a[u].isSelected=!1,this.parent.pivotCommon.filterDialog.memberTreeView.element.querySelector('li[data-memberId="'+u+'"]'))(d=this.parent.pivotCommon.filterDialog.memberTreeView.element.querySelector('li[data-memberId="'+u+'"]'))&&!d.querySelector("ul")&&this.parent.pivotCommon.eventBase.updateChildNodeStates(i.filterMembers,t,u,!1)}for(var o=0,l=e;o<l.length;o++){var d;if(a[m=l[o]])if(this.parent.pivotCommon.filterDialog.memberTreeView.element.querySelector('li[data-memberId="'+m+'"]'))(d=this.parent.pivotCommon.filterDialog.memberTreeView.element.querySelector('li[data-memberId="'+m+'"]'))&&!d.querySelector("ul")&&(a[m].isSelected=!0,this.parent.pivotCommon.eventBase.updateChildNodeStates(i.filterMembers,t,m,!0));r[m]&&(r[m].isSelected=!0)}}else{for(var h=0,p=Object.keys(a);h<p.length;h++){var u;a[u=p[h]].isSelected&&(a[u].isSelected=!1)}for(var c=0,g=e;c<g.length;c++){var m;a[m=g[c]]&&(a[m].isSelected=!0,this.parent.pivotCommon.eventBase.updateChildNodeStates(i.filterMembers,t,m,!0))}}},e.prototype.updateFilterState=function(e){var t=this,i=!1,a={items:[],name:e,type:"Include"},r="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;if("olap"===this.parent.dataType&&r&&!r.fieldList[e].isHierarchy){var n=r.fieldList[e].members,s=r.fieldList[e].currrentMembers;if(a.items=this.parent.pivotCommon.filterDialog.memberTreeView.getAllCheckedNodes(),a.levelCount=r.fieldList[e].levelCount,i=a.items.length!==this.parent.pivotCommon.filterDialog.memberTreeView.fields.dataSource.length,r.fieldList[e].searchMembers.length>0&&!i){var o=Object.keys(n).length,l=Object.keys(s).length;i=o!==l||o!==a.items.length}for(var d=0,h=a.items;d<h.length;d++){var p=h[d];r.fieldList[e].searchMembers.length>0&&s[p]?s[p].isSelected=!0:n[p]&&(n[p].isSelected=!0)}}else{for(var u=0,c=this.parent.pivotCommon.searchTreeItems;u<c.length;u++){var g=c[u];g.isSelected&&(this.parent.pivotCommon.isDateField?a.items.push("Server"===this.parent.dataSourceSettings.mode?g.actualText:g.name):a.items.push(g.htmlAttributes["data-memberId"]))}i=a.items.length!==this.parent.pivotCommon.currentTreeItems.length}if("olap"===this.parent.dataType&&this.removeDataSourceSettings(e),this.parent.allowDeferLayoutUpdate){r.fieldList[a.name].filterType=a.type.toLowerCase(),r.fieldList[a.name].filter=[];for(var m=0;m<a.items.length;m++)r.fieldList[a.name].filter.push(a.items[m])}var f={filterSettings:a,dataSourceSettings:Di.getClonedDataSourceSettings(this.parent.dataSourceSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(Ja,f,(function(r){if(a=r.filterSettings,!r.cancel){if(Di.getFilterItemByName(e,t.parent.dataSourceSettings.filterSettings))for(var n=0;n<t.parent.dataSourceSettings.filterSettings.length;n++)if(t.parent.dataSourceSettings.filterSettings[n].name===e){t.parent.dataSourceSettings.filterSettings.splice(n,1);break}t.parent.dataSourceSettings.filterSettings.push(a)}if(t.parent.pivotCommon.filterDialog.dialogPopUp.close(),!r.cancel){t.refreshPivotButtonState(e,i),i||(t.removeDataSourceSettings(e),a={}),t.parent.lastFilterInfo=a;var s={filterInfo:t.parent.lastFilterInfo};t.parent.actionObj.actionInfo=s,t.updateDataSource(!0);var o=t;o.parent instanceof Tl&&o.axisField.render()}for(var l=0,d=[].slice.call(t.parentElement.querySelectorAll(".e-pivot-button"));l<d.length;l++){var h=d[l];if(h.getAttribute("data-uid")===e){h.focus();break}}}))},e.prototype.refreshPivotButtonState=function(e,i){for(var a,r=0,n=[].slice.call(this.parentElement.querySelectorAll(".e-pivot-button"));r<n.length;r++){var s=n[r];if(s.getAttribute("data-uid")===e){a=s.querySelector("."+H);break}}a&&(i?((0,t.removeClass)([a],U),(0,t.addClass)([a],_)):((0,t.removeClass)([a],_),(0,t.addClass)([a],U)))},e.prototype.removeDataSourceSettings=function(e,t,i){for(var a=this.parent.dataSourceSettings.filterSettings,r=0,n=a.length;r<n;r++)if("olap"===this.parent.dataType&&t){if(!i&&a[r].name===e&&a[r].selectedField===t){a.splice(r,1);break}i&&a[r].type!==i&&a[r].name===e&&(a.splice(r,1),n--,r--)}else if(a[r].name===e){if(a.splice(r,1),"olap"!==this.parent.dataType)break;n--,r--}},e.prototype.updateDropIndicator=function(e){if(this.parent.isDragging&&((0,t.removeClass)([].slice.call(this.parentElement.querySelectorAll("."+W+"-last")),Q),(0,t.removeClass)([].slice.call(this.parentElement.querySelectorAll("."+W)),Q),(0,t.closest)(e.target,"."+ne))){var i=(0,t.closest)(e.target,"."+L);(0,t.addClass)([i.querySelector("."+W)],Q)}},e.prototype.wireEvent=function(e,i,a){t.EventHandler.add(e,"mouseover",this.updateDropIndicator,this),a||(-1===["filters","values"].indexOf(i)&&null!==e.querySelector("."+A)&&t.EventHandler.add(e.querySelector("."+A),"click",this.updateSorting,this),"values"!==i&&null!==e.querySelector("."+H)&&t.EventHandler.add(e.querySelector("."+H),"click",this.updateFiltering,this),"values"===i&&null!==e.querySelector("."+g)&&t.EventHandler.add(e.querySelector("."+g),"click",this.createMenuOption,this)),null!==e.querySelector("."+bt)&&t.EventHandler.add(e.querySelector("."+bt),"click",this.openCalculatedFieldDialog,this),null!==e.querySelector("."+B)&&t.EventHandler.add(e.querySelector("."+B),"click",this.removeButton,this)},e.prototype.unWireEvent=function(e,i,a){t.EventHandler.remove(e,"mouseover",this.updateDropIndicator),a||(-1===["filters","values"].indexOf(i)&&null!==e.querySelector("."+A)&&t.EventHandler.remove(e.querySelector("."+A),"click",this.updateSorting),"values"!==i&&null!==e.querySelector("."+H)&&t.EventHandler.remove(e.querySelector("."+H),"click",this.updateFiltering),"values"===i&&null!==e.querySelector("."+g)&&t.EventHandler.remove(e.querySelector("."+g),"click",this.createMenuOption)),null!==e.querySelector("."+bt)&&t.EventHandler.remove(e.querySelector("."+bt),"click",this.openCalculatedFieldDialog),null!==e.querySelector("."+B)&&t.EventHandler.remove(e.querySelector("."+B),"click",this.removeButton)},e.prototype.addEventListener=function(){this.handlers={load:this.renderPivotButton},this.parent.isDestroyed||this.parent.on(yr,this.handlers.load,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(yr,this.handlers.load)},e.prototype.destroy=function(){this.menuOption&&(this.menuOption.destroy(),this.menuOption=null);var e=(0,t.select)("."+ri,this.parentElement),i=e?(0,t.getInstance)(e,vs.DropDownList):null;i&&!i.isDestroyed&&i.destroy();var a=(e=(0,t.select)("."+ni,this.parentElement))?(0,t.getInstance)(e,vs.DropDownList):null;a&&!a.isDestroyed&&(a.destroy(),a=null),this.draggable&&!this.draggable.isDestroyed&&(this.draggable.destroy(),this.draggable=null),this.axisField&&(this.axisField=null),this.removeEventListener(),this.isDestroyed=!0},e}(),bl=function(){function e(e){this.parent=e}return e.prototype.render=function(){(!this.parent.pivotButtonModule||this.parent.pivotButtonModule&&this.parent.pivotButtonModule.isDestroyed)&&new yl(this.parent),this.createPivotButtons()},e.prototype.createPivotButtons=function(){var e=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],t=this.parent.dialogRenderer.parentElement;if(t.querySelector("."+C+"-filters")&&(t.querySelector("."+C+"-filters").querySelector("."+I).innerHTML=""),t.querySelector("."+C+"-rows")&&(t.querySelector("."+C+"-rows").querySelector("."+I).innerHTML=""),t.querySelector("."+C+"-columns")&&(t.querySelector("."+C+"-columns").querySelector("."+I).innerHTML=""),t.querySelector("."+C+"-values")&&(t.querySelector("."+C+"-values").querySelector("."+I).innerHTML=""),"pivot"===this.parent.dataType&&this.parent.dataSourceSettings.dataSource&&(!(this.parent.dataSourceSettings.dataSource instanceof i.DataManager)&&this.parent.dataSourceSettings.dataSource.length>0||this.parent.dataSourceSettings.dataSource instanceof i.DataManager&&this.parent.engineModule.data&&this.parent.engineModule.data.length>0)||"olap"===this.parent.dataType&&this.parent.dataSourceSettings.url&&""!==this.parent.dataSourceSettings.url||"Server"===this.parent.dataSourceSettings.mode&&""!==this.parent.dataSourceSettings.url)for(var a=["rows","columns","values","filters"],r=0,n=e.length;r<n;r++)if(e[r]){var s={field:e[r],axis:a[r].toString()};this.parent.notify(yr,s)}},e}(),Cl=function(){function e(e){this.parent=e,this.parent.dialogRenderer=new fl(this.parent),this.parent.treeViewModule=new vl(this.parent),this.parent.axisTableModule=new Sl(this.parent),this.parent.axisFieldModule=new bl(this.parent)}return e.prototype.render=function(){this.parent.dialogRenderer.render(),this.parent.isAdaptive||this.parent.treeViewModule.render(),this.parent.axisTableModule.render()},e}(),xl=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),wl=function(e,t,i,a){var r,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(n<3?r(s):n>3?r(t,i,s):r(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s},Tl=function(e){function a(t,i){var a=e.call(this,t,i)||this;return a.pivotChange=!1,a.isRequiredUpdate=!0,a.lastSortInfo={},a.lastFilterInfo={},a.lastAggregationInfo={},a.lastCalcFieldInfo={},a.isPopupView=!1,a.enableValueSorting=!1,a.request="undefined"!=typeof window?new XMLHttpRequest:null,a.remoteData=[],a.actionObj={},a.destroyEngine=!1,a.defaultFieldListOrder="None",a.isDeferUpdateApplied=!1,a.isInitial=!0,a}return xl(a,e),a.prototype.requiredModules=function(){var e=[];return this.allowCalculatedField&&e.push({args:[this],member:"calculatedField"}),e},a.prototype.getAllSummaryType=function(){return["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"]},a.prototype.preRender=function(){this.dataSourceSettings&&"SSAS"===this.dataSourceSettings.providerType?(this.olapEngineModule=new Ko,this.dataType="olap"):(this.engineModule=new Pi,this.dataType="pivot"),this.isAdaptive=t.Browser.isDevice,this.globalize=new t.Internationalization(this.locale),this.renderModule=new Cl(this),this.defaultLocale={staticFieldList:"Pivot Field List",fieldList:"Field List",dropFilterPrompt:"Drop filter here",dropColPrompt:"Drop column here",dropRowPrompt:"Drop row here",dropValPrompt:"Drop value here",addPrompt:"Add field here",adaptiveFieldHeader:"Choose field",centerHeader:"Drag fields between axes below:",add:"Add",drag:"Drag",filter:"Filter",filtered:"Filtered",sort:"Sort",remove:"Remove",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",CalculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",search:"Search",close:"Close",cancel:"Cancel",delete:"Delete",alert:"Alert",warning:"Warning",ok:"OK",allFields:"All Fields",formula:"Formula",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",clearCalculatedField:"Clear edited field info",editCalculatedField:"Edit calculated field",sortAscending:"Sort ascending order",sortDescending:"Sort descending order",sortNone:"Sort data order",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",enterValue:"Enter value",chooseDate:"Enter date",all:"All",multipleItems:"Multiple items",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",member:"Member",label:"Label",date:"Date",value:"Value",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Median:"Median",Min:"Min",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",MoreOption:"More...",Years:"Years",Quarters:"Quarters",Months:"Months",Days:"Days",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds",apply:"Apply",valueFieldSettings:"Value field settings",sourceName:"Field name :",sourceCaption:"Field caption",summarizeValuesBy:"Summarize values by",baseField:"Base field",baseItem:"Base item",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",deferLayoutUpdate:"Defer Layout Update",null:"null",undefined:"undefined",groupOutOfRange:"Out of Range",fieldDropErrorAction:"The field you are moving cannot be placed in that area of the report",memberType:"Field Type",selectedHierarchy:"Parent Hierarchy",formatString:"Format",expressionField:"Expression",olapDropText:"Example: [Measures].[Order Quantity] + ([Measures].[Order Quantity] * 0.10)",customFormat:"Enter custom format string",numberFormatString:"Example: C, P, 0000 %, ###0.##0#, etc.",Measure:"Measure",Dimension:"Dimension",Standard:"Standard",Currency:"Currency",Percent:"Percent",Custom:"Custom",blank:"(Blank)",fieldTooltip:'Drag and drop fields to create an expression. And, if you want to edit the existing calculated fields! You can achieve it by simply selecting the field under "Calculated Members".',fieldTitle:"Field Name",QuarterYear:"Quarter Year",caption:"Field Caption",copy:"Copy",of:"of",group:"Group",removeCalculatedField:"Are you sure you want to delete this calculated field?",yes:"Yes",no:"No",None:"None",qtr:"Qtr",grandTotal:"Grand Total"},this.localeObj=new t.L10n(this.getModuleName(),this.defaultLocale,this.locale),this.isDragging=!1,this.isDeferLayoutUpdate=(0,t.isNullOrUndefined)(this.isDeferLayoutUpdate)&&!this.isPopupView?this.allowDeferLayoutUpdate:this.isDeferLayoutUpdate,this.wireEvent()},a.prototype.frameCustomProperties=function(e,t){this.pivotGridModule&&this.pivotGridModule.updatePageSettings(!1);var i=!!this.pivotGridModule&&this.pivotGridModule.isTabular,a=this.pivotGridModule?this.pivotGridModule.pageSettings:this.pageSettings,r=!!this.pivotGridModule&&this.pivotGridModule.enablePaging,n=!!this.pivotGridModule&&this.pivotGridModule.enableVirtualization,s=this.pivotGridModule?this.pivotGridModule.enableHtmlSanitizer:this.enableHtmlSanitizer,o=this.pivotGridModule?this.pivotGridModule.localeObj:this.staticPivotGridModule?this.staticPivotGridModule.localeObj:this.localeObj,l=!this.pivotGridModule||(this.pivotGridModule.allowDrillThrough||this.pivotGridModule.editSettings.allowEditing),d=this.pivotGridModule?this.pivotGridModule.enableValueSorting:void 0,h=!(!this.pivotGridModule||!this.pivotGridModule.allowDataCompression)&&this.pivotGridModule.allowDataCompression,p=this.pivotGridModule&&this.pivotGridModule.enableVirtualization&&this.pivotGridModule.virtualScrollSettings&&this.pivotGridModule.virtualScrollSettings.allowSinglePage;return"olap"===this.dataType?{mode:"",savedFieldList:t||void 0,savedFieldListData:e||void 0,pageSettings:a,enableValueSorting:d,isDrillThrough:l,localeObj:o,enableVirtualization:n,allowDataCompression:h}:{mode:"",savedFieldList:void 0,pageSettings:a,enableValueSorting:d,isDrillThrough:l,localeObj:o,clonedReport:this.clonedReport,globalize:this.globalize,currenyCode:this.currencyCode,enablePaging:r,enableVirtualization:n,enableHtmlSanitizer:s,allowDataCompression:h,enableOptimizedRendering:p,isTabularLayout:i}},a.prototype.render=function(){"pivot"===this.dataType&&this.dataSourceSettings.url&&""!==this.dataSourceSettings.url?"Server"===this.dataSourceSettings.mode?(this.guid=Di.generateUUID(),this.initialLoad()):new t.Fetch(this.dataSourceSettings.url,"GET").send().then((function(e){return"string"==typeof e?e:e.text()})).then(this.onReadyStateChange.bind(this)):this.initialLoad()},a.prototype.getEngine=function(e,t,i,a,r,n,s,o,l){var d=this;this.currentAction=e,this.pivotGridModule&&this.pivotGridModule.updatePageSettings(!1);var h={pageSettings:this.pivotGridModule?JSON.parse(this.pivotGridModule.getPageSettings()).pageSettings:void 0,enableValueSorting:this.pivotGridModule?this.pivotGridModule.enableValueSorting:void 0,enableDrillThrough:!this.pivotGridModule||(this.pivotGridModule.allowDrillThrough||this.pivotGridModule.editSettings.allowEditing),locale:JSON.stringify(Di.getLocalizedObject(this)),savedFieldList:"onDrop"===e&&null!==this.engineModule.fieldList?Di.getClonedFieldList(this.engineModule.fieldList,!0):void 0,enableOptimizedRendering:this.pivotGridModule&&this.pivotGridModule.enableVirtualization&&this.pivotGridModule.virtualScrollSettings&&this.pivotGridModule.virtualScrollSettings.allowSinglePage,requestType:"string",headers:{"Content-type":"application/json"},enablePaging:this.pivotGridModule&&this.pivotGridModule.enablePaging,enableVirtualization:this.pivotGridModule&&this.pivotGridModule.enableVirtualization,allowDataCompression:this.pivotGridModule&&this.pivotGridModule.allowDataCompression};this.request.readyState!==XMLHttpRequest.UNSENT&&this.request.readyState!==XMLHttpRequest.OPENED||(this.request.withCredentials=!1);var p={request:this.request,dataSourceSettings:JSON.parse(this.getPersistData()).dataSourceSettings,action:e,customProperties:{},internalProperties:h,drillItem:t,sortItem:i,aggregatedItem:a,calculatedItem:r,filterItem:n,memberName:s,fetchRawDataArgs:o,editArgs:l,hash:this.pivotGridModule?this.pivotGridModule.guid:this.staticPivotGridModule?this.staticPivotGridModule.guid:this.guid,isGroupingUpdated:"onRefresh"===this.currentAction&&this.dataSourceSettings.groupSettings.length>0||!(!this.pivotGridModule||!this.pivotGridModule.groupingModule)&&this.pivotGridModule.groupingModule.isUpdate};this.trigger(nr,p,(function(e){d.request=e.request,p.internalProperties=e.internalProperties,p.customProperties=e.customProperties,p.dataSourceSettings=e.dataSourceSettings,p.calculatedItem=e.calculatedItem,p.drillItem=e.drillItem,p.editArgs=e.editArgs,p.fetchRawDataArgs=e.fetchRawDataArgs,p.filterItem=e.filterItem,p.hash=e.hash,p.memberName=e.memberName,p.sortItem=e.sortItem})),this.request.open("POST",this.dataSourceSettings.url,!0),this.request.onreadystatechange=this.onSuccess.bind(this);for(var u=Object.keys(p.internalProperties.headers),c=0;c<u.length;c++){var g=u[c],m=String(p.internalProperties.headers[g]);this.request.setRequestHeader(g,m)}"string"===p.internalProperties.requestType?this.request.send(JSON.stringify(p)):"base64"===p.internalProperties.requestType&&this.request.send(btoa(JSON.stringify(p)))},a.prototype.onSuccess=function(){if(this.request.readyState===XMLHttpRequest.DONE){try{var e={action:this.currentAction,response:this.request.responseText};this.trigger(sr,e);var i=JSON.parse(this.request.responseText);if("fetchFieldMembers"===this.currentAction){var a=JSON.parse(i.members),r=[],n={};this.engineModule.globalize=(0,t.isNullOrUndefined)(this.globalize)?new t.Internationalization:this.globalize,this.engineModule.formatFields=this.engineModule.setFormattedFields(this.dataSourceSettings.formatSettings);for(var s=Di.isDateField(i.memberName,this.engineModule),o="number"===this.engineModule.fieldList[i.memberName].type,l=Object.keys(a),d=0,h=l.length;d<h;d++){var p=a[l[d]],u=s?this.engineModule.getFormattedValue(p.Name,i.memberName):{formattedText:p.Caption};n[l[d]]={index:p.Index,ordinal:p.Ordinal,isDrilled:p.IsDrilled,caption:u.formattedText},r.push({formattedText:u.formattedText,actualText:s?u.actualText:o?isNaN(Number(p.Name))?p.Name:Number(p.Name):p.Name})}this.engineModule.fieldList[i.memberName].members=n,this.engineModule.fieldList[i.memberName].dateMember=r,this.pivotButtonModule.updateFilterEvents()}else{var c=JSON.parse(i.fieldList);if(this.engineModule.fieldList)for(l=Object.keys(this.engineModule.fieldList),d=0;d<l.length;d++)this.engineModule.fieldList[l[d]]&&c[l[d]]&&(c[l[d]].dateMember=this.engineModule.fieldList[l[d]].dateMember,c[l[d]].formattedMembers=this.engineModule.fieldList[l[d]].formattedMembers,c[l[d]].members=this.engineModule.fieldList[l[d]].members);this.engineModule.fieldList=c,this.engineModule.fields=JSON.parse(i.fields),this.engineModule.rowCount=JSON.parse(i.pivotCount).RowCount,this.engineModule.columnCount=JSON.parse(i.pivotCount).ColumnCount,this.engineModule.rowStartPos=JSON.parse(i.pivotCount).RowStartPosition,this.engineModule.colStartPos=JSON.parse(i.pivotCount).ColumnStartPosition,this.engineModule.rowFirstLvl=JSON.parse(i.pivotCount).RowFirstLevel,this.engineModule.colFirstLvl=JSON.parse(i.pivotCount).ColumnFirstLevel,this.pivotGridModule&&this.pivotGridModule.enablePaging&&(this.engineModule.rowPageCount=JSON.parse(i.pivotCount).RowPageCount,this.engineModule.columnPageCount=JSON.parse(i.pivotCount).ColumnPageCount);for(var g=void 0,m=JSON.parse(i.pivotValue),f=0;f<m.length;f++)if(m[f]&&m[f][0]&&"row"===m[f][0].axis){g=f;break}this.engineModule.headerContent=Di.frameContent(m,"header",g,this),this.engineModule.pageSettings=this.pivotGridModule?this.pivotGridModule.pageSettings:void 0;var v=JSON.parse(i.dataSourceSettings).valueSortSettings;this.engineModule.valueSortSettings={headerText:v.headerText,headerDelimiter:v.headerDelimiter,sortOrder:v.sortOrder,columnIndex:v.columnIndex},this.engineModule.pivotValues=m,this.engineModule.isEmptyData=0===this.dataSourceSettings.values.length}}catch(e){this.engineModule.pivotValues=[]}"fetchFieldMembers"!==this.currentAction&&(this.isInitial&&!this.isPopupView?(this.initEngine(),this.isInitial=!1):this.enginePopulatedEventMethod(this,!0,!1),this.calculatedFieldModule&&"onCalcOperation"===this.currentAction&&(this.calculatedFieldModule.endDialog(),this.calculatedFieldModule.isRequireUpdate&&(this.calculatedFieldModule.isRequireUpdate=!1)),this.pivotGridModule&&this.pivotGridModule.calculatedFieldModule&&this.pivotGridModule.calculatedFieldModule.isRequireUpdate&&(this.pivotGridModule.calculatedFieldModule.endDialog(),this.pivotGridModule.calculatedFieldModule.isRequireUpdate=!1))}},a.prototype.onReadyStateChange=function(e){var i=[];if("CSV"===this.dataSourceSettings.type)for(var a=e.split(/\r?\n|\r/),r=0;r<a.length;r++)(0,t.isNullOrUndefined)(a[r])||""===a[r]||i.push(a[r].split(","));else try{i=JSON.parse(e)}catch(e){i=[]}i&&i.length>0&&this.setProperties({dataSourceSettings:{dataSource:i}},!0),this.initialLoad()},a.prototype.initialLoad=function(){var e=this,i={dataSourceSettings:this.dataSourceSettings,defaultFieldListOrder:this.defaultFieldListOrder};this.trigger(Ei,i,(function(a){e.dataSourceSettings=a.dataSourceSettings,e.defaultFieldListOrder=i.defaultFieldListOrder,(0,t.addClass)([e.element],r),e.enableRtl?(0,t.addClass)([e.element],n):(0,t.removeClass)([e.element],n),e.isAdaptive?(0,t.addClass)([e.element],s):(0,t.removeClass)([e.element],s),e.cssClass&&(0,t.addClass)([e.element],e.cssClass.split(" ")),e.notify(hr,{})}))},a.prototype.wireEvent=function(){this.on(hr,this.generateData,this),this.on(fr,this.fieldListRender,this)},a.prototype.unWireEvent=function(){this.pivotGridModule&&this.pivotGridModule.isDestroyed||(this.off(hr,this.generateData),this.off(fr,this.fieldListRender))},a.prototype.getPersistData=function(){return this.addOnPersist(["dataSourceSettings"])},a.prototype.getModuleName=function(){return"pivotfieldlist"},a.prototype.onPropertyChanged=function(i,a){for(var r=!1,s=0,o=Object.keys(i);s<o.length;s++){var l=o[s];switch(l){case"locale":e.prototype.refresh.call(this);break;case"dataSourceSettings":if(i.dataSourceSettings&&(!(0,t.isNullOrUndefined)(i.dataSourceSettings.dataSource)&&this.clonedDataSet!==i.dataSourceSettings.dataSource&&i.dataSourceSettings.groupSettings||1===Object.keys(i.dataSourceSettings).length&&"dataSource"===Object.keys(i.dataSourceSettings)[0]&&this.dataSourceSettings.groupSettings.length>0)&&(this.clonedDataSet=i.dataSourceSettings.dataSource,this.engineModule.groupingFields={}),i.dataSourceSettings&&1===Object.keys(i.dataSourceSettings).length&&i.dataSourceSettings.groupSettings&&"pivot"===this.dataType){var d=this.isPopupView?this.pivotGridModule:this.staticPivotGridModule;d&&d.updateGroupingReport(i.dataSourceSettings.groupSettings,"Date")}if((0,t.isNullOrUndefined)(i.dataSourceSettings.dataSource)&&("olap"!==this.dataType||(0,t.isNullOrUndefined)(i.dataSourceSettings.url))||("olap"!==this.dataType&&((0,t.isNullOrUndefined)(this.savedDataSourceSettings)||(Di.updateDataSourceSettings(this.staticPivotGridModule,this.savedDataSourceSettings),this.savedDataSourceSettings=void 0),i.dataSourceSettings.dataSource&&0===i.dataSourceSettings.dataSource.length&&!(0,t.isNullOrUndefined)(this.staticPivotGridModule)&&(this.savedDataSourceSettings=Di.getClonedDataSourceSettings(this.staticPivotGridModule.dataSourceSettings),this.staticPivotGridModule.setProperties({dataSourceSettings:{rows:[],columns:[],values:[],filters:[]}},!0))),"pivot"===this.dataType?(this.engineModule.fieldList=null,this.engineModule.isEmptyData=!0,this.engineModule.data=[],this.engineModule.pivotValues=[],this.engineModule.groupingFieldsInfo={}):"olap"===this.dataType&&(this.olapEngineModule.fieldList={},this.olapEngineModule.fieldListData=void 0,this.olapEngineModule.isEmptyData=!0),(0,t.isNullOrUndefined)(this.staticPivotGridModule)||(this.staticPivotGridModule.pivotValues=[]),this.initialLoad()),Di.isButtonIconRefesh(l,a,i)){if(this.isPopupView&&this.pivotGridModule&&this.pivotGridModule.showGroupingBar&&this.pivotGridModule.groupingBarModule){var h=Di.cloneFieldSettings(this.dataSourceSettings.filters),p=Di.cloneFieldSettings(this.dataSourceSettings.values),u=Di.cloneFieldSettings(this.dataSourceSettings.rows),c=Di.cloneFieldSettings(this.dataSourceSettings.columns);this.pivotGridModule.setProperties({dataSourceSettings:{rows:u,columns:c,values:p,filters:h}},!0),this.pivotGridModule.axisFieldModule.render()}else if(!this.isPopupView&&this.staticPivotGridModule&&!this.staticPivotGridModule.isDestroyed){var g=this.staticPivotGridModule;if(g.showGroupingBar&&g.groupingBarModule&&g.axisFieldModule.render(),g.showFieldList&&g.pivotFieldListModule){u=Di.cloneFieldSettings(g.dataSourceSettings.rows),c=Di.cloneFieldSettings(g.dataSourceSettings.columns),p=Di.cloneFieldSettings(g.dataSourceSettings.values),h=Di.cloneFieldSettings(g.dataSourceSettings.filters);g.pivotFieldListModule.setProperties({dataSourceSettings:{rows:u,columns:c,values:p,filters:h}},!0),g.pivotFieldListModule.axisFieldModule.render(),g.pivotFieldListModule.treeViewModule.fieldTable&&!g.isAdaptive&&g.pivotFieldListModule.notify(Sr,{})}}this.axisFieldModule.render(),this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify(Sr,{})}else this.remoteData=[],"pivot"===this.dataType&&this.dataSourceSettings.url&&""!==this.dataSourceSettings.url&&("type"in i.dataSourceSettings||"url"in i.dataSourceSettings)&&(this.engineModule.fieldList=null,this.render());break;case"aggregateTypes":this.axisFieldModule&&this.axisFieldModule.render(),this.pivotGridModule&&this.pivotGridModule.axisFieldModule&&(this.pivotGridModule.setProperties({aggregateTypes:i.aggregateTypes},!0),this.pivotGridModule.axisFieldModule.render());break;case"showValuesButton":this.axisFieldModule&&this.axisFieldModule.render(),this.pivotGridModule&&this.pivotGridModule.showGroupingBar&&this.pivotGridModule.groupingBarModule&&this.pivotGridModule.axisFieldModule&&(this.pivotGridModule.setProperties({showValuesButton:i.showValuesButton},!0),this.pivotGridModule.axisFieldModule.render());break;case"enableRtl":this.enableRtl?(0,t.addClass)([this.element],n):(0,t.removeClass)([this.element],n),r=!0;break;case"enableFieldSearching":case"allowCalculatedField":this.refresh();break;case"allowDeferLayoutUpdate":this.isDeferLayoutUpdate=this.allowDeferLayoutUpdate,this.fieldListRender()}r&&this.fieldListRender()}},a.prototype.initEngine=function(){var e=this;if("pivot"===this.dataType){var i=(0,t.isNullOrUndefined)(this.dataSourceSettings.dataSource)?(0,t.isNullOrUndefined)(this.engineModule.data)?void 0:this.engineModule.data[0]:this.dataSourceSettings.dataSource[0];if(i&&this.pivotCommon){var a="[object Array]"===Object.prototype.toString.call(i);if(a&&"JSON"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidJSON"));if(!a&&"CSV"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidCSV"))}}var r={dataSourceSettings:Di.getClonedDataSourceSettings(this.dataSourceSettings)},n=this.isPopupView?this.pivotGridModule:this;n.trigger(Ii,r,(function(t){if(Di.updateDataSourceSettings(e,t.dataSourceSettings),"pivot"===e.dataType){if(e.dataSourceSettings.groupSettings&&e.dataSourceSettings.groupSettings.length>0){var i=e.engineModule.data;e.clonedDataSet=e.clonedDataSet?e.clonedDataSet:"CSV"===e.dataSourceSettings.type?Di.getClonedCSVData(i):Di.getClonedData(i);var a=JSON.parse(e.getPersistData()).dataSourceSettings;a.dataSource=[],e.clonedReport=e.clonedReport?e.clonedReport:a}var r=e.frameCustomProperties();r.enableValueSorting=e.staticPivotGridModule?e.staticPivotGridModule.enableValueSorting:e.enableValueSorting,"Server"!==e.dataSourceSettings.mode&&e.engineModule.renderEngine(e.dataSourceSettings,r,e.aggregateCellInfo?e.getValueCellInfo.bind(e):void 0,e.onHeadersSort?e.getHeaderSortInfo.bind(e):void 0),e.pivotFieldList=e.engineModule.fieldList;var s={pivotFieldList:e.pivotFieldList,pivotValues:e.engineModule.pivotValues},o=e;n.trigger(Fi,s,(function(e){o.pivotFieldList=e.pivotFieldList,o.engineModule.pivotValues=e.pivotValues,o.notify(fr,{}),o.trigger(Gi)}))}else if("olap"===e.dataType){Di.renderOlapEngine(e),e.pivotFieldList=e.olapEngineModule.fieldList;s={pivotFieldList:e.pivotFieldList,pivotValues:e.olapEngineModule.pivotValues};var l=e;n.trigger(Fi,s,(function(e){l.pivotFieldList=e.pivotFieldList,l.olapEngineModule.pivotValues=e.pivotValues,l.notify(fr,{}),l.trigger(Gi)}))}})),"None"!==this.defaultFieldListOrder&&this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify(Sr,{})},a.prototype.generateData=function(){this.pivotFieldList={},this.dataSourceSettings&&(this.dataSourceSettings.dataSource||this.dataSourceSettings.url)?""!==this.dataSourceSettings.url&&"olap"===this.dataType||!(0,t.isNullOrUndefined)(this.dataSourceSettings.dataSource)&&this.dataSourceSettings.dataSource.length>0?("pivot"===this.dataType&&(this.engineModule.data=this.dataSourceSettings.dataSource),this.initEngine()):this.dataSourceSettings.dataSource instanceof i.DataManager?"pivot"===this.dataType&&this.remoteData.length>0?(this.engineModule.data=this.remoteData,this.initEngine()):setTimeout(this.getData.bind(this),100):"Server"===this.dataSourceSettings.mode?this.getEngine("onRefresh"):this.notify(fr,{}):(this.notify(fr,{}),this.trigger(Gi))},a.prototype.getValueCellInfo=function(e){var t=e;return this.trigger(Ba,t),t},a.prototype.getHeaderSortInfo=function(e){var t=e;return this.trigger(Ga,t),t},a.prototype.getData=function(){this.dataSourceSettings.dataSource.defaultQuery?this.dataSourceSettings.dataSource.executeQuery(this.dataSourceSettings.dataSource.defaultQuery).then(this.executeQuery.bind(this)):this.dataSourceSettings.dataSource.executeQuery(new i.Query).then(this.executeQuery.bind(this))},a.prototype.executeQuery=function(e){this.engineModule.data=e.result,this.initEngine()},a.prototype.fieldListRender=function(){var e;this.element.innerHTML="","Popup"===this.renderMode&&this.dialogRenderer.fieldListDialog&&!this.dialogRenderer.fieldListDialog.isDestroyed&&(e=this.dialogRenderer.fieldListDialog.visible,this.dialogRenderer.fieldListDialog.destroy(),(0,t.remove)(document.getElementById(this.element.id+"_Container"))),this.renderModule.render(),"Popup"===this.renderMode?(this.fieldListSpinnerElement=this.dialogRenderer.fieldListDialog.element,e&&this.dialogRenderer.fieldListDialog.show()):this.fieldListSpinnerElement=this.element.querySelector(".e-pivotfieldlist-container"),this.spinnerTemplate?(0,Ni.createSpinner)({target:this.fieldListSpinnerElement,template:this.spinnerTemplate,cssClass:this.cssClass?this.cssClass:void 0},this.createElement):(0,Ni.createSpinner)({target:this.fieldListSpinnerElement,cssClass:this.cssClass?this.cssClass:void 0},this.createElement);var i={pivotEngine:"olap"===this.dataType?this.olapEngineModule:this.engineModule,dataSourceSettings:this.dataSourceSettings,id:this.element.id,element:"Popup"===this.renderMode?this.dialogRenderer.fieldListDialog.element:(0,t.select)("#"+this.element.id+"_Container",this.element),moduleName:this.getModuleName(),enableRtl:this.enableRtl,enableHtmlSanitizer:this.enableHtmlSanitizer,isAdaptive:this.isAdaptive,renderMode:this.renderMode,localeObj:this.localeObj,dataType:this.dataType,cssClass:this.cssClass};this.pivotCommon=new Ns(i),this.pivotCommon.control=this,this.allowDeferLayoutUpdate&&(this.clonedDataSource=Di.getClonedDataSourceSettings(this.dataSourceSettings),"olap"===this.dataType&&(this.clonedFieldListData=Di.cloneOlapFieldSettings(this.olapEngineModule.fieldListData)),this.clonedFieldList=Di.getClonedFieldList(this.pivotFieldList));var a=this.isPopupView?this.pivotGridModule:this.staticPivotGridModule;a&&a.toolbarModule&&Di.toggleFieldListIconVisibility(a)},a.prototype.getFieldCaption=function(e){var t=this.getFields(e),i="olap"===this.dataType?this.olapEngineModule:this.engineModule;if(t.length>0&&i&&i.fieldList)for(var a=t.length;a--;)if(t[a])for(var r=0,n=t[a];r<n.length;r++){var s=n[r];s&&i.fieldList[s.name]&&(s.caption?i.fieldList[s.name].caption=s.caption:i.fieldList[s.name].caption=s.name)}},a.prototype.getFields=function(e){return[e.rows,e.columns,e.values,e.filters]},a.prototype.updateDataSource=function(e,i){var a=this;this.pivotGridModule&&this.pivotGridModule.showWaitingPopup(),(0,Ni.showSpinner)(this.fieldListSpinnerElement);var r=this,n=r.isPopupView?r.pivotGridModule:r,s=!1,o=r.pivotGridModule&&(r.pivotGridModule.enableVirtualization||r.pivotGridModule.enablePaging)?r.pivotGridModule.pageSettings:void 0,l=Object.keys(r.lastCalcFieldInfo).length>0,d=Object.keys(r.lastSortInfo).length>0,h=Object.keys(r.lastAggregationInfo).length>0,p=Object.keys(r.lastFilterInfo).length>0,u={dataSourceSettings:Di.getClonedDataSourceSettings(r.dataSourceSettings)};n.trigger(Ii,u,(function(u){if(o&&(d||p||h||l)||(Di.updateDataSourceSettings(r,u.dataSourceSettings),Di.updateDataSourceSettings(r.pivotGridModule,u.dataSourceSettings)),(0,t.isNullOrUndefined)(i)){var c=!d&&(r.staticPivotGridModule?r.staticPivotGridModule.enableValueSorting:r.enableValueSorting);if(d&&""!==r.dataSourceSettings.valueSortSettings.headerText&&(r.pivotGridModule&&r.pivotGridModule.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),r.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0)),"pivot"===r.dataType){var g=r.frameCustomProperties();g.enableValueSorting=c,g.savedFieldList=r.pivotFieldList,o&&(d||p||h||l)&&!r.allowDeferLayoutUpdate?(d&&("Server"===n.dataSourceSettings.mode?n.getEngine("onSort",null,r.lastSortInfo,null,null,null,null):r.engineModule.onSort(r.lastSortInfo),r.lastSortInfo={}),p&&("Server"===n.dataSourceSettings.mode?n.getEngine("onFilter",null,null,null,null,r.lastFilterInfo,null):r.engineModule.onFilter(r.lastFilterInfo,r.dataSourceSettings),r.lastFilterInfo={}),h&&("Server"===n.dataSourceSettings.mode?n.getEngine("onAggregation",null,null,r.lastAggregationInfo,null,null,null):r.engineModule.onAggregation(r.lastAggregationInfo),r.lastAggregationInfo={}),l&&("Server"===n.dataSourceSettings.mode?n.getEngine("onCalcOperation",null,null,null,r.lastCalcFieldInfo,null,null):r.engineModule.onCalcOperation(r.lastCalcFieldInfo,r.dataSourceSettings),r.lastCalcFieldInfo={})):("Server"===r.dataSourceSettings.mode?d?r.getEngine("onSort",null,r.lastSortInfo,null,null,null,null):h?r.getEngine("onAggregation",null,null,r.lastAggregationInfo,null,null,null):l?r.getEngine("onCalcOperation",null,null,null,r.lastCalcFieldInfo,null,null):p?r.getEngine("onFilter",null,null,null,null,r.lastFilterInfo,null):r.getEngine("onDrop",null,null,null,null,null,null):r.engineModule.renderEngine(r.dataSourceSettings,g,r.aggregateCellInfo?r.getValueCellInfo.bind(r):void 0,r.onHeadersSort?r.getHeaderSortInfo.bind(r):void 0),r.lastSortInfo={},r.lastAggregationInfo={},r.lastCalcFieldInfo={},r.lastFilterInfo={})}else s=r.updateOlapDataSource(r,d,l,s,c,p);r.getFieldCaption(r.dataSourceSettings)}else r.axisFieldModule.render(),r.pivotGridModule&&r.pivotGridModule.notify(pr,r),r.isRequiredUpdate=!1;"Server"!==r.dataSourceSettings.mode?r.enginePopulatedEventMethod(r,e,s):(r.allowDeferLayoutUpdate&&!r.isRequiredUpdate||r.isRequiredUpdate)&&((0,Ni.hideSpinner)(a.fieldListSpinnerElement),a.pivotGridModule&&a.pivotGridModule.hideWaitingPopup())}))},a.prototype.enginePopulatedEventMethod=function(e,i,a){var r=this,n=e.isPopupView?e.pivotGridModule:e,s={dataSourceSettings:e.dataSourceSettings,pivotFieldList:"pivot"===e.dataType?e.engineModule.fieldList:e.olapEngineModule.fieldList,pivotValues:"pivot"===e.dataType?e.engineModule.pivotValues:e.olapEngineModule.pivotValues};n.trigger(Fi,s,(function(n){e.dataSourceSettings=n.dataSourceSettings,e.pivotCommon.dataSourceSettings=e.dataSourceSettings,e.pivotFieldList=n.pivotFieldList,"olap"===e.dataType?(e.olapEngineModule.pivotValues=n.pivotValues,e.pivotCommon.engineModule=e.olapEngineModule):(e.engineModule.pivotValues=n.pivotValues,e.pivotCommon.engineModule=e.engineModule),i||!e.treeViewModule.fieldTable||e.isAdaptive||e.notify(Sr,{}),e.isRequiredUpdate?(e.allowDeferLayoutUpdate&&(e.clonedDataSource=Di.getClonedDataSourceSettings(e.dataSourceSettings),"olap"===r.dataType&&(r.clonedFieldListData=Di.cloneOlapFieldSettings(r.olapEngineModule.fieldListData)),e.clonedFieldList=Di.getClonedFieldList(e.pivotFieldList)),e.updateView(e.pivotGridModule)):r.isPopupView&&(r.isDeferLayoutUpdate||e.pivotGridModule&&e.pivotGridModule.pivotDeferLayoutUpdate)&&(e.pivotGridModule.engineModule=e.engineModule,e.pivotGridModule.setProperties({dataSourceSettings:e.dataSourceSettings.properties},!0),e.pivotGridModule.notify(pr,e),(0,Ni.hideSpinner)(e.fieldListSpinnerElement)),(r.isPopupView&&e.pivotGridModule&&e.pivotGridModule.allowDeferLayoutUpdate&&!e.isRequiredUpdate||!(0,t.isNullOrUndefined)(e.pivotGridModule))&&((0,Ni.hideSpinner)(e.fieldListSpinnerElement),e.pivotGridModule.hideWaitingPopup()),e.isRequiredUpdate=!0,!e.pivotGridModule||a?(0,Ni.hideSpinner)(e.fieldListSpinnerElement):e.pivotGridModule.fieldListSpinnerElement=e.fieldListSpinnerElement}));var o=this.getActionCompleteName();this.actionObj.actionName=o,this.actionObj.actionName&&this.actionCompleteMethod()},a.prototype.updateOlapDataSource=function(e,t,i,a,r,n){var s=e.frameCustomProperties(e.olapEngineModule.fieldListData,e.olapEngineModule.fieldList);return s.enableValueSorting=r,s.savedFieldList=e.pivotFieldList,!i&&!t||n?Di.renderOlapEngine(e,s):(e.olapEngineModule.savedFieldList=e.pivotFieldList,e.olapEngineModule.savedFieldListData=e.olapEngineModule.fieldListData,i?(e.olapEngineModule.updateCalcFields(e.dataSourceSettings,e.lastCalcFieldInfo),e.lastCalcFieldInfo={},a=!e.olapEngineModule.dataFields[e.lastCalcFieldInfo.name],e.pivotGridModule&&e.pivotGridModule.hideWaitingPopup()):e.olapEngineModule.onSort(e.dataSourceSettings)),e.lastSortInfo={},e.lastAggregationInfo={},e.lastCalcFieldInfo={},e.lastFilterInfo={},a},a.prototype.update=function(e){e&&(this.clonedDataSet=e.clonedDataSet,this.clonedReport=e.clonedReport,this.setProperties({dataSourceSettings:e.dataSourceSettings,showValuesButton:e.showValuesButton},!0),this.engineModule=e.engineModule,this.olapEngineModule=e.olapEngineModule,this.dataType=e.dataType,this.pivotFieldList="olap"===this.dataType?e.olapEngineModule.fieldList:e.engineModule.fieldList,this.isPopupView?this.pivotGridModule=e:this.staticPivotGridModule=e,this.getFieldCaption(e.dataSourceSettings),this.pivotCommon.engineModule="olap"===this.dataType?this.olapEngineModule:this.engineModule,this.pivotCommon.dataSourceSettings=this.dataSourceSettings,this.pivotCommon.control=this,this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify(Sr,{}),this.axisFieldModule.render(),!this.isPopupView&&this.allowDeferLayoutUpdate&&(this.clonedDataSource=Di.getClonedDataSourceSettings(this.dataSourceSettings),"olap"===this.dataType&&(this.clonedFieldListData=Di.cloneOlapFieldSettings(this.olapEngineModule.fieldListData)),this.clonedFieldList=Di.getClonedFieldList(this.pivotFieldList)))},a.prototype.updateView=function(e){if(e){var t="Calculated field applied"===this.actionObj.actionName&&"olap"===e.dataType;e.element.querySelector(".e-spin-hide")&&!t&&(!this.allowDeferLayoutUpdate||this.isDeferUpdateApplied||e.isInitial&&"Chart"!==e.currentView)&&e.showWaitingPopup(),e.clonedDataSet=this.clonedDataSet,e.clonedReport=this.clonedReport,e.setProperties({dataSourceSettings:this.dataSourceSettings,showValuesButton:this.showValuesButton},!0),e.engineModule=this.engineModule,e.olapEngineModule=this.olapEngineModule,e.dataType=this.dataType,this.pivotChange||(e.pivotValues="olap"===this.dataType?this.olapEngineModule.pivotValues:this.engineModule.pivotValues);var i={dataSourceSettings:Di.getClonedDataSourceSettings(e.dataSourceSettings),pivotValues:e.pivotValues};e.trigger(Qa,i),this.isPopupView||!("olap"===this.dataType?this.olapEngineModule.isEngineUpdated:this.engineModule.isEngineUpdated)&&!this.isInitial||(this.staticPivotGridModule=e,e.isStaticRefresh=!0,e.isStaticFieldList=!0),this.isDeferUpdateApplied=!1,this.staticPivotGridModule&&(this.staticPivotGridModule.isServerWaitingPopup=!0),e.dataBind()}},a.prototype.triggerPopulateEvent=function(){var e=this,t=this.isPopupView?this.pivotGridModule:this,i={dataSourceSettings:this.dataSourceSettings,pivotFieldList:"olap"===this.dataType?this.olapEngineModule.fieldList:this.engineModule.fieldList,pivotValues:"olap"===this.dataType?this.olapEngineModule.pivotValues:this.engineModule.pivotValues};t.trigger(Fi,i,(function(t){e.dataSourceSettings=t.dataSourceSettings,e.pivotFieldList=t.pivotFieldList,"olap"===e.dataType?e.olapEngineModule.pivotValues=t.pivotValues:e.engineModule.pivotValues=t.pivotValues}))},a.prototype.actionBeginMethod=function(){var e={dataSourceSettings:Di.getClonedDataSourceSettings(this.dataSourceSettings),actionName:this.actionObj.actionName,fieldInfo:this.actionObj.fieldInfo,cancel:!1};return(this.isPopupView?this.pivotGridModule:this).trigger(or,e),e.cancel},a.prototype.actionCompleteMethod=function(){var e={dataSourceSettings:Di.getClonedDataSourceSettings(this.dataSourceSettings),actionName:this.actionObj.actionName,fieldInfo:this.actionObj.fieldInfo,actionInfo:this.actionObj.actionInfo};(this.isPopupView?this.pivotGridModule:this).trigger(lr,e),this.actionObj.actionName="",this.actionObj.actionInfo=void 0,this.actionObj.fieldInfo=void 0},a.prototype.actionFailureMethod=function(e){var t={actionName:this.actionObj.actionName,errorInfo:e};(this.isPopupView?this.pivotGridModule:this).trigger(dr,t)},a.prototype.getActionCompleteName=function(){return this.actionObj.actionName===un?xn:this.actionObj.actionName===ln?Zn:this.actionObj.actionName===dn?$n:this.actionObj.actionName===hn?es:this.actionObj.actionName===pn?ts:this.actionObj.actionName===vn?is:this.actionObj.actionName===on?On:this.actionObj.actionName},a.prototype.destroy=function(){this.unWireEvent(),this.engineModule&&!this.destroyEngine&&(this.engineModule.fieldList={},this.engineModule.rMembers=null,this.engineModule.cMembers=null,this.engineModule.valueMatrix=[],this.engineModule={}),this.olapEngineModule&&!this.destroyEngine&&(this.olapEngineModule.fieldList={},this.olapEngineModule={}),this.pivotFieldList&&(this.pivotFieldList={}),this.contextMenuModule&&this.contextMenuModule.destroy(),this.treeViewModule&&this.treeViewModule.destroy(),this.pivotButtonModule&&this.pivotButtonModule.destroy(),this.pivotCommon&&this.pivotCommon.destroy(),this.dialogRenderer&&this.dialogRenderer.destroy(),this.calculatedFieldModule&&this.calculatedFieldModule.destroy(),e.prototype.destroy.call(this),this.contextMenuModule&&(this.contextMenuModule=null),this.treeViewModule&&(this.treeViewModule=null),this.pivotButtonModule&&(this.pivotButtonModule=null),this.pivotCommon&&(this.pivotCommon=null),this.dialogRenderer&&(this.dialogRenderer=null),this.calculatedFieldModule&&(this.calculatedFieldModule=null),this.axisFieldModule&&(this.axisFieldModule=null),this.axisTableModule&&(this.axisTableModule=null),this.renderModule&&(this.renderModule=null),this.clonedDataSet&&(this.clonedDataSet=null),this.clonedReport&&(this.clonedReport=null),this.clonedFieldList&&(this.clonedFieldList=null),this.clonedFieldListData&&(this.clonedFieldListData=null),this.localeObj&&(this.localeObj=null),this.defaultLocale&&(this.defaultLocale=null),this.element.innerHTML="",(0,t.removeClass)([this.element],r),(0,t.removeClass)([this.element],n),(0,t.removeClass)([this.element],s)},wl([(0,t.Complex)({},Ws)],a.prototype,"dataSourceSettings",void 0),wl([(0,t.Property)("Popup")],a.prototype,"renderMode",void 0),wl([(0,t.Property)()],a.prototype,"target",void 0),wl([(0,t.Property)("")],a.prototype,"cssClass",void 0),wl([(0,t.Property)(!1)],a.prototype,"enableHtmlSanitizer",void 0),wl([(0,t.Property)(!1)],a.prototype,"allowCalculatedField",void 0),wl([(0,t.Property)(!1)],a.prototype,"enableFieldSearching",void 0),wl([(0,t.Property)(!1)],a.prototype,"showValuesButton",void 0),wl([(0,t.Property)(!1)],a.prototype,"allowDeferLayoutUpdate",void 0),wl([(0,t.Property)(1e3)],a.prototype,"maxNodeLimitInMemberEditor",void 0),wl([(0,t.Property)(!0)],a.prototype,"loadOnDemandInMemberEditor",void 0),wl([(0,t.Property)()],a.prototype,"spinnerTemplate",void 0),wl([(0,t.Property)(["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"])],a.prototype,"aggregateTypes",void 0),wl([(0,t.Property)("USD")],a.prototype,"currencyCode",void 0),wl([(0,t.Event)()],a.prototype,"load",void 0),wl([(0,t.Event)()],a.prototype,"enginePopulating",void 0),wl([(0,t.Event)()],a.prototype,"memberFiltering",void 0),wl([(0,t.Event)()],a.prototype,"enginePopulated",void 0),wl([(0,t.Event)()],a.prototype,"onFieldDropped",void 0),wl([(0,t.Event)()],a.prototype,"fieldDrop",void 0),wl([(0,t.Event)()],a.prototype,"fieldDragStart",void 0),wl([(0,t.Event)()],a.prototype,"aggregateCellInfo",void 0),wl([(0,t.Event)()],a.prototype,"memberEditorOpen",void 0),wl([(0,t.Event)()],a.prototype,"calculatedFieldCreate",void 0),wl([(0,t.Event)()],a.prototype,"aggregateMenuOpen",void 0),wl([(0,t.Event)()],a.prototype,"fieldRemove",void 0),wl([(0,t.Event)()],a.prototype,"dataBound",void 0),wl([(0,t.Event)()],a.prototype,"created",void 0),wl([(0,t.Event)()],a.prototype,"destroyed",void 0),wl([(0,t.Event)()],a.prototype,"beforeServiceInvoke",void 0),wl([(0,t.Event)()],a.prototype,"afterServiceInvoke",void 0),wl([(0,t.Event)()],a.prototype,"actionBegin",void 0),wl([(0,t.Event)()],a.prototype,"actionComplete",void 0),wl([(0,t.Event)()],a.prototype,"actionFailure",void 0),wl([(0,t.Event)()],a.prototype,"onHeadersSort",void 0),a=wl([t.NotifyPropertyChanges],a)}(t.Component),Ml="Count",Dl="Median",Ol="Sum",Pl="DistinctCount",Nl="Product",El="SampleStDev",Il="PopulationStDev",Fl="SampleVar",Ll="PopulationVar",Al="CalculatedField",Rl=function(){function e(e){this.isFormula=!1,this.isRequireUpdate=!1,this.formatTypes=["Standard","Currency","Percent","Custom","None"],this.parent=e,this.existingReport=null,this.parent.calculatedFieldModule=this,this.removeEventListener(),this.addEventListener(),this.parentID=this.parent.element.id,this.treeObj=null,this.droppable=null,this.newFields=null,this.isFieldExist=!0,this.formulaText=null,this.fieldText=null,this.formatText=null,this.formatType=null,this.fieldType=null,this.parentHierarchy=null,this.isEdit=!1,this.currentFieldName=null}return e.prototype.getModuleName=function(){return"calculatedField"},e.prototype.keyActionHandler=function(e){var i=e.currentTarget.querySelector(".e-node-focus");if(i)switch(e.action){case"moveRight":case"shiftE":"pivot"===this.parent.dataType&&this.displayMenu(i);break;case"delete":"LI"===i.tagName&&!i.querySelector(".e-list-icon.e-format")&&!i.querySelector(".e-list-icon").classList.contains(".e-icons")&&i.querySelector("."+Kt)&&i.querySelector("."+Kt).classList.contains("e-list-icon")&&this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),{},!0,i);break;case"enter":var a=i.getAttribute("data-field"),r=(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),Ni.Dialog),n=i.getAttribute("data-type"),s=(0,t.select)("#"+this.parentID+"droppable",r.element);"pivot"===this.parent.dataType?""===s.value?s.value=n===Al?i.getAttribute("data-uid"):'"'+n+"("+a+')"':""!==s.value&&(s.value=n===Al?s.value+i.getAttribute("data-uid"):s.value+'"'+n+"("+a+')"'):(this.parent.olapEngineModule&&this.parent.olapEngineModule.fieldList[a]&&this.parent.olapEngineModule.fieldList[a].isCalculatedField&&(a=this.parent.olapEngineModule.fieldList[a].tag),""===s.value?s.value=a:""!==s.value&&(s.value=s.value+a))}},e.prototype.fieldClickHandler=function(e){var i=(0,t.closest)(e.event.target,"li");(e.event.target.classList.contains(nt)||e.event.target.classList.contains(bt)||e.event.target.classList.contains(Ct)||e.event.target.classList.contains(Kt))&&(this.parent.isAdaptive?"olap"===this.parent.dataType&&this.parent.isAdaptive&&("LI"===i.tagName&&i.querySelector(".e-list-edit-icon").classList.contains(bt)&&e.event.target.classList.contains(bt)?(this.isEdit=!0,this.currentFieldName=i.getAttribute("data-field"),this.fieldText=i.getAttribute("data-caption"),this.formulaText=i.getAttribute("data-formula"),this.formatType=i.getAttribute("data-formatString"),this.formatText="Custom"===this.formatType?i.getAttribute("data-customformatstring"):null,this.fieldType=i.getAttribute("data-membertype"),this.parentHierarchy="Dimension"===this.fieldType?i.getAttribute("data-hierarchy"):null,(0,t.addClass)([i.querySelector(".e-list-edit-icon")],Ct),(0,t.removeClass)([i.querySelector(".e-list-edit-icon")],bt),this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)):"LI"===i.tagName&&i.querySelector(".e-list-edit-icon").classList.contains(Ct)&&e.event.target.classList.contains(Ct)?(this.isEdit=!1,this.fieldText=this.formatText=this.formulaText=this.currentFieldName=null,this.parentHierarchy=this.fieldType=this.formatType=null,(0,t.addClass)([i.querySelector(".e-list-edit-icon")],bt),(0,t.removeClass)([i.querySelector(".e-list-edit-icon")],Ct)):"LI"===i.tagName&&i.querySelector("."+Kt).classList.contains("e-icons")&&e.event.target.classList.contains(Kt)&&this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),{},!0,e.node)):this.displayMenu(i,e.node,e.event.target))},e.prototype.accordionClickHandler=function(e){if(e.item&&-1!==e.item.iconCss.indexOf("e-list-icon")&&(0,t.closest)(e.originalEvent.target,".e-acrdn-header-icon")){var i=(0,t.closest)(e.originalEvent.target,".e-acrdn-header").querySelector("."+Ze),a=i.getAttribute("data-field"),r=i.getAttribute("data-caption"),n=Di.getFieldByName(a,this.parent.dataSourceSettings.formatSettings),s=(0,t.closest)(e.originalEvent.target,".e-acrdn-header-icon");if(n){var o=this.getFormat(n.format),l=o?this.formatTypes.indexOf(o)>-1?n.format:"Custom":"None";this.formatType=l}s.querySelector("."+bt)&&e.originalEvent.target.classList.contains(bt)?(this.isEdit=!0,this.currentFieldName=a,this.fieldText=r||a,this.formulaText=this.parent.engineModule.fieldList[a].formula,this.formatText=n?n.format:"",(0,t.addClass)([s.querySelector(".e-list-icon")],Ct),(0,t.removeClass)([s.querySelector(".e-list-icon")],bt),this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)):s.querySelector("."+Ct)&&e.originalEvent.target.classList.contains(Ct)?(this.isEdit=!1,this.fieldText=this.formatText=this.formulaText=this.currentFieldName=null,(0,t.addClass)([s.querySelector(".e-list-icon")],bt),(0,t.removeClass)([s.querySelector(".e-list-icon")],Ct)):s.querySelector("."+Kt)&&e.originalEvent.target.classList.contains(Kt)&&this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),{},!0,i)}},e.prototype.accordionCreated=function(){for(var e=(0,t.getInstance)((0,t.select)("#"+this.parentID+"accordDiv",document),ms.Accordion).element.querySelectorAll(".e-acrdn-item"),i=0;i<e.length;i++)if(e[i].querySelector("."+bt)||e[i].querySelector("."+Ct)){var a=(0,t.createElement)("span",{className:"e-list-icon "+Kt+" e-icons"});(0,t.append)([a],e[i].querySelector(".e-acrdn-header-icon")),(0,t.addClass)([e[i]],"e-select")}},e.prototype.clearFormula=function(){this.treeObj&&this.treeObj.element.querySelector("li")&&((0,t.removeClass)(this.treeObj.element.querySelectorAll("li"),"e-active"),this.displayMenu(this.treeObj.element.querySelector("li")))},e.prototype.displayMenu=function(e,i,a){var r=!a||a.classList.contains(bt),n=!a||a.classList.contains(Ct),s=(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),Ni.Dialog),l=(0,t.getInstance)((0,t.select)("#"+this.parentID+"ddlelement",document),fs.MaskedTextBox);try{if("pivot"!==this.parent.dataType||!e.querySelector(".e-list-icon.e-format")||!e.querySelector(".e-list-icon.e-format").classList.contains(o)||e.querySelector(".e-list-icon").classList.contains(Ct)||e.querySelector(".e-list-icon").classList.contains(Kt)||e.querySelector(".e-list-icon").classList.contains(bt)||"LI"!==e.tagName){if("LI"===e.tagName&&(e.querySelector("."+bt)&&e.querySelector("."+bt).classList.contains("e-list-icon")&&r||"olap"===this.parent.dataType&&e.getAttribute("data-type")===Al&&e.classList.contains("e-active")&&(a&&!a.classList.contains(Kt)||!a))){this.isEdit=!0;var d=e.getAttribute("data-field"),h=e.getAttribute("data-caption");this.currentFieldName=d,l.value=h,l.dataBind();var p=e.getAttribute("data-formatString"),u=s.element,c=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Format_Div",u),vs.DropDownList),g=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Custom_Format_Element",u),fs.MaskedTextBox),m=e.getAttribute("data-customformatstring");if("olap"===this.parent.dataType){var f=e.getAttribute("data-membertype"),v=e.getAttribute("data-hierarchy"),S=e.getAttribute("data-formula"),y=(0,t.select)("#"+this.parentID+"_FieldNameTitle",u),b=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Member_Type_Div",u),vs.DropDownList),C=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Hierarchy_List_Div",u),vs.DropDownList);y.innerText=this.parent.localeObj.getConstant("caption"),(0,t.select)("#"+this.parentID+"droppable",document).value=S,b.readonly=!0,b.value=f,b.dataBind(),"Dimension"===f&&(C.value=v)}else(0,t.addClass)(this.treeObj.element.querySelectorAll("."+Ct),bt),(0,t.removeClass)(this.treeObj.element.querySelectorAll("."+Ct),Ct),(0,t.addClass)([e.querySelector(".e-list-icon")],Ct),(0,t.removeClass)([e.querySelector(".e-list-icon")],bt),e.querySelector("."+Ct).setAttribute("title",this.parent.localeObj.getConstant("clearCalculatedField")),(0,t.select)("#"+this.parentID+"droppable",document).value=e.getAttribute("data-uid");""!==p&&(c.value=p,c.dataBind()),g.value=m,g.dataBind()}else if("LI"===e.tagName&&(e.querySelector("."+Ct)&&e.querySelector("."+Ct).classList.contains("e-list-icon")&&n||"olap"===this.parent.dataType&&!e.classList.contains("e-active"))){this.isEdit=!1,l.value="",l.dataBind();u=s.element;if((g=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Custom_Format_Element",u),fs.MaskedTextBox)).value="",g.dataBind(),"olap"===this.parent.dataType){C=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Hierarchy_List_Div",u),vs.DropDownList),c=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Format_Div",u),vs.DropDownList),b=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Member_Type_Div",u),vs.DropDownList);(y=(0,t.select)("#"+this.parentID+"_FieldNameTitle",u)).innerText=this.parent.localeObj.getConstant("fieldTitle"),C.index=0,C.dataBind(),c.index=0,c.dataBind(),b.index=0,b.readonly=!1,b.dataBind()}else(0,t.addClass)(this.treeObj.element.querySelectorAll("."+Ct),bt),(0,t.removeClass)(this.treeObj.element.querySelectorAll("."+Ct),Ct),e.querySelector("."+bt).setAttribute("title",this.parent.localeObj.getConstant("edit"));(0,t.select)("#"+this.parentID+"droppable",document).value=""}else if("LI"===e.tagName&&e.querySelector("."+Kt)&&e.querySelector("."+Kt).classList.contains("e-list-icon")&&!r&&!n){if(this.parent.actionObj.actionName=pn,this.parent.actionBeginMethod())return;var x=(0,t.select)("#"+this.parentID+"droppable",document),w={name:this.isEdit?this.currentFieldName:l.value,caption:l.value,formula:x.value};this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),w,!0,i)}}else{var T=(0,t.select)("#"+this.parentID+"CalcContextmenu",document)?(0,t.getInstance)((0,t.select)("#"+this.parentID+"CalcContextmenu",document),ms.ContextMenu):null;T&&!T.isDestroyed&&T.destroy(),this.curMenu=e.querySelector("."+De),this.openContextMenu(e)}}catch(e){this.parent.actionFailureMethod(e)}},e.prototype.removeCalcField=function(e){var i,a=this.parent.dataSourceSettings,r=e.getAttribute("data-field"),n=a.calculatedFieldSettings;"pivot"===this.parent.dataType&&(this.parent.isAdaptive?"number"==typeof(h=parseInt(e.getAttribute("id").split(this.parentID+"_")[1],10))&&(0,t.getInstance)((0,t.select)("#"+this.parentID+"accordDiv",document),ms.Accordion).hideItem(h):this.treeObj.removeNodes([e]));for(var s=0;s<n.length;s++)if(n[s]&&n[s].name===r){n.splice(s,1);break}if("olap"===this.parent.dataType){for(var o=(i=this.parent.olapEngineModule).fieldListData?i.fieldListData:[],l=0,d=Object.keys(o);l<d.length;l++){var h,p=d[l];if(o[parseInt(p,10)].name===r)if("number"==typeof(h=parseInt(p,10))){o.splice(h,1);break}}var u=this.treeObj.getNode(e).parentID;this.treeObj.removeNodes([e]),n.length<=0&&this.treeObj.removeNodes([u])}else i=this.parent.engineModule;if(i.fields)for(s=0;s<i.fields.length;s++)if(i.fields[s]===r){i.fields.splice(s,1);break}i.savedFieldList&&i.savedFieldList[r]&&delete i.savedFieldList[r],i.fieldList&&i.fieldList[r]&&delete i.fieldList[r];var c=a.formatSettings;for(s=0;s<c.length;s++)if(c[s]&&c[s].name===r){c.splice(s,1);break}for(var g=[a.values,a.rows,a.columns,a.filters],m=(s=0,g.length);s<m;s++)for(var f=0,v=g[s].length;f<v;f++)if(g[s][f].name===r){g[s].splice(f,1);break}if(this.isEdit&&this.currentFieldName===r){var S=(0,t.getInstance)((0,t.select)("#"+this.parentID+"ddlelement",document),fs.MaskedTextBox);this.isEdit=!1,S.value="",this.currentFieldName=this.formatText=this.fieldText=this.formatType=null,this.formulaText=this.fieldType=this.parentHierarchy=null}(!(0,t.isNullOrUndefined)(this.parent.isDeferLayoutUpdate)&&!this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&!this.parent.pivotGridModule.pivotDeferLayoutUpdate||"pivotfieldlist"!==this.parent.getModuleName())&&this.parent.updateDataSource(),this.closeErrorDialog()},e.prototype.openContextMenu=function(e){var i=this,a=e.getAttribute("data-field"),r="number"!==this.parent.engineModule.fieldList[a].type?"string":"number",n="string"===r?this.getValidSummaryType().slice(0,2):this.getValidSummaryType(),s={cancel:!1,fieldName:a,aggregateTypes:this.getMenuItems(r).slice()};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(ir,s,(function(a){if(!a.cancel){for(var r=[],s=[],o=0,l=a.aggregateTypes;o<l.length;o++){var d=l[o];n.indexOf(d)>-1&&-1===r.indexOf(d)&&(r.push(d),s.push({id:i.parent.element.id+"Calc_"+d,text:i.parent.localeObj.getConstant(d)}))}i.createMenu(s,e);var h=e.getBoundingClientRect(),p=window.scrollY||document.documentElement.scrollTop,u=(0,t.getInstance)((0,t.select)("#"+i.parentID+"CalcContextmenu",document),ms.ContextMenu);i.parent.enableRtl?u.open(h.top+p,h.left-100):u.open(h.top+p,h.left+150)}}))},e.prototype.selectContextMenu=function(e){if(null!==e.element.textContent){var i=(0,t.closest)(this.curMenu,".e-list-item").getAttribute("data-caption");(0,t.closest)(this.curMenu,".e-list-item").setAttribute("data-type",e.element.id.split("_").pop()),this.curMenu.textContent=i+" ("+e.element.textContent+")",(0,t.addClass)([this.curMenu.parentElement.parentElement],["e-node-focus","e-hover"]),this.curMenu.parentElement.parentElement.setAttribute("tabindex","0"),this.curMenu.parentElement.parentElement.focus()}},e.prototype.createMenu=function(e,i){var a,r=this,n={cssClass:this.parentID+"calculatedmenu"+(this.parent.cssClass?" "+this.parent.cssClass:""),items:e,enableRtl:this.parent.enableRtl,locale:this.parent.locale,select:this.selectContextMenu.bind(this),onClose:function(){r.treeObj.element.focus(),(0,t.addClass)([i],["e-hover","e-node-focus"])}};a=(0,t.select)("#"+this.parentID+"CalcContextmenu",document)?(0,t.select)("#"+this.parentID+"CalcContextmenu",document):(0,t.createElement)("ul",{id:this.parentID+"CalcContextmenu"}),(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),Ni.Dialog).element.appendChild(a);var s=new ms.ContextMenu(n);s.isStringTemplate=!0,s.appendTo(a)},e.prototype.applyFormula=function(){var e=this,i=this,a=!1;(0,t.removeClass)([document.getElementById(this.parentID+"ddlelement")],wt);var r=(0,t.getInstance)((0,t.select)("#"+this.parentID+"ddlelement",document),fs.MaskedTextBox);this.newFields=(0,t.extend)([],this.parent.dataSourceSettings.calculatedFieldSettings,null,!0);var n={fieldName:this.isEdit?this.currentFieldName:r.value,calculatedField:this.getCalculatedFieldInfo(),calculatedFieldSettings:Di.cloneCalculatedFieldSettings(this.parent.dataSourceSettings.calculatedFieldSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(Za,n,(function(r){if(r.cancel)e.endDialog(),e.parent.lastCalcFieldInfo={},e.isFormula=!1;else{var n=r.calculatedField;if(!e.isEdit)if("olap"===i.parent.dataType){var s=n.name;i.parent.olapEngineModule.fieldList[s]&&"CalculatedField"!==i.parent.olapEngineModule.fieldList[s].type&&(a=!0)}else for(var o=0,l=Object.keys(i.parent.engineModule.fieldList);o<l.length;o++){var d=l[o];n.name&&n.name===d&&"CalculatedField"!==i.parent.engineModule.fieldList[d].aggregateType&&(a=!0)}if(a)return void i.parent.pivotCommon.errorDialog.createErrorDialog(i.parent.localeObj.getConstant("error"),i.parent.localeObj.getConstant("fieldExist"));e.existingReport=(0,t.extend)({},e.parent.dataSourceSettings,null,!0);var h=e.parent.dataSourceSettings;if((0,t.isNullOrUndefined)(n.name)||""===n.name||(0,t.isNullOrUndefined)(n.caption)||""===n.caption||!n.formula||""===n.formula){if((0,t.isNullOrUndefined)(n.name)||""===n.name||(0,t.isNullOrUndefined)(n.caption)||""===n.caption)(0,t.getInstance)((0,t.select)("#"+e.parentID+"ddlelement",document),fs.MaskedTextBox).value="",(0,t.addClass)([document.getElementById(e.parentID+"ddlelement")],wt),document.getElementById(e.parentID+"ddlelement").focus();else e.triggerActionCompleteEvent()}else{s=void 0;if("olap"===e.parent.dataType){if(s={name:n.name,formula:n.formula,formatString:n.formatString},(0,t.isNullOrUndefined)(n.hierarchyUniqueName)||(s.hierarchyUniqueName=n.hierarchyUniqueName),e.isFieldExist=!1,e.isEdit){for(v=0;v<h.calculatedFieldSettings.length;v++)if(h.calculatedFieldSettings[v].name===s.name&&e.isEdit){h.calculatedFieldSettings[v].hierarchyUniqueName=n.hierarchyUniqueName,e.parent.olapEngineModule.fieldList[s.name].caption=n.caption,h.calculatedFieldSettings[v].formatString=s.formatString,h.calculatedFieldSettings[v].formula=s.formula,s=h.calculatedFieldSettings[v],e.updateFormatSettings(h,s.name,n.formatString),e.parent.olapEngineModule.getFormattedFields(h.formatSettings),e.parent.olapEngineModule.formatFields[s.name]&&(e.parent.olapEngineModule.formatFields[s.name].format?e.parent.olapEngineModule.formatFields[s.name].format=e.getFormat(s.formatString):delete e.parent.olapEngineModule.formatFields[s.name]),e.isFieldExist=!0;break}for(var p=!1,u=0,c=[h.rows,h.columns,h.values,h.filters];u<c.length;u++){for(var g=0,m=c[u];g<m.length;g++){var f=m[g];if(f.isCalculatedField&&null!==s.name&&f.name===s.name&&e.isEdit){f.caption=n.caption,e.isFieldExist=!0,p=!0;break}}if(p)break}}else for(var v=0;v<h.calculatedFieldSettings.length;v++)if(h.calculatedFieldSettings[v].name===s.name)return void e.createConfirmDialog(i.parent.localeObj.getConstant("alert"),i.parent.localeObj.getConstant("confirmText"),n);e.isFieldExist||(h.calculatedFieldSettings.push(s),e.updateFormatSettings(h,s.name,n.formatString),e.parent.olapEngineModule.getFormattedFields(h.formatSettings),e.parent.olapEngineModule.formatFields[s.name]&&(e.parent.olapEngineModule.formatFields[s.name].format?e.parent.olapEngineModule.formatFields[s.name].format=e.getFormat(s.formatString):delete e.parent.olapEngineModule.formatFields[s.name])),e.parent.lastCalcFieldInfo=s}else{s={name:n.name,caption:n.caption,type:"CalculatedField"};var S={name:n.name,formula:n.formula};if((0,t.isNullOrUndefined)(n.formatString)||(S.formatString=n.formatString),e.isFieldExist=!0,e.isEdit){for(v=0;v<h.values.length;v++)if(h.values[v].type===Al&&null!==s.name&&h.values[v].name===s.name&&e.isEdit)for(y=0;y<h.calculatedFieldSettings.length;y++)h.calculatedFieldSettings[y].name===s.name&&(h.values.splice(v,1),h.values.splice(v,0,s),e.currentFormula=h.calculatedFieldSettings[y].formula,h.calculatedFieldSettings.splice(y,1),h.calculatedFieldSettings.splice(y,0,S),e.updateFormatSettings(h,s.name,n.formatString),e.isFieldExist=!1)}else for(var v=0;v<h.values.length;v++)if(h.values[v].type===Al&&h.values[v].name===s.name){for(var y=0;y<h.calculatedFieldSettings.length;y++)if(h.calculatedFieldSettings[y].name===s.name)return void e.createConfirmDialog(i.parent.localeObj.getConstant("alert"),i.parent.localeObj.getConstant("confirmText"),n);e.isFieldExist=!1}e.isFieldExist&&(h.values.push(s),h.calculatedFieldSettings.push(S),e.updateFormatSettings(h,s.name,n.formatString)),e.parent.lastCalcFieldInfo=S}e.addFormula(h,s.name)}}}))},e.prototype.getCalculatedFieldInfo=function(){var e=(0,t.select)("#"+this.parentID+"calculateddialog",document),i=e?(0,t.getInstance)(e,Ni.Dialog):void 0,a=(0,t.getInstance)((0,t.select)("#"+this.parentID+"ddlelement",document),fs.MaskedTextBox),r=(0,t.select)("#"+this.parentID+"droppable",document),n=this.parent.isAdaptive?this.parent.dialogRenderer.adaptiveElement.element:i.element,s=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Custom_Format_Element",n),fs.MaskedTextBox),o={name:this.isEdit?this.currentFieldName:a.value,caption:a.value,formula:r.value},l=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Format_Div",n),vs.DropDownList);if(o.formatString="Custom"===l.value?s.value:"None"===l.value?null:l.value,"olap"===this.parent.dataType){var d=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Member_Type_Div",n),vs.DropDownList),h=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Hierarchy_List_Div",n),vs.DropDownList);"Dimension"===d.value&&(o.hierarchyUniqueName=h.value)}return o},e.prototype.updateFormatSettings=function(e,i,a){for(var r={name:i,format:a,useGrouping:!0},n=!1,s=0;s<e.formatSettings.length;s++)if(e.formatSettings[s].name===i){if("undefined"===a||void 0===a||""===a){e.formatSettings.splice(s,1),n=!0;break}var o=e.formatSettings[s].properties?e.formatSettings[s].properties:e.formatSettings[s];o.format=a,e.formatSettings.splice(s,1,o),n=!0;break}n||""===a||(0,t.isNullOrUndefined)(a)||e.formatSettings.push(r)},e.prototype.addFormula=function(e,t){this.isFormula=!0,this.field=t,this.parent.setProperties({dataSourceSettings:e},!0),"pivotfieldlist"===this.parent.getModuleName()&&(this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&this.parent.pivotGridModule.pivotDeferLayoutUpdate)&&(this.parent.isRequiredUpdate=!1);try{var i={calculatedFieldInfo:this.parent.lastCalcFieldInfo};this.parent.actionObj.actionInfo=i;var a=this.parent.actionObj.actionName===ln?Zn:xn;this.parent.actionObj.actionName=a,this.parent.updateDataSource(!1);var r="pivotfieldlist"===this.parent.getModuleName()&&this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent;r&&"Server"!==r.dataSourceSettings.mode?this.endDialog():this.isRequireUpdate=!0,"pivotfieldlist"===this.parent.getModuleName()&&"Fixed"===this.parent.renderMode&&this.parent.isDeferLayoutUpdate&&(this.parent.pivotChange=!0)}catch(e){this.showError()}},e.prototype.endDialog=function(){this.isEdit=!1;var e=(0,t.select)("#"+this.parentID+"calculateddialog",document),i=e?(0,t.getInstance)(e,Ni.Dialog):void 0;if(i)i.close();else{(0,t.getInstance)((0,t.select)("#"+this.parentID+"ddlelement",document),fs.MaskedTextBox).value="",this.currentFieldName=this.formatText=this.fieldText=this.formatType=null,this.formulaText=this.fieldType=this.parentHierarchy=null;var a=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:i.element;if(this.parent.dialogRenderer.parentElement.querySelector("."+$e).value="",(0,t.select)("#"+this.parentID+"droppable",this.parent.dialogRenderer.parentElement).value="",(0,t.select)("#"+this.parentID+"Custom_Format_Element",this.parent.dialogRenderer.parentElement).value="","olap"===this.parent.dataType){var r=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Member_Type_Div",a),vs.DropDownList),n=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Hierarchy_List_Div",a),vs.DropDownList);r.index=0,r.readonly=!1,r.dataBind(),n.index=0,n.enabled=!1,n.dataBind()}var s=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Custom_Format_Element",a),fs.MaskedTextBox),o=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Format_Div",a),vs.DropDownList);o.index="olap"===this.parent.dataType?0:4,o.dataBind(),s.enabled=!1,s.dataBind()}},e.prototype.showError=function(){if(this.parent.engineModule.fieldList[this.field]&&delete this.parent.engineModule.fieldList[this.field],this.parent.setProperties({dataSourceSettings:this.existingReport},!0),this.isEdit){for(var e=this.parent.dataSourceSettings.calculatedFieldSettings,t=0;e&&t<e.length;t++)if(e[t].name===this.field){e[t].formula=this.currentFormula;break}}else if(this.parent.engineModule.fields)for(t=0;t<this.parent.engineModule.fields.length;t++)if(this.parent.engineModule.fields[t]===this.field){this.parent.engineModule.fields.splice(t,1);break}this.parent.lastCalcFieldInfo={},this.triggerActionCompleteEvent(),this.parent.updateDataSource(!1),this.isFormula=!1},e.prototype.getFieldListData=function(e){var i=[];if("olap"===this.parent.dataType)for(var a=0,r=i=Di.getClonedData(e.olapEngineModule.fieldListData?e.olapEngineModule.fieldListData:[]);a<r.length;a++){var n=r[a];n.spriteCssClass&&(n.spriteCssClass.indexOf("e-attributeCDB-icon")>-1||n.spriteCssClass.indexOf("e-level-members")>-1)?n.hasChildren=!0:n.spriteCssClass&&n.spriteCssClass.indexOf("e-namedSetCDB-icon")>-1?n.hasChildren=!1:n.spriteCssClass&&n.spriteCssClass.indexOf("e-calcMemberGroupCDB")>-1&&(n.expanded=this.isEdit)}else for(var s=0,l=e.engineModule.fieldList?Object.keys(e.engineModule.fieldList):[];s<l.length;s++){var d,h=l[s],p=null,u=e.engineModule.fieldList[h];p="number"===u.type&&"include"!==e.engineModule.fieldList[h].type&&"exclude"!==e.engineModule.fieldList[h].type||"DistinctCount"===u.aggregateType?void 0!==u.aggregateType?u.aggregateType:Ol:Ml,d=this.parent.localeObj.getConstant(p),i.push({index:u.index,name:(this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(u.caption):u.caption)+" ("+d+")",type:p,icon:nt+" "+o,formula:this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(u.formula):u.formula,field:this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(h):h,caption:this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(u.caption?u.caption:h):u.caption?u.caption:h})}return i},e.prototype.fieldDropped=function(e){e.cancel=!0;var i=(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),Ni.Dialog),a=(0,t.select)("#"+this.parentID+"droppable",i.element);(0,t.removeClass)([a],"e-copy-drop"),(0,t.removeClass)([e.draggedNode.querySelector("."+De)],ve);var r=e.draggedNode.getAttribute("data-field");if("olap"===this.parent.dataType)if(this.parent.olapEngineModule.fieldList[r]&&this.parent.olapEngineModule.fieldList[r].isCalculatedField&&(r=this.parent.olapEngineModule.fieldList[r].tag),e.target.id===this.parentID+"droppable"&&""===a.value)a.value=r,a.focus();else if(e.target.id===this.parentID+"droppable"&&""!==a.value){var n=a.value,s=a.selectionStart,o=n.substring(s,n.length),l=(h=n.substring(0,s))+r;a.value=h+r+o,a.focus(),a.setSelectionRange(l.length,l.length)}else e.cancel=!0;else{var d=e.draggedNode.getAttribute("data-type");if(e.target.id===this.parentID+"droppable"&&""===a.value)a.value=d===Al?e.draggedNodeData.id.toString():'"'+d+"("+r+')"',a.focus();else if(e.target.id===this.parentID+"droppable"&&""!==a.value){l=void 0,s=a.selectionStart;var h=(n=a.value).substring(0,s);o=n.substring(s,n.length);d===Al?(l=h+e.draggedNodeData.id.toString(),a.value=h+e.draggedNodeData.id.toString()+o):(l=h+'"'+d+"("+r+')"',a.value=h+'"'+d+"("+r+')"'+o),a.focus(),a.setSelectionRange(l.length,l.length)}else e.cancel=!0}},e.prototype.createDialog=function(){var e=this;if(null!==(0,t.select)("#"+this.parentID+"calculateddialog",document))for((0,t.remove)((0,t.select)("#"+this.parentID+"calculateddialog",document));!(0,t.isNullOrUndefined)(document.querySelector("."+this.parentID+"calculatedmenu"));)(0,t.remove)(document.querySelector("."+this.parentID+"calculatedmenu"));var i=(0,t.createElement)("div",{id:this.parentID+"calculateddialog",className:"e-pivot-calc-dialog-div "+("olap"===this.parent.dataType?"e-olap-calc-dialog-div":"")});this.parent.element.appendChild(i);var a=[{click:this.applyFormula.bind(this),isFlat:!1,buttonModel:{content:this.parent.localeObj.getConstant("ok"),isPrimary:!0,cssClass:this.parent.cssClass}},{click:this.cancelClick.bind(this),isFlat:!1,buttonModel:{content:this.parent.localeObj.getConstant("cancel"),cssClass:this.parent.cssClass}}];if("olap"===this.parent.dataType){var r={click:this.clearFormula.bind(this),isFlat:!1,buttonModel:{cssClass:"e-calc-clear-btn"+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("clear")}};a.splice(0,0,r)}var n=new Ni.Dialog({allowDragging:!0,position:{X:"center",Y:"center"},buttons:a,close:this.closeDialog.bind(this),beforeOpen:this.beforeOpen.bind(this),open:function(){(0,t.select)("#"+e.parentID+"ddlelement",n.element)&&(0,t.select)("#"+e.parentID+"ddlelement",n.element).focus()},animationSettings:{effect:"Zoom"},width:"25%",isModal:!0,closeOnEscape:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,showCloseIcon:!0,header:this.parent.localeObj.getConstant("createCalculatedField"),target:document.body,cssClass:this.parent.cssClass});n.isStringTemplate=!0,n.appendTo(i)},e.prototype.cancelClick=function(){(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),Ni.Dialog).close(),this.isEdit=!1},e.prototype.beforeOpen=function(){(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),Ni.Dialog).element.querySelector(".e-dlg-header").setAttribute("title",this.parent.localeObj.getConstant("createCalculatedField"))},e.prototype.closeDialog=function(){"pivotfieldlist"===this.parent.getModuleName()&&("Abort"!==this.parent.actionObj.actionName&&this.parent.axisFieldModule.render(),"Fixed"!==this.parent.renderMode&&((0,t.addClass)([this.parent.element.querySelector("."+f)],d),this.parent.dialogRenderer.fieldListDialog.show())),this.destroy(),(0,t.isNullOrUndefined)(document.getElementById(this.parentID+"calculateddialog"))||(0,t.remove)(document.getElementById(this.parentID+"calculateddialog")),(0,t.isNullOrUndefined)(document.querySelector("."+this.parentID+"calculatedmenu"))||(0,t.remove)(document.querySelector("."+this.parentID+"calculatedmenu"));var e="pivotview"===this.parent.getModuleName()||"pivotfieldlist"===this.parent.getModuleName()&&"Fixed"===this.parent.renderMode?0:500;this.buttonCall&&(this.buttonCall=!1,setTimeout(this.setFocus.bind(this),e))},e.prototype.setFocus=function(){var e;if("pivotview"===this.parent.getModuleName()&&this.parent.element?e=this.parent.element:document.getElementById(this.parent.element.id+"_Container")&&(e=document.getElementById(this.parent.element.id+"_Container")),e)for(var t=0,i=[].slice.call(e.querySelectorAll(".e-pivot-button"));t<i.length;t++){var a=i[t];if(a.getAttribute("data-uid")===this.currentFieldName){a.focus();break}}},e.prototype.renderDialogElements=function(){var e=(0,t.createElement)("div",{id:this.parentID+"outerDiv",className:("olap"===this.parent.dataType?"e-olap-calc-outer-div ":"")+"e-pivot-calc-outer-div"}),i=(0,t.createElement)("div",{id:this.parentID+"Olap_Tree_Div",className:"e-olap-field-tree-div"}),a=(0,t.createElement)("div",{id:this.parentID+"Pivot_Calc_Div",className:"e-pivot-calculated-div"});if("pivotfieldlist"===this.parent.getModuleName()&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+st)&&this.parent.isAdaptive){var r=(0,t.createElement)("div",{id:this.parentID+"accordDiv",className:"e-pivot-accord"});e.appendChild(r);var n=(0,t.createElement)("div",{id:this.parentID+"buttonDiv",className:pt}),s=(0,t.createElement)("button",{id:this.parentID+"addBtn",className:"e-pivot-add-button",attrs:{type:"button"}});s.innerText=this.parent.localeObj.getConstant("add");var l=(0,t.createElement)("button",{id:this.parentID+"cancelBtn",className:"e-pivot-cancel-button",attrs:{type:"button"}});l.innerText=this.parent.localeObj.getConstant("cancel"),n.appendChild(l),n.appendChild(s),e.appendChild(n)}else{if(!this.parent.isAdaptive&&"olap"===this.parent.dataType)(f=(0,t.createElement)("div",{className:"e-pivot-field-name-title",id:this.parentID+"_FieldNameTitle"})).innerText=this.parent.localeObj.getConstant("fieldTitle"),a.appendChild(f);var d=(0,t.createElement)("div",{id:this.parentID+"innerDiv",className:"e-pivot-calc-input-div"}),h=(0,t.createElement)("input",{id:this.parentID+"ddlelement",attrs:{type:"text"},className:$e});d.appendChild(h),"olap"!==this.parent.dataType||this.parent.isAdaptive?e.appendChild(d):a.appendChild(d);var p=(0,t.createElement)("div",{id:this.parentID+"control_container",className:lt});if(!this.parent.isAdaptive){var u=(0,t.createElement)("div",{className:ft});if(u.innerText="olap"===this.parent.dataType?this.parent.localeObj.getConstant("allFields"):this.parent.localeObj.getConstant("formulaField"),"olap"===this.parent.dataType){var c=(0,t.createElement)("div",{className:ft+"-container"});c.appendChild(u);var g=(0,t.createElement)("span",{attrs:{tabindex:"0","aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("fieldTooltip"),role:"button"},className:o+" "+xt});c.appendChild(g),new Ni.Tooltip({content:this.parent.localeObj.getConstant("fieldTooltip"),position:this.parent.enableRtl?"RightCenter":"LeftCenter",target:"."+xt,offsetY:(this.parent.enableRtl,-10),locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:220,cssClass:this.parent.cssClass}).appendTo(c),p.appendChild(c)}else e.appendChild(u)}var m=(0,t.createElement)("div",{className:ot+"-outer-div"});p.appendChild(m);var f,v=(0,t.createElement)("div",{id:this.parentID+"tree",className:ot});if(m.appendChild(v),"olap"!==this.parent.dataType||this.parent.isAdaptive?e.appendChild(p):i.appendChild(p),!this.parent.isAdaptive)(f=(0,t.createElement)("div",{className:"e-pivot-formula-title"})).innerText="olap"===this.parent.dataType?this.parent.localeObj.getConstant("expressionField"):this.parent.localeObj.getConstant("formula"),"olap"===this.parent.dataType?a.appendChild(f):e.appendChild(f);var S=(0,t.createElement)("textarea",{id:this.parentID+"droppable",className:st+" e-control e-textbox e-input",attrs:{placeholder:this.parent.isAdaptive?this.parent.localeObj.getConstant("dropTextMobile"):"olap"===this.parent.dataType?this.parent.localeObj.getConstant("olapDropText"):this.parent.localeObj.getConstant("dropText")}});if("olap"!==this.parent.dataType||this.parent.isAdaptive?e.appendChild(S):a.appendChild(S),this.parent.isAdaptive){n=(0,t.createElement)("div",{id:this.parentID+"buttonDiv",className:pt});(O=(0,t.createElement)("button",{id:this.parentID+"okBtn",className:ht,attrs:{type:"button"}})).innerText=this.parent.localeObj.getConstant("apply"),n.appendChild(O),e.appendChild(n)}if("olap"===this.parent.dataType){if(!this.parent.isAdaptive){var y=(0,t.createElement)("div",{className:"e-olap-member-title"});y.innerText=this.parent.localeObj.getConstant("memberType"),a.appendChild(y)}var b=(0,t.createElement)("div",{id:this.parentID+"Member_Type_Div",className:at});if(this.parent.isAdaptive)e.appendChild(b);else{a.appendChild(b);var C=(0,t.createElement)("div",{className:"e-olap-hierarchy-title"});C.innerText=this.parent.localeObj.getConstant("selectedHierarchy"),a.appendChild(C)}var x=(0,t.createElement)("div",{id:this.parentID+"Hierarchy_List_Div",className:tt});this.parent.isAdaptive?e.appendChild(x):a.appendChild(x)}if(!this.parent.isAdaptive){var w=(0,t.createElement)("div",{className:"e-pivot-format-title"});w.innerText=this.parent.localeObj.getConstant("formatString"),a.appendChild(w)}var T=(0,t.createElement)("div",{id:this.parentID+"Format_Div",className:it});this.parent.isAdaptive?e.appendChild(T):a.appendChild(T);var M=(0,t.createElement)("div",{id:this.parentID+"custom_Format_Div",className:"e-pivot-calc-custom-format-div"}),D=(0,t.createElement)("input",{id:this.parentID+"Custom_Format_Element",attrs:{type:"text"},className:et});if(M.appendChild(D),a.appendChild(M),this.parent.isAdaptive?e.appendChild(M):a.appendChild(M),"pivotfieldlist"===this.parent.getModuleName()&&null===this.parent.dialogRenderer.parentElement.querySelector("."+st)&&this.parent.isAdaptive){var O=e.querySelector("."+ht);e.appendChild(O)}else"olap"===this.parent.dataType&&e.appendChild(i),e.appendChild(a)}return e},e.prototype.renderAdaptiveLayout=function(e){var i=this.parent.dialogRenderer.adaptiveElement;if(e){if((0,t.select)("#"+this.parentID+"droppable",i.element)){var a=(0,t.getInstance)((0,t.select)("#"+this.parentID+"ddlelement",document),fs.MaskedTextBox);this.formulaText=(0,t.select)("#"+this.parentID+"droppable",document).value,this.fieldText=a.value}if(i.element.querySelector("."+at)){var r=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Member_Type_Div",i.element),vs.DropDownList);this.fieldType=r.value}if(i.element.querySelector("."+tt)){var n=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Hierarchy_List_Div",i.element),vs.DropDownList);this.parentHierarchy="Dimension"===this.fieldType?n.value:null}if(i.element.querySelector("."+it)){var s=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Format_Div",i.element),vs.DropDownList);this.formatType=s.value}if(i.element.querySelector("."+et)){var o=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Custom_Format_Element",i.element),fs.MaskedTextBox);this.formatText="Custom"===("olap"===this.parent.dataType?this.formatType:this.getFormat(this.formatType))?o.value:null}}else this.currentFieldName=this.formulaText=this.fieldText=this.formatText=null,this.fieldType=this.formatType=this.parentHierarchy=null;this.renderMobileLayout(i)},e.prototype.updateAdaptiveCalculatedField=function(e,i){var a=this.parent.dialogRenderer.adaptiveElement.element;this.isEdit=e;var r=e?"pivot"===this.parent.dataType?this.parent.engineModule.fieldList[i]:this.parent.olapEngineModule.fieldList[i]:{id:null,caption:null,formula:null,fieldType:"Measure",formatString:"pivot"===this.parent.dataType?null:"Standard",parentHierarchy:null};this.currentFieldName=r.id;var n=(0,t.getInstance)((0,t.select)("#"+this.parentID+"ddlelement",document),fs.MaskedTextBox);if((0,t.select)("#"+this.parentID+"droppable",document)&&(this.formulaText=(0,t.select)("#"+this.parentID+"droppable",document).value=r.formula,this.fieldText=n.value=r.caption,n.dataBind()),a.querySelector("."+at)){var s=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Member_Type_Div",a),vs.DropDownList);this.fieldType=s.value=r.fieldType,s.readonly=!!e,s.dataBind()}if(a.querySelector("."+tt)){var o=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Hierarchy_List_Div",a),vs.DropDownList);"Dimension"===this.fieldType?this.parentHierarchy=o.value=r.parentHierarchy:(this.parentHierarchy=null,o.index=0),o.dataBind()}if(a.querySelector("."+it)){var l=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Format_Div",a),vs.DropDownList);this.formatType=l.value=this.formatTypes.indexOf(r.formatString)>-1?r.formatString:"Custom"}if(a.querySelector("."+et)){var d=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Custom_Format_Element",a),fs.MaskedTextBox),h=Di.getFieldByName(i,this.parent.dataSourceSettings.formatSettings);"pivot"===this.parent.dataType?this.formatText=d.value=h?h.format:null:this.formatText=d.value="Custom"===this.formatType?r.formatString:null,d.dataBind()}},e.prototype.createDropElements=function(){for(var e=this,i=(0,t.select)("#"+this.parentID+"calculateddialog",document)?(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),Ni.Dialog):null,a=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:i.element,r=[],n=[],s=0,o=this.formatTypes;s<o.length;s++){var l=o[s];r.push({value:"pivot"===this.parent.dataType?this.getFormat(l):l,text:this.parent.localeObj.getConstant(l)})}if("olap"===this.parent.dataType){for(var d=[],h=0,p=["Measure","Dimension"];h<p.length;h++){var u=p[h];d.push({value:u,text:this.parent.localeObj.getConstant(u)})}for(var c=0,g=Di.getClonedData(this.parent.olapEngineModule.fieldListData);c<g.length;c++){var m=g[c];m.spriteCssClass&&(m.spriteCssClass.indexOf("e-attributeCDB-icon")>-1||m.spriteCssClass.indexOf("e-hierarchyCDB-icon")>-1)&&n.push({value:m.id,text:m.caption})}var f=new vs.DropDownList({dataSource:d,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:null!==this.fieldType?this.fieldType:d[0].value,readonly:this.isEdit,cssClass:rt+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(i){v.enabled="Dimension"===i.value,e.fieldType=i.value,e.formulaText=(0,t.select)("#"+e.parentID+"droppable",document).value,v.dataBind()}});f.isStringTemplate=!0,f.appendTo((0,t.select)("#"+this.parentID+"Member_Type_Div",a));var v=new vs.DropDownList({dataSource:n,enableRtl:this.parent.enableRtl,locale:this.parent.locale,allowFiltering:!0,enabled:"Dimension"===f.value,filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+n[0].text.toString(),fields:{value:"value",text:"text"},value:null!==this.parentHierarchy&&"Dimension"===f.value?this.parentHierarchy:n[0].value,cssClass:rt+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(i){e.parentHierarchy=i.value,e.formulaText=(0,t.select)("#"+e.parentID+"droppable",document).value}});v.isStringTemplate=!0,v.appendTo((0,t.select)("#"+this.parentID+"Hierarchy_List_Div",a))}var S=new vs.DropDownList({dataSource:r,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:this.parent.isAdaptive&&null!==this.formatType?this.formatType:"olap"===this.parent.dataType?r[0].value:r[4].value,cssClass:rt+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(i){y.enabled="Custom"===i.value,e.formatType=i.value,e.formulaText=(0,t.select)("#"+e.parentID+"droppable",document).value,y.dataBind()}});S.isStringTemplate=!0,S.appendTo((0,t.select)("#"+this.parentID+"Format_Div",a));var y=new fs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("customFormat"),locale:this.parent.locale,enableRtl:this.parent.enableRtl,value:null!==this.formatText&&"Custom"===S.value?this.formatText:null,enabled:"Custom"===S.value,change:function(i){e.formatText=i.value,e.formulaText=(0,t.select)("#"+e.parentID+"droppable",document).value},cssClass:this.parent.cssClass});y.isStringTemplate=!0,y.appendTo((0,t.select)("#"+this.parentID+"Custom_Format_Element",a))},e.prototype.getFormat=function(e){var t=e;if("olap"!==this.parent.dataType)switch(t){case"Standard":t="N";break;case"Currency":t="C";break;case"Percent":t="P";break;case"N":t="Standard";break;case"C":t="Currency";break;case"P":t="Percent"}else switch(t){case"Standard":t="N";break;case"Currency":t="C";break;case"Percent":t="P"}return t},e.prototype.createTreeView=function(){var e=this,i=(0,t.select)("#"+this.parentID+"calculateddialog",document)?(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),Ni.Dialog):null,a=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:i.element;"olap"===this.parent.dataType?this.treeObj=new ms.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"id",text:"caption",parentID:"pid",iconCss:"spriteCssClass"},allowDragAndDrop:!0,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,locale:this.parent.locale,nodeDragStart:this.dragStart.bind(this),nodeDragging:function(e){e.event.target&&e.event.target.classList.contains(st)?((0,t.removeClass)([e.clonedNode],fe),(0,t.addClass)([e.event.target],"e-copy-drop")):((0,t.addClass)([e.clonedNode],fe),(0,t.removeClass)([e.event.target],"e-copy-drop"),e.dropIndicator="e-no-drop",(0,t.addClass)([e.clonedNode.querySelector("."+o)],"e-icon-expandable"),(0,t.removeClass)([e.clonedNode.querySelector("."+o)],"e-list-icon"))},nodeClicked:this.fieldClickHandler.bind(this),nodeSelected:function(i){i.node.getAttribute("data-type")===Al?e.displayMenu(i.node):((0,t.removeClass)([i.node],"e-active"),i.cancel=!0)},nodeDragStop:this.fieldDropped.bind(this),drawNode:this.drawTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),sortOrder:"None",cssClass:this.parent.cssClass}):this.treeObj=new ms.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"formula",text:"name",iconCss:"icon"},allowDragAndDrop:!0,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,locale:this.parent.locale,cssClass:this.parent.cssClass,nodeCollapsing:this.nodeCollapsing.bind(this),nodeDragStart:this.dragStart.bind(this),nodeClicked:this.fieldClickHandler.bind(this),nodeDragStop:this.fieldDropped.bind(this),drawNode:this.drawTreeNode.bind(this),keyPress:function(e){39===e.event.keyCode&&(e.cancel=!0)},sortOrder:"Ascending"}),this.treeObj.isStringTemplate=!0,this.treeObj.appendTo((0,t.select)("#"+this.parentID+"tree",a))},e.prototype.updateNodeIcon=function(e){if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-icon-expandable.e-process")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-icon")>-1){var i=e.node.querySelector(".e-list-icon");(0,t.removeClass)([i],"e-folderCDB-icon"),(0,t.addClass)([i],"e-folderCDB-open-icon")}else if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-icon-expandable")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-open-icon")>-1){i=e.node.querySelector(".e-list-icon");(0,t.removeClass)([i],"e-folderCDB-open-icon"),(0,t.addClass)([i],"e-folderCDB-icon")}else{for(var a=this.treeObj.fields.dataSource,r=[],n=0,s=a;n<s.length;n++){var o=s[n];o.pid===e.nodeData.id.toString()&&r.push(o)}if(0!==r.length)return;this.parent.olapEngineModule.calcChildMembers=[],this.parent.olapEngineModule.getCalcChildMembers(this.parent.dataSourceSettings,e.nodeData.id.toString()),r=this.parent.olapEngineModule.calcChildMembers,this.parent.olapEngineModule.calcChildMembers=[];for(var l=0,d=r;l<d.length;l++){(i=d[l]).pid=e.nodeData.id.toString(),i.hasChildren=!1,i.spriteCssClass="e-level-members",i.caption=""===i.caption?this.parent.localeObj.getConstant("blank"):i.caption,a.push(i)}this.treeObj.addNodes(r,e.node)}},e.prototype.nodeCollapsing=function(e){e.cancel=!0},e.prototype.dragStart=function(e){var i=!1,a=e.clonedNode;if(a&&("olap"===this.parent.dataType&&(a.querySelector(".e-calc-dimension-icon,.e-calc-measure-icon,.e-measure-icon")||a.querySelector(".e-attributeCDB-icon,.e-hierarchyCDB-icon")||a.querySelector(".e-level-members,.e-namedSetCDB-icon"))||"pivot"===this.parent.dataType&&e.event.target.classList.contains(G))&&(i=!0),i){(0,t.addClass)([e.draggedNode.querySelector("."+De)],ve),(0,t.addClass)([a],"e-pivot-calc");var r=(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),Ni.Dialog);a.style.zIndex=(r.zIndex+1).toString(),a.style.display="inline"}else e.cancel=!0},e.prototype.drawTreeNode=function(e){if("olap"===this.parent.dataType){e.node.querySelector(".e-measure-icon")&&(e.node.querySelector(".e-list-icon").style.display="none");var i=e.nodeData;e.node.setAttribute("data-field",i.id),e.node.setAttribute("data-caption",i.caption);var a=e.node.querySelector("."+ye);if(e.nodeData&&e.nodeData.type===Al&&a&&e.node.querySelector(".e-list-icon.e-calc-member")){e.node.setAttribute("data-type",i.type),e.node.setAttribute("data-membertype",i.fieldType),e.node.setAttribute("data-hierarchy",i.parentHierarchy?i.parentHierarchy:""),e.node.setAttribute("data-formula",i.formula);var r=i.formatString?this.formatTypes.indexOf(i.formatString)>-1?i.formatString:"Custom":"None";e.node.setAttribute("data-formatString",r),e.node.setAttribute("data-customformatstring","Custom"===r?i.formatString:"");var n=(0,t.createElement)("span",{className:Kt+" e-icons e-list-icon"});if(a.classList.add("e-calcfieldmember"),this.parent.isAdaptive){var s=(0,t.createElement)("span",{className:"e-list-edit-icon"+(this.isEdit&&this.currentFieldName===i.id?" e-edited ":" e-edit ")+o}),l=(0,t.createElement)("div",{className:"e-list-header-icon"});l.appendChild(s),l.appendChild(n),a.appendChild(l)}else a.appendChild(n)}if(this.parent.isAdaptive){var d=e.node.querySelector("."+ye);if(e.node&&e.node.querySelector(".e-list-icon")&&d){var h=e.node.querySelector(".e-list-icon");d.insertBefore(h,e.node.querySelector(".e-list-text"))}e.node&&e.node.querySelector(".e-calcMemberGroupCDB,.e-measureGroupCDB-icon,.e-folderCDB-icon")&&(e.node.querySelector("."+jt).style.display="none"),e.node&&e.node.querySelector(".e-level-members")&&(e.node.querySelector(".e-list-icon").style.display="none")}(e.node.querySelector(".e-calc-dimension-icon,.e-calc-measure-icon,.e-measure-icon")||e.node.querySelector(".e-attributeCDB-icon,.e-hierarchyCDB-icon")||e.node.querySelector(".e-level-members,.e-namedSetCDB-icon"))&&(0,t.addClass)([e.node],b)}else{i=e.nodeData.field;e.node.setAttribute("data-field",i),e.node.setAttribute("data-caption",e.nodeData.caption),e.node.setAttribute("data-type",e.nodeData.type);var p=Di.getFieldByName(i,this.parent.dataSourceSettings.formatSettings);if(e.node.setAttribute("data-formatString",p?p.format:""),p){var u=this.getFormat(p.format);r=u?this.formatTypes.indexOf(u)>-1?p.format:"Custom":"None";e.node.setAttribute("data-customformatstring","Custom"===r?u:""),e.node.setAttribute("data-formatString",p?r:"")}var c=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("dragField")},className:o+" e-drag"}),g=(0,t.createElement)("div",{className:" e-iconspace"});(0,t.prepend)([c],e.node.querySelector("."+ye)),(0,t.append)([g,e.node.querySelector("."+nt)],e.node.querySelector("."+ye)),this.getMenuItems(this.parent.engineModule.fieldList[i].type).length<=0?(0,t.removeClass)([e.node.querySelector("."+nt)],o):e.node.querySelector("."+nt).setAttribute("title",this.parent.localeObj.getConstant("format")),this.parent.engineModule.fieldList[i].aggregateType===Al&&(e.node.querySelector("."+nt).setAttribute("title",this.parent.localeObj.getConstant("remove")),(0,t.addClass)([e.node.querySelector("."+nt)],Kt),(0,t.addClass)([e.node.querySelector(".e-iconspace")],[bt,o,"e-list-icon"]),e.node.querySelector("."+bt).setAttribute("title",this.parent.localeObj.getConstant("edit")),e.node.querySelector("."+bt).setAttribute("aria-disabled","false"),e.node.querySelector("."+bt).setAttribute("tabindex","-1"),(0,t.removeClass)([e.node.querySelector("."+nt)],nt),(0,t.removeClass)([e.node.querySelector(".e-iconspace")],"e-iconspace"))}},e.prototype.createTypeContainer=function(e){for(var i=(0,t.createElement)("div",{id:this.parentID+"control_container",className:lt}),a=this.getMenuItems(this.parent.engineModule.fieldList[e].type),r=0;r<a.length;r++){var n=(0,t.createElement)("input",{id:this.parentID+"radio"+e+a[r],attrs:{type:"radio","data-ftxt":e,"data-value":a[r]},className:"e-pivot-calc-radio"});i.appendChild(n)}return i},e.prototype.getMenuItems=function(e,i){for(var a=(0,t.isNullOrUndefined)(i)?this.parent.aggregateTypes:i,r=[],n=this.getValidSummaryType(),s=0;s<a.length;s++)n.indexOf(a[s])>-1&&r.indexOf(a[s])<0&&((a[s]!==Ml&&a[s]!==Pl||"number"===e)&&"number"!==e||r.push(a[s]));return r},e.prototype.getValidSummaryType=function(){return[Ml,Pl,Ol,"Avg",Dl,"Min","Max",Nl,El,Il,Fl,Ll]},e.prototype.getAccordionData=function(e){for(var t=[],i=Object.keys(e.engineModule.fieldList),a=0,r=i.length;a<r;a++){var n=i[a];t.push({header:"<input id="+this.parentID+"_"+a+" class="+Ze+' type="checkbox" data-field='+n+' data-caption="'+this.parent.engineModule.fieldList[n].caption+'" data-type='+this.parent.engineModule.fieldList[n].type+"/>",content:this.parent.engineModule.fieldList[n].aggregateType===Al||this.getMenuItems(this.parent.engineModule.fieldList[n].type).length<1?"":this.createTypeContainer(n).outerHTML,iconCss:this.parent.engineModule.fieldList[n].aggregateType===Al?"e-list-icon "+(this.isEdit&&this.currentFieldName===n?"e-edited":"e-edit"):""})}return t},e.prototype.renderMobileLayout=function(e){var i=this;e.items[4].content=this.renderDialogElements().outerHTML,e.dataBind();var a=(0,t.select)("#"+this.parentID+"calculateddialog",document)?(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),Ni.Dialog):null,r=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:a.element;this.parent.isAdaptive&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+st)&&this.createDropElements();var n=new Os.Button({cssClass:this.parent.cssClass,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});if(n.isStringTemplate=!0,n.appendTo((0,t.select)("#"+this.parentID+"cancelBtn",r)),n.element&&(n.element.onclick=this.cancelBtnClick.bind(this)),null!==this.parent.dialogRenderer.parentElement.querySelector("."+st)&&this.parent.isAdaptive){var s=new Os.Button({cssClass:this.parent.cssClass,isPrimary:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});s.isStringTemplate=!0,s.appendTo((0,t.select)("#"+this.parentID+"okBtn",r));var o=new fs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName"),locale:this.parent.locale,enableRtl:this.parent.enableRtl,change:function(e){i.fieldText=e.value,i.formulaText=(0,t.select)("#"+i.parentID+"droppable",document).value},cssClass:this.parent.cssClass});if(o.isStringTemplate=!0,o.appendTo((0,t.select)("#"+this.parentID+"ddlelement",r)),null!==this.formulaText&&null!==(0,t.select)("#"+this.parentID+"droppable",this.parent.dialogRenderer.parentElement))(0,t.select)("#"+this.parentID+"droppable",this.parent.dialogRenderer.parentElement).value=this.formulaText;null!==this.fieldText&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+$e)&&(this.parent.dialogRenderer.parentElement.querySelector("."+$e).value=this.fieldText,o.value=this.fieldText),s.element&&(s.element.onclick=this.applyFormula.bind(this))}else if(this.parent.isAdaptive){var l=new Os.Button({cssClass:this.parent.cssClass,isPrimary:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});if(l.isStringTemplate=!0,l.appendTo((0,t.select)("#"+this.parentID+"addBtn",r)),"olap"===this.parent.dataType)this.treeObj=new ms.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"id",text:"caption",parentID:"pid",iconCss:"spriteCssClass"},showCheckBox:!0,autoCheck:!1,sortOrder:"None",enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,nodeClicked:this.fieldClickHandler.bind(this),drawNode:this.drawTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:function(e){(0,t.removeClass)([e.node],"e-active"),e.cancel=!0},cssClass:this.parent.cssClass}),this.treeObj.isStringTemplate=!0,this.treeObj.appendTo((0,t.select)("#"+this.parentID+"accordDiv",r));else{var d=new ms.Accordion({items:this.getAccordionData(this.parent),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,expanding:this.accordionExpand.bind(this),clicked:this.accordionClickHandler.bind(this),created:this.accordionCreated.bind(this)});d.isStringTemplate=!0,d.appendTo((0,t.select)("#"+this.parentID+"accordDiv",r)),this.updateType()}l.element&&(l.element.onclick=this.addBtnClick.bind(this))}},e.prototype.accordionExpand=function(e){if(0===e.element.querySelectorAll(".e-radio-wrapper").length)for(var i=Object.keys(this.parent.engineModule.fieldList),a=0,r=i.length;a<r;a++){var n=i[a],s="number"!==this.parent.engineModule.fieldList[n].type?[Ml,Pl]:[Ol,Ml,"Avg",Dl,"Min","Max",Pl,Nl,El,Il,Fl,Ll],o=void 0;if(n===e.element.querySelector("[data-field").getAttribute("data-field"))for(var l=0;l<s.length;l++)(o=new Os.RadioButton({label:this.parent.localeObj.getConstant(s[l]),name:"AggregateType"+n,checked:e.element.querySelector("[data-type").getAttribute("data-type")===s[l],change:this.onChange.bind(this),locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass})).isStringTemplate=!0,o.appendTo((0,t.select)("#"+this.parentID+"radio"+n+s[l],e.element))}},e.prototype.onChange=function(e){var t=e.event.target.parentElement.querySelector(".e-label").innerText,i=e.event.target.closest(".e-acrdn-item").querySelector("[data-field").getAttribute("data-caption");e.event.target.closest(".e-acrdn-item").querySelector(".e-label").innerText=i+" ("+t+")",e.event.target.closest(".e-acrdn-item").querySelector("[data-type").setAttribute("data-type",e.event.target.getAttribute("data-value"))},e.prototype.updateType=function(){for(var e=Object.keys(this.parent.engineModule.fieldList),i=(0,t.select)("#"+this.parentID+"calculateddialog",document)?(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),Ni.Dialog):null,a=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:i.element,r=0,n=e.length;r<n;r++){var s=e[r],o=null;o="number"===this.parent.engineModule.fieldList[s].type&&"include"!==this.parent.engineModule.fieldList[s].type&&"exclude"!==this.parent.engineModule.fieldList[s].type||"DistinctCount"===this.parent.engineModule.fieldList[s].aggregateType?void 0!==this.parent.engineModule.fieldList[s].aggregateType?this.parent.engineModule.fieldList[s].aggregateType:Ol:Ml;var l=new Os.CheckBox({label:this.parent.engineModule.fieldList[s].caption+" ("+this.parent.localeObj.getConstant(o)+")",locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass});l.isStringTemplate=!0,l.appendTo((0,t.select)("#"+this.parentID+"_"+r,a)),(0,t.select)("#"+this.parentID+"_"+r,a).setAttribute("data-field",s),(0,t.select)("#"+this.parentID+"_"+r,a).setAttribute("data-type",o)}},e.prototype.cancelBtnClick=function(){this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.addBtnClick=function(){var e="",t=null,i=null;if("pivot"===this.parent.dataType){for(var a=document.querySelectorAll(".e-accordion .e-check"),r=0;r<a.length;r++)if(t=a[r].parentElement.querySelector("[data-field]").getAttribute("data-field"),-1===(i=a[r].parentElement.querySelector("[data-field]").getAttribute("data-type")).indexOf(Al))e=e+'"'+i+"("+t+')"';else for(var n=0;n<this.parent.dataSourceSettings.calculatedFieldSettings.length;n++)if(this.parent.dataSourceSettings.calculatedFieldSettings[n].name===t){e+=this.parent.dataSourceSettings.calculatedFieldSettings[n].formula;break}}else for(var s=this.treeObj.getAllCheckedNodes(),o=this.parent.olapEngineModule,l=0,d=s;l<d.length;l++){var h=d[l];e+=o.fieldList[h]&&o.fieldList[h].type===Al?o.fieldList[h].tag:h}this.formulaText=null!==this.formulaText?this.formulaText+e:e,this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.createCalculatedFieldDialog=function(e){if(this.parent.isAdaptive&&"pivotfieldlist"===this.parent.getModuleName())this.renderAdaptiveLayout(!e||void 0===e.edit||e.edit),this.isEdit=e&&void 0!==e.edit?e.edit:this.isEdit;else if(!this.parent.isAdaptive){if(this.isEdit=!(!e||void 0===e.edit)&&e.edit,this.renderDialogLayout(),e&&e.edit){var i=this.treeObj.element.querySelector('li[data-field="'+e.fieldName+'"]');if(i)if((0,t.addClass)([i],["e-active","e-node-focus"]),i.setAttribute("aria-selected","true"),i.id=this.treeObj.element.id+"_active","pivot"===this.parent.dataType){var a={event:{target:i.querySelector(".e-list-icon.e-edit.e-icons")}};this.fieldClickHandler(a)}else this.displayMenu(i)}var r=(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),Ni.Dialog);r.element.style.top=parseInt(r.element.style.top,10)<0?"0px":r.element.style.top}},e.prototype.renderDialogLayout=function(){this.newFields=(0,t.extend)([],this.parent.dataSourceSettings.calculatedFieldSettings,null,!0),this.createDialog();var e=(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),Ni.Dialog);e.content=this.renderDialogElements(),e.refresh();var i=new fs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName"),locale:this.parent.locale,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass});i.isStringTemplate=!0,i.appendTo((0,t.select)("#"+this.parentID+"ddlelement",e.element)),this.createDropElements(),this.createTreeView(),this.droppable=new t.Droppable((0,t.select)("#"+this.parentID+"droppable",e.element)),this.keyboardEvents=new t.KeyboardEvents(e.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:{moveRight:"rightarrow",enter:"enter",shiftE:"shift+E",delete:"delete"},eventName:"keydown"})},e.prototype.createConfirmDialog=function(e,i,a,r,n){var s=(0,t.createElement)("div",{id:this.parentID+"_CalculatedFieldErrorDialog",className:re});this.parent.element.appendChild(s);var o=new Ni.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:r?this.removeCalcField.bind(this,n):this.replaceFormula.bind(this,a),isFlat:!1,buttonModel:{cssClass:ie+(this.parent.cssClass?" "+this.parent.cssClass:""),content:r?this.parent.localeObj.getConstant("yes"):this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.closeErrorDialog.bind(this),isFlat:!1,buttonModel:{cssClass:ae+(this.parent.cssClass?" "+this.parent.cssClass:""),content:r?this.parent.localeObj.getConstant("no"):this.parent.localeObj.getConstant("cancel")}}],header:e,content:i,isModal:!0,visible:!0,closeOnEscape:!0,target:document.body,cssClass:this.parent.cssClass,close:this.removeErrorDialog.bind(this)});o.isStringTemplate=!0,o.appendTo(s)},e.prototype.replaceFormula=function(e){var i=this.parent.dataSourceSettings;if("olap"===this.parent.dataType){for(var a=0;a<i.calculatedFieldSettings.length;a++)if(i.calculatedFieldSettings[a].name===e.name){(0,t.isNullOrUndefined)(e.hierarchyUniqueName)||(i.calculatedFieldSettings[a].hierarchyUniqueName=e.hierarchyUniqueName),i.calculatedFieldSettings[a].formatString=e.formatString,i.calculatedFieldSettings[a].formula=e.formula,this.parent.lastCalcFieldInfo=i.calculatedFieldSettings[a];break}}else for(var r=0;r<i.values.length;r++)if(i.values[r].type===Al&&i.values[r].name===e.name)for(a=0;a<i.calculatedFieldSettings.length;a++)i.calculatedFieldSettings[a].name===e.name&&(i.calculatedFieldSettings[a].formula=e.formula,this.parent.lastCalcFieldInfo=i.calculatedFieldSettings[a].properties?i.calculatedFieldSettings[a].properties:i.calculatedFieldSettings[a],this.updateFormatSettings(i,e.name,e.formatString));this.addFormula(i,e.name),this.removeErrorDialog()},e.prototype.removeErrorDialog=function(){var e=(0,t.select)("#"+this.parentID+"_CalculatedFieldErrorDialog",document),i=e?(0,t.getInstance)(e,Ni.Dialog):null;i&&!i.isDestroyed&&i.destroy(),null!==(0,t.select)("#"+this.parentID+"_CalculatedFieldErrorDialog",document)&&(0,t.remove)((0,t.select)("#"+this.parentID+"_CalculatedFieldErrorDialog",document))},e.prototype.closeErrorDialog=function(){(0,t.getInstance)((0,t.select)("#"+this.parentID+"_CalculatedFieldErrorDialog",document),Ni.Dialog).close()},e.prototype.triggerActionCompleteEvent=function(){var e={dataSourceSettings:Di.getClonedDataSourceSettings(this.parent.dataSourceSettings),actionName:cs,fieldInfo:this.parent.actionObj.fieldInfo,actionInfo:this.parent.actionObj.actionInfo},t=this.parent.isPopupView?this.parent.pivotGridModule:this.parent;t.trigger(lr,e),"Abort"!==e.actionName&&this.parent.pivotCommon&&this.parent.pivotCommon.errorDialog?this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("invalidFormula")):(this.parent&&this.parent.actionObj&&(this.parent.actionObj.actionName=e.actionName),this.closeDialog()),this.parent&&this.parent.actionObj&&(this.parent.actionObj.actionName=""),t&&t.actionObj&&(t.actionObj.actionName="")},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on(br,this.createCalculatedFieldDialog,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(br,this.createCalculatedFieldDialog)},e.prototype.destroy=function(){this.treeObj&&!this.treeObj.isDestroyed&&this.treeObj.destroy(),this.treeObj&&(this.treeObj=null),this.newFields&&(this.newFields=null),this.curMenu&&(this.curMenu=null),this.droppable&&(this.droppable=null),this.keyboardEvents&&(this.keyboardEvents=null);var e=(0,t.select)("#"+this.parentID+"ddlelement",document);e&&(0,t.getInstance)(e,fs.MaskedTextBox).destroy(),(e=(0,t.select)("#"+this.parentID+"calculateddialog",document))&&(0,t.getInstance)(e,Ni.Dialog).destroy(),(e=(0,t.select)("#"+this.parentID+"CalcContextmenu",document))&&(0,t.getInstance)(e,ms.ContextMenu).destroy(),(e=(0,t.select)("#"+this.parentID+"accordDiv",document))&&(0,t.getInstance)(e,ms.Accordion).destroy(),(e=(0,t.select)("#"+this.parentID+"_CalculatedFieldErrorDialog",document))&&(0,t.getInstance)(e,Ni.Dialog).destroy()},e}();Tl.Inject(Rl);var kl=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.getModuleName=function(){return"fieldList"},e.prototype.initiateModule=function(){if(!(0,t.select)("#"+this.parent.element.id+"_PivotFieldList",this.parent.element)){if(this.element=(0,t.createElement)("div",{id:this.parent.element.id+"_PivotFieldList",styles:"position:"+(this.parent.enableRtl?"static":"absolute")+";height:0;width:"+this.parent.element.style.width+";display:none"}),null===(0,t.select)("#"+this.parent.element.id+"containerwrapper",document)){var e=(0,t.createElement)("div",{id:this.parent.element.id+"containerwrapper",styles:"height:"+(isNaN(this.parent.height)?this.parent.height:this.parent.height+"px")});this.parent.element.parentElement.appendChild(e),e.appendChild(this.element),e.appendChild(this.parent.element)}else(0,t.select)("#"+this.parent.element.id+"containerwrapper",document).appendChild(this.element);this.parent.pivotFieldListModule=new Tl({dataSourceSettings:{providerType:this.parent.dataSourceSettings.providerType,rows:[],columns:[],values:[],filters:[]},spinnerTemplate:this.parent.spinnerTemplate,allowDeferLayoutUpdate:this.parent.allowDeferLayoutUpdate,renderMode:"Popup",allowCalculatedField:this.parent.allowCalculatedField,showValuesButton:this.parent.showValuesButton,enableRtl:this.parent.enableRtl,locale:this.parent.locale,target:this.parent.element.parentElement,aggregateTypes:this.parent.aggregateTypes,maxNodeLimitInMemberEditor:this.parent.maxNodeLimitInMemberEditor,aggregateCellInfo:this.parent.bindTriggerEvents.bind(this.parent),onHeadersSort:this.parent.bindTriggerEvents.bind(this.parent),cssClass:this.parent.cssClass,enableFieldSearching:this.parent.enableFieldSearching,enableHtmlSanitizer:this.parent.enableHtmlSanitizer}),this.parent.pivotFieldListModule.isPopupView=!0,this.parent.pivotFieldListModule.pivotGridModule=this.parent,this.parent.pivotFieldListModule.appendTo(this.element)}},e.prototype.updateControl=function(){if(this.parent.allowDeferLayoutUpdate&&(this.parent.actionObj.actionName="Field list refreshed"),this.element){for(var e=void 0,i=0;i<this.parent.toolbar.length;i++)"FieldList"===this.parent.toolbar[i]&&(e=!0);e&&this.parent.showToolbar&&"Server"===this.parent.dataSourceSettings.mode?this.element.style.display="none":this.element.style.display="block",(0,t.prepend)([this.element],this.parent.element),this.parent.showGroupingBar&&this.parent.groupingBarModule?(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.update.bind(this))):(0,t.isNullOrUndefined)(this.element.querySelector("."+f))||((0,t.setStyleAttribute)(this.element.querySelector("."+f),{left:"auto"}),this.parent.enableRtl?(0,t.removeClass)([this.element.querySelector("."+f)],"e-fieldlist-left"):(0,t.addClass)([this.element.querySelector("."+f)],"e-fieldlist-left")),(0,t.setStyleAttribute)(this.element,{width:(0,t.formatUnit)(this.parent.element.offsetWidth)})}this.parent.pivotFieldListModule.update(this.parent)},e.prototype.update=function(){var e;if((e="Table"!==this.parent.currentView?this.parent.chart?this.parent.pivotChartModule.getCalulatedWidth():e:this.parent.grid?this.parent.grid.element.offsetWidth:e)&&!(0,t.isNullOrUndefined)(this.element.querySelector("."+f))){var i=e<400?this.parent.minWidth||400:e;(0,t.setStyleAttribute)(this.element.querySelector("."+f),{left:(0,t.formatUnit)(this.parent.enableRtl?-Math.abs(i-this.element.querySelector("."+f).offsetWidth):i-this.element.querySelector("."+f).offsetWidth)}),this.parent.enableRtl?(0,t.addClass)([this.element.querySelector("."+f)],"e-fieldlist-left"):(0,t.removeClass)([this.element.querySelector("."+f)],"e-fieldlist-left")}},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(vr,this.initiateModule,this),this.parent.on(pr,this.updateControl,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(vr,this.initiateModule),this.parent.off(pr,this.updateControl))},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotFieldListModule&&!this.parent.pivotFieldListModule.isDestroyed&&(this.parent.pivotFieldListModule.destroy(),this.parent.pivotFieldListModule=null,(0,t.isNullOrUndefined)((0,t.select)("#"+this.parent.element.id+"_PivotFieldList",document))||(0,t.remove)((0,t.select)("#"+this.parent.element.id+"_PivotFieldList",document)))},e}(),jl=function(){function e(e){this.parent=e}return e.prototype.render=function(){(!this.parent.pivotButtonModule||this.parent.pivotButtonModule&&this.parent.pivotButtonModule.isDestroyed)&&new yl(this.parent),this.createPivotButtons();for(var e=[],i=(e=e.concat([].slice.call(this.parent.groupingBarModule.rowPanel.querySelectorAll("."+L)))).length,a=0;a<i;a++){if(!this.parent.isTabular){var r=(0,t.createElement)("span",{className:"e-indent-div",styles:this.parent.isTabular?"auto":"width:"+24*a+"px"});(0,t.prepend)([r],e[a])}}},e.prototype.createPivotButtons=function(){var e=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],a=Array.prototype.slice.call(this.parent.element.querySelectorAll("."+pe+",."+ue+",."+ce+",."+ge+",."+me));(0,t.isNullOrUndefined)(this.parent.element.querySelector("."+ui))&&a.push(this.parent.groupingBarModule.rowPanel);for(var r=0;r<a.length;r++){var n=a[r];this.parent.dataSourceSettings.values.length>0&&n.classList.contains(ai)&&this.parent.dataSourceSettings.columns.length>0&&n.classList.contains(ii)||(n.innerHTML="")}if("pivot"===this.parent.dataType&&this.parent.dataSourceSettings.dataSource&&(!(this.parent.dataSourceSettings.dataSource instanceof i.DataManager)&&this.parent.dataSourceSettings.dataSource.length>0||this.parent.dataSourceSettings.dataSource instanceof i.DataManager&&this.parent.engineModule.data&&this.parent.engineModule.data.length>0)||"olap"===this.parent.dataType&&this.parent.dataSourceSettings.url&&""!==this.parent.dataSourceSettings.url||"Server"===this.parent.dataSourceSettings.mode&&this.parent.dataSourceSettings.url&&""!==this.parent.dataSourceSettings.url){var s=["rows","columns","values","filters"];if("pivot"===this.parent.dataType&&this.parent.groupingBarSettings.showFieldsPanel){s.push("all-fields"),e.push([]);for(var o=0,l=this.parent.engineModule&&this.parent.engineModule.fieldList?Object.keys(this.parent.engineModule.fieldList):[];o<l.length;o++){var d=l[o];this.parent.engineModule.fieldList[d]&&!this.parent.engineModule.fieldList[d].isSelected&&e[e.length-1].push(Di.getFieldInfo(d,this.parent,!0).fieldItem)}}r=0;for(var h=e.length;r<h;r++)if(e[r]){var p={field:e[r],axis:s[r].toString()};this.parent.notify(yr,p)}}},e}(),ql=function(){function e(e){this.rowAxisWidth=0,this.parent=e,this.parent.groupingBarModule=this,this.resColWidth=this.parent.isAdaptive?180:249,this.addEventListener(),this.parent.axisFieldModule=new jl(this.parent),this.touchObj=new t.Touch(this.parent.element,{tapHold:this.tapHoldHandler.bind(this)})}return e.prototype.getModuleName=function(){return"groupingBar"},e.prototype.renderLayout=function(){this.groupingTable=(0,t.createElement)("div",{className:he});var e=(0,t.createElement)("div",{className:P});this.rightAxisPanel=(0,t.createElement)("div",{className:N});var i=(0,t.createElement)("div",{className:"e-axis-row "+ut+"container"}),a=(0,t.createElement)("div",{className:"e-axis-column "+ut+"container"}),r=(0,t.createElement)("div",{className:"e-axis-value "+ut+"container"}),n=(0,t.createElement)("div",{className:ct+" "+ut+"container"});this.rowPanel=(0,t.createElement)("div",{className:ue+" "+se+(this.parent.isTabular?" e-tabular-group-rows":"")});var s=(0,t.createElement)("div",{className:ce+" "+oe}),o=(0,t.createElement)("div",{className:ge+" "+le}),l=(0,t.createElement)("div",{className:me+" "+de});i.appendChild(this.rowPanel),a.appendChild(s),r.appendChild(o),n.appendChild(l),this.rowAxisPanel=i,e.appendChild(r),e.appendChild(i),this.rightAxisPanel.appendChild(n),this.rightAxisPanel.appendChild(a),this.groupingTable.appendChild((0,t.createElement)("div",{styles:"display:flex;"})),this.groupingTable.firstElementChild.appendChild(e),this.groupingTable.firstElementChild.appendChild(this.rightAxisPanel),"pivot"===this.parent.dataType&&null!=this.parent.groupingBarSettings&&this.parent.groupingBarSettings.showFieldsPanel&&(this.gridPanel=this.createToolbarUI(this.groupingTable)),this.groupingTable.classList.add(di),this.groupingTable.querySelector("."+ue).classList.add(ui);for(var d=0,h=[this.rowPanel,s,o,l];d<h.length;d++){var p=h[d];this.parent.groupingBarSettings.allowDragAndDrop&&new t.Droppable(p,{}),this.unWireEvent(p),this.wireEvent(p)}"Table"!==this.parent.displayOption.view&&"Table"!==this.parent.groupingBarSettings.displayMode?(this.groupingChartTable=this.groupingTable.cloneNode(!0),(0,t.select)("#"+this.parent.element.id+"_AllFields",this.groupingChartTable)&&((0,t.select)("#"+this.parent.element.id+"_AllFields",this.groupingChartTable).remove(),this.chartPanel=this.createToolbarUI(this.groupingChartTable)),this.groupingChartTable.classList.add(si),this.groupingChartTable.classList.remove(di),this.groupingChartTable.querySelector("."+ue).classList.add(ti),this.groupingChartTable.querySelector("."+ue).classList.remove(ui),this.parent.chartSettings.enableMultipleAxis&&this.parent.chartSettings.chartSeries&&["Pie","Pyramid","Doughnut","Funnel"].indexOf(this.parent.chartSettings.chartSeries.type)<0?this.groupingChartTable.querySelector("."+ge).classList.add("e-group-chart-multi-values"):this.groupingChartTable.querySelector("."+ge).classList.add(ai),this.parent.chartSettings.chartSeries&&["Pie","Pyramid","Doughnut","Funnel"].indexOf(this.parent.chartSettings.chartSeries.type)>-1?this.groupingChartTable.querySelector("."+ce).classList.add(ii):this.groupingChartTable.querySelector("."+ce).classList.add("e-group-chart-accumulation-column"),this.groupingChartTable.querySelector("."+me).classList.add("e-group-chart-filters")):this.groupingChartTable=void 0,"Chart"!==this.parent.displayOption.view&&"Chart"!==this.parent.groupingBarSettings.displayMode||(this.groupingTable=void 0)},e.prototype.appendToElement=function(){var e=this.groupingTable?this.groupingTable:this.groupingChartTable;if(!(0,t.isNullOrUndefined)(e)){var i=e.getElementsByClassName(P)[0],a=e.getElementsByClassName(me+" "+de)[0],r=e.getElementsByClassName(ce+" "+oe)[0],n=e.getElementsByClassName(ge+" "+le)[0];if((this.parent.element.querySelector("."+gt)||this.parent.element.querySelector("."+ei))&&this.parent.showGroupingBar){if(this.parent.element.querySelector("."+he))for(var s=this.parent.element.querySelectorAll("."+he),o=0;o<s.length;o++){var l=s[o];(0,t.remove)(l)}if(this.groupingChartTable)if((0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element)){(0,t.setStyleAttribute)(this.groupingChartTable,{width:(0,t.formatUnit)(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())});var d=this.groupingChartTable.getElementsByClassName(P)[0],h=this.groupingChartTable.getElementsByClassName(ge+" "+le)[0];if(this.parent.isAdaptive&&(this.parent.isTabular?(d.style.minWidth=this.parent.dataSourceSettings.rows.length*this.parent.gridSettings.columnWidth+"px",h.style.minWidth=this.parent.dataSourceSettings.rows.length*this.parent.gridSettings.columnWidth+"px"):(d.style.minWidth="180px",h.style.minWidth="180px")),this.parent.element.insertBefore(this.groupingChartTable,(0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element)),this.groupingChartTable.querySelector("."+E)&&null!=this.chartPanel&&!this.chartPanel.isDestroyed){var p=this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2;this.chartPanel.width=this.parent.isAdaptive?p:p<400?this.parent.minWidth||"398px":p,this.chartPanel.refreshOverflow(),this.parent.showFieldList&&this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.element&&(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.alignIcon.bind(this)))}}else this.groupingChartTable=void 0;if("Chart"!==this.parent.displayOption.view&&this.groupingTable){this.parent.isAdaptive&&(this.parent.isTabular?(i.style.minWidth=this.parent.dataSourceSettings.rows.length*this.parent.gridSettings.columnWidth+"px",n.style.minWidth=this.parent.dataSourceSettings.rows.length*this.parent.gridSettings.columnWidth+"px"):(i.style.minWidth="180px",n.style.minWidth="180px")),this.parent.firstColWidth&&(i.style.minWidth="auto",n.style.minWidth="auto"),a.removeAttribute("style"),r.removeAttribute("style"),this.rowPanel.removeAttribute("style");var u=void 0;if(u="olap"===this.parent.dataType?this.parent.olapEngineModule.headerContent?Object.keys(this.parent.olapEngineModule.headerContent).length:0:this.parent.engineModule.headerContent?Object.keys(this.parent.engineModule.headerContent).length:0,!(0,t.isNullOrUndefined)(u)){var c=this.parent.element.querySelector("."+qt).querySelector(".e-columnheader");c.removeAttribute("style"),(0,t.addClass)([c.querySelector("."+Be)],"e-group-row"),c.querySelector(".e-group-row").querySelector(".e-headercelldiv").style.display="none",c.querySelector(".e-group-row").querySelector(".e-sortfilterdiv").style.display="none"}if(this.parent.element.insertBefore(this.groupingTable,this.parent.element.querySelector("."+gt)),(0,t.setStyleAttribute)(this.groupingTable,{width:(0,t.formatUnit)(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.groupingTable&&this.groupingTable.querySelector("."+E)&&null!=this.gridPanel&&!this.gridPanel.isDestroyed){var g=this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2;this.gridPanel.width=this.parent.isAdaptive?g:g<400?this.parent.minWidth||"398px":g,this.gridPanel.refreshOverflow()}this.groupingTable.style.minWidth=this.parent.minWidth?this.parent.minWidth+"px":"400px",this.parent.axisFieldModule.render(),this.setGridRowWidth();var m=this.parent.element.querySelector("."+qt).querySelector("colgroup").children[0],f=this.parent.isTabular?this.rowAxisWidth:parseInt(m.style.width,10),v=(0,t.formatUnit)(this.groupingTable.offsetWidth-f);(0,t.setStyleAttribute)(n,{width:f+"px"}),(0,t.setStyleAttribute)(this.rightAxisPanel,{width:v}),this.groupingTable.style.display="";var S=n.offsetHeight/2;"Chart"===this.parent.displayOption.primary&&(this.groupingTable.style.display="none"),S>r.offsetHeight&&((0,t.setStyleAttribute)(a,{height:(0,t.formatUnit)(S)}),(0,t.setStyleAttribute)(r,{height:(0,t.formatUnit)(S+2)}));var y=this.parent.element.querySelector("."+qt).offsetHeight;(0,t.setStyleAttribute)(this.rowPanel,{height:y+"px"}),this.parent.element.querySelector("."+qt).querySelector(".e-rhandler")&&(this.parent.element.querySelector("."+qt).querySelector(".e-rhandler").style.height=y+"px");for(var b=[].slice.call(this.parent.element.querySelector("."+qt).querySelector("thead").querySelectorAll("tr")).filter((function(e){return e.childNodes.length>0})),C=y/b.length,x=0,w=b;x<w.length;x++){var T=w[x];(0,t.setStyleAttribute)(T,{height:C+"px"});for(var M=0,D=[].slice.call(T.querySelectorAll(".e-rhandler"));M<D.length;M++){var O=D[M];(0,t.setStyleAttribute)(O,{height:C+"px"})}}}else this.parent.axisFieldModule.render(),this.updateChartAxisHeight();if(this.parent.showToolbar&&"Both"===this.parent.displayOption.view){var N="Table"===this.parent.currentView?".e-chart-grouping-bar":".e-pivot-grouping-bar",I=this.parent.element.querySelector(N);I&&(I.style.display="none")}}}},e.prototype.updateChartAxisHeight=function(){if(this.groupingChartTable&&(0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element)){var e=this.groupingChartTable.querySelector("."+N),i=this.groupingChartTable.querySelector("."+P),a=this.groupingChartTable.querySelector("."+ue),r=this.groupingChartTable.querySelector("."+ge),n=this.groupingChartTable.querySelector("."+me),s=this.groupingChartTable.querySelector("."+ce);if(a&&s&&(a.style.height="auto",s.style.height="auto",a.offsetHeight>0&&s.offsetHeight>0)){var o=a.offsetHeight>s.offsetHeight?a.offsetHeight:s.offsetHeight;(0,t.setStyleAttribute)(a,{height:(0,t.formatUnit)(o)}),(0,t.setStyleAttribute)(s,{height:(0,t.formatUnit)(o)})}if(r&&n&&(r.style.height="auto",n.style.height="auto",r.offsetHeight>0&&n.offsetHeight>0)){o=r.offsetHeight>n.offsetHeight?r.offsetHeight:n.offsetHeight;(0,t.setStyleAttribute)(r,{height:(0,t.formatUnit)(o)}),(0,t.setStyleAttribute)(n,{height:(0,t.formatUnit)(o)})}var l=(0,t.formatUnit)(this.groupingChartTable.offsetWidth-Math.ceil(i.getBoundingClientRect().width));(0,t.setStyleAttribute)(r,{width:Math.ceil(r.getBoundingClientRect().width)+"px"}),(0,t.setStyleAttribute)(e,{width:l})}},e.prototype.refreshUI=function(){if(this.groupingChartTable){if((0,t.setStyleAttribute)(this.groupingChartTable,{width:(0,t.formatUnit)(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.groupingChartTable.querySelector("."+E)&&null!=this.chartPanel&&!this.chartPanel.isDestroyed){var e=this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2;this.chartPanel.width=this.parent.isAdaptive?e:e<400?this.parent.minWidth||"398px":e,this.chartPanel.refreshOverflow()}this.updateChartAxisHeight(),this.parent.showFieldList&&this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.element&&(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.alignIcon.bind(this)))}if(this.groupingTable){var i=this.groupingTable.getElementsByClassName(ge+" "+le)[0];if((0,t.setStyleAttribute)(this.groupingTable,{width:(0,t.formatUnit)(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.groupingTable&&this.groupingTable.querySelector("."+E)&&null!=this.gridPanel&&!this.gridPanel.isDestroyed){var a=this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2;this.gridPanel.width=this.parent.isAdaptive?a:a<400?this.parent.minWidth||"398px":a,this.gridPanel.refreshOverflow()}this.groupingTable.style.minWidth=this.parent.minWidth?this.parent.minWidth+"px":"400px";var r=this.parent.element.querySelector("."+qt).querySelector("colgroup").children[0],n=this.parent.isTabular?this.rowAxisWidth:parseInt(r.style.width,10),s=(0,t.formatUnit)(this.groupingTable.offsetWidth-n);if((0,t.setStyleAttribute)(i,{width:n+"px"}),(0,t.setStyleAttribute)(this.rightAxisPanel,{width:s}),this.parent.showFieldList&&this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.element&&(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.alignIcon.bind(this))),!this.parent.grid.element.querySelector(".e-group-row")){var o=this.parent.element.querySelector("."+qt).querySelector(".e-columnheader");(0,t.addClass)([o.querySelector("."+Be)],"e-group-row"),(0,t.setStyleAttribute)(this.rowPanel,{height:this.parent.element.querySelector("."+qt).offsetHeight+"px"}),o.querySelector(".e-group-row").appendChild(this.rowAxisPanel),(0,t.setStyleAttribute)(o.querySelector(".e-group-row").querySelector(".e-headercelldiv"),{display:"none"}),(0,t.setStyleAttribute)(o.querySelector(".e-group-row").querySelector(".e-sortfilterdiv"),{display:"none"});var l=this.parent.element.querySelector("."+qt).offsetHeight;(0,t.setStyleAttribute)(this.rowPanel,{height:l+"px"}),this.parent.element.querySelector("."+qt).querySelector(".e-rhandler")&&(this.parent.element.querySelector("."+qt).querySelector(".e-rhandler").style.height=l+"px");for(var d=[].slice.call(this.parent.element.querySelector("."+qt).querySelector("thead").querySelectorAll("tr")).filter((function(e){return e.childNodes.length>0})),h=l/d.length,p=0,u=d;p<u.length;p++){var c=u[p];(0,t.setStyleAttribute)(c,{height:h+"px"});for(var g=0,m=[].slice.call(c.querySelectorAll(".e-rhandler"));g<m.length;g++){var f=m[g];f.parentElement.parentElement.querySelector("."+Si)||(0,t.setStyleAttribute)(f,{height:h+"px"})}}}}},e.prototype.alignIcon=function(){if(this.parent.pivotFieldListModule){var e=this.parent.pivotFieldListModule.element,i=void 0;if(i="Table"===this.parent.currentView?this.parent.grid?this.parent.grid.element.offsetWidth:i:this.parent.chart?this.parent.pivotChartModule.getCalulatedWidth():i){var a=this.parent.minWidth?this.parent.minWidth:this.parent.isAdaptive?300:400,r=i<a?a:i;(0,t.setStyleAttribute)(e.querySelector("."+f),{left:(0,t.formatUnit)(this.parent.enableRtl?-Math.abs(r-e.querySelector("."+f).offsetWidth):r-e.querySelector("."+f).offsetWidth)})}}},e.prototype.setGridRowWidth=function(){var e=this.parent.element.querySelector("."+qt).querySelector(".e-columnheader");(0,t.addClass)([e.querySelector("."+Be)],"e-group-row"),e.querySelector(".e-group-row").appendChild(this.rowAxisPanel);var i=this.parent.element.querySelector("."+qt).querySelector("colgroup").children[0];if(this.rowPanel.querySelector("."+A))if(this.parent.isAdaptive){if(!this.parent.firstColWidth){if((r=this.parent.grid.columns)&&r.length>0)if(this.parent.isTabular){this.rowAxisWidth=this.parent.dataSourceSettings.rows.length*this.parent.gridSettings.columnWidth;for(var a=0;a<this.parent.engineModule.rowMaxLevel;a++)r[a].width=this.parent.gridSettings.columnWidth}else r[0].width=this.resColWidth;this.parent.posCount=0,this.parent.grid.headerModule.refreshUI()}}else{var r,n=[].slice.call(this.rowPanel.querySelectorAll("."+L)),s=n[n.length-1],o=this.parent.isTabular?0:s.querySelector(".e-indent-div").offsetWidth+20,l=s.querySelector("."+A).offsetWidth+o,d=(0,t.formatUnit)(l<this.resColWidth?this.resColWidth:l),h=this.parent.element.querySelector("."+qt).querySelector("."+Be),p=this.parent.element.querySelector("."+R).querySelector("colgroup").children[0],u=parseInt(d,10),c=this.parent.pivotColumns.length>0;(r=this.parent.grid.columns)&&r.length>0&&(r[0].width=r[0].autoFit?r[0].width:u>this.resColWidth?u:this.resColWidth);var g=void 0;g="olap"===this.parent.dataType?this.parent.renderModule.calculateColWidth(this.parent.olapEngineModule.pivotValues.length>0?this.parent.olapEngineModule.pivotValues[0].length:2):this.parent.renderModule.calculateColWidth(this.parent.dataSourceSettings.values.length>0&&this.parent.engineModule.pivotValues.length>0?this.parent.engineModule.pivotValues[0].length:2);for(var m=0;m<r.length;m++)if(0!==m)if(r[m].columns)this.parent.setCommonColumnsWidth(this.parent.renderModule.pivotColumns[m].columns,g);else if("auto"!==r[m].width){var f=r[m].customAttributes?r[m].customAttributes.cell.valueSort.levelName:"",v=this.parent.renderModule.setSavedWidth(f,g);r[m].width=r[m].autoFit||c&&this.parent.pivotColumns[m].autoFit?r[m].width:this.parent.renderModule.lastColumn&&this.parent.renderModule.lastColumn.field===r[m].field?v-3:v}else r[m].minWidth=g;if(this.parent.isTabular)if("row"===this.parent.dataSourceSettings.valueAxis)this.rowAxisWidth=this.rowAxisPanel.querySelector(".e-tabular-group-rows").getBoundingClientRect().width;else{var S=this.rowAxisPanel.querySelectorAll("."+L);this.rowAxisWidth=this.getPivotButtonsTotalWidth(S),0===this.parent.engineModule.rowMaxLevel&&1===S.length&&(this.rowAxisWidth=250),.8*this.parent.element.getBoundingClientRect().width<=this.rowAxisWidth&&(this.rowAxisWidth=S.length*this.parent.gridSettings.columnWidth)}this.parent.posCount=0,this.parent.setGridColumns(this.parent.grid.columns),this.parent.firstColWidth||(d=r[0].autoFit?r[0].width.toString():d,i.style.width=d,p.style.width=d,h.style.width=d,(0,t.setStyleAttribute)(h,{width:d}))}else this.parent.grid.columns&&this.parent.grid.columns.length>0&&(this.parent.grid.columns[0].width=this.parent.grid.columns[0].width>this.resColWidth?this.parent.grid.columns[0].width:this.resColWidth),this.parent.grid.headerModule.refreshUI();(this.groupingTable||this.groupingChartTable)&&this.refreshUI()},e.prototype.wireEvent=function(e){t.EventHandler.add(e,"mouseover",this.dropIndicatorUpdate,this),t.EventHandler.add(e,"mouseleave",this.dropIndicatorUpdate,this)},e.prototype.unWireEvent=function(e){t.EventHandler.remove(e,"mouseover",this.dropIndicatorUpdate),t.EventHandler.remove(e,"mouseleave",this.dropIndicatorUpdate)},e.prototype.dropIndicatorUpdate=function(e){(this.parent.isDragging&&e.target.classList.contains(ne)&&"mouseover"===e.type||!this.parent.isDragging||!e.target.classList.contains(ne)&&"mouseleave"===e.type)&&((0,t.removeClass)([].slice.call(this.parent.element.querySelectorAll("."+W)),Q),(0,t.removeClass)([].slice.call(this.parent.element.querySelectorAll("."+W+"-last")),Q))},e.prototype.tapHoldHandler=function(e){var i=(0,t.closest)(e.originalEvent.target,"."+A);if(!(0,t.isNullOrUndefined)(i)&&this.parent.isAdaptive){var a=i.getBoundingClientRect();return this.parent.contextMenuModule.fieldElement=i,void this.parent.contextMenuModule.menuObj.open(a.top,a.left)}},e.prototype.RefreshFieldsPanel=function(){if("pivot"===this.parent.dataType&&null!=this.parent.groupingBarSettings){if((0,t.selectAll)("#"+this.parent.element.id+"_AllFields",this.parent.element).length>0)for(var e=0,i=(0,t.selectAll)("#"+this.parent.element.id+"_AllFields",this.parent.element);e<i.length;e++){i[e].remove()}this.parent.groupingBarSettings.showFieldsPanel&&(this.groupingChartTable&&"Table"!==this.parent.displayOption.view&&"Table"!==this.parent.groupingBarSettings.displayMode&&(this.chartPanel=this.createToolbarUI(this.groupingChartTable)),this.groupingTable&&(this.gridPanel=this.createToolbarUI(this.groupingTable)),this.parent.axisFieldModule.render(),this.refreshUI())}},e.prototype.createToolbarUI=function(e){(0,t.select)("#"+this.parent.element.id+"_AllFields",e)&&(0,t.select)("#"+this.parent.element.id+"_AllFields",e).remove(),e.prepend((0,t.createElement)("div",{id:this.parent.element.id+"_AllFields"}));var i=new ms.Toolbar({cssClass:E+(this.parent.cssClass?" "+this.parent.cssClass:""),enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,items:[{template:"<div class="+pe+"></div>"}],allowKeyboard:!1,width:this.parent.gridSettings.allowAutoResizing?"auto":this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2});return i.appendTo((0,t.select)("#"+this.parent.element.id+"_AllFields",e)),i},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(vr,this.renderLayout,this),this.parent.on(pr,this.appendToElement,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(pr,this.appendToElement),this.parent.off(vr,this.renderLayout))},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotButtonModule&&(this.parent.pivotButtonModule.destroy(),this.parent.pivotButtonModule=null),this.groupingTable&&this.groupingTable.querySelector("."+E)&&null!=this.gridPanel&&!this.gridPanel.isDestroyed&&(this.gridPanel.destroy(),this.gridPanel=null),this.groupingChartTable&&this.groupingChartTable.querySelector("."+E)&&null!=this.chartPanel&&!this.chartPanel.isDestroyed&&(this.chartPanel.destroy(),this.chartPanel=null),this.touchObj&&!this.touchObj.isDestroyed&&this.touchObj.destroy(),this.parent.element.querySelector("."+he)&&(0,t.remove)(this.parent.element.querySelector("."+he))},e.prototype.getPivotButtonsTotalWidth=function(e){for(var t=0,i=0;i<e.length;i++){t+=(e[i].getBoundingClientRect().width<this.parent.gridSettings.columnWidth?this.parent.gridSettings.columnWidth:e[i].getBoundingClientRect().width)+6}return t},e}(),Vl=function(){function e(e){this.parent=e,this.parent.conditionalFormattingModule=this,this.parentID=this.parent.element.id,this.fontColor=[],this.backgroundColor=[],this.newFormat=[]}return e.prototype.getModuleName=function(){return"conditionalFormatting"},e.prototype.createDialog=function(){null!==(0,t.select)("#"+this.parentID+"conditionalformatting",document)&&(0,t.remove)((0,t.select)("#"+this.parentID+"conditionalformatting",document));var e=(0,t.createElement)("div",{id:this.parentID+"conditionalformatting",className:"e-pivot-formatting-dialog"});this.parent.element.appendChild(e);var i,a=[{click:this.addButtonClick.bind(this),isFlat:!1,buttonModel:{cssClass:(this.parent.isAdaptive?"e-small e-round "+Tt:Tt)+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:o+" "+Te,content:this.parent.isAdaptive?"":this.parent.localeObj.getConstant("condition")}},{click:this.applyButtonClick.bind(this),isFlat:!1,buttonModel:{isPrimary:!0,cssClass:"e-format-apply-button"+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("apply")}},{click:this.cancelButtonClick.bind(this),isFlat:!1,buttonModel:{cssClass:"e-format-cancel-button"+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}];(i=this.parent.isAdaptive?new Ni.Dialog({animationSettings:{effect:"Zoom"},isModal:!0,width:"100%",height:"100%",showCloseIcon:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,position:{X:"center",Y:"center"},allowDragging:!0,buttons:a,beforeOpen:this.beforeOpen.bind(this),close:this.removeDialog.bind(this),cssClass:this.parent.cssClass,header:this.parent.localeObj.getConstant("conditionalFormatting"),target:document.body}):new Ni.Dialog({allowDragging:!0,position:{X:"center",Y:this.parent.element.offsetTop},buttons:a,beforeOpen:this.beforeOpen.bind(this),close:this.removeDialog.bind(this),cssClass:this.parent.cssClass,isModal:!0,closeOnEscape:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,showCloseIcon:!0,header:this.parent.localeObj.getConstant("conditionalFormatting"),target:this.parent.element})).isStringTemplate=!0,i.appendTo(e)},e.prototype.beforeOpen=function(){(0,t.select)("#"+this.parentID+"conditionalformatting",document).querySelector("."+Nt).setAttribute("title",this.parent.localeObj.getConstant("conditionalFormatting"))},e.prototype.addButtonClick=function(){var e=this,t=this;this.parent.trigger(Ya,{conditions:"LessThan",value1:0,applyGrandTotals:!0,style:{backgroundColor:"white",color:"black",fontFamily:"Arial",fontSize:"12px"}},(function(i){t.refreshConditionValues(),e.destroyColorPickers(),t.newFormat.push(i),t.addFormat()}))},e.prototype.applyButtonClick=function(){if(this.refreshConditionValues()){this.parent.setProperties({dataSourceSettings:{conditionalFormatSettings:this.newFormat}},!0);var e={conditionalFormattingInfo:this.parent.dataSourceSettings.conditionalFormatSettings};this.parent.actionObj.actionInfo=e,this.parent.dataSourceSettings.values.length>0&&this.parent.renderPivotGrid(),(0,t.getInstance)((0,t.select)("#"+this.parentID+"conditionalformatting",document),Ni.Dialog).close()}},e.prototype.cancelButtonClick=function(){(0,t.getInstance)((0,t.select)("#"+this.parentID+"conditionalformatting",document),Ni.Dialog).close(),this.newFormat=[]},e.prototype.refreshConditionValues=function(){for(var e=0;e<this.newFormat.length;e++){if(""===(0,t.select)("#"+this.parentID+"conditionvalue1"+e,document).value||""===(0,t.select)("#"+this.parentID+"conditionvalue2"+e,document).value)return""===(0,t.select)("#"+this.parentID+"conditionvalue1"+e,document).value?(0,t.select)("#"+this.parentID+"conditionvalue1"+e,document).focus():(0,t.select)("#"+this.parentID+"conditionvalue2"+e,document).focus(),!1;this.newFormat[e].value1=Number((0,t.select)("#"+this.parentID+"conditionvalue1"+e,document).value),this.newFormat[e].value2=Number((0,t.select)("#"+this.parentID+"conditionvalue2"+e,document).value)}return!0},e.prototype.addFormat=function(){for(var e=(0,t.createElement)("div",{id:this.parentID+"formatDiv",className:"e-new-format"}),i=0;i<this.newFormat.length;i++)e.appendChild(this.createDialogElements(i));if(0===this.newFormat.length){var a=this.createDialogElements(),r=(0,t.createElement)("p",{id:this.parentID+"emptyFormat",className:"e-pivot-conditional-empty-format"});r.innerText=this.parent.localeObj.getConstant("emptyFormat"),a.appendChild(r),e.appendChild(a)}(0,t.getInstance)((0,t.select)("#"+this.parentID+"conditionalformatting",document),Ni.Dialog).setProperties({content:e},!1);for(i=0;i<this.newFormat.length;i++)this.renderDropDowns(i),this.renderColorPicker(i)},e.prototype.createDialogElements=function(e){var i=(0,t.createElement)("div",{id:this.parentID+"outerDiv"+e,className:"e-format-outer-div"});if(void 0!==e){var a=this.newFormat[e],r=(0,t.createElement)("button",{id:this.parentID+"removeButton"+e,className:"e-format-delete-button",attrs:{type:"button",title:this.parent.localeObj.getConstant("delete")}});i.appendChild(r);var n=(0,t.createElement)("div",{id:this.parentID+"innerDiv"+e,className:"e-format-inner-div"}),s=(0,t.createElement)("table",{id:this.parentID+"_valueTable"+e,className:Mt,attrs:{role:"table"}}),o=(0,t.createElement)("tr"),l=(0,t.createElement)("td"),d=(0,t.createElement)("span",{id:this.parentID+"valuelabel"+e,className:"e-format-value-label"});d.innerText=this.parent.localeObj.getConstant("value"),l.appendChild(d),o.appendChild(l),s.appendChild(o),o=(0,t.createElement)("tr"),l=(0,t.createElement)("td");var h=(0,t.createElement)("div",{id:this.parentID+"measure"+e}),p=(0,t.createElement)("input",{id:this.parentID+"measureinput"+e,attrs:{type:"text",tabindex:"0"}});h.appendChild(p),l.appendChild(h),o.appendChild(l),l=(0,t.createElement)("td");var u=(0,t.createElement)("div",{id:this.parentID+"condition"+e}),c=(0,t.createElement)("input",{id:this.parentID+"conditioninput"+e,attrs:{type:"text",tabindex:"0"}});u.appendChild(c),l.appendChild(u),o.appendChild(l),l=(0,t.createElement)("td",{attrs:{style:"display:table"},className:"e-format-input-value"});var g="Between"!==a.conditions&&"NotBetween"!==a.conditions?Ot:"",m=(0,t.createElement)("div",{attrs:{style:"display: table-row;"}}),f=(0,t.createElement)("div",{id:this.parentID+"ConditionValue1"+e,attrs:{style:"display: table-cell;"}}),v=(0,t.createElement)("input",{id:this.parentID+"conditionvalue1"+e,attrs:{type:"text",tabindex:"0",value:(0,t.isNullOrUndefined)(a.value1)?"0":a.value1.toString(),placeholder:this.parent.localeObj.getConstant("emptyInput")}});f.appendChild(v),m.appendChild(f);var S=(0,t.createElement)("span",{id:this.parentID+"valuespan"+e,className:"e-format-value-span "+g,innerHTML:"&"});m.appendChild(S);var y=(0,t.createElement)("div",{id:this.parentID+"ConditionValue2"+e,attrs:{style:"display: table-cell;"}}),b=(0,t.createElement)("input",{id:this.parentID+"conditionvalue2"+e,attrs:{type:"text",tabindex:"0",value:(0,t.isNullOrUndefined)(a.value2)?"0":a.value2.toString(),placeholder:this.parent.localeObj.getConstant("emptyInput")}});y.appendChild(b),m.appendChild(y),l.appendChild(m),o.appendChild(l),s.appendChild(o),n.appendChild(s);var C=(0,t.createElement)("table",{id:this.parentID+"_grandTotalTable"+e,className:Mt+" e-grandtotal-checkbox-table",attrs:{role:"table"}}),x=(0,t.createElement)("tr"),w=(0,t.createElement)("td");C.appendChild(x);var T=(0,t.createElement)("input",{id:this.parentID+"grandtotalcheckbox"+e,attrs:{type:"checkbox",tabindex:"0"}});w.appendChild(T),x.appendChild(w),C.appendChild(x),n.appendChild(C);var M=(0,t.createElement)("table",{id:this.parentID+"_formatTable"+e,className:Mt,attrs:{role:"table"}}),D=(0,t.createElement)("tr"),O=(0,t.createElement)("td"),P=(0,t.createElement)("span",{id:this.parentID+"formatlabel"+e,className:"e-format-label"});P.innerText=this.parent.localeObj.getConstant("formatLabel"),O.appendChild(P),D.appendChild(O),M.appendChild(D),D=(0,t.createElement)("tr"),O=(0,t.createElement)("td");var N=(0,t.createElement)("div",{id:this.parentID+"fontname"+e}),E=(0,t.createElement)("input",{id:this.parentID+"fontnameinput"+e,attrs:{type:"text",tabindex:"0"}});N.appendChild(E),O.appendChild(N),D.appendChild(O),O=(0,t.createElement)("td");var I=(0,t.createElement)("div",{id:this.parentID+"fontsize"+e}),F=(0,t.createElement)("input",{id:this.parentID+"fontsizeinput"+e,attrs:{type:"text",tabindex:"0"}});I.appendChild(F),O.appendChild(I),D.appendChild(O),this.parent.isAdaptive&&(M.appendChild(D),D=(0,t.createElement)("tr"),M.appendChild(D),D=(0,t.createElement)("tr")),O=(0,t.createElement)("td");var L=(0,t.createElement)("input",{id:this.parentID+"fontcolor"+e,attrs:{type:"color",tabindex:"0"},className:"e-format-font-color"});O.appendChild(L);var A=(0,t.createElement)("input",{id:this.parentID+"backgroundcolor"+e,attrs:{type:"color",tabindex:"0"},className:"e-format-back-color"});O.appendChild(A),D.appendChild(O),O=(0,t.createElement)("td");var R=(0,t.createElement)("input",{id:this.parentID+"valuepreview"+e,className:Dt+" e-format-value-preview",attrs:{tabindex:"-1",readonly:"true",value:"123.45"}});O.appendChild(R),D.appendChild(O),M.appendChild(D),n.appendChild(M),i.appendChild(n)}return i},e.prototype.renderDropDowns=function(e){var i=(0,t.getInstance)((0,t.select)("#"+this.parentID+"conditionalformatting",document),Ni.Dialog).element,a=this.newFormat[e],r=[];r.push({index:0,name:this.parent.localeObj.getConstant("AllValues"),field:this.parent.localeObj.getConstant("AllValues")});for(var n=0;n<this.parent.dataSourceSettings.values.length;n++){var s=this.parent.dataSourceSettings.values[n].caption||this.parent.dataSourceSettings.values[n].name;s=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(s):s,r.push({index:n+1,name:s,field:this.parent.dataSourceSettings.values[n].name})}var o=(0,t.isNullOrUndefined)(a.measure)?this.parent.localeObj.getConstant("AllValues"):a.measure,l=[];l[e]=new vs.DropDownList({dataSource:r,fields:{text:"name",value:"field"},value:o,width:"100%",cssClass:this.parent.cssClass,popupHeight:"200px",popupWidth:"auto",locale:this.parent.locale,enableRtl:this.parent.enableRtl,change:this.measureChange.bind(this,e)}),l[e].isStringTemplate=!0,l[e].appendTo((0,t.select)("#"+this.parentID+"measureinput"+e,i));var d=[{value:"LessThan",name:this.parent.localeObj.getConstant("LessThan")},{value:"LessThanOrEqualTo",name:this.parent.localeObj.getConstant("LessThanOrEqualTo")},{value:"GreaterThan",name:this.parent.localeObj.getConstant("GreaterThan")},{value:"GreaterThanOrEqualTo",name:this.parent.localeObj.getConstant("GreaterThanOrEqualTo")},{value:"Equals",name:this.parent.localeObj.getConstant("Equals")},{value:"NotEquals",name:this.parent.localeObj.getConstant("NotEquals")},{value:"Between",name:this.parent.localeObj.getConstant("Between")},{value:"NotBetween",name:this.parent.localeObj.getConstant("NotBetween")}];o=(0,t.isNullOrUndefined)(a.conditions)?"LessThan":a.conditions;var h=[];h[e]=new vs.DropDownList({dataSource:d,fields:{value:"value",text:"name"},value:o,width:"100%",cssClass:this.parent.cssClass,popupHeight:"200px",popupWidth:"auto",locale:this.parent.locale,enableRtl:this.parent.enableRtl,change:this.conditionChange.bind(this,e)}),h[e].isStringTemplate=!0,h[e].appendTo((0,t.select)("#"+this.parentID+"conditioninput"+e,i));var p="Between"!==this.newFormat[e].conditions&&"NotBetween"!==this.newFormat[e].conditions?Ot:"",u=new fs.TextBox({enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:"e-format-value1 "+this.parent.cssClass,width:"auto"});u.isStringTemplate=!0,u.appendTo((0,t.select)("#"+this.parentID+"conditionvalue1"+e,i));var c=new fs.TextBox({enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:"e-format-value2 "+p+" "+this.parent.cssClass,width:"auto"});c.isStringTemplate=!0,c.appendTo((0,t.select)("#"+this.parentID+"conditionvalue2"+e,i));var g=new Os.CheckBox({label:this.parent.localeObj.getConstant("applyToGrandTotal"),checked:this.newFormat[e].applyGrandTotals,enableRtl:this.parent.enableRtl,locale:this.parent.locale,change:this.onCheckChange.bind(this,e),cssClass:this.parent.cssClass});g.isStringTemplate=!0,g.appendTo((0,t.select)("#"+this.parentID+"grandtotalcheckbox"+e,i));o=(0,t.isNullOrUndefined)(a.style.fontFamily)?"Arial":a.style.fontFamily;var m=[];m[e]=new vs.DropDownList({dataSource:[{index:0,name:"Arial"},{index:1,name:"San Serif"},{index:2,name:"Impact"},{index:3,name:"Trebuchet MS"},{index:4,name:"Serif"},{index:5,name:"Verdana"},{index:6,name:"Courier New"},{index:7,name:"Times New Roman"},{index:8,name:"Tahoma"},{index:9,name:"Gerogia"}],fields:{text:"name"},value:o,width:"100%",cssClass:this.parent.cssClass,popupHeight:"200px",popupWidth:"auto",locale:this.parent.locale,enableRtl:this.parent.enableRtl,change:this.fontNameChange.bind(this,e)}),m[e].isStringTemplate=!0,m[e].appendTo((0,t.select)("#"+this.parentID+"fontnameinput"+e,i));o=(0,t.isNullOrUndefined)(a.style.fontSize)?"12px":a.style.fontSize;var f=[];f[e]=new vs.DropDownList({dataSource:[{index:0,name:"9px"},{index:1,name:"10px"},{index:2,name:"11px"},{index:3,name:"12px"},{index:4,name:"13px"},{index:5,name:"14px"},{index:6,name:"15px"},{index:6,name:"16px"}],fields:{text:"name"},popupHeight:"200px",popupWidth:"auto",value:o,width:"100%",change:this.fontSizeChange.bind(this,e),locale:this.parent.locale,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass}),f[e].isStringTemplate=!0,f[e].appendTo((0,t.select)("#"+this.parentID+"fontsizeinput"+e,i))},e.prototype.conditionChange=function(e,i){this.newFormat[e].conditions=i.value;var a=(0,t.select)("#"+this.parentID+"valuespan"+e,document),r=(0,t.select)("#"+this.parentID+"conditionvalue2"+e,document);"Between"===i.value||"NotBetween"===i.value?(a.classList.remove(Ot),r.parentElement.classList.remove(Ot)):(a.classList.add(Ot),r.parentElement.classList.add(Ot))},e.prototype.onCheckChange=function(e,t){this.newFormat[e].applyGrandTotals=t.checked},e.prototype.fontNameChange=function(e,i){this.newFormat[e].style.fontFamily=i.value.toString(),(0,t.select)("#"+this.parentID+"valuepreview"+e,document).style.fontFamily=i.value},e.prototype.fontSizeChange=function(e,i){this.newFormat[e].style.fontSize=i.value.toString(),(0,t.select)("#"+this.parentID+"valuepreview"+e,document).style.fontSize=i.value},e.prototype.measureChange=function(e,t){this.newFormat[e].measure=t.value.toString()===this.parent.localeObj.getConstant("AllValues")?void 0:t.value.toString()},e.prototype.renderColorPicker=function(e){var i=(0,t.getInstance)((0,t.select)("#"+this.parentID+"conditionalformatting",document),Ni.Dialog).element,a=this.newFormat[e],r=(0,t.isNullOrUndefined)(a.style.color)?"black":a.style.color,n="#"===r.charAt(0)&&this.isHex(r.substr(1))?r:this.colourNameToHex(r);(0,t.select)("#"+this.parentID+"valuepreview"+e,document).style.color=n,this.fontColor[e]=new fs.ColorPicker({cssClass:Pt+" e-format-font-color-picker"+(this.parent.cssClass?" "+this.parent.cssClass:""),value:n,mode:"Palette",change:this.fontColorChange.bind(this,e),locale:this.parent.locale,enableRtl:this.parent.enableRtl}),this.fontColor[e].isStringTemplate=!0,this.fontColor[e].appendTo((0,t.select)("#"+this.parentID+"fontcolor"+e,i)),(0,t.addClass)([this.fontColor[e].element.nextElementSibling.querySelector(".e-selected-color")],o),n="#"===(r=(0,t.isNullOrUndefined)(a.style.backgroundColor)?"white":a.style.backgroundColor).charAt(0)&&this.isHex(r.substr(1))?r:this.colourNameToHex(r),(0,t.select)("#"+this.parentID+"valuepreview"+e,document).style.backgroundColor=n,(0,t.select)("#"+this.parentID+"valuepreview"+e,document).style.fontFamily=a.style.fontFamily,(0,t.select)("#"+this.parentID+"valuepreview"+e,document).style.fontSize=a.style.fontSize,this.backgroundColor[e]=new fs.ColorPicker({cssClass:Pt+(this.parent.cssClass?" "+this.parent.cssClass:""),value:n,mode:"Palette",change:this.backColorChange.bind(this,e),locale:this.parent.locale,enableRtl:this.parent.enableRtl}),this.backgroundColor[e].isStringTemplate=!0,this.backgroundColor[e].appendTo((0,t.select)("#"+this.parentID+"backgroundcolor"+e,i)),(0,t.addClass)([this.backgroundColor[e].element.nextElementSibling.querySelector(".e-selected-color")],o);var s=new Os.Button({iconCss:o+" e-format-delete-icon",cssClass:"e-flat"+(this.parent.cssClass?" "+this.parent.cssClass:""),locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});s.isStringTemplate=!0,s.appendTo((0,t.select)("#"+this.parentID+"removeButton"+e,i)),s.element.onclick=this.toggleButtonClick.bind(this,e)},e.prototype.backColorChange=function(e,i){this.newFormat[e].style.backgroundColor=i.currentValue.hex,(0,t.select)("#"+this.parentID+"valuepreview"+e,document).style.backgroundColor=i.currentValue.hex},e.prototype.fontColorChange=function(e,i){this.newFormat[e].style.color=i.currentValue.hex,(0,t.select)("#"+this.parentID+"valuepreview"+e,document).style.color=i.currentValue.hex},e.prototype.toggleButtonClick=function(e){this.destroyColorPickers(),this.newFormat.splice(e,1),this.addFormat()},e.prototype.isHex=function(e){for(var t=parseInt(e,16);"0"===e.charAt(0);)e=e.substr(1);return t.toString(16)===e.toLowerCase()||0===t&&""===e},e.prototype.hexToRgb=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},e.prototype.colourNameToHex=function(e){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};if(void 0!==t[e.toLowerCase()])return t[e.toLowerCase()];if(0===e.search("rgba")){for(var i=e.substr(5).split(")")[0].split(","),a="",r=0;r<i.length-1;r++)i[r]=(+i[r]).toString(16),1===i[r].length&&(i[r]="0"+i[r]),a+=i[r];return"#"+a+Math.round(255*+i[3]).toString(16)}if(0===e.search("rgb")){for(i=e.substr(4).split(")")[0].split(","),a="",r=0;r<i.length;r++)i[r]=(+i[r]).toString(16),1===i[r].length&&(i[r]="0"+i[r]),a+=i[r];return"#"+a}return"#d5d5d5"},e.prototype.removeDialog=function(){var e=(0,t.select)("#"+this.parentID+"conditionalformatting",document),i=e?(0,t.getInstance)(e,Ni.Dialog):null;i&&!i.isDestroyed&&(this.destroyColorPickers(),i.destroy()),e&&(0,t.remove)(e),this.fontColor=[],this.backgroundColor=[],this.newFormat=[]},e.prototype.destroyColorPickers=function(){for(var e=0;e<(this.newFormat?this.newFormat.length:0);e++)this.fontColor&&this.fontColor[e]&&!this.fontColor[e].isDestroyed&&this.fontColor[e].destroy(),this.backgroundColor&&this.backgroundColor[e]&&!this.backgroundColor[e].isDestroyed&&this.backgroundColor[e].destroy()},e.prototype.showConditionalFormattingDialog=function(){this.newFormat=[];for(var e=0;e<this.parent.dataSourceSettings.conditionalFormatSettings.length;e++)this.newFormat.push((0,t.extend)({},this.parent.dataSourceSettings.conditionalFormatSettings[e].properties,null,!0));this.createDialog(),(0,t.getInstance)((0,t.select)("#"+this.parentID+"conditionalformatting",document),Ni.Dialog).refresh(),this.addFormat()},e.prototype.destroy=function(){var e=(0,t.select)("#"+this.parentID+"conditionalformatting",document),i=e?(0,t.getInstance)(e,Ni.Dialog):null;i&&!i.isDestroyed&&i.close()},e}(),Hl=function(){function e(e){this.isMultiAxisChange=!1,this.isReportChange=!1,this.currentReport="",this.parent=e,this.parent.toolbarModule=this,this.addEventListener()}return e.prototype.getModuleName=function(){return"toolbar"},e.prototype.createToolbar=function(){this.parent.isModified=!1,this.renderDialog(),null!==(0,t.select)("#"+this.parent.element.id+"pivot-toolbar",this.parent.element)&&(0,t.remove)((0,t.select)("#"+this.parent.element.id+"pivot-toolbar",this.parent.element));var e=(0,t.createElement)("div",{id:this.parent.element.id+"pivot-toolbar",className:Xt});this.parent.showFieldList&&(0,t.select)("#"+this.parent.element.id+"_PivotFieldList",this.parent.element)?this.parent.element.insertBefore(e,(0,t.select)("#"+this.parent.element.id+"_PivotFieldList",this.parent.element)):this.parent.showGroupingBar&&(0,t.select)("#"+this.parent.element.id+" .e-pivot-grouping-bar",this.parent.element)?this.parent.element.insertBefore(e,(0,t.select)("#"+this.parent.element.id+" .e-pivot-grouping-bar",this.parent.element)):this.parent.element.insertBefore(e,(0,t.select)("#"+this.parent.element.id+"_grid",this.parent.element)),this.toolbar=new ms.Toolbar({created:this.create.bind(this),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,items:this.getItems(),allowKeyboard:!1,cssClass:this.parent.cssClass,width:this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber()}),this.toolbar.isStringTemplate=!0;var i="viewContainerRef";this.parent[i]&&((0,t.setValue)("registeredTemplate",{},this.toolbar),this.toolbar[i]=this.parent[i]),this.parent.toolbarTemplate&&"string"==typeof this.parent.toolbarTemplate?(this.toolbar.appendTo(this.parent.toolbarTemplate),this.parent.element.replaceChild(this.toolbar.element,this.parent.element.querySelector("."+Xt)),this.toolbar.element.classList.add(Xt)):this.toolbar.appendTo(e),this.toolbar.width=this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber(),this.parent.chart&&this.parent.chart.setProperties({width:this.parent.grid?this.parent.getGridWidthAsNumber().toString():this.parent.getWidthAsNumber().toString()},!0),this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+he)&&this.parent.groupingBarModule.refreshUI()},e.prototype.fetchReports=function(){var e={reportName:[]};return this.parent.trigger(pa,e),e},e.prototype.fetchReportsArgs=function(){var e=new i.Deferred;return this.parent.trigger(pa,{reportName:[]},(function(t){e.resolve(t)})),e},e.prototype.getItems=function(){for(var e=this.parent.toolbar.filter((function(e,t,i){return i.indexOf(e)===t})),i=[],a=0,r=e;a<r.length;a++){var n=r[a];switch(n){case"New":i.push({prefixIcon:"e-new-report "+o,tooltipText:this.parent.localeObj.getConstant("new"),click:this.actionClick.bind(this),id:this.parent.element.id+"new"});break;case"Save":i.push({prefixIcon:"e-save-report "+o,tooltipText:this.parent.localeObj.getConstant("save"),click:this.actionClick.bind(this),id:this.parent.element.id+"save"});break;case"SaveAs":i.push({prefixIcon:"e-saveas-report "+o,tooltipText:this.parent.localeObj.getConstant("saveAs"),click:this.actionClick.bind(this),id:this.parent.element.id+"saveas"});break;case"Rename":i.push({prefixIcon:"e-rename-report "+o,tooltipText:this.parent.localeObj.getConstant("rename"),click:this.actionClick.bind(this),id:this.parent.element.id+"rename"});break;case"Remove":i.push({prefixIcon:Kt+" "+o,tooltipText:this.parent.localeObj.getConstant("deleteReport"),click:this.actionClick.bind(this),id:this.parent.element.id+"remove"});break;case"Load":i.push({template:"<div><input class=e-load-report id="+this.parent.element.id+"_reportlist></input></div>",click:this.actionClick.bind(this),id:this.parent.element.id+"load"});break;case"Grid":var s="Chart"===this.parent.displayOption.view;i.push({prefixIcon:Zt+" "+o,tooltipText:this.parent.localeObj.getConstant("grid"),id:this.parent.element.id+"grid",cssClass:(s?vt:"")+(this.parent.cssClass?" "+this.parent.cssClass:""),click:this.menuItemClick.bind(this)});break;case"Chart":var l="Table"===this.parent.displayOption.view;i.push({template:'<ul id="'+this.parent.element.id+'chart_menu"></ul>',id:this.parent.element.id+"chartmenu",cssClass:(l?vt:"")+(this.parent.cssClass?" "+this.parent.cssClass:"")});break;case"MDX":"olap"===this.parent.dataType&&i.push({prefixIcon:"e-mdx "+o,id:this.parent.element.id+"mdxQuery",click:this.actionClick.bind(this),tooltipText:this.parent.localeObj.getConstant("mdxQuery")});break;case"Export":i.push({template:'<ul id="'+this.parent.element.id+'export_menu"></ul>',id:this.parent.element.id+"exportmenu"});break;case"SubTotal":i.push({template:'<ul id="'+this.parent.element.id+'subtotal_menu"></ul>',id:this.parent.element.id+"subtotalmenu"});break;case"GrandTotal":i.push({template:'<ul id="'+this.parent.element.id+'grandtotal_menu"></ul>',id:this.parent.element.id+"grandtotalmenu"});break;case"ConditionalFormatting":i.push({prefixIcon:"e-toolbar-formatting "+o,id:this.parent.element.id+"formatting",click:this.actionClick.bind(this),tooltipText:this.parent.localeObj.getConstant("toolbarFormatting")});break;case"NumberFormatting":i.push({prefixIcon:"e-pivot-format-toolbar "+o,id:this.parent.element.id+"numberFormatting",click:this.actionClick.bind(this),tooltipText:this.parent.localeObj.getConstant("numberFormat")});break;case"Formatting":i.push({template:'<ul id="'+this.parent.element.id+'formatting_menu"></ul>',id:this.parent.element.id+"formattingmenu"});break;case"FieldList":i.push({prefixIcon:"e-toolbar-fieldlist "+o,tooltipText:this.parent.localeObj.getConstant("fieldList"),click:this.actionClick.bind(this),align:"Right",id:this.parent.element.id+"fieldlist"}),this.parent.element.querySelector(".e-toggle-field-list")&&(this.parent.element.querySelector(".e-toggle-field-list").style.display="none");break;default:"object"==typeof n&&i.push(n)}}this.parent.showFieldList&&-1===e.indexOf("FieldList")&&(0,t.select)("#"+this.parent.element.id+"_PivotFieldList",this.parent.element)&&"none"===(0,t.select)("#"+this.parent.element.id+"_PivotFieldList",this.parent.element).style.display&&((0,t.select)("#"+this.parent.element.id+"_PivotFieldList",this.parent.element).style.display="block");var d={customToolbar:i};return this.parent.trigger(fa,d),i},e.prototype.reportChange=function(e){if(this.parent.actionObj.actionName=sn,this.isReportChange=!0,this.parent.actionBeginMethod())e.cancel=!0;else try{this.dropArgs=e,this.parent.isModified&&""!==this.currentReport?this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("newReportConfirm")):this.reportLoad(e)}catch(e){this.parent.actionFailureMethod(e)}},e.prototype.reportLoad=function(e){var t=this;if("Save"!==this.action&&"Rename"!==this.action&&"New"!==this.action){var i={reportName:e.itemData.value},a={reportName:e.itemData.value};this.parent.actionObj.actionInfo=a,this.parent.trigger(ua,i,(function(e){t.currentReport=e.reportName,t.parent.isModified=!1}))}},e.prototype.saveReport=function(e){if(this.currentReport&&""!==this.currentReport&&e.item.id===this.parent.element.id+"save"){var t={report:this.getCurrentReport(),reportName:this.currentReport};this.parent.actionObj.actionName=this.parent.getActionCompleteName();var i={reportName:this.currentReport};this.parent.actionObj.actionInfo=i,this.parent.trigger(ha,t),this.parent.actionObj.actionName&&this.parent.actionCompleteMethod(),this.parent.isModified=!1}else{if(""===this.currentReport&&(e.item.id===this.parent.element.id+"save"||e.item.id===this.parent.element.id+"saveas"))return void this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("emptyReport"));this.dialogShow(e,"saveAs")}},e.prototype.mdxQueryDialog=function(){(0,t.select)("#"+this.parent.element.id+"mdx-dialog",document)||this.renderMDXDialog();var e=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"mdx-dialog",document),Ni.Dialog),i=(0,t.createElement)("div",{className:"e-mdx-query"}),a=(0,t.createElement)("textarea",{className:hi,attrs:{readonly:"readonly","aria-label":this.parent.localeObj.getConstant("mdxQuery")}});a.innerText=this.parent.olapEngineModule.getMDXQuery(this.parent.dataSourceSettings).trim(),i.appendChild(a),e.content=i,e.show()},e.prototype.dialogShow=function(e,i){if(e){var a=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"report-dialog",document),Ni.Dialog);a.header=e.item.tooltipText;var r=(0,t.createElement)("div",{className:"e-report-outer"}),n=(0,t.createElement)("div",{className:"e-pivotview-report-label"});n.innerText=this.parent.localeObj.getConstant("reportName");var s=(0,t.createElement)("input",{className:Jt+" "+Dt,attrs:{placeholder:this.parent.localeObj.getConstant("emptyReportName"),value:i&&"rename"===i?this.currentReport:""}});s.innerText=i&&"rename"===i?this.currentReport:"",s.setSelectionRange(s.textContent.length,s.textContent.length),r.appendChild(n),r.appendChild(s),a.content=r,a.refresh(),a.show()}},e.prototype.renameReport=function(e){this.parent.trigger(va,e),this.currentReport&&""!==this.currentReport?this.dialogShow(e,"rename"):this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("emptyReport"))},e.prototype.actionClick=function(e){var t=e.item.id===this.parent.element.id+"new"?Nr:e.item.id===this.parent.element.id+"save"?Er:e.item.id===this.parent.element.id+"saveas"?Ir:e.item.id===this.parent.element.id+"rename"?Fr:e.item.id===this.parent.element.id+"remove"?Lr:e.item.id===this.parent.element.id+"load"?Ar:e.item.id===this.parent.element.id+"formatting"?Rr:e.item.id===this.parent.element.id+"numberFormatting"?kr:e.item.id===this.parent.element.id+"mdxQuery"?jr:e.item.id===this.parent.element.id+"fieldlist"?qr:"";if(this.parent.actionObj.actionName=t,!this.parent.actionBeginMethod())try{switch(e.item.id){case this.parent.element.id+"save":case this.parent.element.id+"saveas":this.saveReport(e);break;case this.parent.element.id+"remove":return this.action="Remove",void(this.currentReport&&""!==this.currentReport?this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeConfirm")):this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("emptyReport")));case this.parent.element.id+"rename":this.renameReport(e);break;case this.parent.element.id+"new":this.action="New",this.newArgs=e,this.parent.isModified&&this.currentReport&&""!==this.currentReport?this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("newReportConfirm")):this.createNewReport(e);break;case this.parent.element.id+"load":this.action="Load";break;case this.parent.element.id+"fieldlist":this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.dialogRenderer&&this.parent.pivotFieldListModule.dialogRenderer.onShowFieldList();break;case this.parent.element.id+"formatting":this.parent.conditionalFormattingModule&&this.parent.conditionalFormattingModule.showConditionalFormattingDialog();break;case this.parent.element.id+"mdxQuery":this.mdxQueryDialog();break;case this.parent.element.id+"numberFormatting":this.parent.numberFormattingModule&&this.parent.numberFormattingModule.showNumberFormattingDialog()}}catch(e){this.parent.actionFailureMethod(e)}},e.prototype.renderDialog=function(){null!==(0,t.select)("#"+this.parent.element.id+"report-dialog",this.parent.element)&&(0,t.remove)((0,t.select)("#"+this.parent.element.id+"report-dialog",this.parent.element));var e=(0,t.createElement)("div",{id:this.parent.element.id+"report-dialog",className:"e-pivotview-report-dialog"});this.parent.element.appendChild(e);var i=new Ni.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,position:{X:"center",Y:"center"},buttons:[{click:this.okBtnClick.bind(this),isFlat:!1,buttonModel:{content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.cancelBtnClick.bind(this),isFlat:!1,buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],isModal:!0,visible:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"auto",height:"auto",zIndex:1000001,closeOnEscape:!0,target:document.body,cssClass:this.parent.cssClass});i.isStringTemplate=!0,i.appendTo(e)},e.prototype.renderMDXDialog=function(){null!==(0,t.select)("#"+this.parent.element.id+"mdx-dialog",this.parent.element)&&(0,t.remove)((0,t.select)("#"+this.parent.element.id+"mdx-dialog",this.parent.element));var e=(0,t.createElement)("div",{id:this.parent.element.id+"mdx-dialog",className:"e-pivotview-mdx-dialog"});this.parent.element.appendChild(e);var i=new Ni.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,position:{X:"center",Y:"center"},buttons:[{click:this.copyMDXQuery.bind(this),isFlat:!1,buttonModel:{content:this.parent.localeObj.getConstant("copy"),isPrimary:!0}}],header:this.parent.localeObj.getConstant("mdxQuery"),isModal:!0,visible:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"auto",height:"auto",zIndex:1000001,closeOnEscape:!0,target:document.body,cssClass:this.parent.cssClass});i.isStringTemplate=!0,i.appendTo(e)},e.prototype.copyMDXQuery=function(){var e=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"mdx-dialog",document),Ni.Dialog).element.querySelector("."+hi);try{e.select(),document.execCommand("copy")}catch(e){window.alert("Oops, unable to copy")}},e.prototype.okBtnClick=function(){var e=this,i=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"report-dialog",document),Ni.Dialog),a=i.element.querySelector("."+Jt);if(a&&""===a.value)a.focus();else{if(this.parent.localeObj||(this.parent=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id,document),hl)),i.header!==this.parent.localeObj.getConstant("save")&&i.header!==this.parent.localeObj.getConstant("saveAs")||!a.value||""===a.value){if(i.header===this.parent.localeObj.getConstant("new")&&a.value&&""!==a.value){this.action="New",this.currentReport=a.value;var r=!1,n=this,s={reportName:[]};this.parent.trigger(pa,s,(function(i){for(var o=0;o<i.reportName.length;o++)if(a.value===s.reportName[o]){r=!0;break}if(r)n.createConfirmDialog(n.parent.localeObj.getConstant("alert"),n.parent.localeObj.getConstant("replaceConfirmBefore")+'"'+a.value+'"'+n.parent.localeObj.getConstant("replaceConfirmAfter"));else{n.parent.trigger(ma);var l={report:n.getCurrentReport(),reportName:a.value},d={reportName:a.value};e.parent.actionObj.actionInfo=d,n.parent.trigger(ha,l),n.parent.isModified=!1,n.updateReportList(),(0,t.getInstance)((0,t.select)("#"+e.parent.element.id+"report-dialog",document),Ni.Dialog).hide()}}))}else if(i.header===this.parent.localeObj.getConstant("rename")&&a.value&&""!==a.value){if(this.currentReport===a.value)return void i.hide();this.action="Rename";var o=!1;this.renameText=a.value;c=this.fetchReports();for(var l=0;l<c.reportName.length;l++)if(a.value===c.reportName[l]){o=!0;break}if(o)return void this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("replaceConfirmBefore")+'"'+a.value+'"'+this.parent.localeObj.getConstant("replaceConfirmAfter"));var d={reportName:this.currentReport,rename:a.value},h={reportName:{oldName:this.currentReport,newName:a.value}};this.parent.actionObj.actionInfo=h,this.parent.trigger(ca,d),this.currentReport=a.value,this.updateReportList(),i.hide()}}else{this.action="Save",this.currentReport=a.value;var p=!1,u=this,c={reportName:[]};this.parent.trigger(pa,c,(function(i){for(var r=0;r<i.reportName.length;r++)if(a.value===i.reportName[r]){p=!0;break}if(p)u.createConfirmDialog(u.parent.localeObj.getConstant("alert"),u.parent.localeObj.getConstant("replaceConfirmBefore")+'"'+a.value+'"'+u.parent.localeObj.getConstant("replaceConfirmAfter"));else{var n={report:u.getCurrentReport(),reportName:a.value},s={reportName:a.value};e.parent.actionObj.actionInfo=s,u.parent.trigger(ha,n),u.parent.isModified=!1,u.updateReportList(),(0,t.getInstance)((0,t.select)("#"+e.parent.element.id+"report-dialog",document),Ni.Dialog).hide()}}))}this.parent.actionObj.actionName=this.parent.getActionCompleteName(),this.parent.actionObj.actionName&&this.parent.actionCompleteMethod()}},e.prototype.createNewReport=function(e){this.dialogShow(e)},e.prototype.cancelBtnClick=function(){(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"report-dialog",document),Ni.Dialog).hide()},e.prototype.createConfirmDialog=function(e,i){document.getElementById(this.parent.element.id+"_ConfirmDialog")&&(0,t.remove)(document.getElementById(this.parent.element.id+"_ConfirmDialog").parentElement);var a=(0,t.createElement)("div",{id:this.parent.element.id+"_ConfirmDialog",className:re});this.parent.element.appendChild(a);var r=new Ni.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,header:e,content:i,isModal:!0,visible:!0,closeOnEscape:!0,target:document.body,cssClass:this.parent.cssClass,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{isFlat:!1,buttonModel:{content:this.parent.localeObj.getConstant("yes"),isPrimary:!0,cssClass:ie+(this.parent.cssClass?" "+this.parent.cssClass:"")},click:this.okButtonClick.bind(this)},{isFlat:!1,buttonModel:{content:this.parent.localeObj.getConstant("no"),cssClass:ae+(this.parent.cssClass?" "+this.parent.cssClass:"")},click:this.cancelButtonClick.bind(this)}]});r.isStringTemplate=!0,r.appendTo(a),r.element.querySelector(".e-dlg-header").innerText=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(e):e},e.prototype.okButtonClick=function(){var e=this,i=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"report-dialog",document),Ni.Dialog);if("Remove"===this.action){var a={reportName:this.currentReport},r={reportName:this.currentReport};this.parent.actionObj.actionInfo=r,this.parent.trigger(ga,a);var n=this.fetchReports();if(n.reportName&&n.reportName.length>0){var s={reportName:n.reportName[n.reportName.length-1]};this.parent.trigger(ua,s,(function(t){e.currentReport=t.reportName,e.parent.isModified=!1})),this.currentReport=n.reportName[n.reportName.length-1]}else this.currentReport="",this.parent.isModified=!1,this.action="";this.updateReportList(),this.parent.actionObj.actionName=Fn,this.parent.actionObj.actionName&&this.parent.actionCompleteMethod()}else if("New"===this.action||"Save"!==this.action&&"Rename"!==this.action&&"New"!==this.action){if(this.currentReport&&""!==this.currentReport&&this.parent.isModified){var o={report:this.getCurrentReport(),reportName:this.currentReport};r={reportName:this.currentReport};this.parent.actionObj.actionInfo=r,this.parent.actionObj.actionName=Pn,this.parent.actionObj.actionName&&this.parent.actionCompleteMethod(),this.parent.trigger(ha,o),this.parent.isModified=!1,"New"===this.action?(this.parent.actionObj.actionName=Nr,this.createNewReport(this.newArgs)):(this.parent.actionObj.actionName=sn,this.reportLoad(this.dropArgs))}else if("New"===this.action){this.parent.trigger(ma);o={report:this.getCurrentReport(),reportName:this.currentReport};this.parent.trigger(ha,o),this.parent.isModified=!1,this.updateReportList(),i.hide()}}else if("Save"===this.action){o={report:this.getCurrentReport(),reportName:this.currentReport};this.parent.trigger(ha,o),this.parent.isModified=!1,this.updateReportList(),i.hide()}else if("Rename"===this.action){var l={reportName:this.currentReport,rename:this.renameText,isReportExists:!0};this.parent.trigger(ca,l),this.currentReport=this.renameText,this.parent.isModified=!1,this.updateReportList(),i.hide()}(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_ConfirmDialog",document),Ni.Dialog).hide()},e.prototype.cancelButtonClick=function(){var e=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"report-dialog",document),Ni.Dialog);if("New"===this.action)this.parent.isModified?this.createNewReport(this.newArgs):e.hide();else if("Save"===this.action){if((0,t.select)("#"+this.parent.element.id+"_reportlist",this.parent.element)){var i=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_reportlist",this.parent.element),vs.DropDownList);this.currentReport=i.value}e.hide()}else"Rename"===this.action?e.hide():this.dropArgs&&"Remove"!==this.action&&this.reportLoad(this.dropArgs);(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_ConfirmDialog",document),Ni.Dialog).hide()},e.prototype.createChartMenu=function(){var e=this;if((0,t.select)("#"+this.parent.element.id+"chart_menu",this.parent.element)){for(var i=(0,t.select)("#"+this.parent.element.id+"chart_menu",this.parent.element),a=[],r=this.getValidChartType(),n=0;n<r.length&&n<7;n++){var s=r[n];a.push({text:this.parent.localeObj.getConstant(s.toLowerCase()),id:this.parent.element.id+"_"+s})}7===a.length&&(a.splice(6),a.push({text:this.parent.localeObj.getConstant("MoreOption"),id:this.parent.element.id+"_ChartMoreOption"}));var l=a.length<=0||"Table"===this.parent.displayOption.view;a.push({separator:!0}),a.push({text:this.parent.localeObj.getConstant("multipleAxes"),id:this.parent.element.id+"_multipleAxes"}),a.push({text:this.parent.localeObj.getConstant("showLegend"),id:this.parent.element.id+"_showLegend"});var d=[{iconCss:$t+" "+o,items:l?[]:a}],h=i?(0,t.getInstance)(i,ms.Menu):null;h&&!h.isDestroyed&&(h.destroy(),h=null),(h=new ms.Menu({items:d,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:ci+(this.parent.cssClass?" "+this.parent.cssClass:""),select:this.menuItemClick.bind(this),beforeOpen:this.whitespaceRemove.bind(this),onClose:function(){e.focusToolBar()},beforeItemRender:this.multipleAxesCheckbox.bind(this)})).isStringTemplate=!0,h.appendTo(i)}},e.prototype.create=function(){var e=this;if((0,t.select)("#"+this.parent.element.id+"chart_menu",this.parent.element)&&this.createChartMenu(),(0,t.select)("#"+this.parent.element.id+"export_menu",this.parent.element)){var i=(0,t.select)("#"+this.parent.element.id+"export_menu",this.parent.element),a=[{iconCss:"e-export "+o,items:[{text:this.parent.localeObj.getConstant("pdf"),iconCss:Wt+" "+o,id:this.parent.element.id+"pdf"},{text:this.parent.localeObj.getConstant("excel"),iconCss:Qt+" "+o,id:this.parent.element.id+"excel"},{text:this.parent.localeObj.getConstant("csv"),iconCss:Yt+" "+o,id:this.parent.element.id+"csv"},{text:this.parent.localeObj.getConstant("png"),iconCss:"e-pivotview-png-export "+o,id:this.parent.element.id+"png"},{text:this.parent.localeObj.getConstant("jpeg"),iconCss:"e-pivotview-jpeg-export "+o,id:this.parent.element.id+"jpeg"},{text:this.parent.localeObj.getConstant("svg"),iconCss:"e-pivotview-svg-export "+o,id:this.parent.element.id+"svg"}]}],r=new ms.Menu({items:a,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:ci+(this.parent.cssClass?" "+this.parent.cssClass:""),select:this.menuItemClick.bind(this),beforeOpen:this.updateExportMenu.bind(this),onClose:function(){e.focusToolBar()}});r.isStringTemplate=!0,r.appendTo(i)}if((0,t.select)("#"+this.parent.element.id+"subtotal_menu",this.parent.element)){var n=(0,t.select)("#"+this.parent.element.id+"subtotal_menu",this.parent.element),s=(a=[{iconCss:"e-sub-total "+o,items:[{text:this.parent.localeObj.getConstant("showSubTotals"),id:this.parent.element.id+"subtotal",iconCss:li+" "+o},{text:this.parent.localeObj.getConstant("doNotShowSubTotals"),id:this.parent.element.id+"notsubtotal",iconCss:li+" "+o},{text:this.parent.localeObj.getConstant("showSubTotalsRowsOnly"),id:this.parent.element.id+"subtotalrow",iconCss:li+" "+o},{text:this.parent.localeObj.getConstant("showSubTotalsColumnsOnly"),id:this.parent.element.id+"subtotalcolumn",iconCss:li+" "+o},{separator:!0},{text:this.parent.localeObj.getConstant("subTotalPosition"),id:this.parent.element.id+"subtotalpositions",iconCss:oi+" "+o,items:[{text:this.parent.localeObj.getConstant("auto"),id:this.parent.element.id+"sub-none-position",iconCss:li+" "+o},{text:this.parent.localeObj.getConstant("top"),id:this.parent.element.id+"sub-top-position",iconCss:li+" "+o},{text:this.parent.localeObj.getConstant("bottom"),id:this.parent.element.id+"sub-bottom-position",iconCss:li+" "+o}]}]}],new ms.Menu({items:a,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:ci+(this.parent.cssClass?" "+this.parent.cssClass:""),select:this.menuItemClick.bind(this),beforeOpen:this.updateSubtotalSelection.bind(this),onClose:function(){e.focusToolBar()}}));s.isStringTemplate=!0,s.appendTo(n)}if((0,t.select)("#"+this.parent.element.id+"grandtotal_menu",this.parent.element)){var l=(0,t.select)("#"+this.parent.element.id+"grandtotal_menu",this.parent.element),d=(a=[{iconCss:"e-grand-total "+o,items:[{text:this.parent.localeObj.getConstant("showGrandTotals"),id:this.parent.element.id+"grandtotal",iconCss:li+" "+o},{text:this.parent.localeObj.getConstant("doNotShowGrandTotals"),id:this.parent.element.id+"notgrandtotal",iconCss:li+" "+o},{text:this.parent.localeObj.getConstant("showGrandTotalsRowsOnly"),id:this.parent.element.id+"grandtotalrow",iconCss:li+" "+o},{text:this.parent.localeObj.getConstant("showGrandTotalsColumnsOnly"),id:this.parent.element.id+"grandtotalcolumn",iconCss:li+" "+o},{separator:!0},{text:this.parent.localeObj.getConstant("grandTotalPosition"),id:this.parent.element.id+"grandtotalpositions",iconCss:oi+" "+o,items:[{text:this.parent.localeObj.getConstant("top"),id:this.parent.element.id+"top-position",iconCss:li+" "+o},{text:this.parent.localeObj.getConstant("bottom"),id:this.parent.element.id+"bottom-position",iconCss:li+" "+o}]}]}],new ms.Menu({items:a,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:ci+(this.parent.cssClass?" "+this.parent.cssClass:""),select:this.menuItemClick.bind(this),beforeOpen:this.updateGrandtotalSelection.bind(this),onClose:function(){e.focusToolBar()}}));d.isStringTemplate=!0,d.appendTo(l)}if((0,t.select)("#"+this.parent.element.id+"formatting_menu",this.parent.element)){var h=(0,t.select)("#"+this.parent.element.id+"formatting_menu",this.parent.element),p=(a=[{iconCss:"e-pivot-format-menu "+o,items:[{text:this.parent.localeObj.getConstant("numberFormatMenu"),iconCss:"e-pivot-number-format-menu "+o,id:this.parent.element.id+"numberFormattingMenu"},{text:this.parent.localeObj.getConstant("conditionalFormattingMenu"),iconCss:"e-pivot-conditional-format-menu "+o,id:this.parent.element.id+"conditionalFormattingMenu"}]}],new ms.Menu({items:a,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:ci+(this.parent.cssClass?" "+this.parent.cssClass:""),select:this.menuItemClick.bind(this)}));p.isStringTemplate=!0,p.appendTo(h)}var u={report:this.parent.getPersistData(),reportName:this.parent.localeObj.getConstant("defaultReport")};if(this.currentReport=this.parent.localeObj.getConstant("defaultReport"),this.parent.trigger(ha,u),(0,t.select)("#"+this.parent.element.id+"_reportlist",this.parent.element)){var c=(0,t.select)("#"+this.parent.element.id+"_reportlist",this.parent.element),g=this.fetchReports(),m=new vs.DropDownList({dataSource:g.reportName,width:"150px",popupHeight:"200px",placeholder:""===this.currentReport?this.parent.localeObj.getConstant("reportList"):"",enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:"e-reportlist-drop"+(this.parent.cssClass?" "+this.parent.cssClass:""),select:this.reportChange.bind(this),value:this.currentReport});m.isStringTemplate=!0,m.appendTo(c)}this.updateItemElements()},e.prototype.getCurrentReport=function(){var e=this.parent.getPersistData();if("CSV"===this.parent.dataSourceSettings.type&&"Server"!==this.parent.dataSourceSettings.mode){var t=JSON.parse(e);t.dataSourceSettings.dataSource.splice(0,0,this.parent.engineModule.fields),e=JSON.stringify(t)}return e},e.prototype.updateItemElements=function(){for(var e=0,t=[].slice.call(this.toolbar.element.querySelectorAll(".e-toolbar-item"));e<t.length;e++){var i=t[e];i.querySelector("button")?i.querySelector("button").setAttribute("tabindex","0"):i.querySelector(".e-menu.e-menu-parent")&&(i.querySelector(".e-menu.e-menu-parent").setAttribute("tabindex","-1"),i.querySelector(".e-menu-item.e-menu-caret-icon")&&i.querySelector(".e-menu-item.e-menu-caret-icon").setAttribute("tabindex","0"))}},e.prototype.whitespaceRemove=function(e){var t=e.element.querySelector(".e-separator");t&&(t.style.margin="0px")},e.prototype.multipleAxesCheckbox=function(e){var i=this;if(this.parent.element.id+"_multipleAxes"===e.element.id){(n=(0,t.createElement)("input",{id:this.parent.element.id+"_checkBox"})).style.display="none",this.parent.element.appendChild(n);var a=new Os.CheckBox({label:this.parent.localeObj.getConstant("multipleAxes"),cssClass:"e-multipleAxes"+(this.parent.cssClass?" "+this.parent.cssClass:""),checked:this.parent.chartSettings.enableMultipleAxis,change:function(){document.getElementById(i.parent.element.id+"_multipleAxes").click()},enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});e.element.innerText="",a.appendTo(n),["Pie","Funnel","Pyramid","Doughnut","Pareto"].indexOf(this.parent.chartSettings.chartSeries.type)>-1&&!e.element.classList.contains(vt)?(e.element.classList.add(vt),a.disabled=!0):["Pie","Funnel","Pyramid","Doughnut","Pareto"].indexOf(this.parent.chartSettings.chartSeries.type)<0&&e.element.classList.contains(vt)&&(e.element.classList.remove(vt),a.disabled=!1);var r=this.parent.element.querySelector("."+jt+".e-multipleAxes");e.element.appendChild(r)}else if(this.parent.element.id+"_showLegend"===e.element.id){var n;(n=(0,t.createElement)("input",{id:this.parent.element.id+"_showLegendCheckBox"})).style.display="none",this.parent.element.appendChild(n);a=new Os.CheckBox({label:this.parent.localeObj.getConstant("showLegend"),checked:this.getLableState(),cssClass:"e-showLegend"+(this.parent.cssClass?" "+this.parent.cssClass:""),change:function(){document.getElementById(i.parent.element.id+"_showLegend").click()},enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});e.element.innerText="",a.appendTo(n);r=this.parent.element.querySelector("."+jt+".e-showLegend");e.element.appendChild(r)}},e.prototype.getLableState=function(){var e=JSON.parse(this.parent.getChartSettings()).chartSettings;return e&&e.legendSettings&&void 0!==e.legendSettings.visible?this.showLableState=e.legendSettings.visible:this.showLableState=!0,this.showLableState},e.prototype.getAllChartItems=function(){return["Line","Column","Area","Bar","StackingColumn","StackingArea","StackingBar","StackingLine","StepLine","StepArea","SplineArea","Scatter","Spline","StackingColumn100","StackingBar100","StackingArea100","StackingLine100","Bubble","Pareto","Polar","Radar","Pie","Pyramid","Funnel","Doughnut"]},e.prototype.updateExportMenu=function(e){var i=[].slice.call(e.element.querySelectorAll("li"));"Table"===this.parent.currentView?((0,t.addClass)(i.slice(3),St),(0,t.removeClass)(i.slice(1,3),St)):((0,t.addClass)(i.slice(1,3),St),(0,t.removeClass)(i.slice(3),St))},e.prototype.updateSubtotalSelection=function(e){e.parentItem.id!==this.parent.element.id+"subtotalpositions"?((0,t.select)("#"+this.parent.element.id+"subtotal ."+li,e.element).classList.contains(oi)||(0,t.select)("#"+this.parent.element.id+"subtotal ."+li,e.element).classList.add(oi),(0,t.select)("#"+this.parent.element.id+"notsubtotal ."+li,e.element).classList.contains(oi)||(0,t.select)("#"+this.parent.element.id+"notsubtotal ."+li,e.element).classList.add(oi),(0,t.select)("#"+this.parent.element.id+"subtotalrow ."+li,e.element).classList.contains(oi)||(0,t.select)("#"+this.parent.element.id+"subtotalrow ."+li,e.element).classList.add(oi),(0,t.select)("#"+this.parent.element.id+"subtotalcolumn ."+li,e.element).classList.contains(oi)||(0,t.select)("#"+this.parent.element.id+"subtotalcolumn ."+li,e.element).classList.add(oi),this.parent.dataSourceSettings.showSubTotals&&this.parent.dataSourceSettings.showRowSubTotals&&!this.parent.dataSourceSettings.showColumnSubTotals?(0,t.select)("#"+this.parent.element.id+"subtotalrow ."+li,e.element).classList.remove(oi):this.parent.dataSourceSettings.showSubTotals&&!this.parent.dataSourceSettings.showRowSubTotals&&this.parent.dataSourceSettings.showColumnSubTotals?(0,t.select)("#"+this.parent.element.id+"subtotalcolumn ."+li,e.element).classList.remove(oi):this.parent.dataSourceSettings.showSubTotals&&this.parent.dataSourceSettings.showRowSubTotals&&this.parent.dataSourceSettings.showColumnSubTotals?(0,t.select)("#"+this.parent.element.id+"subtotal ."+li,e.element).classList.remove(oi):this.parent.dataSourceSettings.showSubTotals&&(this.parent.dataSourceSettings.showRowSubTotals||this.parent.dataSourceSettings.showColumnSubTotals)||(0,t.select)("#"+this.parent.element.id+"notsubtotal ."+li,e.element).classList.remove(oi)):((0,t.select)("#"+this.parent.element.id+"sub-none-position ."+li,e.element).classList.add(oi),"Auto"===this.parent.dataSourceSettings.subTotalsPosition&&(0,t.select)("#"+this.parent.element.id+"sub-none-position ."+li,e.element).classList.remove(oi),(0,t.select)("#"+this.parent.element.id+"sub-top-position ."+li,e.element).classList.add(oi),"Top"===this.parent.dataSourceSettings.subTotalsPosition&&(0,t.select)("#"+this.parent.element.id+"sub-top-position ."+li,e.element).classList.remove(oi),(0,t.select)("#"+this.parent.element.id+"sub-bottom-position ."+li,e.element).classList.add(oi),"Bottom"===this.parent.dataSourceSettings.subTotalsPosition&&(0,t.select)("#"+this.parent.element.id+"sub-bottom-position ."+li,e.element).classList.remove(oi))},e.prototype.updateGrandtotalSelection=function(e){e.parentItem.id!==this.parent.element.id+"grandtotalpositions"?((0,t.select)("#"+this.parent.element.id+"grandtotal ."+li,e.element).classList.contains(oi)||(0,t.select)("#"+this.parent.element.id+"grandtotal ."+li,e.element).classList.add(oi),(0,t.select)("#"+this.parent.element.id+"notgrandtotal ."+li,e.element).classList.contains(oi)||(0,t.select)("#"+this.parent.element.id+"notgrandtotal ."+li,e.element).classList.add(oi),(0,t.select)("#"+this.parent.element.id+"grandtotalrow ."+li,e.element).classList.contains(oi)||(0,t.select)("#"+this.parent.element.id+"grandtotalrow ."+li,e.element).classList.add(oi),(0,t.select)("#"+this.parent.element.id+"grandtotalcolumn ."+li,e.element).classList.contains(oi)||(0,t.select)("#"+this.parent.element.id+"grandtotalcolumn ."+li,e.element).classList.add(oi),this.parent.dataSourceSettings.showGrandTotals&&this.parent.dataSourceSettings.showRowGrandTotals&&!this.parent.dataSourceSettings.showColumnGrandTotals?(0,t.select)("#"+this.parent.element.id+"grandtotalrow ."+li,e.element).classList.remove(oi):this.parent.dataSourceSettings.showGrandTotals&&!this.parent.dataSourceSettings.showRowGrandTotals&&this.parent.dataSourceSettings.showColumnGrandTotals?(0,t.select)("#"+this.parent.element.id+"grandtotalcolumn ."+li,e.element).classList.remove(oi):this.parent.dataSourceSettings.showGrandTotals&&this.parent.dataSourceSettings.showRowGrandTotals&&this.parent.dataSourceSettings.showColumnGrandTotals?(0,t.select)("#"+this.parent.element.id+"grandtotal ."+li,e.element).classList.remove(oi):this.parent.dataSourceSettings.showGrandTotals&&(this.parent.dataSourceSettings.showRowGrandTotals||this.parent.dataSourceSettings.showColumnGrandTotals)||(0,t.select)("#"+this.parent.element.id+"notgrandtotal ."+li,e.element).classList.remove(oi)):((0,t.select)("#"+this.parent.element.id+"top-position ."+li,e.element).classList.add(oi),"Top"===this.parent.dataSourceSettings.grandTotalsPosition&&(0,t.select)("#"+this.parent.element.id+"top-position ."+li,e.element).classList.remove(oi),(0,t.select)("#"+this.parent.element.id+"bottom-position ."+li,e.element).classList.add(oi),"Bottom"===this.parent.dataSourceSettings.grandTotalsPosition&&(0,t.select)("#"+this.parent.element.id+"bottom-position ."+li,e.element).classList.remove(oi))},e.prototype.updateReportList=function(){if((0,t.select)("#"+this.parent.element.id+"_reportlist",this.parent.element)){var e=this.fetchReports(),i=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_reportlist",this.parent.element),vs.DropDownList);i.dataSource=e.reportName,""===this.currentReport&&i.dataSource.length>0?(i.value=i.dataSource[i.dataSource.length-1],i.text=i.dataSource[i.dataSource.length-1],this.currentReport=i.dataSource[i.dataSource.length-1]):(i.value=this.currentReport,i.text=this.currentReport),i.refresh()}},e.prototype.menuItemClick=function(e){var t,i=this,a={},r=e.item.id===this.parent.element.id+"grid"?Vr:e.item.id===this.parent.element.id+"_Column"||e.item.id===this.parent.element.id+"_Bar"||e.item.id===this.parent.element.id+"_Line"||e.item.id===this.parent.element.id+"_Area"||e.item.id===this.parent.element.id+"_Scatter"||e.item.id===this.parent.element.id+"_Polar"||e.item.id===this.parent.element.id+"_ChartMoreOption"?Hr:e.item.id===this.parent.element.id+"_multipleAxes"?Ur:e.item.id===this.parent.element.id+"_showLegend"?_r:e.item.id===this.parent.element.id+"pdf"?Br:e.item.id===this.parent.element.id+"png"?Gr:e.item.id===this.parent.element.id+"excel"?zr:e.item.id===this.parent.element.id+"csv"?Wr:e.item.id===this.parent.element.id+"jpeg"?Qr:e.item.id===this.parent.element.id+"svg"?Yr:e.item.id===this.parent.element.id+"notsubtotal"?Kr:e.item.id===this.parent.element.id+"subtotalrow"?Xr:e.item.id===this.parent.element.id+"subtotalcolumn"?Jr:e.item.id===this.parent.element.id+"subtotal"?Zr:e.item.id===this.parent.element.id+"notgrandtotal"?$r:e.item.id===this.parent.element.id+"grandtotalrow"?en:e.item.id===this.parent.element.id+"grandtotalcolumn"?tn:e.item.id===this.parent.element.id+"grandtotal"?an:e.item.id===this.parent.element.id+"numberFormattingMenu"?rn:e.item.id===this.parent.element.id+"conditionalFormattingMenu"?nn:"";if(this.parent.actionObj.actionName=r,!this.parent.actionBeginMethod()){(this.getAllChartItems().indexOf(e.item.id.split(this.parent.element.id+"_")[1])>-1||"ChartMoreOption"===e.item.id.split(this.parent.element.id+"_")[1]||"multipleAxes"===e.item.id.split(this.parent.element.id+"_")[1]||"showLegend"===e.item.id.split(this.parent.element.id+"_")[1])&&(t=e.item.id.split(this.parent.element.id+"_")[1]);try{switch(e.item.id){case this.parent.element.id+"grid":if(this.parent.grid&&this.parent.chart){this.parent.grid.element.style.display="",this.parent.chart.element.style.display="none",this.parent.chartSettings.enableMultipleAxis&&this.parent.chartSettings.enableScrollOnMultiAxis&&(this.parent.element.querySelector(".e-pivotchart").style.display="none"),this.parent.currentView="Table",this.parent.setProperties({displayOption:{primary:"Table"}},!0),this.parent.showGroupingBar&&this.parent.groupingBarModule&&(this.parent.element.querySelector(".e-pivot-grouping-bar")&&(this.parent.element.querySelector(".e-pivot-grouping-bar").style.display=""),this.parent.element.querySelector(".e-chart-grouping-bar")&&(this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none"));var n={toolbarInfo:{displayOption:this.parent.displayOption,gridSettings:this.parent.gridSettings}};this.parent.actionObj.actionInfo=n,this.parent.layoutRefresh()}break;case this.parent.element.id+"pdf":"Table"===this.parent.currentView?this.parent.pdfExport({fileName:"Export.pdf"},!1,void 0,!1):this.parent.chartExport("PDF",{fileName:"result"},void 0,null,void 0);break;case this.parent.element.id+"excel":a={excelExportProperties:{fileName:"Export.xlsx"},isBlob:void 0,isMultipleExport:void 0,workbook:void 0},this.parent.trigger(ji,a,(function(e){i.parent.excelExport(e.excelExportProperties,e.isMultipleExport,e.workbook,e.isBlob)}));break;case this.parent.element.id+"csv":a={excelExportProperties:{fileName:"Export.csv"},isBlob:!1,isMultipleExport:!1,workbook:void 0},this.parent.trigger(ji,a,(function(e){"Server"===i.parent.dataSourceSettings.mode?i.parent.getEngine("onCsvExport",null,null,null,null,null,null,null,null,e.excelExportProperties):i.parent.csvExport(e.excelExportProperties,e.isMultipleExport,e.workbook,e.isBlob)}));break;case this.parent.element.id+"png":this.parent.chartExport("PNG",{fileName:"result"},void 0,null,void 0);break;case this.parent.element.id+"jpeg":this.parent.chartExport("JPEG",{fileName:"result"},void 0,null,void 0);break;case this.parent.element.id+"svg":this.parent.chartExport("SVG",{fileName:"result"},void 0,null,void 0);break;case this.parent.element.id+"notsubtotal":this.parent.setProperties({dataSourceSettings:{showSubTotals:!1,showColumnSubTotals:!1,showRowSubTotals:!1}},!0),this.parent.refreshData();break;case this.parent.element.id+"subtotalrow":this.parent.setProperties({dataSourceSettings:{showSubTotals:!0,showColumnSubTotals:!1,showRowSubTotals:!0}},!0),this.parent.refreshData();break;case this.parent.element.id+"subtotalcolumn":this.parent.setProperties({dataSourceSettings:{showSubTotals:!0,showColumnSubTotals:!0,showRowSubTotals:!1}},!0),this.parent.refreshData();break;case this.parent.element.id+"subtotal":this.parent.setProperties({dataSourceSettings:{showSubTotals:!0,showColumnSubTotals:!0,showRowSubTotals:!0}},!0),this.parent.refreshData();break;case this.parent.element.id+"notgrandtotal":this.parent.setProperties({dataSourceSettings:{showGrandTotals:!1,showColumnGrandTotals:!1,showRowGrandTotals:!1}},!0),this.parent.refreshData();break;case this.parent.element.id+"grandtotalrow":this.parent.setProperties({dataSourceSettings:{showGrandTotals:!0,showColumnGrandTotals:!1,showRowGrandTotals:!0}},!0),this.parent.refreshData();break;case this.parent.element.id+"grandtotalcolumn":this.parent.setProperties({dataSourceSettings:{showGrandTotals:!0,showColumnGrandTotals:!0,showRowGrandTotals:!1}},!0),this.parent.refreshData();break;case this.parent.element.id+"grandtotal":this.parent.setProperties({dataSourceSettings:{showGrandTotals:!0,showColumnGrandTotals:!0,showRowGrandTotals:!0}},!0),this.parent.refreshData();break;case this.parent.element.id+"top-position":this.parent.setProperties({dataSourceSettings:{grandTotalsPosition:"Top"}},!0),this.parent.refreshData();break;case this.parent.element.id+"bottom-position":this.parent.setProperties({dataSourceSettings:{grandTotalsPosition:"Bottom"}},!0),this.parent.refreshData();break;case this.parent.element.id+"sub-top-position":this.parent.setProperties({dataSourceSettings:{subTotalsPosition:"Top"}},!0),this.parent.refreshData();break;case this.parent.element.id+"sub-bottom-position":this.parent.setProperties({dataSourceSettings:{subTotalsPosition:"Bottom"}},!0),this.parent.refreshData();break;case this.parent.element.id+"sub-none-position":this.parent.setProperties({dataSourceSettings:{subTotalsPosition:"Auto"}},!0),this.parent.refreshData();break;case this.parent.element.id+"numberFormattingMenu":this.parent.numberFormattingModule&&this.parent.numberFormattingModule.showNumberFormattingDialog();break;case this.parent.element.id+"conditionalFormattingMenu":this.parent.conditionalFormattingModule&&this.parent.conditionalFormattingModule.showConditionalFormattingDialog();break;case this.parent.element.id+"_"+t:e.item&&e.item.text&&("ChartMoreOption"===t?this.createChartTypeDialog():"multipleAxes"===t?(this.parent.chartSettings.enableScrollOnMultiAxis&&(this.isMultiAxisChange=!0),this.parent.chartSettings.enableMultipleAxis=!this.parent.chartSettings.enableMultipleAxis,this.updateChartType(this.parent.chartSettings.chartSeries.type,!0)):this.getAllChartItems().indexOf(t)>-1?this.updateChartType(t,!1):"showLegend"===t&&(this.parent.chart.legendSettings.visible=!this.showLableState,this.parent.chartSettings.legendSettings?this.parent.chartSettings.legendSettings.visible=!this.showLableState:this.parent.setProperties({chartSettings:{legendSettings:{visible:!this.showLableState}}},!0),this.updateChartType(this.parent.chartSettings.chartSeries.type,!0)))}}catch(e){this.parent.actionFailureMethod(e)}}},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on(xr,this.createToolbar,this)},e.prototype.getValidChartType=function(){for(var e=[],t=0;t<=this.parent.chartTypes.length;t++){var i=this.parent.chartTypes[t];this.getAllChartItems().indexOf(i)>-1&&e.indexOf(i)<0&&e.push(i)}return e},e.prototype.createChartTypeDialog=function(){var e=this,i=this.parent.element.appendChild((0,t.createElement)("div",{id:this.parent.element.id+"_ChartTypeDialog",className:"e-pivotchart-type-dialog"})),a=new Ni.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("chartTypeSettings"),content:this.getDialogContent(),isModal:!0,beforeOpen:this.beforeOpen.bind(this),visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:function(){e.chartTypeDialogUpdate()},isFlat:!1,buttonModel:{cssClass:ie+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:function(){e.removeDialog()},isFlat:!1,buttonModel:{cssClass:ae+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,target:this.parent.element,cssClass:this.parent.cssClass,close:this.removeDialog.bind(this)});a.isStringTemplate=!0,a.appendTo(i)},e.prototype.removeDialog=function(){var e=(0,t.select)("#"+this.parent.element.id+"_ChartTypeDialog",this.parent.element)?(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_ChartTypeDialog",this.parent.element),Ni.Dialog):null;e&&!e.isDestroyed&&e.destroy(),document.getElementById(this.parent.element.id+"_ChartTypeDialog")&&(0,t.remove)(document.getElementById(this.parent.element.id+"_ChartTypeDialog"))},e.prototype.chartTypeDialogUpdate=function(){var e=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_ChartTypeOption"),vs.DropDownList).value,i=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DialogMultipleAxis"),Os.CheckBox).checked,a=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DialogShowLabel"),Os.CheckBox).checked;this.parent.chart.legendSettings.visible=a,this.chartLableState&&(this.parent.chart.legendSettings.visible=a,this.parent.chartSettings.legendSettings?this.parent.chartSettings.legendSettings.visible=a:this.parent.setProperties({chartSettings:{legendSettings:{visible:a}}},!0)),this.updateChartType(e,!1),this.parent.chartSettings.enableMultipleAxis=i,this.parent.chartSettings.multipleAxisMode=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_AxisModeOption"),vs.DropDownList).value,((0,t.select)("#"+this.parent.element.id+"_ChartTypeDialog",document)?(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_ChartTypeDialog",document),Ni.Dialog):null).close()},e.prototype.updateChartType=function(e,i){if(this.getAllChartItems().indexOf(e)>-1&&this.parent.chart){this.parent.currentView="Chart",this.parent.setProperties({displayOption:{primary:"Chart"}},!0),this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&(this.parent.element.querySelector("."+ei).style.width=(0,t.formatUnit)(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber()),this.parent.element.querySelector("."+ei).style.height=(0,t.formatUnit)(this.parent.pivotChartModule.getChartHeight())),this.parent.chart.setProperties({width:(0,t.formatUnit)(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber()),height:(0,t.formatUnit)(this.parent.pivotChartModule.getChartHeight())},!0),this.parent.chartSettings.chartSeries.type=e;var a={toolbarInfo:{displayOption:this.parent.displayOption,chartSettings:this.parent.chartSettings}};this.parent.actionObj.actionInfo=a,this.parent.chartSettings.chartSeries.type!==e||i||this.parent.chart.refresh()}},e.prototype.getDialogContent=function(){var e=(0,t.createElement)("div",{className:"e-chart-type-div-content"}),i=(0,t.createElement)("div",{className:"e-chart-type-option-container"}),a=(0,t.createElement)("div",{className:"e-multiple-axes-mode-container"}),r=(0,t.createElement)("div",{className:"e-chart-type-option-text"});r.innerText=this.parent.localeObj.getConstant("ChartType");var n=(0,t.createElement)("div",{className:"e-multiple-axes-mode-text"});n.innerText=this.parent.localeObj.getConstant("multipleAxisMode");var s=(0,t.createElement)("div",{id:this.parent.element.id+"_ChartTypeOption"}),o=(0,t.createElement)("div",{id:this.parent.element.id+"_AxisModeOption"});i.appendChild(r),i.appendChild(s);for(var l=[],d=[{value:"Stacked",text:this.parent.localeObj.getConstant("stacked")},{value:"Single",text:this.parent.localeObj.getConstant("single")},{value:"Combined",text:this.parent.localeObj.getConstant("combined")}],h=this.getValidChartType(),p=0;p<h.length;p++)l.push({value:h[p],text:this.parent.localeObj.getConstant(h[p].toLowerCase())});var u=new vs.DropDownList({dataSource:l,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:this.parent.chartSettings.chartSeries.type?this.parent.chartSettings.chartSeries.type:this.getValidChartType()[0],width:"100%",change:this.changeDropDown.bind(this),cssClass:this.parent.cssClass});u.isStringTemplate=!0,u.appendTo(s),e.appendChild(i);var c=(0,t.createElement)("input",{id:this.parent.element.id+"_DialogMultipleAxis",attrs:{type:"checkbox"}});e.appendChild(c);var g=(0,t.createElement)("input",{id:this.parent.element.id+"_DialogShowLabel",attrs:{type:"checkbox"}});e.appendChild(g),a.appendChild(n),a.appendChild(o),e.appendChild(a);var m=new vs.DropDownList({dataSource:d,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:this.parent.chartSettings.multipleAxisMode?this.parent.chartSettings.multipleAxisMode:"Stacked",width:"100%",enabled:this.parent.chartSettings.enableMultipleAxis,cssClass:this.parent.cssClass});return m.isStringTemplate=!0,m.appendTo(o),e},e.prototype.changeDropDown=function(e){var i=JSON.parse(this.parent.getChartSettings()).chartSettings;if(i&&i.legendSettings&&void 0!==i.legendSettings.visible||((0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DialogShowLabel"),Os.CheckBox).checked=!0),["Pie","Funnel","Pyramid","Doughnut","Pareto"].indexOf(e.value.toString())>-1)(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DialogMultipleAxis"),Os.CheckBox).disabled=!0,(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_AxisModeOption"),vs.DropDownList).enabled=!1;else{var a=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DialogMultipleAxis"),Os.CheckBox);a.disabled=!1,(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_AxisModeOption"),vs.DropDownList).enabled=a.checked}},e.prototype.beforeOpen=function(){var e=this,i=new Os.CheckBox({label:this.parent.localeObj.getConstant("multipleAxes"),cssClass:"e-dialog-multiple-axis"+(this.parent.cssClass?" "+this.parent.cssClass:""),checked:!!this.parent.chartSettings.enableMultipleAxis&&this.parent.chartSettings.enableMultipleAxis,change:function(i){(0,t.getInstance)((0,t.select)("#"+e.parent.element.id+"_AxisModeOption"),vs.DropDownList).enabled=i.checked},enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer}),a=new Os.CheckBox({label:this.parent.localeObj.getConstant("showLegend"),checked:this.getLableState(),change:function(){e.chartLableState=!0},cssClass:"e-dialog-show-legend"+(this.parent.cssClass?" "+this.parent.cssClass:""),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer}),r=(0,t.select)("#"+this.parent.element.id+"_ChartTypeDialog",document)?(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_ChartTypeDialog",document),Ni.Dialog):null;a.appendTo((0,t.select)("#"+this.parent.element.id+"_DialogShowLabel",r.element)),i.appendTo((0,t.select)("#"+this.parent.element.id+"_DialogMultipleAxis",r.element)),["Pie","Funnel","Pyramid","Doughnut","Pareto"].indexOf(this.parent.chartSettings.chartSeries.type)>-1&&(i.disabled=!0,(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_AxisModeOption"),vs.DropDownList).enabled=!1);var n=JSON.parse(this.parent.getChartSettings()).chartSettings;n&&n.legendSettings&&void 0!==n.legendSettings.visible?this.chartLableState=!0:this.chartLableState=!1},e.prototype.refreshToolbar=function(){this.destroy(),this.createToolbar()},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(xr,this.createToolbar)},e.prototype.destroy=function(){this.removeEventListener();var e=(0,t.select)("#"+this.parent.element.id+"_ConfirmDialog",document),i=e?(0,t.getInstance)(e,Ni.Dialog):null;i&&!i.isDestroyed&&(i.destroy(),i=null);var a=(e=(0,t.select)("#"+this.parent.element.id+"report-dialog",document))?(0,t.getInstance)(e,Ni.Dialog):null;a&&!a.isDestroyed&&(a.destroy(),a=null);var r=(e=(0,t.select)("#"+this.parent.element.id+"mdx-dialog",document))?(0,t.getInstance)(e,Ni.Dialog):null;r&&!r.isDestroyed&&(r.destroy(),r=null);var n=(e=(0,t.select)("#"+this.parent.element.id+"chart_menu",document))?(0,t.getInstance)(e,ms.Menu):null;n&&!n.isDestroyed&&(n.destroy(),n=null);var s=(e=(0,t.select)("#"+this.parent.element.id+"_ChartTypeDialog",document))?(0,t.getInstance)(e,Ni.Dialog):null;s&&!s.isDestroyed&&(s.destroy(),s=null);var o=(e=(0,t.select)("#"+this.parent.element.id+"export_menu",document))?(0,t.getInstance)(e,ms.Menu):null;o&&!o.isDestroyed&&(o.destroy(),o=null);var l=(e=(0,t.select)("#"+this.parent.element.id+"subtotal_menu",document))?(0,t.getInstance)(e,ms.Menu):null;l&&!l.isDestroyed&&(l.destroy(),l=null);var d=(e=(0,t.select)("#"+this.parent.element.id+"grandtotal_menu",document))?(0,t.getInstance)(e,ms.Menu):null;d&&!d.isDestroyed&&(d.destroy(),d=null);var h=(e=(0,t.select)("#"+this.parent.element.id+"formatting_menu",document))?(0,t.getInstance)(e,ms.Menu):null;h&&!h.isDestroyed&&(h.destroy(),h=null);var p=(e=(0,t.select)("#"+this.parent.element.id+"_reportlist",document))?(0,t.getInstance)(e,vs.DropDownList):null;p&&!p.isDestroyed&&(p.destroy(),p=null),this.toolbar&&!this.toolbar.isDestroyed&&(this.toolbar.destroy(),this.toolbar=null),(e=(0,t.select)("#"+this.parent.element.id+"pivot-toolbar",document))&&(0,t.remove)(e)},e.prototype.focusToolBar=function(){(0,t.removeClass)(document.querySelector("."+Xt).querySelectorAll(".e-menu-item.e-focused"),"e-focused"),(0,t.removeClass)(document.querySelector("."+Xt).querySelectorAll(".e-menu-item.e-selected"),"e-selected"),document.querySelector(".e-toolbar-items")&&(0,t.addClass)([document.querySelector(".e-toolbar-items")],"e-focused")},e}(),Ul=function(){function e(e){this.parent=e,this.parent.numberFormattingModule=this,this.removeEventListener(),this.addEventListener(),this.newFormat=[],this.lastFormattedValue=[]}return e.prototype.getModuleName=function(){return"numberFormatting"},e.prototype.showNumberFormattingDialog=function(){var e,i=this,a=(0,t.createElement)("div",{id:this.parent.element.id+"_FormatDialog",className:"e-pivot-format-dialog"});this.parent.element.appendChild(a),this.dialog=new Ni.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("numberFormat"),content:this.getDialogContent(),isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"320px",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.updateFormatting.bind(this),isFlat:!1,buttonModel:{cssClass:ie+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("apply"),isPrimary:!0}},{click:function(){i.dialog.hide()},isFlat:!1,buttonModel:{cssClass:ae+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,cssClass:this.parent.cssClass,target:this.parent.element,close:this.removeDialog.bind(this)}),this.dialog.isStringTemplate=!0,this.dialog.appendTo(a),this.dialog.element.querySelector("."+Nt).innerText=this.parent.localeObj.getConstant("numberFormat"),this.newFormat=[{name:this.parent.localeObj.getConstant("AllValues"),format:"N0",useGrouping:!0,type:void 0}];for(var r=[],n=0;n<this.parent.dataSourceSettings.formatSettings.length;n++)e={name:this.parent.dataSourceSettings.formatSettings[n].name,format:this.parent.dataSourceSettings.formatSettings[n].format,useGrouping:this.parent.dataSourceSettings.formatSettings[n].useGrouping,type:this.parent.dataSourceSettings.formatSettings[n].type},this.newFormat.push(e);for(n=0;n<this.newFormat.length;n++)r.push(this.newFormat[n].name);for(var s=0;s<this.parent.dataSourceSettings.values.length;s++)-1===r.indexOf(this.parent.dataSourceSettings.values[s].name)&&(e={name:this.parent.dataSourceSettings.values[s].name,format:"N0",useGrouping:!0},this.newFormat.push(e));this.renderControls()},e.prototype.getDialogContent=function(){var e=(0,t.createElement)("div",{id:this.parent.element.id+"_FormatDialogOuter",className:"e-pivot-format-dialog-outer"}),i=(0,t.createElement)("table",{id:this.parent.element.id+"_FormatTable",className:"e-pivot-format-table",attrs:{role:"tableItems"}}),a=(0,t.createElement)("tr"),r=(0,t.createElement)("td"),n=(0,t.createElement)("div",{id:this.parent.element.id+"_FormatValueLable",className:"e-pivot-format-value-lable"});n.innerText=this.parent.localeObj.getConstant("values");var s=(0,t.createElement)("div",{id:this.parent.element.id+"_FormatValueDrop"});r.appendChild(n),r.appendChild(s),a.appendChild(r),i.appendChild(a),a=(0,t.createElement)("tr"),r=(0,t.createElement)("td");var o=(0,t.createElement)("div",{id:this.parent.element.id+"_FormatLable",className:"e-pivot-format-lable"});o.innerText=this.parent.localeObj.getConstant("formatType");var l=(0,t.createElement)("div",{id:this.parent.element.id+"_FormatDrop"});r.appendChild(o),r.appendChild(l),a.appendChild(r),i.appendChild(a),a=(0,t.createElement)("tr"),r=(0,t.createElement)("td");var d=(0,t.createElement)("div",{id:this.parent.element.id+"_GroupingLable",className:"e-pivot-format-grouping-lable"});d.innerText=this.parent.localeObj.getConstant("grouping");var h=(0,t.createElement)("div",{id:this.parent.element.id+"_GroupingDrop"});r.appendChild(d),r.appendChild(h),a.appendChild(r),i.appendChild(a),a=(0,t.createElement)("tr"),r=(0,t.createElement)("td");var p=(0,t.createElement)("div",{id:this.parent.element.id+"_DecimalLable",className:"e-pivot-format-decimal-lable"});p.innerText=this.parent.localeObj.getConstant("decimalPlaces");var u=(0,t.createElement)("div",{id:this.parent.element.id+"_DecimalDrop"});return r.appendChild(p),r.appendChild(u),a.appendChild(r),i.appendChild(a),a=(0,t.createElement)("tr"),r=(0,t.createElement)("td"),this.customLable=(0,t.createElement)("div",{id:this.parent.element.id+"_CustomLable",className:"e-pivot-format-custom-lable"}),this.customLable.innerText=this.parent.localeObj.getConstant("customFormatString"),this.customText=(0,t.createElement)("input",{id:this.parent.element.id+"_CustomText",attrs:{type:"text",tabindex:"0"},className:Dt+" e-pivot-format-custom-text"}),r.appendChild(this.customLable),r.appendChild(this.customText),a.appendChild(r),i.appendChild(a),a=(0,t.createElement)("tr"),i.appendChild(a),e.appendChild(i),e},e.prototype.renderControls=function(){var e,i,a;if((0,t.select)("#"+this.parent.element.id+"_FormatValueDrop",this.dialog.element)){var r=[];r.push({index:0,name:this.parent.localeObj.getConstant("AllValues"),field:this.parent.localeObj.getConstant("AllValues")});for(var n=0;n<this.parent.dataSourceSettings.values.length;n++){var s=this.parent.dataSourceSettings.values[n].caption||this.parent.dataSourceSettings.values[n].name;s=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(s):s,r.push({index:n+1,name:s,field:this.parent.dataSourceSettings.values[n].name})}(e=new vs.DropDownList({dataSource:r,fields:{text:"name",value:"field"},enableRtl:this.parent.enableRtl,locale:this.parent.locale,index:0,cssClass:"e-pivot-format-value-drop"+(this.parent.cssClass?" "+this.parent.cssClass:""),change:this.valueChange.bind(this),width:"100%",open:this.customUpdate.bind(this)})).isStringTemplate=!0,e.appendTo((0,t.select)("#"+this.parent.element.id+"_FormatValueDrop",this.dialog.element))}if((0,t.select)("#"+this.parent.element.id+"_FormatDrop",this.dialog.element)){var o=[{index:0,name:this.parent.localeObj.getConstant("number")},{index:1,name:this.parent.localeObj.getConstant("currency")},{index:2,name:this.parent.localeObj.getConstant("percentage")},{index:3,name:this.parent.localeObj.getConstant("Custom")}];(i=new vs.DropDownList({dataSource:o,fields:{text:"name",value:"name"},index:0,change:this.dropDownChange.bind(this),enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:"e-pivot-format-drop"+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%"})).isStringTemplate=!0,i.appendTo((0,t.select)("#"+this.parent.element.id+"_FormatDrop",this.dialog.element))}if((0,t.select)("#"+this.parent.element.id+"_GroupingDrop",this.dialog.element)){o=[{index:0,name:this.parent.localeObj.getConstant("true")},{index:1,name:this.parent.localeObj.getConstant("false")}];(a=new vs.DropDownList({dataSource:o,fields:{text:"name",value:"name"},enableRtl:this.parent.enableRtl,locale:this.parent.locale,index:0,cssClass:"e-pivot-format-grouping-drop"+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:this.groupingChange.bind(this)})).isStringTemplate=!0,a.appendTo((0,t.select)("#"+this.parent.element.id+"_GroupingDrop",this.dialog.element))}if((0,t.select)("#"+this.parent.element.id+"_DecimalDrop",this.dialog.element)){o=[{index:0,name:0},{index:1,name:1},{index:2,name:2},{index:3,name:3},{index:4,name:4},{index:5,name:5},{index:6,name:6},{index:7,name:7},{index:8,name:8},{index:9,name:9},{index:10,name:10}];var l=new vs.DropDownList({dataSource:o,fields:{text:"name",value:"name"},enableRtl:this.parent.enableRtl,locale:this.parent.locale,index:0,cssClass:"e-pivot-format-decimal-drop"+(this.parent.cssClass?" "+this.parent.cssClass:""),popupHeight:150,width:"100%",change:this.decimalChange.bind(this)});l.isStringTemplate=!0,l.appendTo((0,t.select)("#"+this.parent.element.id+"_DecimalDrop",this.dialog.element))}if(i.value!==this.parent.localeObj.getConstant("Custom")&&(this.customText.disabled=!0),0!==this.lastFormattedValue.length){e.value=this.lastFormattedValue[0].name;var d=this.lastFormattedValue[0].format,h=""===d?"":d.split("")[0].toLowerCase(),p=this.lastFormattedValue[0].useGrouping?this.parent.localeObj.getConstant("true"):this.parent.localeObj.getConstant("false");this.updateFormattingDialog(d,h,p)}},e.prototype.valueChange=function(e){for(var i=this.newFormat,a=!1,r=0;r<i.length;r++)if(i[r].name===e.value){var n=i[r].format,s=""===n?"":n.split("")[0].toLowerCase(),o=i[r].useGrouping?this.parent.localeObj.getConstant("true"):this.parent.localeObj.getConstant("false");this.updateFormattingDialog(n,s,o),a=!0;break}a||((0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_FormatDrop",this.parent.element),vs.DropDownList).value=this.parent.localeObj.getConstant("number"),(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DecimalDrop",this.parent.element),vs.DropDownList).value=0,(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_GroupingDrop",this.parent.element),vs.DropDownList).value=this.parent.localeObj.getConstant("true"))},e.prototype.updateFormattingDialog=function(e,i,a){var r=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_FormatDrop",this.parent.element),vs.DropDownList);2===e.length&&["n","p","c"].indexOf(i)>-1?(r.value="n"===i?this.parent.localeObj.getConstant("number"):"p"===i?this.parent.localeObj.getConstant("percentage"):"c"===i?this.parent.localeObj.getConstant("currency"):this.parent.localeObj.getConstant("number"),(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DecimalDrop",this.parent.element),vs.DropDownList).value=Number(e.split("")[1]),(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_GroupingDrop",this.parent.element),vs.DropDownList).value=a):(r.value=this.parent.localeObj.getConstant("Custom"),this.customText.value=e)},e.prototype.customUpdate=function(){if((0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_FormatDrop",this.parent.element),vs.DropDownList).value===this.parent.localeObj.getConstant("Custom")){var e=this.getIndexValue();this.newFormat[e].format=this.customText.value}},e.prototype.dropDownChange=function(e){var i=this.getIndexValue(),a=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_GroupingDrop",this.parent.element),vs.DropDownList),r=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DecimalDrop",this.parent.element),vs.DropDownList);if(e.value===this.parent.localeObj.getConstant("Custom"))this.customText.disabled=!1,a.enabled=!1,r.enabled=!1,this.newFormat[i].format=this.customText.value;else{var n=this.formattedText();this.newFormat[i].format=n,this.customText.disabled=!0,a.enabled=!0,r.enabled=!0,this.customText.value=""}},e.prototype.groupingChange=function(){var e=this.getIndexValue(),i=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_GroupingDrop",this.parent.element),vs.DropDownList);this.newFormat[e].useGrouping=i.value===this.parent.localeObj.getConstant("true")},e.prototype.getIndexValue=function(){for(var e=[],i=0;i<this.newFormat.length;i++)e.push(this.newFormat[i].name);var a=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_FormatValueDrop",this.parent.element),vs.DropDownList);return e.indexOf(a.value.toString())},e.prototype.decimalChange=function(){var e=this.getIndexValue(),t=this.formattedText();this.newFormat[e].format=t},e.prototype.formattedText=function(){var e=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_FormatDrop",this.parent.element),vs.DropDownList),i=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DecimalDrop",this.parent.element),vs.DropDownList);return e.value===this.parent.localeObj.getConstant("number")||e.value===this.parent.localeObj.getConstant("percentage")||e.value===this.parent.localeObj.getConstant("currency")?(e.value===this.parent.localeObj.getConstant("number")?"N":e.value===this.parent.localeObj.getConstant("currency")?"C":"P")+i.value:this.customText.value},e.prototype.removeDialog=function(){this.dialog&&!this.dialog.isDestroyed&&this.dialog.destroy(),document.getElementById(this.parent.element.id+"_FormatDialog")&&(0,t.remove)(document.getElementById(this.parent.element.id+"_FormatDialog"))},e.prototype.updateFormatting=function(){var e=this,i=this.formattedText(),a=this.getIndexValue();this.newFormat=this.newFormat.splice(a,1);for(var r=(0,t.extend)([],this.newFormat,!0),n=this.parent.dataSourceSettings.formatSettings,s=0;s<n.length;s++)this.insertFormat(n[s].name,n[s].format,n[s].type,n[s].currency,n[s].useGrouping);var o=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_FormatValueDrop",this.parent.element),vs.DropDownList);if(o.value===this.parent.localeObj.getConstant("AllValues"))for(s=0;s<this.parent.dataSourceSettings.values.length;s++)this.insertFormat(this.parent.dataSourceSettings.values[s].name,i);else this.insertFormat(o.value.toString(),i);var l={formatSettings:Di.cloneFormatSettings(this.newFormat),formatName:o.value.toString(),cancel:!1};this.parent.trigger(tr,l,(function(t){if(t.cancel)e.dialog.close(),e.parent.setProperties({dataSourceSettings:{formatSettings:r}},!0);else{if("olap"===e.parent.dataType)for(var i=function(i){var a=Di.getFieldInfo(t.formatSettings[i].name,e.parent);e.parent.dataSourceSettings.calculatedFieldSettings.forEach((function(e){e.name===a.fieldName&&(e.formatString=t.formatSettings[i].format)}))},a=0;a<t.formatSettings.length;a++)i(a);e.parent.setProperties({dataSourceSettings:{formatSettings:t.formatSettings}},!0);var n={numberFormattingInfo:e.parent.dataSourceSettings.formatSettings};e.parent.actionObj.actionInfo=n;try{e.parent.updateDataSource(),e.dialog.close()}catch(t){e.parent.setProperties({dataSourceSettings:{formatSettings:r}},!0),e.parent.pivotCommon.errorDialog.createErrorDialog(e.parent.localeObj.getConstant("error"),e.parent.localeObj.getConstant("invalidFormat")),e.parent.hideWaitingPopup()}}}))},e.prototype.insertFormat=function(e,i,a,r,n){for(var s=!1,o=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_GroupingDrop",this.parent.element),vs.DropDownList),l={name:e,format:i,useGrouping:(0,t.isNullOrUndefined)(n)?o.value===this.parent.localeObj.getConstant("true"):n,type:a,currency:r},d=this.newFormat,h=0;h<d.length;h++)d[h].name===e&&(d[h]=l,s=!0);s||d.push(l),this.lastFormattedValue=[],this.lastFormattedValue.push(l)},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on(Tr,this.showNumberFormattingDialog,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(Tr,this.showNumberFormattingDialog)},e.prototype.destroy=function(){this.dialog&&!this.dialog.isDestroyed&&(this.dialog.destroy(),this.dialog=null),this.removeEventListener()},e}(),_l=function(){function e(e){this.dateGroup=/_date_group_years|_date_group_quarters|_date_group_quarterYear|_date_group_months|_date_group_days|_date_group_hours|_date_group_minutes|_date_group_seconds/g,this.parent=e,this.parent.groupingModule=this,this.addEventListener()}return e.prototype.getModuleName=function(){return"grouping"},e.prototype.render=function(e){var t=e.target,i=e.option,a=e.parentElement,r=[];this.parentElement=a,this.isUpdate=!1;var n=parseInt(t.getAttribute("aria-colindex"),10)-1,s=Number(t.getAttribute("index")),o=this.parent.engineModule.pivotValues[s][n],l=o.valueSort.axis.toString();(r=this.getSelectedCells(o.axis,l,o.actualText.toString())).push({axis:o.axis,fieldName:l,name:o.actualText.toString(),cellInfo:o}),-1!==i.replace(a.id,"").indexOf("_custom_group")?this.createGroupSettings(l,r):this.updateUnGroupSettings(l,r)},e.prototype.getSelectedOptions=function(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];-1===Di.inArray(r.name,t)&&t.push(r.name)}return t},e.prototype.createGroupSettings=function(e,t){var i=this.parent.engineModule.fieldList[e],a=this.getGroupSettings(e);if(t.length>0){var r=void 0,n=!1;if(i.isCustomField)if(a)a&&"Custom"===a.type?1===t.length?n=!0:(n=!1,r="custom"):a&&"Number"===a.type&&(n=!1,r="number");else{var s=this.getGroupSettings(e.replace(this.dateGroup,"")),o=this.getGroupSettings(e.replace(/_custom_group/g,""));s?(n=!1,r="date",e=e.replace(this.dateGroup,"")):o&&(n=1===t.length,r="custom")}else a?"Number"===a.type||"Date"===a.type?(n=!1,r="Date"===a.type?"date":"number"):"Custom"===a.type&&(n=1===t.length,r="custom"):"number"===i.type||-1!==["datetime","date"].indexOf(i.type)||this.isDateType(e)?(n=!1,r=1===t.length?-1!==["datetime","date"].indexOf(i.type)||this.isDateType(e)?"date":"number":"custom"):"string"===i.type&&(n=1===t.length,r="custom");n?(this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("warning"),this.parent.localeObj.getConstant("invalidSelection")),this.parent.grid.clearSelection()):r&&""!==r&&this.createGroupDialog(e,r,t)}},e.prototype.updateUnGroupSettings=function(e,t){var i=this.parent.engineModule.fieldList[e],a=Di.cloneGroupSettings(this.parent.dataSourceSettings.groupSettings),r=this.getGroupSettings(e);if(t.length>0){var n=void 0;if(i.isCustomField)if(r)"Custom"===r.type&&(n="custom");else{var s=this.getGroupSettings(e.replace(this.dateGroup,"")),o=this.getGroupSettings(e.replace(/_custom_group/g,""));s?(n="date",e=e.replace(this.dateGroup,"")):o&&(n="custom")}else r&&("Number"!==r.type&&"Date"!==r.type||(n="Date"===r.type?"date":"number"));if("date"===n||"number"===n)a=this.validateSettings(e,a,n,[]);else if("custom"===n){var l=this.getSelectedOptions(t);a=this.validateSettings(e,a,n,l)}this.updateDateSource(a,n)}},e.prototype.updateDateSource=function(e,t){this.isUpdate&&(this.parent.setProperties({dataSourceSettings:{groupSettings:e}},!0),this.parent.updateGroupingReport(e,"date"===t?"Date":"custom"===t?"Custom":"Number"),"Server"===this.parent.dataSourceSettings.mode?this.parent.getEngine("onRefresh"):this.parent.initEngine())},e.prototype.removeGroupSettings=function(e,t,i,a){var r=a.indexOf(e);if(-1!==r)for(var n=i[r],s=0,o=n.customGroups.length;s<o;s++)if(n.customGroups[s]){var l=n.customGroups[s];-1!==Di.inArray(l.groupName,t)&&(i=this.modifyParentGroupItems(e,i,[l.groupName],l.items,a),n.customGroups.splice(s,1),this.isUpdate=!0,s--,o--)}return delete this.parent.engineModule.groupingFieldsInfo[e],i},e.prototype.getGroupSettings=function(e){for(var t=0,i=this.parent.dataSourceSettings.groupSettings;t<i.length;t++){var a=i[t];if(a.name===e)return a}},e.prototype.isDateType=function(e){for(var t=0,i=this.parent.dataSourceSettings.formatSettings;t<i.length;t++){var a=i[t];if(a.name===e&&a.type)return!0}return!1},e.prototype.getSelectedCells=function(e,t,i){for(var a=[],r=this.parent.element.querySelectorAll("."+Rt+",."+kt),n=0;n<r.length;n++){var s=r[n],o=parseInt(s.getAttribute("aria-colindex"),10)-1,l=Number(s.getAttribute("index")),d=this.parent.engineModule.pivotValues[l][o];d&&d.axis===e&&"grand sum"!==d.type&&"sum"!==d.type&&d.valueSort.axis===t&&i!==d.actualText.toString()&&a.push({axis:d.axis,fieldName:d.valueSort.axis.toString(),name:d.actualText.toString(),cellInfo:d})}return a},e.prototype.createGroupDialog=function(e,i,a){var r=(0,t.createElement)("div",{id:this.parentElement.id+"_GroupDialog",className:"e-group-field-settings",attrs:{"data-field":e,"data-type":i}});this.parentElement.appendChild(r);var n=new Ni.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("grouping"),content:this.createGroupOptions(e,i),isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:300,height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.updateGroupSettings.bind(this,a),isFlat:!1,buttonModel:{cssClass:ie+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:function(){n.hide()},isFlat:!1,buttonModel:{cssClass:ae+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,close:this.removeDialog.bind(this),target:this.parentElement,cssClass:this.parent.cssClass});n.isStringTemplate=!0,n.appendTo(r)},e.prototype.createGroupOptions=function(e,i){var a=this,r=this,n=(0,t.createElement)("div",{className:"e-group-field-div-content",id:this.parentElement.id+"_group_field_div_content",attrs:{"data-fieldName":e,"data-type":i}}),s=(0,t.createElement)("div",{className:"e-group-option-container"});n.appendChild(s);var o=this.parent.dataSourceSettings,l=Di.getFieldByName(e,o.groupSettings);switch(i){case"custom":var d=void 0,h=o.rows;h=h.concat(o.columns,o.values,o.filters);var p=Di.getFieldByName(e.replace(/_custom_group/g,""),h);if((0,t.isNullOrUndefined)(p)&&!(0,t.isNullOrUndefined)(this.parent.clonedReport)){var u=this.parent.clonedReport,c=u.rows;c=c.concat(u.columns,u.values,u.filters),p=Di.getFieldByName(e.replace(/_custom_group/g,""),c)}var g=Di.getFieldByName(e,h),m=Di.getFieldByName(e+"_custom_group",h);if(g){var f=e+"_custom_group";d=m?m.caption:this.parent.engineModule.fieldList[p.name].caption+(f.match(/_custom_group/g).length+1)}var v=(0,t.createElement)("div",{className:"e-caption-option-text"});v.innerText=this.parent.localeObj.getConstant("groupFieldCaption");var S=(0,t.createElement)("div",{className:"e-group-caption-container"}),y=(0,t.createElement)("input",{id:this.parentElement.id+"group_caption_option",className:"e-group-caption-text",attrs:{type:"text"}});S.appendChild(v),S.appendChild(y),s.appendChild(S);var b=(0,t.createElement)("div",{className:"e-input-option-text"});b.innerText=this.parent.localeObj.getConstant("groupTitle");var C=(0,t.createElement)("div",{className:"e-group-input-container"}),x=(0,t.createElement)("input",{id:this.parentElement.id+"group_input_option",className:"e-group-input-text",attrs:{type:"text"}});C.appendChild(b),C.appendChild(x),s.appendChild(C);var w=new fs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("captionName"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,value:d,width:"100%",cssClass:this.parent.cssClass});w.isStringTemplate=!0,w.appendTo(y);var T=new fs.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("groupName"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,width:"100%",cssClass:this.parent.cssClass});T.isStringTemplate=!0,T.appendTo(x);break;case"date":case"number":var M=(0,t.createElement)("div",{className:"e-group-start-option-container"}),D=(0,t.createElement)("input",{id:this.parentElement.id+"group_start_option",className:"e-group_start_option",attrs:{type:"checkbox"}}),O=(0,t.createElement)("input",{id:this.parentElement.id+"group_start_input",className:"e-group_start_input",attrs:{type:"text"}});M.appendChild(D),M.appendChild(O),s.appendChild(M);var P=(0,t.createElement)("div",{className:"e-group-end-option-container"}),N=(0,t.createElement)("input",{id:this.parentElement.id+"group_end_option",className:"e-group_end_option",attrs:{type:"checkbox"}}),E=(0,t.createElement)("input",{id:this.parentElement.id+"group_end_input",className:"e-group_end_input",attrs:{type:"text"}});P.appendChild(N),P.appendChild(E),s.appendChild(P);var I=(0,t.createElement)("div",{className:"e-group-interval-option-container"}),F=(0,t.createElement)("div",{className:"e-group-inerval-option-text"});F.innerText=this.parent.localeObj.getConstant("groupBy");var L=(0,t.createElement)("input",{id:this.parentElement.id+"group_interval_input",className:"e-group_interval_input",attrs:{type:"text"}});I.appendChild(F),I.appendChild(L),s.appendChild(I);var A=void 0,R=void 0;if("date"===i){var k=[],j=[{value:"Seconds",text:this.parent.localeObj.getConstant("Seconds")},{value:"Minutes",text:this.parent.localeObj.getConstant("Minutes")},{value:"Hours",text:this.parent.localeObj.getConstant("Hours")},{value:"Days",text:this.parent.localeObj.getConstant("Days")},{value:"Months",text:this.parent.localeObj.getConstant("Months")},{value:"QuarterYear",text:this.parent.localeObj.getConstant("QuarterYear")},{value:"Quarters",text:this.parent.localeObj.getConstant("Quarters")},{value:"Years",text:this.parent.localeObj.getConstant("Years")}];l&&"Date"===l.type?(k=l.groupInterval,A=l.startingAt?l.startingAt.toString():void 0,R=l.endingAt?l.endingAt.toString():void 0):k=["Months"],(V=new Ms.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,format:"dd/MM/yyyy hh:mm:ss a",enabled:!(void 0===A),width:"100%",cssClass:this.parent.cssClass})).isStringTemplate=!0,V.appendTo(O),(H=new Ms.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,format:"dd/MM/yyyy hh:mm:ss a",enabled:!(void 0===R),width:"100%",cssClass:this.parent.cssClass})).isStringTemplate=!0,H.appendTo(E),vs.MultiSelect.Inject(vs.CheckBoxSelection);var q=new vs.MultiSelect({dataSource:j,value:k,fields:{text:"text",value:"value"},mode:"CheckBox",showDropDownIcon:!0,enableSelectionOrder:!1,placeholder:this.parent.localeObj.getConstant("selectGroup"),filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+this.parent.localeObj.getConstant("Months"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass,select:function(){(0,t.getInstance)((0,t.select)("#"+r.parentElement.id+"_GroupDialog",document),Ni.Dialog).element.querySelector("."+ie).removeAttribute("disabled")},removed:function(){var e=q.liCollections,i=0;e.forEach((function(e){e.classList.contains("e-active")&&i++})),0===i&&(0,t.getInstance)((0,t.select)("#"+r.parentElement.id+"_GroupDialog",document),Ni.Dialog).element.querySelector("."+ie).setAttribute("disabled","disabled")}});q.isStringTemplate=!0,q.appendTo(L),V.value=void 0===A?null:new Date(A),V.dataBind(),H.value=void 0===R?null:new Date(R),H.dataBind()}else{var V,H,U=void 0;l&&"Number"===l.type?(U=l.rangeInterval,A=l.startingAt?l.startingAt.toString():void 0,R=l.endingAt?l.endingAt.toString():void 0):U=2,(V=new fs.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,showClearButton:!0,format:"###.##########",value:void 0===A?void 0:parseFloat(A),enabled:!(void 0===A),width:"100%",cssClass:this.parent.cssClass})).isStringTemplate=!0,V.appendTo(O),(H=new fs.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,showClearButton:!0,format:"###.##########",value:void 0===R?void 0:parseFloat(R),enabled:!(void 0===R),width:"100%",cssClass:this.parent.cssClass})).isStringTemplate=!0,H.appendTo(E);var _=new fs.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,showClearButton:!0,format:"###.##########",min:0,value:U,width:"100%",cssClass:this.parent.cssClass});_.isStringTemplate=!0,_.appendTo(L)}var B=new Os.CheckBox({label:this.parent.localeObj.getConstant("startAt"),checked:!(void 0===A),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass,change:function(e){var r="date"===i?(0,t.getInstance)((0,t.select)("#"+a.parentElement.id+"group_start_input"),Ms.DateTimePicker):(0,t.getInstance)((0,t.select)("#"+a.parentElement.id+"group_start_input"),fs.NumericTextBox);r.enabled=e.checked,r.dataBind()}});B.isStringTemplate=!0,B.appendTo(D);var G=new Os.CheckBox({label:this.parent.localeObj.getConstant("endAt"),checked:!(void 0===R),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass,change:function(e){var r="date"===i?(0,t.getInstance)((0,t.select)("#"+a.parentElement.id+"group_end_input"),Ms.DateTimePicker):(0,t.getInstance)((0,t.select)("#"+a.parentElement.id+"group_end_input"),fs.NumericTextBox);r.enabled=e.checked,r.dataBind()}});G.isStringTemplate=!0,G.appendTo(N)}return n},e.prototype.updateGroupSettings=function(e){var i=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"_GroupDialog",document),Ni.Dialog),a=i.element,r=a.getAttribute("data-type"),n=a.getAttribute("data-field"),s=Di.cloneGroupSettings(this.parent.dataSourceSettings.groupSettings);if(0===s.length&&!this.parent.clonedDataSet&&!this.parent.clonedReport){var o=this.parent.engineModule.data;this.parent.clonedDataSet="CSV"===this.parent.dataSourceSettings.type?Di.getClonedCSVData(o):Di.getClonedData(o),this.parent.setProperties({dataSourceSettings:{dataSource:[]}},!0),this.parent.clonedReport=(0,t.extend)({},this.parent.dataSourceSettings,null,!0),this.parent.setProperties({dataSourceSettings:{dataSource:o}},!0)}if("custom"===r){var l=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_input_option"),fs.MaskedTextBox),d=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_caption_option"),fs.MaskedTextBox);if((0,t.removeClass)([l.element],wt),null===l.value||""===l.value)return(0,t.addClass)([l.element],wt),void l.element.focus();for(var h=this.getSelectedOptions(e),p={groupName:l.value,items:h},u=[],c=[],g={name:n,caption:d.value,type:"Custom",customGroups:[]},m=!1,f=0,v=s.length;f<v;f++)if(s[f].name===n){(g=s[f]).caption=d.value;for(var S=0,y=g.customGroups.length;S<y;S++)if(g.customGroups[S]){var b=g.customGroups[S];b.items&&ul.isContainCommonElements(b.items,h)&&(u=this.mergeArray(u,[b.groupName]),c=this.mergeArray(c,b.items),g.customGroups.splice(S,1),S--,y--)}for(var C=0,x=h;C<x.length;C++){var w=x[C],T=c.indexOf(w);-1!==T&&c.splice(T,1)}c=this.mergeArray(c,[p.groupName]),g.customGroups.push(p),this.isUpdate=!0,m=!0;break}m||(g.customGroups.push(p),this.isUpdate=!0,s.push(g)),s=this.validateSettings(n,s,r,0===u.length?p.items:u,c)}else if("date"===r||"number"===r){var M=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_start_option"),Os.CheckBox),D=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_end_option"),Os.CheckBox),O="date"===r?(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_start_input"),Ms.DateTimePicker):(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_start_input"),fs.NumericTextBox),P="date"===r?(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_end_input"),Ms.DateTimePicker):(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_end_input"),fs.NumericTextBox),N="date"===r?(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_interval_input"),vs.MultiSelect):(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_interval_input"),fs.NumericTextBox);g={name:n,startingAt:M.checked?O.value.toString():void 0,endingAt:D.checked?P.value.toString():void 0};if("date"===r){for(var E=[],I=0,F=N.value;I<F.length;I++){var L=F[I];E.push(L)}g.type="Date",g.groupInterval=E}else g.type="Number",g.rangeInterval=N.value;for(m=!1,f=0,v=s.length;f<v;f++)if(s[f].name===n){s.splice(f,1,g),this.isUpdate=!0,m=!0;break}m||(this.isUpdate=!0,s.push(g)),s=this.validateSettings(n,s,r,[],[])}i.close(),this.updateDateSource(s,r)},e.prototype.getGroupBasedSettings=function(e){for(var t={},i=0,a=e;i<a.length;i++){var r=a[i];t[r.type]?t[r.type].push(r):t[r.type]=[r]}return t},e.prototype.getGroupByName=function(e){for(var t={},i=0,a=e;i<a.length;i++){var r=a[i],n=r.name.replace(/_custom_group/g,"");t[n]?t[n].push(r):t[n]=[r]}return t},e.prototype.validateSettings=function(e,t,i,a,r){var n=[],s=this.getGroupBasedSettings(t),o=["Date","Number","Custom"];if(s[o[2]]&&"custom"===i){var l=this.getGroupByName(s[o[2]]);if(l[e.replace(/_custom_group/g,"")]){var d=l[e.replace(/_custom_group/g,"")],h=d.map((function(e){return e.name}));d=r?this.modifyParentGroupItems(e,d,a,r,h):this.removeGroupSettings(e.replace("_custom_group",""),a,d,h)}for(var p=[],u=0,c=Object.keys(l);u<c.length;u++){var g=c[u];h=l[g].map((function(e){return e.name}));p=this.reOrderSettings(l[g],h,p,g,e)}s[o[2]]=p}else if(("date"===i||"number"===i)&&!r){var m="date"===i?s[o[0]]:s[o[1]];if("date"===i){s[o[0]]=m.filter((function(t){return t.name!==e}));var f=["_date_group_years","_date_group_quarters","_date_group_quarterYear","_date_group_months","_date_group_days","_date_group_hours","_date_group_minutes","_date_group_seconds"];if(0===s[o[0]].length){delete this.parent.engineModule.groupingFieldsInfo[e];var v=function(t){f.some((function(i){return t===""+e+i}))&&delete S.parent.engineModule.groupingFieldsInfo[t]},S=this;for(var y in this.parent.engineModule.groupingFieldsInfo)v(y);var b=function(t){f.some((function(i){return t===""+e+i}))&&delete C.parent.engineModule.fieldList[t]},C=this;for(var y in this.parent.engineModule.fieldList)b(y);var x=this.parent.engineModule.fields.filter((function(t){return!f.some((function(i){return t===""+e+i}))}));this.parent.engineModule.fields=x}}else s[o[1]]=m.filter((function(t){return t.name!==e}));this.isUpdate=!0}for(var w=0,T=o;w<T.length;w++){var M=T[w];s[M]&&(n=n.concat(s[M]))}return n},e.prototype.reOrderSettings=function(e,i,a,r,n){var s=i.indexOf(r);if(s>-1&&e[s].customGroups&&e[s].customGroups.length>0)a.push(e[s]),this.reOrderSettings(e,i,a,r+"_custom_group");else if(s>-1&&e[s].customGroups&&0===e[s].customGroups.length&&!(0,t.isNullOrUndefined)(n)){delete this.parent.engineModule.fieldList[n],delete this.parent.engineModule.groupingFieldsInfo[n];var o=this.parent.engineModule.fields.filter((function(e){return e!==n}));this.parent.engineModule.fields=o}return a},e.prototype.modifyParentGroupItems=function(e,t,i,a,r){var n=r.indexOf(e+"_custom_group");if(-1!==n){var s=t[n];if(s.customGroups&&s.customGroups.length>0)for(var o=0,l=s.customGroups.length;o<l;o++)if(s.customGroups[o]){var d=!1,h=s.customGroups[o];if(h.items){for(var p=0,u=i;p<u.length;p++){var c=u[p],g=h.items.indexOf(c);-1!==g&&(h.items.splice(g,1),this.isUpdate=!0,d=!0)}d&&(h.items=this.mergeArray(h.items,a))}}}return t},e.prototype.mergeArray=function(e,t){for(var i=[],a=e.concat(t),r=a.length,n={};r--;){var s=String(a[r]);n[s]||(i.unshift(s),n[s]=!0)}return i},e.prototype.removeDialog=function(){if(!(this.parent.grid&&this.parent.grid.isDestroyed||(0,t.isNullOrUndefined)(this.parent.grid))){this.parent.grid.clearSelection();var e=(0,t.select)("#"+this.parent.element.id+"_GroupDialog",document),i=e?(0,t.getInstance)(e,Ni.Dialog):null;i&&!i.isDestroyed&&i.destroy(),this.parent.element&&document.getElementById(this.parent.element.id+"_GroupDialog")&&(0,t.remove)(document.getElementById(this.parent.element.id+"_GroupDialog"))}},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on(Mr,this.render,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.removeDialog(),this.parent.off(Mr,this.render))},e.prototype.destroy=function(){this.removeEventListener()},e}()})(),S})()));